Lyte.Mixin.register("crux-element-validation",{isValidDate:function(e,t){if(!e)return!1;t=(t=(t=t||this.getData("cxPropDatePattern")).toUpperCase()).replace(/'/g,""),e=e.replace(/'/g,"");try{return $L.moment(e,t,{i18n:!0}).validate()}catch(e){return!1}},isEmoji:function(e){return!!/([\uD800-\uDBFF][\uDC00-\uDFFF])/i.test(e)},SplitWord:function(e){e=e.split(",");for(var t,o,a=[],r=0;r<e.length;r++)-1!=(o=e[r].indexOf("\\"))&&e[r].length-2==o?(t=e[r].slice(0,e[r].length-2)+","+e[r+1],Lyte.arrayUtils(a,"push",t),r+=1):""!=e[r]&&Lyte.arrayUtils(a,"push",e[r]);return 1==a.length?a[0]:a},dateValidate:function(e){var t=this.isValidDate(e.value.trim(),this.getData("cxPropDatePattern"));if(!t){var o=this.getData("cxPropField"),a=(o.errorFieldLabel?o.errorFieldLabel:o.field_label).replace(/_____/g,")").replace(/____/g,"(").replace(/___/g,"."),r=_cruxUtils.getI18n("crm.field.valid.check",Lyte.Component.registeredHelpers.cruxEncodeHTML(a));this.showAlert(r,e),e.setAttribute("autocomplete","off")}return t},patternValidate:function(e,t,o,a){!this.isValidDate(o.value,this.getData("cxPropDatePattern"))&&this.$node.querySelector("lyte-input").calendarDiv&&this.$node.querySelector("lyte-input").calendarDiv.querySelector("lyte-calendar").revertToToday()},showAlertMsg:function(e){var t=document.getElementById("cruxElementAlert");t||(t=Lyte.Component.render("lyte-alert",{id:"cruxElementAlert",ltPropShowCloseButton:!1,ltPropButtonPosition:"center",ltPropButtons:[{type:"accept",text:_cruxUtils.getI18n("crm.mb.newversion.msg4"),appearance:"primary"}],ltPropContentAlign:"center"},"body"));var o=document.createElement("span");o.innerHTML=e,t.ltProp({secondaryMessage:o.innerText,top:"0px"}),t.ltProp("show",!0);var a=this;t.setMethods({onClose:function(){a&&a.$node.querySelector("lyte-input")?a.$node.querySelector("lyte-input").focus():a&&a.$node.querySelector("lyte-number")&&a.$node.querySelector("lyte-number").focus()}.bind(this)})},showAlert:function(e,t){if(this.getMethods("onError")){if(!this.executeMethod("onError",e,this))return!1}t&&t.focus(),this.showAlertMsg(e)},showMsgBox:function(e,t,o){if(this.getMethods("onError")){if(!this.executeMethod("onError",e,this))return!1}var a=document.getElementById("lyteMsgBox");o||(o={}),o.ltPropType=t,o.ltPropMessage=e,o.id="lyteMsgBox",a&&a.ltProp("show",!1),(a=Lyte.Component.render("lyte-messagebox",o,"body")).setMethods("onClose",function(e){document.body.removeChild(e.$node)}),a.ltProp("show",!0)},getDateInUserDatePattern:function(e,t){return t=(t=t||this.getData("cxPropDatePattern")).toUpperCase(),$L.moment(e).format(t)},getTimeInUserFormat:function(e,t){var o=e.getHours(),a=e.getMinutes()<10?"0"+e.getMinutes():e.getMinutes(),r="";if("12"==(t=t||this.getData("cxPropTimeFormatInput"))){var i="PM";o>12?r=(o-=12)<10?"0"+o:o:0==o?(r="12",i="AM"):(r=o,o<10&&(r="0"+r),12!=o&&(i="AM")),r+=":"+a+" "+_cruxUtils.getI18n(i)}else o<10&&o.toString().length<2&&(o="0"+o),r=o+":"+a;return r},getDateObject:function(e,t,o){o=(o=o?o.toUpperCase():this.getData("cxPropDatePattern").toUpperCase()).replace(/'/g,"");var a=$L.moment(e,o,{i18n:!0}).getDObj();if(!a)return"";if(t){var r=t.match(/(\d{1,2}):(\d{1,2})/),i=(t=t.replace(_cruxUtils.getI18n("AM"),"AM").replace(_cruxUtils.getI18n("PM"),"PM")).match(/([A,P]M)/);if(t=t.split(":"),i){var s=this.convertTimeTo24HoursFormat(parseInt(r[0]),i[1]);a.setHours(s)}else a.setHours(t[0]);a.setMinutes(t[1].split(" ")[0])}return a},convertTimeTo24HoursFormat:function(e,t){return"am"==(t=t.toLowerCase())?0==e?12:12==e?0:e:"pm"==t?12==e?e:e+12:t==_cruxUtils.getI18n("AM")||_cruxUtils.getI18n("am")==t?0==e?12:12==e?0:e:t==_cruxUtils.getI18n("PM")||_cruxUtils.getI18n("pm")==t?12==e?e:e+12:void 0},isValidInteger:function(e){if(""==e)return!0;return!(isNaN(e)||-1!=e.indexOf(".")||!/^-?\d+(,(\d)+)*$/.test(e))},isValidDecimal:function(e){if(""==e)return!0;var t=/^-?(\d+)?(\.){0,1}(\d+)*$/.exec(e);return!!t&&(void 0!=t[1]||void 0!=t[3])},decimalLengthCheck:function(e,t){if(""==e)return!0;var o=/^-?(\d+)?(\.){0,1}(\d+)*$/.exec(e);if(!o)return!1;var a=o[3];return t=t||this.getData("cxPropField"),!(a&&a.length>t.decimal_place)},convertCurrencyValue:function(e,t,o,a,r,i,s,l,p,n){var c=void 0!=n?parseFloat(t):this.getNumberWithCommas(parseFloat(t),",",".");o=o||this.getData("cxPropDefaultRoundOff");var d=parseFloat(t),u=(parseInt(d+"")+"").length,x=void 0!=n?n:Number(parseFloat(t).toPrecision(u+o)).toFixed(o);if(p=0!=p,(a=a||this.getData("cxPropCurrencyDetails"))[r=r||this.getData("cxPropCurrencyCode")]&&e){o=parseInt(a[r].decimals);var m,y=parseInt(a[e].decimals);m=s?t*s:i?t/parseFloat(i)+"":t/parseFloat(a[e].er)+"";var h=a[e].format.split("|"),f=a[r].format.split("|"),P=void 0!=n?n:this.getNumberWithCommas(parseFloat(t).toFixed(y),h[0],h[1]);if(c=p?a[e].symbol+" ":"",e==r||0==P)c+=P;else if(l)c=c+P+" ("+a[r].symbol+" "+this.getNumberWithCommas(l,f[0],f[1])+")";else{var g=parseFloat(m).toPrecision((parseInt(m)+"").length+o);c=c+P+" ("+a[r].symbol+" "+this.getNumberWithCommas(parseFloat(g).toFixed(o),f[0],f[1])+")"}}else if(this.getData("cxPropDefaultOrgCurrency")){h=this.getData("cxPropDefaultOrgCurrency")&&"object"==typeof this.getData("cxPropDefaultOrgCurrency")&&this.getData("cxPropDefaultOrgCurrency").format?this.getData("cxPropDefaultOrgCurrency").format.split("|"):[",","."];c=p?this.getData("cxPropDefaultOrgCurrency")+" ":"",c+=this.getNumberWithCommas(x,h[0],h[1],void 0!=n)}else if(a&&r&&a[r]){h=a[r].format.split("|");c=p?a[r].symbol+" ":"",c+=this.getNumberWithCommas(x,h[0],h[1],void 0!=n)}return c},getNumberWithCommas:function(e,t,o,a){if(a)return e.toString();t=t||",",o=o||".";var r=e.toString().split(".");return r[0]=r[0].replace(/\B(?=(\d{3})+(?!\d))/g,t),r.join(o)},isValidPhoneNo:function(e,t){if(!this.validateLength(e,t))return!1;var o=e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=e.replace(/[;,](?!.)/,"")).replace(/\s{2,}/g," ")).replace(/\s-/g,"-")).replace(/-\s/g,"-")).replace(/\s\./g,".")).replace(/\.\s/g,".")).replace(/\s;/g,";")).replace(/;\s/g,";")).replace(/\s,/g,",")).replace(/,\s/g,",")).replace(/\(\s/g,"(")).replace(/\s\)/g,")");t=(o=o.replace(/\)(?![\s;,\-\/])/g,") ")).length;if(""==o)return!1;for(var a=o[0],r=1;r<t;r++)"("==o[r]&&" "!=o[r-1]?a=a+" "+o[r]:a+=o[r];return a=(a=a.replace(/^\s+/,"")).replace(/\s+$/,""),!!/^([\+]?)(?![\.-])((?=([\.\/-]?[ ]?[\da-zA-Z]+))\3+|([ ]?\((?![\.-])(?=[ \.-]?[\da-zA-Z]+)([ \.-]?[\da-zA-Z]+)+\)(?!\.)([ -][\da-zA-Z]+)?)+)+((([,]+)?[;]?([\*#]+)?[\da-zA-Z]+)+)?[#;]?$/.test(e=a)},isValidTwitter:function(e){if(""==e)return!0;if(e.trim().length<=50&&e.trim().length>0){return/^[a-zA-Z0-9_]*$/.test(e)}return!1},isValidWebUrl:function(e){if(""==e)return!0;return new RegExp('^(http:\\/\\/www.|https:\\/\\/www.|ftp:\\/\\/www.|www.|http:\\/\\/|https:\\/\\/|ftp:\\/\\/|){1}[^\0-"-\'*-,.-/:-?[-^`{}- ]+(\\.[^\0-"$-,.-/<>@[-^`{}- ]+)+([/?].*)*$').test(e)},getNumberValueForView:function(e,t,o,a,r,i,s,l,p,n,c,d,u){if("currency"==t||39==a||36==a||77==a){if(r=r||this.getData("cxPropCurrencyDetails"),o&&r){for(var x in r)if(r[x].symbol==o){o=x;break}}else o=void 0;e=this.convertCurrencyValue(o,e,i,r,s,l,p,n,c,d)}else 38!=a&&34!=a&&40!=a&&"double"==t&&e%1==0&&(e=e/1+".0");return u&&"undefined"!=typeof Search&&Search.formatNumber?Search.formatNumber(e):e.toString()},validateNumberField:function(e,t,o,a,r){return e&&""!=e.trim()?o&&e.length>o?(this.getMethods("onError")?this.executeMethod("onError",this.errorCodes.ERR04,this):this.setData("cxPropErrorMessage",_cruxUtils.getI18n("crm.field.length.check",Lyte.Component.registeredHelpers.cruxEncodeHTML(t.field_label))),!1):a&&e>a?(this.getMethods("onError")?this.executeMethod("onError",this.errorCodes.ERR02,this):this.setData("cxPropErrorMessage",_cruxUtils.getI18n("crm.custom.field.less.than.equalto",Lyte.Component.registeredHelpers.cruxEncodeHTML(t.field_label),a)),!1):r&&e<r?(this.getMethods("onError")?this.executeMethod("onError",this.errorCodes.ERR02,this):this.setData("cxPropErrorMessage",_cruxUtils.getI18n("crm.custom.field.greater.than.equalto",Lyte.Component.registeredHelpers.cruxEncodeHTML(t.field_label),r)),!1):"integer"==t.data_type||"bigint"==t.data_type?((i=this.isValidInteger(e))||(this.getMethods("onError")?this.executeMethod("onError",this.errorCodes.ERR02,this):this.setData("cxPropErrorMessage",_cruxUtils.getI18n("crm.field.valid.check",Lyte.Component.registeredHelpers.cruxEncodeHTML(t.field_label)))),i):((i=this.isValidDecimal(e))?(i=this.decimalLengthCheck(e,t))||(this.getMethods("onError")?this.executeMethod("onError",this.errorCodes.ERR03,this):this.setData("cxPropErrorMessage",_cruxUtils.getI18n("crm.field.valid.decimal.check2",Lyte.Component.registeredHelpers.cruxEncodeHTML(t.field_label),t.decimal_place))):this.getMethods("onError")?this.executeMethod("onError",this.errorCodes.ERR02,this):this.setData("cxPropErrorMessage",_cruxUtils.getI18n("crm.field.valid.check",Lyte.Component.registeredHelpers.cruxEncodeHTML(t.field_label))),i):this.validateMandatory(!0);var i},validatePhoneNumber:function(e,t){if(!t||""==t.trim())return this.validateMandatory(!0)?t?(this.getMethods("onError")?this.executeMethod("onError",this.errorCodes.ERR02,this):this.setData("cxPropErrorMessage",_cruxUtils.getI18n("crm.field.valid.check",Lyte.Component.registeredHelpers.cruxEncodeHTML(e.field_label))),this.$node.querySelector("lyte-input")&&this.$node.querySelector("lyte-input").focus(),!1):(this.setData("cxPropErrorMessage",""),!0):(this.$node.querySelector("lyte-input")&&this.$node.querySelector("lyte-input").focus(),!1);var o;if(this.data&&this.data.cxPropEnableCountryCode&&t.startsWith("+"))try{o=ZlibPhoneNumber.isValidNumber(t)}catch(e){"undefined"!=typeof murphy&&murphy.error(e),o=!1}else o=this.isValidPhoneNo(t);return o?this.setData("cxPropErrorMessage",""):(this.getMethods("onError")?this.executeMethod("onError",this.errorCodes.ERR02,this):this.setData("cxPropErrorMessage",_cruxUtils.getI18n("crm.field.valid.check",Lyte.Component.registeredHelpers.cruxEncodeHTML(e.field_label))),this.$node.querySelector("lyte-input")&&this.$node.querySelector("lyte-input").focus()),o},errorCodes:{ERR01:"value_empty",ERR02:"value_invalid",ERR03:"decimal_check",ERR04:"maxlength_check"},validateLength:function(e,t){return!((t=t||this.data.cxPropMaxlength)&&e.length>t)||(this.getMethods("onError")?this.executeMethod("onError",this.errorCodes.ERR04,this):this.setData("cxPropErrorMessage",_cruxUtils.getI18n("crm.field.length.check",Lyte.Component.registeredHelpers.cruxEncodeHTML(this.getData("cxPropField").field_label))),this.$node&&this.$node.querySelector("lyte-input")&&this.$node.querySelector("lyte-input").focus(),!1)},validateText:function(e,t,o,a){return this.validateMandatory(!t||""==t.trim(),void 0,e,a)?!(t&&!this.validateLength(t,o))&&(this.setData("cxPropErrorMessage",""),!0):(this.$node&&this.$node.querySelector("lyte-input")&&this.$node.querySelector("lyte-input").focus(),!1)},phoneClick:function(e,t,o,a){event.preventDefault(),"undefined"!=typeof ctiApiNotifier&&ctiApiNotifier.click2Call(e,Crm.userDetails.ZGID,Crm.userDetails.USER_ID,t,"",o,a),event.stopPropagation()},phoneMouseOver:function(e){e.querySelector("a")&&(e.querySelector("a").style.visibility="visible")},phoneMouseOut:function(e){e.querySelector("a")&&(e.querySelector("a").style.visibility="hidden")},stopPropagation:function(){return event.stopPropagation(),!1},toPrecision:function(e,t){var o=(e=e.toString()).split("."),a=o[0],r=a.length;o.length<2&&(o[1]="");for(var i=r,s=0;i<t;i++,s++)0==s&&(a+="."),o[1][s]?a+=o[1][s]:a+="0";return a},getDateObjectFromString:function(e,t,o){if(!e)return new Date;if(!e.getMonth){if(!t)e.indexOf(":")>-1&&(o=o||Crm.userDetails.TIME_FORMAT,(e.indexOf("AM")>1||e.indexOf("PM")>1)&&(o=o.replace("a","A")),t+=" "+o);var a=$L.moment(e.trim(),t.toUpperCase().trim()).getDObj();return a||(a=new Date),a}return e},checkBrackets:function(e){var t=[];for(var o in e)if("("==e[o])t.push(e[o]);else if(")"==e[o]){if(!t.length)return!1;t.pop()}return!t.length},checkCorrectInputEle:function(e){for(var t=e.split(""),o=["(",")"],a=0;a<t.length;a++){var r=t[a];if(-1!=o.indexOf(r)){var i=a+1,s=/\d/,l=a-1;if("("==r){if(void 0!=t[l]&&(s.test(t[l])||")"==t[l]||"."==t[l]))return!1;if(void 0!=t[i]){if(-1!=["/","*"].indexOf(t[i]))return!1}}else if(")"==r){if(void 0!=t[i]&&(s.test(t[i])||"."==t[i]||"("==t[l]))return!1;if(void 0!=t[l]){if(-1!=["+","-","*","/"].indexOf(t[l])||"."==t[l])return!1}}}}return!0},clearLeadingZero:function(e){for(var t,o=/[\d\.]+/gm;null!==(t=o.exec(e));)-1==(t=t.toString()).indexOf(".")&&void 0!=t.match(/(^0{1,}(?!($|\.)))/g)&&(e=e.replace(t,t.replace(/(^0{1,}(?!($|\.)))/g,"")));return e},checkDotCorrectInput:function(e){for(var t=e.split(/[+\-*/,]+/),o=t.length,a=0;a<o;a++){if(t[a].split(".").length>2)return!1}return!0},getDateTimeInUserFormat:function(e,t,o,a){var r=this.getDateInUserDatePattern(e);return r+=" "+this.getTimeInUserFormat(e,t,a)},showHideInfoTooltip:function(e){var t;e?((t=$L(e)).addClass("cxCurrentHovercard"),t.next()[0].ltProp("show",!0)):(t=this.$node.querySelector(".cxCurrentHovercard"),$L(t).removeClass("cxCurrentHovercard"))},validateMandatory:function(e,t,o,a){return o=o||this.data.cxPropField,!((a=a||this.data.cxPropLayout)&&o[a]?o[a].required:o.required)||!e||(void 0!==t?t():this.getMethods("onError")?this.executeMethod("onError",this.errorCodes.ERR01,this):this.setData("cxPropErrorMessage",_cruxUtils.getI18n("crm.field.empty.check",Lyte.Component.registeredHelpers.cruxEncodeHTML(this.getData("cxPropField").field_label))),!1)},setFocusUtil:function(){this.$node.focus=function(){var e=this.$node.querySelector("input");(e=e||this.$node.querySelector("textarea"))&&e.focus(),e&&(e.selectionStart=e.value.length)}.bind(this)},observeMandatoryMixin:function(e,t){var o=this.$node.querySelector(e);if(o&&"create"==this.getData("cxPropFrom")){var a=this.data.cxPropLayout?this.data.cxPropField[this.data.cxPropLayout].required:this.data.cxPropField.required;t=t||"mandatoryField",a?o.classList.add(t):o.classList.remove(t)}},setSelectUtil:function(){this.$node.select=function(){var e=this.$node.querySelector("lyte-input");e&&e.select()}.bind(this)}}),Lyte.Component.register("crux-boolean-component",{_template:'<template tag-name="crux-boolean-component"> <template is="switch" value="{{cxPropFrom}}"><template case="view"> <template is="if" value="{{cxPropValue}}"><template case="true"> <span id="{{cxPropId}}" class="criteria-yes"></span> </template><template case="false"><template is="if" value="{{cxPropEmptyValue}}"><template case="true">{{cxPropEmptyValue}}</template></template></template></template> <template is="if" value="{{cxPropViewInfoTooltip}}"><template case="true"> <crux-view-info-tooltip cx-prop-field="{{cxPropField}}" cx-prop-value="{{cxPropValue}}"> <template is="yield" yield-name="viewInfoTooltipYield"> <lyte-yield yield-name="viewInfoTooltipYield" prop-field="{{propField}}" prop-value="{{propValue}}"></lyte-yield> </template> </crux-view-info-tooltip> </template></template> </template><template case="criteria"></template><template case="filter"> <lyte-dropdown on-option-selected="{{method(\'onOptionSelected\')}}" lt-prop-yield="true" lt-prop-tabindex="1" lt-prop-selected="{{value}}" class="{{if(ifEquals(cxPropAppearance,\'flat\'),\'cxFlatDropdown\',\'cxBoxDropdown\')}} {{cxPropClass}}"> <template is="registerYield" yield-name="yield"> <lyte-drop-button data-zcqa="{{cxPropZcqa}}"> <span class="lyteMarginRight cruxBoolColor">{{selectedLabel}}</span> <lyte-icon class="dropdown"></lyte-icon> </lyte-drop-button> <lyte-drop-box class="cxDropbox"> <lyte-drop-body> <template is="for" items="{{cxPropConditions}}" item="item" index="index"> <lyte-drop-item data-value="{{item.value}}" class="criteria-option {{if(ifEquals(value,item.value),\'criteria-option-selected\')}} {{if(ifEquals(cxPropFrom,\'criteria\'),\'criteria-option-from\')}}" data-zcqa="{{concat(cxPropField.field_label,\'_\',item.label)}}">{{item.label}}</lyte-drop-item> </template> </lyte-drop-body> </lyte-drop-box> </template> </lyte-dropdown> </template><template case="create"> <template is="if" value="{{cxPropField[cxPropFieldKey]}}"><template case="true"> <div class="cxElementLabel {{cxPropLabelClass}}"> {{cxPropField[cxPropFieldKey]}} <template is="if" value="{{cxPropInfoTooltip}}"><template case="true"> <span class="dIB vam cxInfoIcon" onmouseenter="{{action(\'showInfoTooltip\',this)}}"></span> <lyte-hovercard lt-prop-placement="topLeft" lt-prop-keep-alive="true" lt-prop-popover-wrapper-class="cxElementsHovercard" lt-prop-origin-elem=".cxCurrentHovercard" on-hovercard-hide="{{method(\'hideInfoTooltip\')}}"> <template is="registerYield" yield-name="hoverCardYield"> <lyte-hovercard-content class="cxElementsHoverCardContent"> {{cxPropInfoTooltip}} </lyte-hovercard-content> </template> </lyte-hovercard> </template></template> </div> </template></template> <div class="cxElementValue {{if(cxPropDisabled,\'cxElementDisabled\',\'\')}}"> <lyte-checkbox lt-prop-name="{{cxPropName}}" id="{{cxPropId}}" lt-prop-title="{{cxPropTooltip}}" lt-prop-tooltip-config="{{cxPropTooltipConfig}}" lt-prop-checked="{{lbind(cxPropValue)}}" lt-prop-type="{{cxPropType}}" lt-prop-disabled="{{cxPropDisabled}}" on-changed="{{method(\'onChange\')}}" onclick="{{action(\'onClicked\')}}" class="{{cxPropClass}} {{if(isError,\'cxErrorBox\')}} {{if(cxPropField.required,\'mandatoryField\',\'\')}}" data-zcqa="{{cxPropZcqa}}" lt-prop-tooltip-class="{{cxPropTooltipClass}}" lt-prop-tooltip-style="font-size : 11px; margin: 10px;" lt-prop-tabindex="{{cxPropTabIndex}}" lt-prop-aria="{{cxPropAria}}" lt-prop-aria-attributes="{{cxPropAriaAttributes}}" lt-prop-class="{{cxPropInputClass}}" lt-prop-read-only="{{cxPropReadonly}}" on-before-checked="{{method(\'beforeChecked\')}}" on-before-unchecked="{{method(\'beforeUnchecked\')}}"></lyte-checkbox> <template is="if" value="{{isError}}"><template case="true"> <crux-error-message error-message="{{cxPropErrorMessage}}" cx-prop-error-yield="{{cxPropErrorYield}}" cx-prop-error-zcqa-prefix="{{cxPropErrorZcqaPrefix}}" cx-prop-field="{{cxPropField}}" cx-prop-error-zcqa-suffix="{{cxPropErrorZcqaSuffix}}" class="{{cxPropErrorClass}}" cx-prop-error-span-class="{{cxPropErrorSpanClass}}"> <template is="registerYield" yield-name="errorYield"><lyte-yield yield-name="errorYield" error-message="{{cxPropErrorMessage}}" cx-field="{{cxPropField}}"></lyte-yield></template> </crux-error-message> </template></template> </div> </template></template> </template>',_dynamicNodes:[{type:"attr",position:[1]},{type:"switch",position:[1],cases:{view:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"text",position:[0]}]}},default:{}}]}},default:{}},{type:"attr",position:[3]},{type:"if",position:[3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"insertYield",position:[1]}]},{type:"componentDynamic",position:[1]}]}},default:{}}]},criteria:{dynamicNodes:[],additional:{next:"filter"}},filter:{dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,1,0]},{type:"componentDynamic",position:[1,3]},{type:"componentDynamic",position:[1]},{type:"attr",position:[3,1,1]},{type:"for",position:[3,1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,0]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[3,1]},{type:"componentDynamic",position:[3]}]},{type:"componentDynamic",position:[1]}]},create:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,1]},{type:"attr",position:[1,3]},{type:"if",position:[1,3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[3]},{type:"registerYield",position:[3,1],dynamicNodes:[{type:"text",position:[1,1]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[3]}]}},default:{}}]}},default:{}},{type:"attr",position:[3]},{type:"attr",position:[3,1]},{type:"componentDynamic",position:[3,1]},{type:"attr",position:[3,3]},{type:"if",position:[3,3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"attr",position:[0]},{type:"insertYield",position:[0]}]},{type:"componentDynamic",position:[1]}]}},default:{}}]}},default:{}}],_observedAttributes:["lyteViewPort","cxPropFrom","cxPropField","cxPropFieldKey","cxPropValue","cxPropConditions","selectedLabel","cxPropDisabled","cxPropZcqa","cxPropValue","cxPropErrorMessage","cxPropType","cxPropId","cxPropName","cxPropClearErrorMessage","cxPropLabelClass","cxPropReadonly","cxPropClass","lyteUnbound","cxPropEmptyValue","cxPropTooltip","cxPropErrorYield","cxPropInfoTooltip","cxPropAppearance","cxPropAria","cxPropAriaAttributes","isError","cxPropTooltipConfig","cxPropTooltipClass","cxPropErrorZcqaPrefix","cxPropErrorZcqaSuffix","cxPropErrorClass","cxPropInputClass","cxPropErrorSpanClass","cxPropType","cxPropLayout","cxPropViewInfoTooltip","cxPropNoneSelected"],data:function(){return{lyteViewPort:Lyte.attr("boolean",{default:!1}),cxPropFrom:Lyte.attr("string",{default:"view"}),cxPropField:Lyte.attr("object",{default:{}}),cxPropFieldKey:Lyte.attr("string",{default:""}),cxPropValue:Lyte.attr("boolean"),cxPropConditions:Lyte.attr("array",{default:[{value:"1",label:_cruxUtils.getI18n("crm.label.selected")},{value:"0",label:_cruxUtils.getI18n("crm.label.notSelected")}]}),selectedLabel:Lyte.attr("string",{default:_cruxUtils.getI18n("crm.select")}),cxPropDisabled:Lyte.attr("boolean",{default:!1}),cxPropZcqa:Lyte.attr("string"),cxPropValue:Lyte.attr("boolean"),cxPropErrorMessage:Lyte.attr("string",{default:""}),cxPropType:Lyte.attr("string"),cxPropId:Lyte.attr("string",{default:""}),cxPropName:Lyte.attr("string",{default:""}),cxPropClearErrorMessage:Lyte.attr("boolean",{default:!0}),cxPropLabelClass:Lyte.attr("string",{default:""}),cxPropReadonly:Lyte.attr("boolean",{default:!1}),cxPropClass:Lyte.attr("string",{default:""}),lyteUnbound:Lyte.attr("boolean",{default:!1}),cxPropEmptyValue:Lyte.attr("string",{default:""}),cxPropTooltip:Lyte.attr("string",{default:""}),cxPropErrorYield:Lyte.attr("boolean",{default:!1}),cxPropInfoTooltip:Lyte.attr("string",{default:""}),cxPropAppearance:Lyte.attr("string",{default:"flat"}),cxPropAria:Lyte.attr("boolean",{default:!1}),cxPropAriaAttributes:Lyte.attr("object",{default:{}}),isError:Lyte.attr("boolean",{default:!1}),cxPropTooltipConfig:Lyte.attr("string",{default:'{"position": "followcursor", "appearance": "box"}'}),cxPropTooltipClass:Lyte.attr("string",{default:"cxtooltip"}),cxPropErrorZcqaPrefix:Lyte.attr("string",{default:""}),cxPropErrorZcqaSuffix:Lyte.attr("string",{default:"Error"}),cxPropErrorClass:Lyte.attr("string"),cxPropInputClass:Lyte.attr("string",{default:""}),cxPropErrorSpanClass:Lyte.attr("string"),cxPropType:Lyte.attr("string",{default:"default"}),cxPropLayout:Lyte.attr("string"),cxPropViewInfoTooltip:Lyte.attr("boolean",{default:!1}),cxPropNoneSelected:Lyte.attr("boolean",{default:!1})}},actions:{onClicked:function(){this.getMethods("onClicked")&&this.executeMethod("onClicked")},showInfoTooltip:function(e){this.showHideInfoTooltip(e)}},methods:{onOptionSelected:function(e,t){this.setData("value",t),this.prevent=!0,this.setData("cxPropValue","1"==t),this.setSelectedLabel(),this.getMethods("onValueChange")&&this.executeMethod("onValueChange",this.getValue())},onChange:function(){this.data.cxPropClearErrorMessage&&this.setData("cxPropErrorMessage",""),this.getMethods("onValueChange")&&(this.setData("cxPropValue",this.$node.querySelector("lyte-checkbox").ltProp("checked")),this.executeMethod("onValueChange",this.getData("cxPropValue")))},hideInfoTooltip:function(){this.showHideInfoTooltip()},beforeChecked:function(){if(this.data.cxPropReadonly)return!1},beforeUnchecked:function(){if(this.data.cxPropReadonly)return!1}},init:function(){var e=this.data.cxPropFrom;"criteria"!=e&&"filter"!=e||this.data.cxPropNoneSelected?(Lyte.arrayUtils(this.data.cxPropConditions,"unshift",[{value:"-1",label:_cruxUtils.getI18n("crm.select")}]),this.data.value="-1"):(void 0==this.data.cxPropValue?(this.data.value="1",this.data.cxPropValue=!0):this.data.value=this.data.cxPropValue?"1":"0",this.setSelectedLabel()),this.getData("cxPropDisabled")&&!this.data.cxPropTooltip&&this.setData("cxPropTooltip",_cruxUtils.getI18n("crm.lable.read.only")),-1==["primary","switch","slider"].indexOf(this.data.cxPropType)&&this.setData("cxPropType","default"),this.$node.focus=function(){this.$node.querySelector("lyte-checkbox")&&this.$node.querySelector("lyte-checkbox").focus()}.bind(this)},getValue:function(){return"-1"==this.data.value&&"create"!=this.data.cxPropFrom?-1:!!this.data.cxPropValue&&this.data.cxPropValue},validate:function(){if("create"==this.data.cxPropFrom){var e=this.validateMandatory(!this.data.cxPropValue);return e&&this.setData("cxPropErrorMessage",""),e}return!0},setSelectedLabelObs:function(){this.prevent||(this.setData("value",1==this.data.cxPropValue?"1":"0"),delete this.prevent,this.setSelectedLabel())}.observes("cxPropValue"),setSelectedLabel:function(){for(var e=this.data.value,t=this.data.cxPropConditions,o=0;o<t.length;o++)if(t[o].value==e){this.setData("selectedLabel",t[o].label);break}},observeErrorMessage:function(){this.setData("isError",""!=this.data.cxPropErrorMessage)}.observes("cxPropErrorMessage"),observeMandatory:function(){this.observeMandatoryMixin("lyte-checkbox")}.observes("cxPropField.required").on("didConnect"),observeIsError:function(){"create"==this.getData("cxPropFrom")&&(this.getData("isError")?this.$node.querySelector("lyte-checkbox").classList.add("cxErrorBox"):this.$node.querySelector("lyte-checkbox").classList.remove("cxErrorBox"))}.observes("isError","lyteViewPort").on("didConnect")},{mixins:["crux-element-validation"]}),Lyte.Component.register("crux-date-component",{_template:'<template tag-name="crux-date-component"> <template is="switch" value="{{cxPropFrom}}"><template case="view"> <span id="{{cxPropId}}" class="cxElementViewValue"> <template is="if" value="{{cxPropValue}}"><template case="true">{{cxPropValue}} <template is="if" value="{{cxPropViewInfoTooltip}}"><template case="true"> <crux-view-info-tooltip cx-prop-field="{{cxPropField}}" cx-prop-value="{{cxPropValue}}"> <template is="yield" yield-name="viewInfoTooltipYield"> <lyte-yield yield-name="viewInfoTooltipYield" prop-field="{{propField}}" prop-value="{{propValue}}"></lyte-yield> </template> </crux-view-info-tooltip> </template></template> </template><template case="false"><template is="if" value="{{cxPropEmptyValue}}"><template case="true">{{cxPropEmptyValue}}</template></template></template></template> </span> </template><template case="criteria"> <lyte-input lt-prop-name="{{cxPropName}}" id="{{cxPropId}}" lt-prop-boundary="{{cxPropBoundary}}" class="{{cxPropClass}} cxFlex {{if(ifEquals(cxPropAppearance,\'box\'),\'cxBoxInput\',\'cxFlatInput\')}}" lt-prop-type="date" lt-prop-id="searchValue" lt-prop-calendar-class="cxCriteriaCalendar" lt-prop-placeholder="{{cxPropDatePattern}}" lt-prop-format="{{format}}" on-navigate="{{method(\'navigation\')}}" lt-prop-bind-to-body="false" lt-prop-start-week-day="{{cxPropStartWeekDay}}" lt-prop-current-date="{{cxPropValue}}" on-date-change="{{method(\'onDateChange1\')}}" data-zcqa="{{cxPropZcqa}}" lt-prop-min-date="{{cxPropMinDate}}" on-calendar-open="{{method(\'onCalendarOpenComp\')}}" lt-prop-appearance="{{cxPropAppearance}}" on-before-calendar-close="{{method(\'cruxOnBeforeCalendarClose\')}}" on-calendar-close="{{method(\'cruxOnCalendarClose\')}}" lt-prop-header-type="{{cxPropHeaderType}}" lt-prop-auto-update="false" lt-prop-calendar-properties="{&quot;i18n&quot; : true,&quot;disableNavigation&quot; : true}" lt-prop-wrapper-class="{{cxPropWrapperClass}}" lt-prop-prevent-keys="{{cxPropPreventKeys}}" lt-prop-yield="{{cxPropYield}}" lt-prop-tab-index="{{cxPropTabIndex}}"> <template is="if" value="{{cxPropYield}}"><template case="true"> <template is="yield" yield-name="footer"><lyte-yield yield-name="footer"></lyte-yield></template> </template></template> </lyte-input> </template><template case="filter"> <lyte-input class="lyteInputBox cxBoxInput {{cxPropClass}}" lt-prop-appearance="box" lt-prop-name="{{cxPropName}}" id="{{cxPropId}}" lt-prop-calendar-class="smartFilterCal" lt-prop-boundary="{{cxPropBoundary}}" lt-prop-type="date" lt-prop-id="searchValue" on-navigate="{{method(\'navigation\')}}" lt-prop-placeholder="{{cxPropPlaceholder}}" lt-prop-format="{{format}}" lt-prop-class="cxFilterDateClass {{cxPropInputClass}}" lt-prop-start-week-day="{{cxPropStartWeekDay}}" lt-prop-current-date="{{value}}" data-zcqa="{{cxPropZcqa}}" on-date-change="{{method(\'onDateChange1\')}}" cx-prop-login-user-required="true" on-calendar-open="{{method(\'onCalendarOpenComp\')}}" on-before-calendar-close="{{method(\'cruxOnBeforeCalendarClose\')}}" on-calendar-close="{{method(\'cruxOnCalendarClose\')}}" lt-prop-header-type="{{cxPropHeaderType}}" lt-prop-auto-update="true" onkeyup="{{action(\'onKeyUpCloseCalendar\')}}" lt-prop-prevent-keys="{{cxPropPreventKeys}}"></lyte-input> </template><template case="create"> <template is="if" value="{{cxPropField[cxPropFieldKey]}}"><template case="true"> <div class="cxElementLabel {{cxPropLabelClass}}"> {{cxPropField[cxPropFieldKey]}} <template is="if" value="{{cxPropInfoTooltip}}"><template case="true"> <span class="dIB vam cxInfoIcon" onmouseenter="{{action(\'showInfoTooltip\',this)}}"></span> <lyte-hovercard lt-prop-placement="topLeft" lt-prop-keep-alive="true" lt-prop-popover-wrapper-class="cxElementsHovercard" lt-prop-origin-elem=".cxCurrentHovercard" on-hovercard-hide="{{method(\'hideInfoTooltip\')}}"> <template is="registerYield" yield-name="hoverCardYield"> <lyte-hovercard-content class="cxElementsHoverCardContent"> {{cxPropInfoTooltip}} </lyte-hovercard-content> </template> </lyte-hovercard> </template></template> </div> </template></template> <div class="cxElementValue {{if(cxPropDisabled,\'cxElementDisabled\',\'\')}}"> <lyte-input lt-prop-name="{{cxPropName}}" id="{{cxPropId}}" lt-prop-title="{{cxPropTooltip}}" lt-prop-tooltip-config="{{cxPropTooltipConfig}}" lt-prop-tooltip-style="margin: 10px; font-size : 11px;" lt-prop-type="date" on-navigate="{{method(\'navigation\')}}" lt-prop-placeholder="{{cxPropPlaceholder}}" lt-prop-format="{{format}}" lt-prop-start-week-day="{{cxPropStartWeekDay}}" lt-prop-current-date="{{cxPropValue}}" data-zcqa="{{cxPropZcqa}}" on-date-change="{{method(\'onDateChange1\')}}" lt-prop-disabled="{{cxPropDisabled}}" lt-prop-readonly="{{cxPropReadonly}}" class="w100per {{if(ifEquals(cxPropAppearance,\'box\'),\'cxBoxInput\',\'cxFlatInput\')}}" lt-prop-appearance="{{cxPropAppearance}}" lt-prop-autofocus="{{cxPropAutofocus}}" lt-prop-tab-index="{{cxPropTabIndex}}" lt-prop-maxlength="{{cxPropMaxlength}}" lt-prop-min-date="{{cxPropMinDate}}" lt-prop-calendar-class="{{cxPropCalendarClaYouss}}" on-calendar-open="{{method(\'onCalendarOpenComp\')}}" lt-prop-dropdown-freeze="{{cxPropFreeze}}" lt-prop-scope="{{cxPropScope}}" lt-prop-dropdown-properties="{{cxPropDropdownProperties}}" lt-prop-max-date="{{cxPropMaxDate}}" on-before-calendar-close="{{method(\'cruxOnBeforeCalendarClose\')}}" lt-prop-aria="{{cxPropAria}}" lt-prop-aria-attributes="{{cxPropAriaAttributes}}" on-calendar-close="{{method(\'cruxOnCalendarClose\')}}" on-before-open="{{method(\'beforeOpen\')}}" lt-prop-tooltip-class="{{cxPropTooltipClass}}" lt-prop-autocomplete="{{cxPropAutocomplete}}" lt-prop-header-type="{{cxPropHeaderType}}" lt-prop-auto-update="false" lt-prop-bind-to-body="false" lt-prop-calendar-properties="{{cxPropCalendarProperties}}" onkeyup="{{action(\'removeErrorMessage\')}}" lt-prop-wrapper-class="{{cxPropWrapperClass}}" lt-prop-class="{{cxPropInputClass}}" lt-prop-boundary="{{cxPropBoundary}}" lt-prop-prevent-keys="{{cxPropPreventKeys}}" lt-prop-yield="{{cxPropYield}}"> <template is="if" value="{{cxPropYield}}"><template case="true"> <template is="yield" yield-name="footer"><lyte-yield yield-name="footer"></lyte-yield></template> </template></template> </lyte-input> <template is="if" value="{{cxPropShowDisabledIcon}}"><template case="true"><span class="cxElementsDisabledIcon {{cxPropDisabledIconClass}}"></span></template></template> <template is="if" value="{{isError}}"><template case="true"> <crux-error-message error-message="{{cxPropErrorMessage}}" cx-prop-error-yield="{{cxPropErrorYield}}" cx-prop-error-zcqa-prefix="{{cxPropErrorZcqaPrefix}}" cx-prop-field="{{cxPropField}}" cx-prop-error-zcqa-suffix="{{cxPropErrorZcqaSuffix}}" class="{{cxPropErrorClass}}" cx-prop-error-span-class="{{cxPropErrorSpanClass}}"> <template is="registerYield" yield-name="errorYield"><lyte-yield yield-name="errorYield" error-message="{{cxPropErrorMessage}}" cx-field="{{cxPropField}}"></lyte-yield></template> </crux-error-message> </template></template> </div> </template></template> </template>',_dynamicNodes:[{type:"attr",position:[1]},{type:"switch",position:[1],cases:{view:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"if",position:[1,1],cases:{true:{dynamicNodes:[{type:"text",position:[0]},{type:"attr",position:[2]},{type:"if",position:[2],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"insertYield",position:[1]}]},{type:"componentDynamic",position:[1]}]}},default:{}}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"text",position:[0]}]}},default:{}}]}},default:{}}]},criteria:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"if",position:[1,1],cases:{true:{dynamicNodes:[{type:"registerYield",position:[1],dynamicNodes:[{type:"insertYield",position:[0]}]}]}},default:{}},{type:"componentDynamic",position:[1]}]},filter:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]},create:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,1]},{type:"attr",position:[1,3]},{type:"if",position:[1,3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[3]},{type:"registerYield",position:[3,1],dynamicNodes:[{type:"text",position:[1,1]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[3]}]}},default:{}}]}},default:{}},{type:"attr",position:[3]},{type:"attr",position:[3,1]},{type:"attr",position:[3,1,1]},{type:"if",position:[3,1,1],cases:{true:{dynamicNodes:[{type:"registerYield",position:[1],dynamicNodes:[{type:"insertYield",position:[0]}]}]}},default:{}},{type:"componentDynamic",position:[3,1]},{type:"attr",position:[3,3]},{type:"if",position:[3,3],cases:{true:{dynamicNodes:[{type:"attr",position:[0]}]}},default:{}},{type:"attr",position:[3,5]},{type:"if",position:[3,5],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"attr",position:[0]},{type:"insertYield",position:[0]}]},{type:"componentDynamic",position:[1]}]}},default:{}}]}},default:{}}],_observedAttributes:["lyteViewPort","cxPropValue","cxPropFrom","cxPropDatePattern","cxPropStartWeekDay","format","cxPropField","cxPropFieldKey","cxPropEmptyValue","cxPropZcqa","cxPropYield","cxPropDisabled","cxPropReadonly","cxPropClass","cxPropPlaceholder","isError","cxPropAppearance","cxPropErrorMessage","cxPropIgnoreEmptyValue","cxPropId","cxPropName","cxPropClearErrorMessage","cxPropBoundary","cxPropErrorYield","cxPropMinDate","lyteUnbound","cxPropTabIndex","cxPropDirection","cxPropLabelClass","cxPropTooltip","value","cxPropCalendarClass","cxPropInfoTooltip","cxPropAutocomplete","cxPropDateInUserPattern","cxPropFreeze","cxPropScope","cxPropMaxDate","cxPropDropdownProperties","cxPropAria","cxPropAriaAttributes","cxPropTooltipConfig","cxPropTooltipClass","cxPropHeaderType","cxPropErrorZcqaPrefix","cxPropErrorZcqaSuffix","cxPropCalendarProperties","cxPropErrorClass","cxPropWrapperClass","cxPropInputClass","cxPropErrorSpanClass","cxPropPreventKeys","cxPropLayout","cxPropViewInfoTooltip","cxPropShowDisabledIcon","cxPropDisabledIconClass"],data:function(){return{lyteViewPort:Lyte.attr("boolean",{default:!1}),cxPropValue:Lyte.attr("string"),cxPropFrom:Lyte.attr("string",{default:"view"}),cxPropDatePattern:Lyte.attr("string",{default:"undefined"!=typeof Crm?Crm.userDetails.DATE_PATTERN:"dd/mm/yyyy"}),cxPropStartWeekDay:Lyte.attr("number",{default:"undefined"!=typeof Crm&&Crm.calPreferences&&void 0!=Crm.calPreferences.WEEKSTARTSON?Crm.calPreferences.WEEKSTARTSON:1}),format:Lyte.attr("string"),cxPropField:Lyte.attr("object",{default:{}}),cxPropFieldKey:Lyte.attr("string",{default:""}),cxPropEmptyValue:Lyte.attr("string",{default:""}),cxPropZcqa:Lyte.attr("string"),cxPropYield:Lyte.attr("boolean",{default:!1}),cxPropDisabled:Lyte.attr("boolean",{default:!1}),cxPropReadonly:Lyte.attr("boolean",{default:!1}),cxPropClass:Lyte.attr("string",{default:""}),cxPropPlaceholder:Lyte.attr("string"),isError:Lyte.attr("boolean",{default:!1}),cxPropAppearance:Lyte.attr("string",{default:"flat"}),cxPropErrorMessage:Lyte.attr("string",{default:""}),cxPropIgnoreEmptyValue:Lyte.attr("boolean",{default:!1}),cxPropId:Lyte.attr("string",{default:""}),cxPropName:Lyte.attr("string",{default:""}),cxPropClearErrorMessage:Lyte.attr("boolean",{default:!0}),cxPropBoundary:Lyte.attr("object",{default:{}}),cxPropErrorYield:Lyte.attr("boolean",{default:!1}),cxPropMinDate:Lyte.attr("string",{default:""}),lyteUnbound:Lyte.attr("boolean",{default:!1}),cxPropTabIndex:Lyte.attr("string"),cxPropDirection:Lyte.attr("string",{default:"vertical"}),cxPropLabelClass:Lyte.attr("string",{default:""}),cxPropTooltip:Lyte.attr("string",{default:""}),value:Lyte.attr("string"),cxPropCalendarClass:Lyte.attr("string"),cxPropInfoTooltip:Lyte.attr("string",{default:""}),cxPropAutocomplete:Lyte.attr("string",{default:"on"}),cxPropDateInUserPattern:Lyte.attr("boolean"),cxPropFreeze:Lyte.attr("boolean",{default:!1}),cxPropScope:Lyte.attr("string"),cxPropMaxDate:Lyte.attr("string"),cxPropDropdownProperties:Lyte.attr("object",{default:{preventScroll:"body"}}),cxPropAria:Lyte.attr("boolean",{default:!1}),cxPropAriaAttributes:Lyte.attr("object",{default:{}}),cxPropTooltipConfig:Lyte.attr("string",{default:'{"position": "followcursor", "appearance": "box"}'}),cxPropTooltipClass:Lyte.attr("string"),cxPropHeaderType:Lyte.attr("string",{default:"dropdown"}),cxPropErrorZcqaPrefix:Lyte.attr("string",{default:""}),cxPropErrorZcqaSuffix:Lyte.attr("string",{default:"Error"}),cxPropCalendarProperties:Lyte.attr("object",{default:{}}),cxPropErrorClass:Lyte.attr("string"),cxPropWrapperClass:Lyte.attr("string"),cxPropInputClass:Lyte.attr("string",{default:""}),cxPropErrorSpanClass:Lyte.attr("string"),cxPropPreventKeys:Lyte.attr("boolean",{default:!1}),cxPropLayout:Lyte.attr("string"),cxPropViewInfoTooltip:Lyte.attr("boolean",{default:!1}),cxPropShowDisabledIcon:Lyte.attr("boolean",{default:!1}),cxPropDisabledIconClass:Lyte.attr("string",{default:""})}},getValue:function(){if(this.$node.querySelector("#cruxLoadingElem"))return this.data.cxPropValue;var e=this.$node.querySelector("input").value;if("criteria"==this.getData("cxPropFrom")){var t=this.getDateObject(e.trim());if(t){for(var o=t.getFullYear()+"-";o.length<5;)o="0"+o;return o+=(t.getMonth()+1<10?"0":"")+(t.getMonth()+1)+"-",o+=(t.getDate()<10?"0":"")+t.getDate()}return""}return e},validate:function(){var e=this.$node.querySelector("input"),t=e?e.value:void 0;t&&""==t.trim()&&(t="");var o=this.getData("cxPropField");if("create"==this.getData("cxPropFrom")){var a=!0;return t?(a=this.isValidDate(t))||(this.getMethods("onError")?this.executeMethod("onError",this.errorCodes.ERR02,this):this.setData("cxPropErrorMessage",_cruxUtils.getI18n("crm.field.valid.check",Lyte.Component.registeredHelpers.cruxEncodeHTML(o.field_label)))):a=this.validateMandatory(!0),1==a?this.setData("cxPropErrorMessage",""):(this.focusFromHere=!0,this.$node.focus()),a}return!(""!=t||!this.getData("cxPropIgnoreEmptyValue"))||this.dateValidate(e)},actions:{showInfoTooltip:function(e){this.showHideInfoTooltip(e)},onKeyUpCloseCalendar:function(){event&&13==event.keyCode&&this.input.blur()},removeErrorMessage:function(){this.data.cxPropClearErrorMessage&&this.setData("cxPropErrorMessage","")}},init:function(){if(this.setData("cxPropDatePattern",this.getData("cxPropDatePattern").replace(/'/g,"")),this.data.format=this.getData("cxPropDatePattern").toUpperCase(),this.getData("cxPropPlaceholder")||this.setData("cxPropPlaceholder",this.getData("format")),"view"==this.data.cxPropFrom){var e=this.data.cxPropValue;e&&-1!=e.indexOf(":")&&(this.data.cxPropValue=e.substring(0,e.split(":")[0].lastIndexOf(" ")))}else this.getData("cxPropDisabled")&&!this.data.cxPropTooltip&&this.setData("cxPropTooltip",_cruxUtils.getI18n("crm.lable.read.only"));this.$node.focus=this.focus.bind(this)},observeValue:function(){if(this._prevent)delete this._prevent;else if("view"!=this.data.cxPropFrom){if(this.data.cxPropValue){this._prevent=!0;var e=this.data.cxPropValue;e=e.replace(/[+-]\d{2}:\d{2}/,"");var t=/^(.*)T/.exec(e);t&&(e=t[1]),this.data.cxPropDateInUserPattern?this.setData("cxPropValue",this.getDateInUserDatePattern(this.getDateObjectFromString(e,this.data.cxPropDatePattern))):this.setData("cxPropValue",this.getDateInUserDatePattern(this.getDateObjectFromString(e,"YYYY-MM-DD"))),this._prevent=!1}"filter"==this.getData("cxPropFrom")&&this.setData("value",this.getData("cxPropValue"))}else"view"==this.data.cxPropFrom&&this.data.cxPropValue&&0==this.data.cxPropDateInUserPattern&&(this.setData("cxPropValue",this.getDateInUserDatePattern(this.getDateObjectFromString(this.data.cxPropValue,"YYYY-MM-DD"))),this.data.cxPropDateInUserPattern=!0)}.observes("cxPropValue","cxPropFrom").on("init"),methods:{onDateChange1:function(){var e=this.$node.querySelector("input").value;e.indexOf("'")>-1&&(this.$node.querySelector("input").value=e.replace(/'/g,"")),this.getData("cxPropClearErrorMessage")&&this.setData("cxPropErrorMessage",""),this.getMethods("onDateChange")&&this.executeMethod("onDateChange",arguments[0],arguments[1],arguments[2]),this.getMethods("onValueChange")&&this.executeMethod("onValueChange",this.getValue()),"criteria"!=this.data.cxPropFrom&&this.isValidDate(this.$node.querySelector("input").value,this.data.cxPropDatePattern)&&this.data.cxPropValue!=this.getValue()&&(this._prevent=!0,this.setData("cxPropValue",this.getValue()))},navigation:function(){arguments[0]&&arguments[0].target&&arguments[0].target.parentElement.classList.contains("lyteCalCurrentDate")&&(this.setData("selectedDate",this.getDateInUserDatePattern(new Date)),this.input.blur(),arguments[3].$node.querySelector(".lyteCalToday").click())},onCalendarOpenComp:function(){this.getMethods("onCalendarOpen")&&this.executeMethod("onCalendarOpen")},hideInfoTooltip:function(){this.showHideInfoTooltip()},cruxOnBeforeCalendarClose:function(e,t){if(this.getMethods("onBeforeCalendarClose")&&0==this.executeMethod("onBeforeCalendarClose",e,t))return!1},cruxOnCalendarClose:function(e,t){this.patternValidate(void 0,"",this.$node.querySelector("input"),!0),this.input.calendarDiv&&this.input.calendarDiv.querySelector("lyte-calendar").revertToSelected(),this.getMethods("onCalendarClose")&&this.executeMethod("onCalendarClose",e,t)},beforeOpen:function(){if(this.focusFromHere)return delete this.focusFromHere,!1}},observeErrorMessage:function(){this.setData("isError",""!=this.getData("cxPropErrorMessage"))}.observes("cxPropErrorMessage").on("init"),observeMandatory:function(){this.observeMandatoryMixin("lyte-input")}.observes("cxPropField.required","lyteViewPort").on("didConnect"),observeIsError:function(){this.input&&"create"==this.getData("cxPropFrom")&&(1==this.data.isError?this.input.classList.add("cruxErrorField","cxErrorBox"):this.input.classList.remove("cruxErrorField","cxErrorBox"))}.observes("isError","lyteViewPort").on("didConnect"),focus:function(){this.input&&(this.input.focus(),delete this.focusFromHere)},observeValue2:function(){this.data.cxPropClearErrorMessage&&this.setData("cxPropErrorMessage","")}.observes("cxPropValue"),observeClass:function(e){if("create"==this.data.cxPropFrom){var t=$L("lyte-input",this.$node);if(!t.length)return;e&&e.oldValue&&t.removeClass(e.oldValue),this.data.cxPropClass&&t.addClass(this.data.cxPropClass)}}.observes("cxPropClass","lyteViewPort").on("didConnect"),setInput:function(){this.input=this.$node.querySelector("lyte-input")}.observes("lyteViewPort").on("didConnect")},{mixins:["crux-element-validation"]}),Lyte.Component.register("crux-date-time-component",{_template:'<template tag-name="crux-date-time-component"> <template is="switch" value="{{cxPropFrom}}"><template case="view"> <span id="{{cxPropId}}" class="cxElementViewValue">{{displayValue}}</span> <template is="if" value="{{cxPropViewInfoTooltip}}"><template case="true"> <crux-view-info-tooltip cx-prop-field="{{cxPropField}}" cx-prop-value="{{cxPropValue}}"> <template is="yield" yield-name="viewInfoTooltipYield"> <lyte-yield yield-name="viewInfoTooltipYield" prop-field="{{propField}}" prop-value="{{propValue}}"></lyte-yield> </template> </crux-view-info-tooltip> </template></template> </template><template case="filter"></template><template case="criteria"> <div class="cxDateTimeWrapper"> <lyte-input lt-prop-type="datetime" lt-prop-appearance="{{cxPropAppearance}}" class="cxBoxInput w100per" lt-prop-name="{{cxPropName}}" id="{{cxPropId}}" lt-prop-id="searchValue" lt-prop-placeholder="{{cxPropDatePattern}}" lt-prop-current-date="{{selectedDate}}" lt-prop-start-week-day="{{cxPropStartWeekDay}}" on-navigate="{{method(\'navigation\')}}" lt-prop-yield="{{cxPropYield}}" on-date-change="{{method(\'onDateChange\')}}" lt-prop-format="{{format}}" data-zcqa="{{cxPropZcqa}}" lt-prop-min-date="{{cxPropMinDate}}" lt-prop-minute-interval="30" lt-prop-dropdown="true" lt-prop-direction="{{cxPropDirection}}" lt-prop-time-format="{{cxPropTimeFormatInput}}" lt-prop-default-time="{{startTime}}" lt-prop-start-time="{{calendarStartTime}}" on-time-change="{{method(\'onTimeChange\')}}" ondragstart="return false;" ondrop="return false;" lt-prop-show-interval="{{cxPropShowInterval}}" on-calendar-open="{{method(\'onCalendarOpenComp\')}}" lt-prop-boundary="{{cxPropBoundary}}" on-before-calendar-close="{{method(\'cruxOnBeforeCalendarClose\')}}" on-calendar-close="{{method(\'cruxOnCalendarClose\')}}" lt-prop-header-type="{{cxPropHeaderType}}" lt-prop-calendar-properties="{&quot;i18n&quot; : true,&quot;disableNavigation&quot; : true}" lt-prop-wrapper-class="{{cxPropWrapperClass}}" lt-prop-class="{{cxPropInputClass}}" lt-prop-bind-to-body="false" lt-prop-prevent-keys="{{cxPropPreventKeys}}" lt-prop-tab-index="{{cxPropTabIndex}}"> <template is="if" value="{{cxPropYield}}"><template case="true"> <template is="yield" yield-name="footer"><lyte-yield yield-name="footer"></lyte-yield></template> </template></template> </lyte-input> </div> </template><template case="create"> <template is="if" value="{{cxPropField[cxPropFieldKey]}}"><template case="true"> <div class="cxElementLabel {{cxPropLabelClass}}"> {{cxPropField[cxPropFieldKey]}} <template is="if" value="{{cxPropInfoTooltip}}"><template case="true"> <span class="dIB vam cxInfoIcon" onmouseenter="{{action(\'showInfoTooltip\',this)}}"></span> <lyte-hovercard lt-prop-placement="topLeft" lt-prop-keep-alive="true" lt-prop-popover-wrapper-class="cxElementsHovercard" lt-prop-origin-elem=".cxCurrentHovercard" on-hovercard-hide="{{method(\'hideInfoTooltip\')}}"> <template is="registerYield" yield-name="hoverCardYield"> <lyte-hovercard-content class="cxElementsHoverCardContent"> {{cxPropInfoTooltip}} </lyte-hovercard-content> </template> </lyte-hovercard> </template></template> </div> </template></template> <div class="cxElementValue {{if(cxPropDisabled,\'cxElementDisabled\',\'\')}}"> <div> <lyte-input lt-prop-name="{{cxPropDateFieldName}}" id="{{cxPropDateFieldId}}" lt-prop-title="{{cxPropTooltip}}" lt-prop-tooltip-config="{{cxPropTooltipConfig}}" lt-prop-tooltip-style="margin: 10px; font-size : 11px;" lt-prop-type="datetime" lt-prop-appearance="{{cxPropAppearance}}" class="cxBoxInput w100per" on-navigate="{{method(\'navigation\')}}" lt-prop-current-date="{{selectedDate}}" lt-prop-start-week-day="{{cxPropStartWeekDay}}" lt-prop-yield="{{cxPropYield}}" on-date-change="{{method(\'onDateChange\')}}" data-zcqa="{{cxPropZcqa}}" lt-prop-autofocus="{{cxPropAutofocus}}" lt-prop-tab-index="{{cxPropTabIndex}}" lt-prop-disabled="{{cxPropDisabled}}" lt-prop-calendar-class="{{cxPropCalendarClass}}" lt-prop-min-date="{{cxPropMinDate}}" lt-prop-minute-interval="30" lt-prop-dropdown="true" lt-prop-direction="{{cxPropDirection}}" lt-prop-time-format="{{cxPropTimeFormatInput}}" lt-prop-default-time="{{startTime}}" lt-prop-start-time="{{calendarStartTime}}" on-time-change="{{method(\'onTimeChange\')}}" ondragstart="return false;" ondrop="return false;" lt-prop-end-time="{{cxPropEndTime}}" lt-prop-format="{{format}}" lt-prop-show-interval="{{cxPropShowInterval}}" on-before-open="{{method(\'onBeforeOpen\')}}" lt-prop-dropdown-disabled="{{cxPropDisabled}}" lt-prop-placeholder="{{cxPropPlaceholder}}" on-calendar-open="{{method(\'onCalendarOpenComp\')}}" lt-prop-dropdown-freeze="{{cxPropFreeze}}" lt-prop-scope="{{cxPropScope}}" lt-prop-dropdown-properties="{&quot;preventScroll&quot;:&quot;body&quot;}" lt-prop-max-date="{{cxPropMaxDate}}" on-before-calendar-close="{{method(\'cruxOnBeforeCalendarClose\')}}" lt-prop-aria="{{cxPropAria}}" lt-prop-aria-attributes="{{cxPropAriaAttributes}}" on-calendar-close="{{method(\'cruxOnCalendarClose\')}}" lt-prop-common-placeholder="{{cxPropCommonPlaceholder}}" lt-prop-tooltip-class="{{cxPropTooltipClass}}" lt-prop-autocomplete="{{cxPropAutocomplete}}" lt-prop-header-type="{{cxPropHeaderType}}" lt-prop-bind-to-body="false" lt-prop-show-today="{{cxPropShowToday}}" onkeyup="{{action(\'removeErrorMessage\')}}" lt-prop-wrapper-class="{{cxPropWrapperClass}}" lt-prop-class="{{cxPropInputClass}}" lt-prop-time-class="{{cxPropInputTimeClass}}" lt-prop-readonly="{{cxPropReadonly}}" lt-prop-prevent-keys="{{cxPropPreventKeys}}" lt-prop-time-placeholder="{{cxPropTimePlaceholder}}" lt-prop-boundary="{{cxPropBoundary}}"> <template is="if" value="{{cxPropYield}}"><template case="true"><template is="yield" yield-name="footer"><lyte-yield yield-name="footer"></lyte-yield></template></template></template> </lyte-input> <template is="if" value="{{cxPropShowDisabledIcon}}"><template case="true"><span class="cxElementsDisabledIcon {{cxPropDisabledIconClass}}"></span></template></template> <template is="if" value="{{isError}}"><template case="true"> <crux-error-message error-message="{{cxPropErrorMessage}}" cx-prop-error-yield="{{cxPropErrorYield}}" cx-prop-error-zcqa-prefix="{{cxPropErrorZcqaPrefix}}" cx-prop-field="{{cxPropField}}" cx-prop-error-zcqa-suffix="{{cxPropErrorZcqaSuffix}}" class="{{cxPropErrorClass}}" cx-prop-error-span-class="{{cxPropErrorSpanClass}}"> <template is="registerYield" yield-name="errorYield"><lyte-yield yield-name="errorYield" error-message="{{cxPropErrorMessage}}" cx-field="{{cxPropField}}"></lyte-yield></template> </crux-error-message> </template></template> </div> </div> </template></template> </template>',_dynamicNodes:[{type:"attr",position:[1]},{type:"switch",position:[1],cases:{view:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,0]},{type:"attr",position:[3]},{type:"if",position:[3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"insertYield",position:[1]}]},{type:"componentDynamic",position:[1]}]}},default:{}}]},filter:{dynamicNodes:[],additional:{next:"criteria"}},criteria:{dynamicNodes:[{type:"attr",position:[1,1]},{type:"attr",position:[1,1,1]},{type:"if",position:[1,1,1],cases:{true:{dynamicNodes:[{type:"registerYield",position:[1],dynamicNodes:[{type:"insertYield",position:[0]}]}]}},default:{}},{type:"componentDynamic",position:[1,1]}]},create:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,1]},{type:"attr",position:[1,3]},{type:"if",position:[1,3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[3]},{type:"registerYield",position:[3,1],dynamicNodes:[{type:"text",position:[1,1]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[3]}]}},default:{}}]}},default:{}},{type:"attr",position:[3]},{type:"attr",position:[3,1,1]},{type:"attr",position:[3,1,1,1]},{type:"if",position:[3,1,1,1],cases:{true:{dynamicNodes:[{type:"registerYield",position:[0],dynamicNodes:[{type:"insertYield",position:[0]}]}]}},default:{}},{type:"componentDynamic",position:[3,1,1]},{type:"attr",position:[3,1,3]},{type:"if",position:[3,1,3],cases:{true:{dynamicNodes:[{type:"attr",position:[0]}]}},default:{}},{type:"attr",position:[3,1,5]},{type:"if",position:[3,1,5],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"attr",position:[0]},{type:"insertYield",position:[0]}]},{type:"componentDynamic",position:[1]}]}},default:{}}]}},default:{}}],_observedAttributes:["lyteViewPort","cxPropValue","cxPropFrom","cxPropField","cxPropFieldKey","cxPropDatePattern","cxPropTimeFormat","cxPropStartWeekDay","format","cxPropEmptyValue","selectedDate","startTime","cxPropYield","isError","cxPropTimeZone","cxPropAppearance","cxPropErrorMessage","calendarStartTime","cxPropDateFieldId","cxPropDateFieldName","cxPropTimeFieldId","cxPropTimeFieldName","cxPropClearErrorMessage","cxPropTimeFormatInput","cxPropId","cxPropName","cxPropDirection","cxPropLabelClass","cxPropEndTime","cxPropCalendarClass","cxPropMinDate","cxPropReadonly","cxPropStartTime","cxPropDefaultTime","cxPropDisabled","cxPropTabIndex","cxPropZcqa","cxPropClass","cxPropShowInterval","lyteUnbound","cxPropWrapperClass","cxPropTooltip","cxPropPlaceholder","cxPropErrorYield","cxPropInfoTooltip","cxPropFreeze","cxPropScope","cxPropMaxDate","cxPropDropdownProperties","cxPropDatetimeInUserPattern","cxPropBoundary","cxPropAria","cxPropAriaAttributes","cxPropCommonPlaceholder","cxPropTooltipConfig","cxPropTooltipClass","cxPropAutocomplete","cxPropHeaderType","displayValue","cxPropErrorZcqaPrefix","cxPropErrorZcqaSuffix","cxPropShowToday","cxPropErrorClass","cxPropWrapperClass","cxPropInputClass","cxPropErrorSpanClass","cxPropPreventKeys","cxPropTimePlaceholder","cxPropReturnTimezone","cxPropLayout","cxPropInputTimeClass","cxPropViewInfoTooltip","cxPropShowDisabledIcon","cxPropDisabledIconClass"],data:function(){return{lyteViewPort:Lyte.attr("boolean",{default:!1}),cxPropValue:Lyte.attr("string"),cxPropFrom:Lyte.attr("string",{default:"view"}),cxPropField:Lyte.attr("object",{default:{}}),cxPropFieldKey:Lyte.attr("string",{default:""}),cxPropDatePattern:Lyte.attr("string",{default:"undefined"!=typeof Crm?Crm.userDetails.DATE_PATTERN:"dd/mm/yyyy"}),cxPropTimeFormat:Lyte.attr("string"),cxPropStartWeekDay:Lyte.attr("number",{default:"undefined"!=typeof Crm&&Crm.calPreferences&&void 0!=Crm.calPreferences.WEEKSTARTSON?Crm.calPreferences.WEEKSTARTSON:1}),format:Lyte.attr("string"),cxPropEmptyValue:Lyte.attr("string",{default:""}),selectedDate:Lyte.attr("string"),startTime:Lyte.attr("string"),cxPropYield:Lyte.attr("boolean",{default:!1}),isError:Lyte.attr("boolean",{default:!1}),cxPropTimeZone:Lyte.attr("string",{default:"undefined"!=typeof Crm?Crm.userDetails.TIME_ZONE:"+05.30"}),cxPropAppearance:Lyte.attr("string",{default:"box"}),cxPropErrorMessage:Lyte.attr("string",{default:""}),calendarStartTime:Lyte.attr("string"),cxPropDateFieldId:Lyte.attr("string",{default:""}),cxPropDateFieldName:Lyte.attr("string",{default:""}),cxPropTimeFieldId:Lyte.attr("string",{default:""}),cxPropTimeFieldName:Lyte.attr("string",{default:""}),cxPropClearErrorMessage:Lyte.attr("boolean",{default:!0}),cxPropTimeFormatInput:Lyte.attr("string"),cxPropId:Lyte.attr("string",{default:""}),cxPropName:Lyte.attr("string",{default:""}),cxPropDirection:Lyte.attr("string",{default:"vertical"}),cxPropLabelClass:Lyte.attr("string",{default:""}),cxPropEndTime:Lyte.attr("string"),cxPropCalendarClass:Lyte.attr("string"),cxPropMinDate:Lyte.attr("string",{default:""}),cxPropReadonly:Lyte.attr("boolean",{default:!1}),cxPropStartTime:Lyte.attr("string"),cxPropDefaultTime:Lyte.attr("string"),cxPropDisabled:Lyte.attr("boolean",{default:!1}),cxPropTabIndex:Lyte.attr("string"),cxPropZcqa:Lyte.attr("string"),cxPropClass:Lyte.attr("string",{default:""}),cxPropShowInterval:Lyte.attr("boolean",{default:!1}),lyteUnbound:Lyte.attr("boolean",{default:!1}),cxPropWrapperClass:Lyte.attr("string"),cxPropTooltip:Lyte.attr("string",{default:""}),cxPropPlaceholder:Lyte.attr("string"),cxPropErrorYield:Lyte.attr("boolean",{default:!1}),cxPropInfoTooltip:Lyte.attr("string",{default:""}),cxPropFreeze:Lyte.attr("boolean",{default:!1}),cxPropScope:Lyte.attr("string"),cxPropMaxDate:Lyte.attr("string"),cxPropDropdownProperties:Lyte.attr("object",{default:{preventScroll:"body"}}),cxPropDatetimeInUserPattern:Lyte.attr("boolean"),cxPropBoundary:Lyte.attr("object",{default:{}}),cxPropAria:Lyte.attr("boolean",{default:!1}),cxPropAriaAttributes:Lyte.attr("object",{default:{}}),cxPropCommonPlaceholder:Lyte.attr("string"),cxPropTooltipConfig:Lyte.attr("string",{default:'{"position": "followcursor", "appearance": "box"}'}),cxPropTooltipClass:Lyte.attr("string"),cxPropAutocomplete:Lyte.attr("string",{default:"on"}),cxPropHeaderType:Lyte.attr("string",{default:"dropdown"}),displayValue:Lyte.attr("string"),cxPropErrorZcqaPrefix:Lyte.attr("string",{default:""}),cxPropErrorZcqaSuffix:Lyte.attr("string",{default:"Error"}),cxPropShowToday:Lyte.attr("boolean",{default:!0}),cxPropErrorClass:Lyte.attr("string"),cxPropWrapperClass:Lyte.attr("string"),cxPropInputClass:Lyte.attr("string"),cxPropErrorSpanClass:Lyte.attr("string"),cxPropPreventKeys:Lyte.attr("boolean",{default:!1}),cxPropTimePlaceholder:Lyte.attr("string"),cxPropReturnTimezone:Lyte.attr("boolean",{default:!1}),cxPropLayout:Lyte.attr("string"),cxPropInputTimeClass:Lyte.attr("string"),cxPropViewInfoTooltip:Lyte.attr("boolean",{default:!1}),cxPropShowDisabledIcon:Lyte.attr("boolean",{default:!1}),cxPropDisabledIconClass:Lyte.attr("string",{default:""})}},init:function(){this.setData("cxPropDatePattern",this.getData("cxPropDatePattern").replace(/'/g,"")),this.setData("format",this.getData("cxPropDatePattern").toUpperCase()),this.getData("cxPropPlaceholder")||this.setData("cxPropPlaceholder",this.getData("format")),this.getData("cxPropDisabled")&&!this.data.cxPropTooltip&&this.setData("cxPropTooltip",_cruxUtils.getI18n("crm.lable.read.only"))},getValue:function(e){if(this.$node.querySelector("#cruxLoadingElem"))return this.data.cxPropValue;var t=this.$node.querySelectorAll("input");if(""!=t[0].value.trim()){if(e&&e.userFormat)return t[0].value+" "+t[1].value;var o=this.getDateObject(t[0].value.trim(),t[1].value);if(!o)return"";function a(e){return e<10?"0"+e:e}for(var r=this.getData("cxPropTimeZone"),i=o.getFullYear().toString();i.length<4;)i="0"+i;var s=i+"-"+a(o.getMonth()+1)+"-"+a(o.getDate())+"T"+a(o.getHours())+":"+a(o.getMinutes())+":"+a(o.getSeconds());return("create"!=this.data.cxPropFrom||this.data.cxPropReturnTimezone)&&(s+=r.replace(".",":")),s}return""},validate:function(){var e=this.$node.querySelectorAll("input"),t=this.data.cxPropField;if("create"==this.data.cxPropFrom){if(void 0==e||0==e.length||!e[0].value||!e[0].value.trim())return this.validateMandatory(!0)?(this.setData("cxPropErrorMessage",""),!0):(this.focusFromHere=!0,this.$node.querySelector("lyte-input")&&this.$node.querySelector("lyte-input").focus(),!1);var o=this.isValidDate(e[0].value,void 0),a=$L.moment(e[1].value,this.data.cxPropTimeFormat.replace("a","A"),{i18n:!0}).validate();return o&&a?this.setData("cxPropErrorMessage",""):(this.getMethods("onError")?this.executeMethod("onError",this.errorCodes.ERR02,this):this.setData("cxPropErrorMessage",_cruxUtils.getI18n("crm.field.valid.check",Lyte.Component.registeredHelpers.cruxEncodeHTML(t.field_label))),this.focusFromHere=!0,this.$node.querySelector("lyte-input")&&this.$node.querySelector("lyte-input").focus(),o=!1),o}return this.dateValidate(e[0])},methods:{onDateChange:function(){this.$node.querySelector("input").value=this.$node.querySelector("input").value.replace(/'/g,""),this.data.cxPropClearErrorMessage&&this.setData("cxPropErrorMessage",""),this.getMethods("onValueChange")&&this.executeMethod("onValueChange",this.getValue(),"date")},onTimeChange:function(){this.$node.querySelector("input").value||this.setData("selectedDate",this.getDateInUserDatePattern(new Date)),this.getData("cxPropClearErrorMessage")&&this.setData("cxPropErrorMessage",""),this.getMethods("onValueChange")&&this.executeMethod("onValueChange",this.getValue(),"time")},navigation:function(){arguments[0]&&arguments[0].target&&arguments[0].target.parentElement.classList.contains("lyteCalCurrentDate")&&(this.setData("selectedDate",this.getDateInUserDatePattern(new Date)),this.$node.querySelector("lyte-input").blur(),arguments[3].$node.querySelector(".lyteCalToday").click())},onBeforeOpen:function(){if(this.focusFromHere)return delete this.focusFromHere,!1;this.getMethods("onBeforeCalendarOpen")&&this.executeMethod("onBeforeCalendarOpen")},onCalendarOpenComp:function(){this.getMethods("onCalendarOpen")&&this.executeMethod("onCalendarOpen")},hideInfoTooltip:function(){this.showHideInfoTooltip()},cruxOnBeforeCalendarClose:function(e,t){this.getMethods("onBeforeCalendarClose")&&this.executeMethod("onBeforeCalendarClose",e,t)},cruxOnCalendarClose:function(e,t){this.patternValidate(void 0,"",this.$node.querySelector("input"),!0),this.$node.querySelector("lyte-input").calendarDiv&&this.$node.querySelector("lyte-input").calendarDiv.querySelector("lyte-calendar").revertToSelected(),this.getMethods("onCalendarClose")&&this.executeMethod("onCalendarClose",e,t)}},observeErrorMessage:function(){this.setData("isError",""!=this.getData("cxPropErrorMessage"))}.observes("cxPropErrorMessage").on("init"),obeserveCxPropValue:function(){var e=this.getData("cxPropTimeFormat");e||(e="undefined"!=typeof Crm?Crm.userDetails.TIME_FORMAT:"HH:mm",this.setData("cxPropTimeFormat",e));var t="24";if(e.indexOf("a")>-1?(t="12",this.setData({cxPropTimeFormatInput:"12",calendarStartTime:"12:00 AM"})):this.setData({cxPropTimeFormatInput:"24",calendarStartTime:"00:00"}),this.timeFormat=t,"view"!=this.getData("cxPropFrom")){if(this.getData("cxPropStartTime")&&this.setData("calendarStartTime",this.getData("cxPropStartTime")),this.getData("cxPropValue"))if(n=(n=this.getData("cxPropValue")).replace(/[+-]\d{2}:\d{2}/,""),this.data.cxPropDatetimeInUserPattern){var o=6;"hh:mm a"==this.data.cxPropTimeFormat&&(o+=3);var a=n.substring(0,n.length-o);this.setData("selectedDate",a),this.setData("startTime",n.substring(n.length-o+1))}else{var r=n.split("-");a=new Date(r[0],r[1]-1,r[2].split("T")[0]);(c=(n=n.split("T"))[1]?n[1].split(":"):"")&&(a.setHours(c[0]),a.setMinutes(c[1])),this.setData("selectedDate",this.getDateInUserDatePattern(a)),this.setData("startTime",this.getTimeInUserFormat(a))}else if(this.setData("selectedDate",""),this.getData("cxPropDefaultTime"))this.setData("startTime",this.getData("cxPropDefaultTime"));else if(!this.getData("cxPropStartTime"))if("create"!=this.data.cxPropFrom)this.setData("startTime","01:00"+("12"==t?" "+_cruxUtils.getI18n("AM"):""));else if(this.data.cxPropCommonPlaceholder||this.data.cxPropTimePlaceholder)this.setData("startTime","");else{var i,s=(c=new Date).getHours(),l=c.getMinutes().toString(),p=s>11?_cruxUtils.getI18n("PM"):_cruxUtils.getI18n("AM");1==l.length&&(l="0"+l),"12"==t?(12!=s&&1==(s=(s%12).toString()).length&&(s="0"+s),i=s+":00 "+p):(s<10&&(s="0"+s),i=s+":00"),this.setData("startTime",i)}}else if(this.data.cxPropValue)if(0==this.data.cxPropDatetimeInUserPattern){var n,c;r=this.data.cxPropValue.split("-"),a=new Date(r[0],r[1]-1,r[2].split("T")[0]);(c=(n=this.data.cxPropValue.split("T"))[1]?n[1].split(":"):"")&&(a.setHours(c[0]),a.setMinutes(c[1])),this.setData("displayValue",this.getDateInUserDatePattern(a)+" "+this.getTimeInUserFormat(a,this.data.timeFormat))}else this.setData("displayValue",this.data.cxPropValue);else this.getData("cxPropEmptyValue")&&this.setData("displayValue",this.getData("cxPropEmptyValue"))}.observes("cxPropValue","cxPropFrom").on("init"),observeIsError:function(){"create"==this.getData("cxPropFrom")&&this.$node.querySelector("lyte-input")&&(this.getData("isError")?this.$node.querySelector("lyte-input").classList.add("cxErrorBox"):this.$node.querySelector("lyte-input").classList.remove("cxErrorBox"),this.lyteInput=this.$node.querySelector("lyte-input"))}.observes("isError","lyteViewPort").on("didConnect"),observeMandatory:function(){this.observeMandatoryMixin("lyte-input")}.observes("cxPropField.required","lyteViewPort").on("didConnect"),actions:{preventInvalidTime:function(){this.paste()},showInfoTooltip:function(e){this.showHideInfoTooltip(e)},removeErrorMessage:function(){this.data.cxPropClearErrorMessage&&this.setData("cxPropErrorMessage","")}},observesdidConnect:function(){if("create"==this.getData("cxPropFrom")&&this.$node.querySelectorAll("input")[1]){var e=this;this.$node.querySelectorAll("input")[1].onpaste=function(){e.paste()}}this.$node.focus=this.focus.bind(this)}.observes("lyteViewPort").on("didConnect"),paste:function(){var e=event.clipboardData.getData("text"),t=(e=e.split(":"))[0],o=e[1],a=/^\d{1,2}$/,r="AM";if(!a.test(t)||!a.test(o)||""==t||t>23||""==o||o>59||void 0==t||void 0==o)event.preventDefault();else{var i=!1;12==this.timeFormat&&t>12&&(t-=12,i=!0,r="PM"),1==t.length&&(t="0"+t,i=!0),1==o.length&&(o="0"+o,i=!0),i&&(this.setData("startTime",24==this.timeFormat?t+":"+o:t+":"+o+" "+r),event.preventDefault())}},observeStartTime:function(){this.setData("calendarStartTime",this.getData("cxPropStartTime"))}.observes("cxPropStartTime"),focus:function(){this.$node.querySelector("lyte-input")&&this.$node.querySelector("lyte-input").focus()},observeClass:function(e){if("create"==this.data.cxPropFrom){var t=$L("lyte-input",this.$node);if(!t.length)return;e&&e.oldValue&&t.removeClass(e.oldValue),this.data.cxPropClass&&t.addClass(this.data.cxPropClass)}}.observes("cxPropClass","lyteViewPort").on("didConnect"),didDestroy:function(){delete this.lyteInput}},{mixins:["crux-element-validation"]}),Lyte.Component.register("crux-email-component",{_template:'<template tag-name="crux-email-component"> <template is="switch" value="{{cxPropFrom}}"><template case="create"> <template is="if" value="{{cxPropField[cxPropFieldKey]}}"><template case="true"> <div class="cxElementLabel {{cxPropLabelClass}}"> {{cxPropField[cxPropFieldKey]}} <template is="if" value="{{cxPropInfoTooltip}}"><template case="true"> <span class="dIB vam cxInfoIcon" onmouseenter="{{action(\'showInfoTooltip\',this)}}"></span> <lyte-hovercard lt-prop-placement="topLeft" lt-prop-keep-alive="true" lt-prop-popover-wrapper-class="cxElementsHovercard" lt-prop-origin-elem=".cxCurrentHovercard" on-hovercard-hide="{{method(\'hideInfoTooltip\')}}"> <template is="registerYield" yield-name="hoverCardYield"> <lyte-hovercard-content class="cxElementsHoverCardContent"> {{cxPropInfoTooltip}} </lyte-hovercard-content> </template> </lyte-hovercard> </template></template> </div> </template></template> <div class="cxElementValue {{if(cxPropDisabled,\'cxElementDisabled\',\'\')}}"> <lyte-input lt-prop-name="{{cxPropName}}" id="{{cxPropId}}" lt-prop-title="{{cxPropTooltip}}" lt-prop-tooltip-config="{{cxPropTooltipConfig}}" lt-prop-tooltip-style="margin: 10px; font-size : 11px;" lt-prop-class="cxBorderBottom {{cxPropInputClass}}" class="w100per {{if(ifEquals(cxPropAppearance,\'box\'),\'cxBoxInput\',\'cxFlatInput\')}}" lt-prop-type="text" lt-prop-value="{{lbind(cxPropValue)}}" lt-prop-maxlength="{{cxPropMaxlength}}" lt-prop-direction="{{cxPropDirection}}" lt-prop-disabled="{{cxPropDisabled}}" lt-prop-readonly="{{cxPropReadonly}}" lt-prop-placeholder="{{cxPropPlaceholder}}" on-value-change="{{method(\'onChange\')}}" lt-prop-appearance="{{cxPropAppearance}}" data-zcqa="{{cxPropZcqa}}" lt-prop-tab-index="{{cxPropTabIndex}}" lt-prop-autofocus="{{cxPropAutofocus}}" lt-prop-aria="{{cxPropAria}}" lt-prop-aria-attributes="{{cxPropAriaAttributes}}" lt-prop-auto-update="{{cxPropEnableLbind}}" lt-prop-tooltip-class="{{cxPropTooltipClass}}" lt-prop-wrapper-class="{{cxPropWrapperClass}}"></lyte-input> <template is="if" value="{{cxPropShowDisabledIcon}}"><template case="true"><span class="cxElementsDisabledIcon {{cxPropDisabledIconClass}}"></span></template></template> <template is="if" value="{{isError}}"><template case="true"> <crux-error-message error-message="{{cxPropErrorMessage}}" cx-prop-error-yield="{{cxPropErrorYield}}" cx-prop-error-zcqa-prefix="{{cxPropErrorZcqaPrefix}}" cx-prop-field="{{cxPropField}}" cx-prop-error-zcqa-suffix="{{cxPropErrorZcqaSuffix}}" class="{{cxPropErrorClass}}" cx-prop-error-span-class="{{cxPropErrorSpanClass}}"> <template is="registerYield" yield-name="errorYield"><lyte-yield yield-name="errorYield" error-message="{{cxPropErrorMessage}}" cx-field="{{cxPropField}}"></lyte-yield></template> </crux-error-message> </template></template> </div> </template><template case="view"> <template is="if" value="{{cxPropValue}}"><template case="true"> <template is="if" value="{{cxPropMaskingProperties}}"><template case="true">{{cruxMaskValue(cxPropValue,cxPropMaskingProperties)}} </template><template case="false"> <template is="if" value="{{cxPropViewClipLabel}}"><template case="true"> <a class="cxEmailViewLink cxElementViewValue cxElementViewClipLabel" href="mailto:{{cxPropValue}}" id="{{cxPropId}}" onclick="{{action(\'stopP\')}}"> <lyte-text lt-prop-value="{{cxPropValue}}"></lyte-text> </a> </template><template case="false"> <a class="cxEmailViewLink cxElementViewValue cxElementViewWrapLabel" href="mailto:{{cxPropValue}}" id="{{cxPropId}}" onclick="{{action(\'stopP\')}}">{{cxPropValue}}</a> </template></template> <template is="if" value="{{cxPropViewInfoTooltip}}"><template case="true"> <crux-view-info-tooltip cx-prop-field="{{cxPropField}}" cx-prop-value="{{cxPropValue}}"> <template is="yield" yield-name="viewInfoTooltipYield"> <lyte-yield yield-name="viewInfoTooltipYield" prop-field="{{propField}}" prop-value="{{propValue}}"></lyte-yield> </template> </crux-view-info-tooltip> </template></template> </template></template> </template><template case="false"><template is="if" value="{{cxPropEmptyValue}}"><template case="true">{{cxPropEmptyValue}}</template></template></template></template> </template></template> </template>',_dynamicNodes:[{type:"attr",position:[1]},{type:"switch",position:[1],cases:{create:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,1]},{type:"attr",position:[1,3]},{type:"if",position:[1,3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[3]},{type:"registerYield",position:[3,1],dynamicNodes:[{type:"text",position:[1,1]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[3]}]}},default:{}}]}},default:{}},{type:"attr",position:[3]},{type:"attr",position:[3,1]},{type:"componentDynamic",position:[3,1]},{type:"attr",position:[3,3]},{type:"if",position:[3,3],cases:{true:{dynamicNodes:[{type:"attr",position:[0]}]}},default:{}},{type:"attr",position:[3,5]},{type:"if",position:[3,5],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"attr",position:[0]},{type:"insertYield",position:[0]}]},{type:"componentDynamic",position:[1]}]}},default:{}}]},view:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"text",position:[0]}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"componentDynamic",position:[1,1]}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,0]}]}},default:{}},{type:"attr",position:[3]},{type:"if",position:[3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"insertYield",position:[1]}]},{type:"componentDynamic",position:[1]}]}},default:{}}]}},default:{}}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"text",position:[0]}]}},default:{}}]}},default:{}}]}},default:{}}],_observedAttributes:["lyteViewPort","cxPropValue","cxPropEmptyValue","cxPropFrom","cxPropDisabled","cxPropReadonly","cxPropPlaceholder","isError","cxPropAppearance","cxPropErrorMessage","cxPropField","cxPropFieldKey","cxPropId","cxPropName","cxPropClearErrorMessage","cxPropDirection","cxPropLabelClass","cxPropErrorYield","cxPropTabIndex","cxPropZcqa","lyteUnbound","cxPropClass","cxPropIconClass","cxPropTooltip","cxPropMaxlength","cxPropInfoTooltip","cxPropAutocomplete","cxPropMaskingProperties","cxPropViewClipLabel","cxPropEnableLbind","cxPropTooltipConfig","cxPropTooltipClass","cxPropErrorZcqaPrefix","cxPropErrorZcqaSuffix","cxPropErrorClass","cxPropWrapperClass","cxPropInputClass","cxPropErrorSpanClass","cxPropLayout","cxPropViewInfoTooltip","cxPropShowDisabledIcon","cxPropDisabledIconClass","cxPropAria","cxPropAriaAttributes"],data:function(){return{lyteViewPort:Lyte.attr("boolean",{default:!1}),cxPropValue:Lyte.attr("string"),cxPropEmptyValue:Lyte.attr("string",{default:""}),cxPropFrom:Lyte.attr("string",{default:"view"}),cxPropDisabled:Lyte.attr("boolean"),cxPropReadonly:Lyte.attr("boolean"),cxPropPlaceholder:Lyte.attr("string"),isError:Lyte.attr("boolean",{default:!1}),cxPropAppearance:Lyte.attr("string",{default:"flat"}),cxPropErrorMessage:Lyte.attr("string",{default:""}),cxPropField:Lyte.attr("object",{default:{}}),cxPropFieldKey:Lyte.attr("string",{default:""}),cxPropId:Lyte.attr("string",{default:""}),cxPropName:Lyte.attr("string",{default:""}),cxPropClearErrorMessage:Lyte.attr("boolean",{default:!0}),cxPropDirection:Lyte.attr("string",{default:"vertical"}),cxPropLabelClass:Lyte.attr("string",{default:""}),cxPropErrorYield:Lyte.attr("boolean",{default:!1}),cxPropTabIndex:Lyte.attr("string"),cxPropZcqa:Lyte.attr("string"),lyteUnbound:Lyte.attr("boolean",{default:!1}),cxPropClass:Lyte.attr("string",{default:""}),cxPropIconClass:Lyte.attr("string",{default:"cxEditIcon"}),cxPropTooltip:Lyte.attr("string",{default:""}),cxPropMaxlength:Lyte.attr("number"),cxPropInfoTooltip:Lyte.attr("string",{default:""}),cxPropAutocomplete:Lyte.attr("string",{default:"on"}),cxPropMaskingProperties:Lyte.attr("object"),cxPropViewClipLabel:Lyte.attr("boolean",{default:!1}),cxPropEnableLbind:Lyte.attr("boolean",{default:!0}),cxPropTooltipConfig:Lyte.attr("string",{default:'{"position": "followcursor", "appearance": "box"}'}),cxPropTooltipClass:Lyte.attr("string"),cxPropErrorZcqaPrefix:Lyte.attr("string",{default:""}),cxPropErrorZcqaSuffix:Lyte.attr("string",{default:"Error"}),cxPropErrorClass:Lyte.attr("string"),cxPropWrapperClass:Lyte.attr("string"),cxPropInputClass:Lyte.attr("string",{default:""}),cxPropErrorSpanClass:Lyte.attr("string"),cxPropLayout:Lyte.attr("string"),cxPropViewInfoTooltip:Lyte.attr("boolean",{default:!1}),cxPropShowDisabledIcon:Lyte.attr("boolean",{default:!1}),cxPropDisabledIconClass:Lyte.attr("string",{default:""}),cxPropAria:Lyte.attr("boolean",{default:!1}),cxPropAriaAttributes:Lyte.attr("object",{default:{}})}},getValue:function(){return"string"==typeof this.data.cxPropValue?this.getData("cxPropValue").trim():this.getData("cxPropValue")},validate:function(){var e=this.getValue(),t=this.data.cxPropField;if(!e)return this.validateMandatory(!0)?(this.setData("cxPropErrorMessage",""),!0):(this.$node.querySelector("lyte-input")&&this.$node.querySelector("lyte-input").focus(),!1);if(!this.validateLength(e))return!1;var o=!1;if("undefined"==typeof XRegExp){o=(a=/^[A-Za-z0-9\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF_](?:[A-Za-z0-9\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF!#$%&'*+/=?^_`{|}~.-]*[^,])@(?=.{4,256}$)(?:([A-Za-z0-9\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+)(([-_]*[A-Za-z0-9\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*)[.])+[A-Za-z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]{2,22}$/).test(e)}else{var a=/^[\p{L}\p{M}\p{N}_]([\p{L}\p{M}\p{N}!#$%&'*+-/=?^_`{|}~.]*)@(?=.{4,256}$)(([\p{L}\p{N}\p{M}]+)(([-_]*[\p{L}\p{M}\p{N}])*)[.])+[\p{L}\p{M}]{2,22}$/,r=new XRegExp(a.source,"i");o=XRegExp.test(e.trim(),r)}return o?this.setData("cxPropErrorMessage",""):this.getMethods("onError")?this.executeMethod("onError",this.errorCodes.ERR02,this):this.setData("cxPropErrorMessage",_cruxUtils.getI18n("crm.field.valid.check",Lyte.Component.registeredHelpers.cruxEncodeHTML(t.field_label))),o},methods:{onChange:function(){this.data.cxPropClearErrorMessage&&this.setData("cxPropErrorMessage",""),this.getMethods("onValueChange")&&this.executeMethod("onValueChange",this.getData("cxPropValue"))},hideInfoTooltip:function(){this.showHideInfoTooltip()}},observeErrorMessage:function(){this.setData("isError",""!=this.data.cxPropErrorMessage)}.observes("cxPropErrorMessage").on("init"),actions:{stopP:function(){event.stopPropagation()},showInfoTooltip:function(e){this.showHideInfoTooltip(e)}},observeIsError:function(){"create"==this.getData("cxPropFrom")&&this.$node.querySelector("lyte-input")&&(this.getData("isError")?this.$node.querySelector("lyte-input").classList.add("cxErrorBox"):this.$node.querySelector("lyte-input")&&this.$node.querySelector("lyte-input").classList.remove("cxErrorBox"))}.observes("isError","lyteViewPort").on("didConnect"),observeMandatory:function(){this.observeMandatoryMixin("lyte-input")}.observes("cxPropField.required","lyteViewPort").on("didConnect"),init:function(){this.getData("cxPropDisabled")&&!this.data.cxPropTooltip&&this.setData("cxPropTooltip",_cruxUtils.getI18n("crm.lable.read.only")),"create"==this.data.cxPropFrom&&this.setFocusUtil()},observeClass:function(e){if("create"==this.data.cxPropFrom){var t=$L("lyte-input",this.$node);if(!t.length)return;e&&e.oldValue&&t.removeClass(e.oldValue),this.data.cxPropClass&&t.addClass(this.data.cxPropClass)}}.observes("cxPropClass","lyteViewPort").on("didConnect")},{mixins:["crux-element-validation"]}),Lyte.Component.register("crux-layout-component",{_template:'<template tag-name="crux-layout-component"> <template is="switch" value="{{cxPropFrom}}"><template case="view"> <template is="if" value="{{cxPropValue}}"><template case="true"> <template is="if" value="{{cxPropMaskingProperties}}"><template case="true">{{cruxMaskValue(cxPropValue.name,cxPropMaskingProperties)}} </template><template case="false">{{cxPropValue.name}} <template is="if" value="{{cxPropViewInfoTooltip}}"><template case="true"> <crux-view-info-tooltip cx-prop-field="{{cxPropField}}" cx-prop-value="{{cxPropValue}}"> <template is="yield" yield-name="viewInfoTooltipYield"> <lyte-yield yield-name="viewInfoTooltipYield" prop-field="{{propField}}" prop-value="{{propValue}}"></lyte-yield> </template> </crux-view-info-tooltip> </template></template> </template></template> </template><template case="false"><template is="if" value="{{cxPropEmptyValue}}"><template case="true">{{cxPropEmptyValue}}</template></template></template></template> </template><template case="filter"></template><template case="criteria"></template><template case="create"> <lyte-dropdown id="{{cxPropId}}" lt-prop-boundary="{{cxPropBoundary}}" lt-prop-yield="true" lt-prop-type="{{cxPropType}}" lt-prop-tabindex="1" on-add="{{method(\'addToList\')}}" on-remove="{{method(\'removeFromList\')}}" lt-prop-disabled-list="{{disabledList}}" lt-prop-selected="{{selectedIds}}" on-option-selected="{{method(\'selectLayout\')}}" on-before-show="{{method(\'onBeforeLayoutDropdown\')}}" on-hide="{{method(\'closeDropdown\')}}" class="{{if(ifEquals(cxPropAppearance,\'flat\'),\'cxFlatDropdown\',\'cxBoxDropdown\')}} {{cxPropClass}}" on-before-hide="{{method(\'beforeHide\')}}" lt-prop-display-value="{{displayValue}}" lt-prop-placeholder="{{placeholder}}"> <template is="registerYield" yield-name="yield"> <template is="if" value="{{expHandlers(cxPropType,\'!=\',&quot;single&quot;)}}"><template case="true"> <lyte-drop-button data-zcqa="{{cxPropZcqa}}"> <ul class="lyteMultipleSelect"> <template is="for" items="{{value}}" item="layout" index="index"> <li data-value="{{layout.id}}"> <span class="lyteDropdownVisible" onmouseenter="{{action(\'setToolTip\',this)}}">{{layout.name}}</span> <lyte-drop-remove class="lyteCloseIcon"></lyte-drop-remove> </li> </template> <li class="lyteMultiselectInput"> <lyte-search class="w100per" lt-prop-type="text" lt-prop-query-selector="{&quot;scope&quot;:&quot;.{{searchScope}}&quot;, &quot;target&quot;:&quot;.cruxlayoutList&quot;, &quot;search&quot;:&quot;.cruxlayoutList:not(.lyteDropdownActive)&quot;}" on-search="{{method(\'showNoResult\')}}" id="search_layout" lt-prop-placeholder="{{placeholder}}" onclick="{{action(\'searchBoxClicked\')}}" on-focus="{{method(\'onSearchBoxFocused\')}}" onkeydown="{{action(\'preventDefault\',this,event)}}" lt-prop-trim="true"></lyte-search> </li> </ul> </lyte-drop-button> </template></template> <lyte-drop-box class="cxDropbox"> <lyte-drop-body class="{{searchScope}}"> <template is="if" value="{{showLoading}}"><template case="true"> <div class="cxLayoutLoaderWrap aligncenter"> <span class="cxElementsLoaderBg cxLayoutLoaderIcon"></span> </div> </template><template case="false"><template is="for" items="{{layout}}" item="lay" index="index"><template is="if" value="{{expHandlers(modelReq,\'==\',\'wizard\')}}"><template case="true"> <lyte-drop-item class="picklist_values cruxlayoutList" data-value="{{lay.id}}" data-zcqa="{{concat(cxPropField.field_label,\'_\',lay.name)}}" selected="{{if(cruxContains(selectedIds,lay.id),true,false)}}">{{lay.name}}</lyte-drop-item> </template><template case="false"> <lyte-drop-item class="picklist_values cruxlayoutList" data-value="{{lay.id}}" data-zcqa="{{concat(cxPropField.field_label,\'_\',lay.name)}}" selected="{{if(cruxContains(selectedIds,lay.id),true,false)}}">{{lay.name}}</lyte-drop-item> </template></template></template></template></template> <template is="if" value="{{expHandlers(layoutLength,\'!\')}}"><template case="true"> <div class="lyteDropdown-disabled cxDropdownNoResult">{{cruxGetI18n(\'crm.label.no.options.found\')}}</div> </template></template> </lyte-drop-body> </lyte-drop-box> </template> </lyte-dropdown> </template></template> </template>',_dynamicNodes:[{type:"attr",position:[1]},{type:"switch",position:[1],cases:{view:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"text",position:[0]}]},false:{dynamicNodes:[{type:"text",position:[0]},{type:"attr",position:[2]},{type:"if",position:[2],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"insertYield",position:[1]}]},{type:"componentDynamic",position:[1]}]}},default:{}}]}},default:{}}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"text",position:[0]}]}},default:{}}]}},default:{}}]},filter:{dynamicNodes:[],additional:{next:"criteria"}},criteria:{dynamicNodes:[],additional:{next:"create"}},create:{dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1,1]},{type:"for",position:[1,1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"text",position:[1,1,0]},{type:"componentDynamic",position:[1,3]}]},{type:"attr",position:[1,1,3,1]},{type:"componentDynamic",position:[1,1,3,1]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"attr",position:[3,1]},{type:"attr",position:[3,1,1]},{type:"if",position:[3,1,1],cases:{true:{dynamicNodes:[]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"for",position:[0],dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,0]},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,0]},{type:"componentDynamic",position:[1]}]}},default:{}}]}]}},default:{}},{type:"attr",position:[3,1,3]},{type:"if",position:[3,1,3],cases:{true:{dynamicNodes:[{type:"text",position:[1,0]}]}},default:{}},{type:"componentDynamic",position:[3,1]},{type:"componentDynamic",position:[3]}]},{type:"componentDynamic",position:[1]}]}},default:{}}],_observedAttributes:["lyteViewPort","cxPropValue","cxPropFrom","cxPropModule","layout","value","layoutLength","disabledList","cxPropEmptyValue","selectedIds","cxPropField","cxPropFieldKey","cxPropZcqa","placeholder","cxPropType","cxPropIgnoreEmptyValue","showLoading","moduleId","cxPropAppearance","cxPropBoundary","lyteUnbound","cxPropId","modelReq","cxPropClass","searchScope","cxPropMaskingProperties","cxPropDontShowDisabledLayouts","displayValue","cxPropLayouts","cxPropPlaceholder","cxPropViewInfoTooltip","cxPropDisplayValue"],data:function(){return{lyteViewPort:Lyte.attr("boolean",{default:!1}),cxPropValue:Lyte.attr("object"),cxPropFrom:Lyte.attr("string",{default:"view"}),cxPropModule:Lyte.attr("string"),layout:Lyte.attr("array"),value:Lyte.attr("array",{default:[]}),layoutLength:Lyte.attr("boolean",{default:!0}),disabledList:Lyte.attr("array",{default:["cruxDisabled"]}),cxPropEmptyValue:Lyte.attr("string",{default:""}),selectedIds:Lyte.attr("array",{default:[]}),cxPropField:Lyte.attr("object",{default:{}}),cxPropFieldKey:Lyte.attr("string",{default:""}),cxPropZcqa:Lyte.attr("string"),placeholder:Lyte.attr("string",{default:_cruxUtils.getI18n("None")}),cxPropType:Lyte.attr("string",{default:"multisearch"}),cxPropIgnoreEmptyValue:Lyte.attr("boolean",{default:!1}),showLoading:Lyte.attr("boolean",{default:!0}),moduleId:Lyte.attr("string"),cxPropAppearance:Lyte.attr("string",{default:"flat"}),cxPropBoundary:Lyte.attr("object",{default:{}}),lyteUnbound:Lyte.attr("boolean",{default:!1}),cxPropId:Lyte.attr("string",{default:""}),modelReq:Lyte.attr("string"),cxPropClass:Lyte.attr("string"),searchScope:Lyte.attr("string",{default:"parentscope_"}),cxPropMaskingProperties:Lyte.attr("object"),cxPropDontShowDisabledLayouts:Lyte.attr("boolean",{default:!1}),displayValue:Lyte.attr("string",{default:_cruxUtils.getI18n("crm.select")}),cxPropLayouts:Lyte.attr("array"),cxPropPlaceholder:Lyte.attr("string"),cxPropViewInfoTooltip:Lyte.attr("boolean",{default:!1}),cxPropDisplayValue:Lyte.attr("string")}},init:function(){var e=this.data.cxPropFrom;if("criteria"==e||"filter"==e||"create"==e){"undefined"!=typeof moduleRecordMapping?this.data.moduleId=moduleRecordMapping[this.data.cxPropModule].id:this.data.moduleId=this.data.cxPropModule,this.data.modelReq||(this.data.modelReq=this.data.cxPropField&&this.data.cxPropField.api_name.match("Layout")?"layout":"wizard");var t=this.data.searchScope;t+=this.data.modelReq,this.getData("cxPropId")&&(t=t+"_"+this.data.cxPropId),this.setData("searchScope",t),this.data.cxPropType||this.setData("cxPropType","multisearch"),this.data.cxPropDisplayValue&&this.setData("displayValue",this.data.cxPropDisplayValue)}},methods:{addToList:function(e,t,o){Lyte.arrayUtils(this.data.value,"push",this.data.layout.filter(function(e){return e.id==t})[0]),Lyte.arrayUtils(this.data.selectedIds,"push",t),$L("."+this.getData("searchScope")+" lyte-drop-item").length==JSON.parse(o).length&&this.setData("layoutLength",!1),this.setData("placeholder",this.data.cxPropPlaceholder?this.data.cxPropPlaceholder:"filter"==this.data.cxPropFrom?_cruxUtils.getI18n("crm.label.filter.typehere"):""),this.getMethods("onValueChange")&&this.executeMethod("onValueChange",this.getValue()),""!=this.$node.querySelector("lyte-search").ltProp("value")&&(this.adding=!0,this.$node.querySelector("lyte-search").setValue("")),this.preventClose=!0},removeFromList:function(e,t){for(var o=this.data.value,a=0;a<o.length;a++)if(o[a].id==t){Lyte.arrayUtils(this.data.value,"removeAt",a),Lyte.arrayUtils(this.data.selectedIds,"removeAt",a);break}0==this.data.value.length&&this.setData("placeholder",this.data.cxPropPlaceholder?this.data.cxPropPlaceholder:"filter"==this.data.cxPropFrom?_cruxUtils.getI18n("crm.label.filter.typehere"):_cruxUtils.getI18n("None")),this.setData("layoutLength",!0),this.getMethods("onValueChange")&&this.executeMethod("onValueChange",this.getValue()),this.dropdown&&this.dropdown.open()},showNoResult:function(e){this.data.showLoading||(this.closing?this.closing=!1:this.dropdown&&this.dropdown.component.childComp.classList.contains("lyteDropdownHidden")&&this.dropdown.toggle(),this.adding?this.adding=!1:(e=e.filter(e=>!e.classList.contains("lyteDropdownActive")),this.setData("layoutLength",0!=e.length)))},selectLayout:function(e,t,o,a){this.setData("value",[{id:t,name:a.innerText}]),this.getMethods("onValueChange")&&this.executeMethod("onValueChange",this.getValue()),this.setData("selectedIds",[t])},onBeforeLayoutDropdown:function(){if(this.getMethods("onBeforeShow")&&this.executeMethod("onBeforeShow",arguments[0],arguments[1]),this.data.cxPropLayouts&&(this.setData("layout",this.data.cxPropLayouts),this.setData("showLoading",!1),"single"!=this.data.cxPropType?this.dropdown&&this.dropdown.setData("ltPropSelected",this.getData("selectedIds")):this.dropdown&&this.dropdown.ltProp("selected",this.data.selectedIds[0])),void 0==this.data.layout){this.getData("moduleId");var e=this,t=this.data.cxPropModule&&moduleRecordMapping?moduleRecordMapping[this.data.cxPropModule].api_name:this.data.cxPropModule;store.findAll(this.data.modelReq,{module:t},!0).then(function(t){"single"!=e.data.cxPropType||"create"==e.data.cxPropFrom||void 0!=t[0]&&"cruxLayoutSelect"==t[0].id||t.splice(0,0,{name:_cruxUtils.getI18n("crm.select"),id:"cruxLayoutSelect"});var o=[],a=!1,r=t.length,i="undefined"!=typeof Crm?store.peekRecord("user",Crm.userDetails.USER_ID):{};!i&&window.clientPortalName&&(i={profile:{id:Crm.userDetails.PROFILE_ID}});for(var s=0;s<r;s++){var l=t[s].profiles;"wizard"===e.data.modelReq&&window.clientPortalName&&(l=t[s].portal_user_types),a=e.checkProfilePermission(l,i.profile),"territory"==e.data.modelReq&&null==t[s].parent_id||a&&(0==e.data.cxPropDontShowDisabledLayouts||1==e.data.cxPropDontShowDisabledLayouts&&-1!=t[s].status)&&(o.push(t[s]),a=!1)}e.setData("layout",o),0!=o.length&&o.length!=e.getData("value").length||e.setData("layoutLength",!1),e.setData("showLoading",!1),e.dropdown.setData("ltPropSelected",e.getData("selectedIds")),e.$node.querySelector("lyte-search input")&&e.$node.querySelector("lyte-search input").value&&e.$node.querySelector("lyte-search").setValue(e.$node.querySelector("lyte-search input").value)},function(t){e.setData({layout:[],layoutLength:!1,showLoading:!1})})}else"single"!=this.data.cxPropType&&this.setData("layoutLength",!(this.data.layout.length==this.data.value.length))},closeDropdown:function(){this.closing=!0,this.$node.querySelector("lyte-search")&&""!=this.$node.querySelector("lyte-search").ltProp("value")&&(this.$node.querySelector("lyte-search").setValue(""),this.dropdown&&this.dropdown.close())},beforeHide:function(e){if(this.preventClose&&(this.preventClose=!1,e&&"scroll"==e.type))return!1},onSearchBoxFocused:function(e,t){var o=this.dropdown;"criteria"==this.data.cxPropFrom&&o&&!o.ltProp("isOpen")&&o.open()}},checkProfilePermission:function(e,t){if(!e||!t)return!0;for(var o=0,a=e.length;o<a;o++)if(e[o].id==t.id)return!0;return!1},getValue:function(){for(var e=this.data.value,t=[],o=0;o<e.length;o++)t.push({id:e[o].id,name:e[o].name});return"single"==this.data.cxPropType?t[0]:t},validate:function(){return!(0==this.data.value.length&&!this.data.cxPropIgnoreEmptyValue)||(this.showAlert(_cruxUtils.getI18n("crm.field.valid.check",Lyte.Component.registeredHelpers.cruxEncodeHTML(this.data.cxPropField.field_label))),!1)},observeValue:function(){if("view"!=this.data.cxPropFrom&&this.data.cxPropValue){var e=this.data.cxPropValue;e=e.layouts?e.layouts.hasOwnProperty("id")?[].concat(e.layouts):e.layouts:[e];for(var t=[],o=!0,a=0;a<e.length;a++)e[a].selected=!0,e[a].name||(o=!1),t.push(e[a].id);if(o){this.data.layoutLength;this.setData({value:e,selectedIds:t}),"single"==this.data.cxPropType&&this.setData("displayValue",e[0].name),this.setData("placeholder",this.data.cxPropPlaceholder?this.data.cxPropPlaceholder:"filter"==this.data.cxPropFrom?_cruxUtils.getI18n("crm.label.filter.typehere"):"")}else{var r=this.data.cxPropModule&&"filter"===this.data.cxPropFrom&&moduleRecordMapping?moduleRecordMapping[this.data.cxPropModule].api_name:this.data.cxPropModule,i=this;store.findAll(this.data.modelReq,{module:r},!0).then(function(o){for(var a=e.length,r=0;r<a;r++){var s=store.peekRecord(i.data.modelReq,e[r].id);s?e[r].name=s.name:(e.splice(r,1),t.splice(r,1),r--,a--)}i.data.layoutLength;i.setData({value:e,selectedIds:t}),i.setData("placeholder",this.data.cxPropPlaceholder?this.data.cxPropPlaceholder:"filter"==i.data.cxPropFrom?_cruxUtils.getI18n("crm.label.filter.typehere"):"")},function(){for(var o=e.length,a=0;a<o;a++)e[a].name||(e.splice(a,1),t.splice(a,1),o--,a--);i.data.layoutLength;i.setData({value:e,selectedIds:t}),i.setData("placeholder",this.data.cxPropPlaceholder?this.data.cxPropPlaceholder:"filter"==i.data.cxPropFrom?_cruxUtils.getI18n("crm.label.filter.typehere"):"")})}}}.observes("cxPropValue").on("init"),actions:{searchBoxClicked:function(){if(this.dropdown&&1==this.dropdown.ltProp("isOpen"))return this.$node.querySelector("lyte-search").querySelector("input").value&&this.$node.querySelector("lyte-search").setValue(""),!1},preventDefault:function(e,t){13==t.keyCode&&t.preventDefault()},setToolTip:function(e){e.offsetWidth<e.scrollWidth?e.setAttribute("title",e.textContent):e.setAttribute("title","")}},didDestroy:function(){delete this.dropdown,window.removeEventListener("resize",this.resetPosition.bind(this))},setDropdown:function(){this.dropdown=this.$node.querySelector("lyte-dropdown"),window.addEventListener("resize",this.resetPosition.bind(this))}.observes("lyteViewPort").on("didConnect"),resetPosition:function(){setTimeout(function(){this.dropdown.resetPosition()}.bind(this),200)}},{mixins:["crux-element-validation"]}),Lyte.Mixin.register("crux-lookup-mixin",{lookupInit:function(e,t,o,a,r){var i=this,s=[this.executeMethod("fetchModuleData",t)];if(this.data.cxPropRelatedId){var l=[{id:this.data.cxPropRelatedId,name:_cruxUtils.getI18n("crm.related.contact.account",this.data.module.plural_label,this.data.cxPropRelatedName)},{id:"2",name:_cruxUtils.getI18n("crm.allcontact.show",this.data.module.plural_label)}];this.setData("headerOptions",l),this.setData("selectedHeaderValue",this.data.cxPropRelatedId),s.push(this.executeMethod("fetchModuleData",this.data.cxPropRelatedModuleId))}Lyte.resolvePromises(s).then(function(t){var s=t[0];e.$node&&(e.setData("module",s),i.setModuleData(e,s,o,r,a))})},setModuleData:function(e,t,o,a,r){e.setData("moduleName",t.module_name);var i=t.display_field.api_name;e.setData("displayField",i),o?e.getRecs():e.beforeShowFunc(r,a,!0)},constructSearchFilter:function(e,t){var o={comparator:"contains",field:{api_name:e},value:t};if(("Products"==this.data.modulenameUicomp||"Products"==this.data.moduleName)&&this.data.module.fields){var a=this.data.module.fields.filterBy({api_name:"Product_Code"});a.length&&a[0].visible&&(o={group_operator:"or",group:[o,{comparator:"contains",field:{api_name:"Product_Code"},value:t}]})}if(this.data.header)for(var r=0;r<this.data.header.length;r++)if(this.data.header[r].api_name!=e)switch(this.data.header[r].cxTypeMapping){case"email":case"phone":o={group_operator:"or",group:[o,{comparator:"contains",field:{api_name:this.data.header[r].api_name},value:t}]}}return JSON.stringify(o)}}),Lyte.Component.register("crux-lookup-component",{_template:'<template tag-name="crux-lookup-component"> <template is="switch" value="{{cxPropFrom}}"><template case="view"> <template is="if" value="{{showEmptyValue}}"><template case="true"> {{cxPropEmptyValue}} </template><template case="false"> <template is="if" value="{{cxPropMaskingProperties}}"><template case="true">{{cruxMaskValue(lookupValue,cxPropMaskingProperties)}} </template><template case="false"> <link-to data-zcqa="{{cxPropZcqa}}" lt-prop-route="{{cxPropRouteName}}" lt-prop-dp="{{cxPropDynamicParams}}" lt-prop-qp="{{cxPropQueryParams}}" lt-prop-id="{{cxPropId}}" lt-prop-td="{{cxPropTransitionData}}" lt-prop-class="link cxLink" lt-prop-target="{{cxPropTarget}}" onmouseover="{{action(\'showLookupBC\',true)}}" onmouseout="{{action(\'showLookupBC\')}}"><template is="if" value="{{expHandlers(expHandlers(cxPropIconClass,\'&amp;&amp;\',lookupValue),\'&amp;&amp;\',expHandlers(cxPropHideIconForView,\'!\'))}}"><template case="true"><div class="{{cxPropIconClass}}"></div></template></template><lyte-text lt-prop-value="{{lookupValue}}" lt-prop-tooltip-config="{{cxPropTooltipConfig}}" class="cruxPreventClick"></lyte-text></link-to> <template is="if" value="{{cxPropViewInfoTooltip}}"><template case="true"> <crux-view-info-tooltip cx-prop-field="{{cxPropField}}" cx-prop-value="{{cxPropValue}}"> <template is="yield" yield-name="viewInfoTooltipYield"> <lyte-yield yield-name="viewInfoTooltipYield" prop-field="{{propField}}" prop-value="{{propValue}}"></lyte-yield> </template> </crux-view-info-tooltip> </template></template> </template></template> </template></template> </template><template case="create"> <template is="if" value="{{cxPropField[cxPropFieldKey]}}"><template case="true"> <div class="cxElementLabel {{cxPropLabelClass}}"> {{cxPropField[cxPropFieldKey]}} <template is="if" value="{{cxPropInfoTooltip}}"><template case="true"> <span class="dIB vam cxInfoIcon" onmouseenter="{{action(\'showInfoTooltip\',this)}}"></span> <lyte-hovercard lt-prop-placement="topLeft" lt-prop-keep-alive="true" lt-prop-popover-wrapper-class="cxElementsHovercard" lt-prop-origin-elem=".cxCurrentHovercard" on-hovercard-hide="{{method(\'hideInfoTooltip\')}}"> <template is="registerYield" yield-name="hoverCardYield"> <lyte-hovercard-content class="cxElementsHoverCardContent"> {{cxPropInfoTooltip}} </lyte-hovercard-content> </template> </lyte-hovercard> </template></template> </div> </template></template> <div class="cxElementValue {{if(cruxAnd(cxPropDisabled,expHandlers(cxPropReadonly,\'!\')),\'cxElementDisabled\',\'\')}}"> <div class="cxLookupComponent cxBoxWithRightIcon {{cxPropWrapperClass}}"> <div class="cxBoxLeftContent"> <template is="if" value="{{cxPropAutocomplete}}"><template case="true"> <lyte-autocomplete lt-prop-dropdown-class="cxLookupDropbox cxDropbox" lt-prop-input="{&quot;class&quot; : &quot;cxLookupCompInputElem&quot;}" lt-prop-title="{{tooltip}}" lt-prop-tooltip-config="{{cxPropTooltipConfig}}" lt-prop-tooltip-class="{{cxPropTooltipClass}}" lt-prop-prevent-inside-click="true" data-zcqa="{{cxPropZcqa}}" lt-prop-value="{{lookupSingle}}" on-select="{{method(\'autoComp\')}}" lt-prop-dropdown-height="250px" lt-prop-yield="true" lt-prop-appearance="{{cxPropAppearance}}" lt-prop-highlight="false" lt-prop-min-length="0" lt-prop-value-set="true" on-scroll="{{method(\'scrollRecord\')}}" lt-prop-autofocus="{{cxPropAutofocus}}" on-before-show="{{method(\'beforeShow\')}}" lt-prop-tab-index="{{cxPropTabIndex}}" lt-prop-disabled="{{cxPropDisabled}}" lt-prop-readonly="{{cxPropReadonly}}" lt-prop-placeholder="{{cxPropPlaceholder}}" id="{{cxPropId}}" class="{{cxPropClass}} {{if(isError,\'cxErrorBox\')}}" lt-prop-maxlength="{{cxPropMaxlength}}" lt-prop-error-class="noErrClass" on-focus="{{method(\'autoFocus\')}}" lt-prop-external-search="true" on-ext-search="{{method(\'beforeSearch\')}}" on-blur="{{method(\'onBlurInput\')}}" after-render="{{method(\'afterRenderAutocomplete\')}}" lt-prop-aria="{{cxPropAria}}" lt-prop-aria-attributes="{{cxPropAriaAttributes}}" on-hide="{{method(\'onHideDropdown\')}}" lt-prop-id="{{cxPropInputId}}" lt-prop-dropdown="{&quot;preventParentScroll&quot; : &quot;{{cxPropPreventParentScroll}}&quot;}"> <template is="registerYield" yield-name="yield"> <lyte-drop-box> <lyte-drop-body class="{{if(visible,\'cxVisibleLookup\')}}"> <template is="if" value="{{expHandlers(initComp,\'&amp;&amp;\',expHandlers(ften.length,\'>\',0))}}"><template case="true"><template is="for" items="{{ften}}" item="val" index="index"> <lyte-drop-item data-value="{{val.id}}" class="lookupSearchLi" data-zcqa="{{val[displayField]}}" onmouseenter="{{action(\'showHideIcon1\',true,val)}}" onmouseleave="{{action(\'showHideIcon1\',false,val)}}"> <lyte-autocomplete-label> <lyte-text class="cxLookupDropboxLabel" lt-prop-value="{{val[displayField]}}"></lyte-text> <template is="if" value="{{cxPropShowHideTooltip}}"><template case="true"> <span class="cxLookupInfoIcon {{if(val.cxPropShowIcon,\'cruxLookupPopover\')}}" onmouseenter="{{action(\'infoPop\',this,val,event)}}" onmouseleave="{{action(\'infoPop\',this,val,event)}}" style="{{if(val.cxPropShowIcon,\'visibility: visible;\',\'visibility: hidden\')}}"></span> </template></template> </lyte-autocomplete-label> </lyte-drop-item> </template></template><template case="false"><template is="if" value="{{expHandlers(initComp,\'&amp;&amp;\',expHandlers(expHandlers(ften,\'!\'),\'||\',expHandlers(ften.length,\'===\',0)))}}"><template case="true"> <template is="if" value="{{searchPerformed}}"><template case="true"> <div class="cxDropdownNoResult">{{cruxGetI18n(\'crm.template.listview.search.no.results\')}}</div> </template><template case="false"> <div class="cxDropdownNoResult">{{cruxGetI18n(\'crm.krp.no.records.found\',module.singular_label)}}</div> </template></template> </template></template></template></template> </lyte-drop-body> <template is="if" value="{{cxPropFooterYield}}"><template case="true"><lyte-drop-footer><lyte-yield yield-name="footer"></lyte-yield></lyte-drop-footer></template></template> </lyte-drop-box> </template> </lyte-autocomplete> </template><template case="false"><template is="if" value="{{cxPropDisabled}}"><template case="true"> <lyte-input class="cxLookupCompDisabledInput" lt-prop-appearance="{{cxPropAppearance}}" data-zcqa="{{cxPropZcqa}}" lt-prop-value="{{lookupSingle}}" lt-prop-disabled="true"></lyte-input> </template><template case="false"> <lyte-input class="cxLookupCompReadonlyInput" lt-prop-appearance="{{cxPropAppearance}}" data-zcqa="{{cxPropZcqa}}" lt-prop-value="{{lookupSingle}}" lt-prop-readonly="true" onclick="{{action(\'showLookup\',event)}}" lt-prop-id="{{cxPropInputId}}"></lyte-input> </template></template></template></template> <template is="if" value="{{cxPropShowDisabledIcon}}"><template case="true"><span class="cxElementsDisabledIcon {{cxPropDisabledIconClass}}"></span></template></template> <template is="if" value="{{showLoading}}"><template case="true"> <div class="cxBoxSpinWrapper cxFlexCenter"> <span class="cxElementsLoaderBg" id="Crm_{{cxPropModule}}_{{cxPropField.column_name}}_loadimg"></span> </div> </template><template case="false"><template is="if" value="{{expHandlers(cxPropAutocomplete,\'&amp;&amp;\',expHandlers(cxPropShowCloseIcon,\'||\',expHandlers(expHandlers(cxPropShowCloseIcon,\'!\'),\'&amp;&amp;\',lookupSingle)))}}"><template case="true"> <div class="cxBoxCloseIconWrap cxFlexCenter"> <div id="Crm_lookup_img_Crm_{{cxPropModule}}_{{cxPropField.column_name}}" class="cxBoxCloseIcon cP {{cxPropClearIconClass}}" onclick="{{action(\'clearlookupField\')}}" data-zcqa="lookup_Crm_{{cxPropModule}}_{{cxPropField.column_name}}_close"></div> </div> </template></template></template></template> </div> <div class="cxLookupIcon cxBoxRightIcon cxFlexCenter cP {{cxPropRightIconClass}}" onclick="{{action(\'showLookup\',event)}}" data-zcqa="{{if(cxPropImgZcqa,cxPropImgZcqa,concat(\'lookup_\',cxPropZcqa))}}"> <div class="{{cxPropIconClass}}" data-label="Crm_{{cxPropModule}}_{{cxPropField.column_name}}" id="Crm_{{cxPropModule}}_{{cxPropField.column_name}}_img" tabindex="{{cxPropField.tab_index}}" lt-prop-title="{{cxPropIconTooltip}}"></div> </div> <template is="if" value="{{renderLookup}}"><template case="true"><template is="if" value="{{cxPropAdvanceSearchEnabled}}"><template case="true"> <crux-lookup-filter-modal cx-prop-field-of-lookup-val="{{cxPropFieldOfLookupVal}}" cx-prop-parent-module="{{cxPropParentModule}}" cx-prop-default-criteria="{{cxPropDefaultCriteria}}" module="{{lbind(module)}}" show="{{show}}" disp-init="{{dispInit}}" fetch-module-data="{{method(\'fetchModule\')}}" fetch-records="{{method(\'fetchRecordsData\')}}" mod-id="{{modId}}" display-field="{{lbind(displayField)}}" is-single="{{isSingle}}" record="{{lbind(record)}}" selected-single="{{selectedSingle.id}}" selected-single-record="{{lbind(selectedSingle)}}" lookup-single="{{lbind(lookupSingle)}}" module-name="{{lbind(moduleName)}}" on-value-change="{{method(\'triggerOnValueChange\')}}" cx-prop-value="{{cxPropValue}}" render-lookup="{{lbind(renderLookup)}}" fields-obj="{{moduledataUicomp}}" cx-prop-create-yield="{{cxPropCreateYield}}" temp-close="{{lbind(tempClose)}}" id-index="{{idIndex}}" cx-prop-related-id="{{cxPropRelatedId}}" cx-prop-related-module-id="{{cxPropRelatedModuleId}}" cx-prop-related-name="{{cxPropRelatedName}}" cx-prop-dont-show-related-dropdown="{{cxPropDontShowRelatedDropdown}}" cx-prop-field="{{moduledataUicomp}}" cx-prop-return-full-object-on-get="{{cxPropReturnFullObjectOnGet}}" cx-prop-default-fields="{{cxPropDefaultFields}}" related-record-data="{{cxPropRelatedRecordData}}" cx-prop-additional-params="{{cxPropAdditionalParams}}"> <template is="yield" yield-name="createYield"><lyte-yield yield-name="createYield"></lyte-yield></template> </crux-lookup-filter-modal> </template><template case="false"> <crux-lookup-modal fetch-records-on-enter="{{cxPropFetchRecordsOnEnter}}" module-data="{{moduleData}}" moduledata-uicomp="{{moduledataUicomp}}" api-name="{{apiName}}" query-param-object="{{lbind(queryParamObject)}}" related-field-comp="{{lbind(relatedFieldComp)}}" advanced-search="{{Crm.userDetails.isLookupAdvancedSearchEnabled}}" column-list="{{Crm.userDetails.isLookupAdvancedSearchEnabled}}" related-to="{{lbind(relatedTo)}}" record="{{lbind(record)}}" mod-id="{{modId}}" disp-init="{{dispInit}}" rendered-page="{{lbind(renderedPage)}}" selected-single="{{selectedSingle.id}}" selected-single-record="{{lbind(selectedSingle)}}" display-field="{{lbind(displayField)}}" is-single="{{isSingle}}" field-mapping="{{uiTypeMapping}}" lookup-single="{{lbind(lookupSingle)}}" module-name="{{lbind(moduleName)}}" module="{{lbind(module)}}" per-page="10" show="{{show}}" rep-record="{{lbind(repRecord)}}" fld-id="{{fldId}}" relations="{{lbind(relations)}}" fetch-module-data="{{method(\'fetchModule\')}}" cx-prop-value="{{cxPropValue}}" fetch-records="{{method(\'fetchRecordsData\')}}" cx-prop-field="{{moduledataUicomp}}" on-create-new="{{method(\'createNew\')}}" cx-prop-related-to="{{cxPropRelatedTo}}" on-value-change="{{method(\'triggerOnValueChange\')}}" cx-prop-create-yield="{{cxPropCreateYield}}" cx-prop-header="{{cxPropHeader}}" meta-more-records="{{cxPropMetaMoreRecords}}" cx-prop-fields="{{cxPropFields}}" cx-prop-related-id="{{cxPropRelatedId}}" cx-prop-related-module-id="{{cxPropRelatedModuleId}}" cx-prop-related-name="{{cxPropRelatedName}}" cx-prop-meta-more-records="{{cxPropMetaMoreRecords}}" cx-prop-dont-show-related-dropdown="{{cxPropDontShowRelatedDropdown}}" on-close="{{method(\'modalClosed\')}}" cx-prop-return-full-object-on-get="{{cxPropReturnFullObjectOnGet}}"> <template is="yield" yield-name="createYield"><lyte-yield yield-name="createYield"></lyte-yield></template> </crux-lookup-modal> </template></template></template></template> </div> <template is="if" value="{{isError}}"><template case="true"> <crux-error-message error-message="{{cxPropErrorMessage}}" cx-prop-error-yield="{{cxPropErrorYield}}" cx-prop-error-zcqa-prefix="{{cxPropErrorZcqaPrefix}}" cx-prop-field="{{cxPropField}}" cx-prop-error-zcqa-suffix="{{cxPropErrorZcqaSuffix}}" class="{{cxPropErrorClass}}" cx-prop-error-span-class="{{cxPropErrorSpanClass}}"> <template is="registerYield" yield-name="errorYield"><lyte-yield yield-name="errorYield" error-message="{{cxPropErrorMessage}}" cx-field="{{cxPropField}}"></lyte-yield></template> </crux-error-message> </template></template> </div> </template></template> </template>',_dynamicNodes:[{type:"attr",position:[1]},{type:"switch",position:[1],cases:{view:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"text",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"text",position:[0]}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,0]},{type:"if",position:[1,0],cases:{true:{dynamicNodes:[{type:"attr",position:[0]}]}},default:{}},{type:"attr",position:[1,1]},{type:"componentDynamic",position:[1,1]},{type:"componentDynamic",position:[1]},{type:"attr",position:[3]},{type:"if",position:[3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"insertYield",position:[1]}]},{type:"componentDynamic",position:[1]}]}},default:{}}]}},default:{}}]}},default:{}}]},create:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,1]},{type:"attr",position:[1,3]},{type:"if",position:[1,3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[3]},{type:"registerYield",position:[3,1],dynamicNodes:[{type:"text",position:[1,1]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[3]}]}},default:{}}]}},default:{}},{type:"attr",position:[3]},{type:"attr",position:[3,1]},{type:"attr",position:[3,1,1,1]},{type:"if",position:[3,1,1,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"attr",position:[1,1]},{type:"attr",position:[1,1,1]},{type:"if",position:[1,1,1],cases:{true:{dynamicNodes:[{type:"attr",position:[0]},{type:"for",position:[0],dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1,1]},{type:"componentDynamic",position:[1,1,1]},{type:"attr",position:[1,1,3]},{type:"if",position:[1,1,3],cases:{true:{dynamicNodes:[{type:"attr",position:[1],attr:{style:{name:"style",helperInfo:{name:"if",args:["val.cxPropShowIcon","'visibility: visible;'","'visibility: hidden'"]}}}}]}},default:{}},{type:"componentDynamic",position:[1,1]},{type:"componentDynamic",position:[1]}]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"text",position:[1,0]}]},false:{dynamicNodes:[{type:"text",position:[1,0]}]}},default:{}}]}},default:{}}]}},default:{}},{type:"componentDynamic",position:[1,1]},{type:"attr",position:[1,3]},{type:"if",position:[1,3],cases:{true:{dynamicNodes:[{type:"insertYield",position:[0,0]},{type:"componentDynamic",position:[0]}]}},default:{}},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]}},default:{}}]}},default:{}},{type:"attr",position:[3,1,1,3]},{type:"if",position:[3,1,1,3],cases:{true:{dynamicNodes:[{type:"attr",position:[0]}]}},default:{}},{type:"attr",position:[3,1,1,5]},{type:"if",position:[3,1,1,5],cases:{true:{dynamicNodes:[{type:"attr",position:[1,1]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1,1]}]}},default:{}}]}},default:{}},{type:"attr",position:[3,1,3]},{type:"attr",position:[3,1,3,1]},{type:"attr",position:[3,1,5]},{type:"if",position:[3,1,5],cases:{true:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"insertYield",position:[0]}]},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"insertYield",position:[0]}]},{type:"componentDynamic",position:[1]}]}},default:{}}]}},default:{}},{type:"attr",position:[3,3]},{type:"if",position:[3,3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"attr",position:[0]},{type:"insertYield",position:[0]}]},{type:"componentDynamic",position:[1]}]}},default:{}}]}},default:{}}],_observedAttributes:["lyteViewPort","cxPropDefaultCriteria","cxPropFieldOfLookupVal","cxPropParentModule","cxPropModule","cxPropValue","cxPropRouteName","cxPropZcqa","cxPropDynamicParams","cxPropQueryParams","cxPropTransitionData","cxPropIconClass","cxPropId","cxPropFrom","cxPropEmptyValue","lookupSingle","cxPropAutofocus","cxPropTabIndex","cxPropDisabled","cxPropPlaceholder","cxPropReadonly","cxPropToggle","cxPropField","cxPropFieldKey","cxPropLabelClass","cxPropAdvanceSearchEnabled","lookupCreateRecord","initComp","ften","records","apiName","cxPropClass","cxPropMaxlength","displayField","modulenameUicomp","columnName","renderLookup","moduleData","moduledataUicomp","queryParamObject","relatedFieldComp","relatedTo","record","modId","dispInit","renderedPage","selectedSingle","isSingle","uiTypeMapping","moduleName","show","repRecord","fldId","relations","module","value","cxPropTarget","cxPropCreateYield","cxPropRelatedTo","lyteUnbound","cxPropAutocomplete","cxPropFetchRecordsOnEnter","cxPropAppearance","isError","cxPropErrorMessage","cxPropShowHideTooltip","cxPropClearErrorMessage","cxPropTooltip","cxPropImagePath","cxPropMetaMoreRecords","cxPropIconTooltip","showEmptyValue","cxPropErrorYield","cxPropHeader","cxPropFields","visible","cxPropInfoTooltip","cxPropImgZcqa","lookupValue","cxPropShowBc","lookupId","cxPropFooterYield","cxPropRecordImageSrc","cxPropAria","cxPropAriaAttributes","cxPropPopoverWrapperClass","cxPropMaskingProperties","tooltip","cxPropRelatedId","cxPropRelatedModuleId","cxPropRelatedName","cxPropRelatedRecordData","cxPropShowCloseIcon","cxPropTooltipConfig","cxPropTooltipClass","cxPropHideIconForView","cxPropDontShowRelatedDropdown","cxPropErrorZcqaPrefix","cxPropErrorZcqaSuffix","searchPerformed","cxPropErrorClass","cxPropInputId","showLoading","cxPropErrorSpanClass","cxPropClearIconClass","cxPropPreventParentScroll","cxPropRightIconClass","cxPropWrapperClass","cxPropLayout","cxPropViewInfoTooltip","cxPropShowDisabledIcon","cxPropDisabledIconClass","cxPropReturnFullObjectOnGet","cxPropDefaultFields"],data:function(){return{lyteViewPort:Lyte.attr("boolean",{default:!1}),cxPropDefaultCriteria:Lyte.attr("array",{default:[]}),cxPropFieldOfLookupVal:Lyte.attr("array",{default:[]}),cxPropParentModule:Lyte.attr("string",{default:""}),cxPropModule:Lyte.attr("string"),cxPropValue:Lyte.attr("string"),cxPropRouteName:Lyte.attr("string"),cxPropZcqa:Lyte.attr("string"),cxPropDynamicParams:Lyte.attr("string"),cxPropQueryParams:Lyte.attr("string"),cxPropTransitionData:Lyte.attr("string"),cxPropIconClass:Lyte.attr("string"),cxPropId:Lyte.attr("string",{default:""}),cxPropFrom:Lyte.attr("string",{default:"view"}),cxPropEmptyValue:Lyte.attr("string",{default:""}),lookupSingle:Lyte.attr("string",{default:"",hideAttr:!0}),cxPropAutofocus:Lyte.attr("boolean"),cxPropTabIndex:Lyte.attr("string"),cxPropDisabled:Lyte.attr("boolean",{default:!1}),cxPropPlaceholder:Lyte.attr("string"),cxPropReadonly:Lyte.attr("boolean",{default:!1}),cxPropToggle:Lyte.attr("boolean",{default:!1}),cxPropField:Lyte.attr("object",{default:{},hideAttr:!0}),cxPropFieldKey:Lyte.attr("string",{default:""}),cxPropLabelClass:Lyte.attr("string",{default:""}),cxPropAdvanceSearchEnabled:Lyte.attr("boolean",{default:"undefined"!=typeof Crm&&Crm.userDetails.isLookupAdvancedSearchEnabled}),lookupCreateRecord:Lyte.attr("object",{default:{}}),initComp:Lyte.attr("boolean",{default:!1}),ften:Lyte.attr("array",[]),records:Lyte.attr("array",{default:[]}),apiName:Lyte.attr("string"),cxPropClass:Lyte.attr("string",{default:""}),cxPropMaxlength:Lyte.attr("number"),displayField:Lyte.attr("string",{default:"",hideAttr:!0}),modulenameUicomp:Lyte.attr("string"),columnName:Lyte.attr("string"),renderLookup:Lyte.attr("boolean",{default:!1}),moduleData:Lyte.attr("object"),moduledataUicomp:Lyte.attr("object"),queryParamObject:Lyte.attr("object",{default:{}}),relatedFieldComp:Lyte.attr("array",{default:[]}),relatedTo:Lyte.attr("object",{default:{}}),record:Lyte.attr("array",{default:[]}),modId:Lyte.attr("string",{default:""}),dispInit:Lyte.attr("boolean",{default:!1}),renderedPage:Lyte.attr("number",{default:1}),selectedSingle:Lyte.attr("object",{default:{}}),isSingle:Lyte.attr("boolean"),uiTypeMapping:Lyte.attr("object",{default:"undefined"!=typeof crmConstants&&crmConstants.defaultUiTypeToCruxMapping?crmConstants.defaultUiTypeToCruxMapping:{}}),moduleName:Lyte.attr("string",{default:""}),show:Lyte.attr("boolean",{default:!1}),repRecord:Lyte.attr("array",{default:[]}),fldId:Lyte.attr("string"),relations:Lyte.attr("array",{default:[]}),module:Lyte.attr("object",{default:{}}),value:Lyte.attr("object",{default:{}}),cxPropTarget:Lyte.attr("string",{default:"_self"}),cxPropCreateYield:Lyte.attr("boolean"),cxPropRelatedTo:Lyte.attr("object"),lyteUnbound:Lyte.attr("boolean",{default:!1}),cxPropAutocomplete:Lyte.attr("boolean",{default:!0}),cxPropFetchRecordsOnEnter:Lyte.attr("boolean",{default:!1}),cxPropAppearance:Lyte.attr("string",{default:"box"}),isError:Lyte.attr("boolean",{default:!1}),cxPropErrorMessage:Lyte.attr("string",{default:""}),cxPropShowHideTooltip:Lyte.attr("boolean",{default:!0}),cxPropClearErrorMessage:Lyte.attr("boolean",{default:!0}),cxPropTooltip:Lyte.attr("string",{default:""}),cxPropImagePath:Lyte.attr("string",{default:"/recruit/CRMClient/images"}),cxPropMetaMoreRecords:Lyte.attr("string",{default:"more_records"}),cxPropIconTooltip:Lyte.attr("string"),showEmptyValue:Lyte.attr("boolean",{default:!1}),cxPropErrorYield:Lyte.attr("boolean",{default:!1}),cxPropHeader:Lyte.attr("string"),cxPropFields:Lyte.attr("array"),visible:Lyte.attr("boolean",{default:!1}),cxPropInfoTooltip:Lyte.attr("string",{default:""}),cxPropImgZcqa:Lyte.attr("string"),lookupValue:Lyte.attr("string"),cxPropShowBc:Lyte.attr("boolean",{default:!1}),lookupId:Lyte.attr("string"),cxPropFooterYield:Lyte.attr("boolean",{default:!1}),cxPropRecordImageSrc:Lyte.attr("string"),cxPropAria:Lyte.attr("boolean",{default:!1}),cxPropAriaAttributes:Lyte.attr("object",{default:{}}),cxPropPopoverWrapperClass:Lyte.attr("string",{default:""}),cxPropMaskingProperties:Lyte.attr("object"),tooltip:Lyte.attr("string"),cxPropRelatedId:Lyte.attr("string"),cxPropRelatedModuleId:Lyte.attr("string"),cxPropRelatedName:Lyte.attr("string"),cxPropRelatedRecordData:Lyte.attr("array",{default:[]}),cxPropShowCloseIcon:Lyte.attr("boolean",{default:!1}),cxPropTooltipConfig:Lyte.attr("string",{default:'{"position": "bottom"}'}),cxPropTooltipClass:Lyte.attr("string",{default:"cxTooltip"}),cxPropHideIconForView:Lyte.attr("boolean",{default:!1}),cxPropDontShowRelatedDropdown:Lyte.attr("boolean",{default:!1}),cxPropErrorZcqaPrefix:Lyte.attr("string",{default:""}),cxPropErrorZcqaSuffix:Lyte.attr("string",{default:"Error"}),searchPerformed:Lyte.attr("boolean",{default:!1}),cxPropErrorClass:Lyte.attr("string"),cxPropInputId:Lyte.attr("string",{default:"inputId"}),showLoading:Lyte.attr("boolean",{default:!1}),cxPropErrorSpanClass:Lyte.attr("string"),cxPropClearIconClass:Lyte.attr("string"),cxPropPreventParentScroll:Lyte.attr("boolean",{default:!1}),cxPropRightIconClass:Lyte.attr("string"),cxPropWrapperClass:Lyte.attr("string"),cxPropLayout:Lyte.attr("string"),cxPropViewInfoTooltip:Lyte.attr("boolean",{default:!1}),cxPropShowDisabledIcon:Lyte.attr("boolean",{default:!1}),cxPropDisabledIconClass:Lyte.attr("string",{default:""}),cxPropReturnFullObjectOnGet:Lyte.attr("boolean",{default:!1}),cxPropDefaultFields:Lyte.attr("object",{default:{}})}},init:function(){this.lookupModalName=this.getData("cxPropAdvanceSearchEnabled")?"crux-lookup-filter-modal":"crux-lookup-modal",this._modalOpened=!1},lookupModalName:"",methods:{autoComp:function(e){this.selection=!0,this.data.cxPropClearErrorMessage&&this.setData("cxPropErrorMessage","");for(var t,o=this.getData("ften"),a=this.getData("displayField"),r=o.length,i=0;i<r;i++)if(o[i].id===e){if(this.setData("selectedSingle",o[i]),this.setData("ften",o[i]),t="Full_Name"===a?o[i].First_Name?o[i].First_Name+" "+o[i].Last_Name:o[i].Last_Name:o[i][a],this.setData("lookupSingle",t),this.setData("cxPropValue",{id:o[i].id,name:t}),this.data.cxPropClearErrorMessage&&this.setData("cxPropErrorMessage",""),this.getMethods("onValueChange")){if(this.data.cxPropReturnFullObjectOnGet){var s=o[i];s.name=s.name?s.name:t,this.executeMethod("onValueChange",s)}else this.executeMethod("onValueChange",this.data.cxPropValue);this.executeMethod("onValueChange",this.data.cxPropReturnFullObjectOnGet?o[i]:this.getData("cxPropValue"))}break}},beforeSearch:function(e,t,o){if(o.type){e=e.trim();this.setData("showLoading",!0),["Backspace","Meta"].indexOf(o.key)>-1&&this.search&&(this.search=!1);this.getData("record");if(""==e?(this.setData("selectedSingle",{}),this.setData("lookupSingle",""),this.setData("selectedSingleId",""),this.setData("cxPropValue",""),this.$node.querySelector("lyte-autocomplete").ltProp("selected",""),this.setData("cxPropShowCloseIcon",!1)):this.setData("cxPropShowCloseIcon",!0),this.search)this.setData("showLoading",!1);else{this.onSearchFun(e,void 0,t.getData("ltPropSelected"))}}},scrollRecord:function(){if(!this.noMoreScroll){var e=this.getData("ften"),t=this.getData("queryParamObject"),o=event.target&&"LYTE-DROP-BODY"===event.target.tagName?event.target:null;t.page=Math.ceil(e.length/10),t.per_page=10,this.scrollRequest(this,t,o,e,!1)}},beforeShow:function(e,t){return!this.data.cxPropReadonly&&(this.setData("visible",!0),this.setData("showLoading",!0),this.initFromField=!0,new Promise(function(o,a){this._initRes=o,this._initRej=a,this.lookupInit(this,this.getData("moduledataUicomp").lookup.module.id,!1,e,t)}.bind(this)))},autoFocus:function(e,t){var o=$L(t).find("lyte-dropdown")[0].component.getDropBox(),a=$L(this.$node).width();o.style.width=a+"px",this.$node.querySelector(".cxLookupComponent").classList.add("cxBoxDropdownOpened")},fetchModule:function(e){return this.executeMethod("fetchModuleData",e)},fetchRecordsData:function(e,t){var o=this;return this.executeMethod("fetchRecords",e,t).then(function(e){return e},function(e){return o.setData("renderLookup",!1),e})},createNew:function(){this.executeMethod("onCreateNew")},triggerOnValueChange:function(e){e.name=e.name?e.name:e.displayName,this.setData("cxPropValue",e),this._modalOpened=!1,$(this.$node.querySelector("input")).effect("highlight",{},1e3),this.getData("cxPropClearErrorMessage")&&this.setData("cxPropErrorMessage",""),this.getMethods("onValueChange")&&this.executeMethod("onValueChange",e)},onBlurInput:function(e,t){return this.$node.querySelector(".cxLookupComponent").classList.remove("cxBoxDropdownOpened"),setTimeout(function(){this.selection&&this.getData("cxPropClearErrorMessage")&&this.setData("cxPropErrorMessage",""),""==t.querySelector("input").value&&(this.setData("cxPropValue",void 0),this.setData({selectedSingle:{},lookupSingle:void 0}),this.getMethods("onValueChange")&&this.executeMethod("onValueChange",this.getData("cxPropValue"))),this.selection=!1}.bind(this),100),this.getMethods("onBlur")&&this.executeMethod("onBlur",event,this.$node),!0},afterRenderAutocomplete:function(){this.$node.querySelector("lyte-input")&&"box"==this.getData("cxPropAppearance")&&this.$node.querySelector("lyte-input").classList.add("cxBoxInput")},hideInfoTooltip:function(){this.showHideInfoTooltip()},onHideDropdown:function(){this.setData("visible",!1)},modalClosed:function(){this._modalOpened=!1}},actions:{infoPop:function(e,t,o){var a=document.getElementById("cruxLookupPopover");"mouseenter"==o.type?(this.entered=!0,a||(a=Lyte.Component.render("crux-lookup-popup",{id:"cruxLookupPopover",fieldMapping:this.getData("uiTypeMapping"),cxPropPopoverWrapperClass:this.data.cxPropPopoverWrapperClass},"body")),a.setData({show:!0,module:this.getData("module"),data:t})):(this.entered=!1,a.setData("show",!1))},clearlookupField:function(){this.clear()},showLookup:function(e){this._modalOpened=!0,this.getData("cxPropDisabled")||this.data.cxPropReadonly||(this.getMethods("onShowLookup")?this.executeMethod("onShowLookup",e):this.showLookupFunc(this),e&&e.stopPropagation())},showHideIcon1:function(e,t){this.entered||Lyte.objectUtils(t,"add","cxPropShowIcon",e)},showInfoTooltip:function(e){this.showHideInfoTooltip(e)},showLookupBC:function(e){var t=!0;if(this.getMethods("onBeforeShowBusinessCard")&&(t=this.executeMethod("onBeforeShowBusinessCard",this.data.lookupId,this.data.cxPropModule)),this.data.cxPropShowBc&&t){var o=document.querySelector("crux-lookup-view-popup");if(clearTimeout(this.popoverTimeout),e){if(this.$node.classList.add("cxLookupBc"),o?o.setData({field:this.data.cxPropField,entityId:this.data.lookupId,cxPropTypeMapping:this.data.uiTypeMapping,cxPropRecordImageSrc:this.data.cxPropRecordImageSrc,module:this.data.cxPropModule}):o=Lyte.Component.render("crux-lookup-view-popup",{field:this.data.cxPropField,entityId:this.data.lookupId,cxPropTypeMapping:this.data.uiTypeMapping,cxPropRecordImageSrc:this.data.cxPropRecordImageSrc,module:this.data.cxPropModule},".cxLookupBc"),this.getMethods("onLookupHoverFetchBcData")){var a=this;o.setMethods({onLookupHoverFetchBcDataPopup:function(e,t){return a.executeMethod("onLookupHoverFetchBcData",e,t)}})}o.setData("show",!0)}else o&&(this.popoverTimeout=setTimeout(function(){o.setData("show",!1),this.$node.classList.remove("cxLookupBc")}.bind(this),200))}},stopPropagation:function(){this.stopPropagation()}},ftenToRecord:function(){this.initial||(this.setData("ften",this.getData("record")),this.initial=!0),this.getData("cxPropMetaMoreRecords")&&this.getData("record").$&&(0==this.getData("record").$[this.getData("cxPropMetaMoreRecords")]||this.getData("record").$.meta&&0==this.getData("record").$.meta[this.getData("cxPropMetaMoreRecords")])?this.noMoreScroll=!0:this.noMoreScroll=!1}.observes("record"),ftenTorepRecord:function(){this.noMoreScroll=!1}.observes("repRecord"),saveAndAssocRec:function(){this.$node.classList.remove("currentLookupModal"),this.saveNewRecord(this)}.observes("save","newCreatedid"),observeSelectedId:function(){var e=this.getData("moduledataUicomp"),t=this,o=this.getData("selectedSingleId"),a=this.getData("module"),r=this.getData("newLookupcreated");if(e.selectedId=o,e.lookupSingle=this.getData("lookupSingle"),this.setData("moduledataUicomp",e),r){var i=e.lookup.module.id;i&&(a.id||e.module.id===i?(a.id||e.module.id===i)&&(t.setData({module:e.module[0],moduleName:e.module[0].module_name,displayField:e.module[0].display_field.api_name}),t.setSelectedId(i,o)):store.findRecord("module",i).then(function(e){t.setData({module:e[0],moduleName:e[0].module_name,displayField:e[0].display_field.api_name}),t.setSelectedId(i,o)}))}}.observes("selectedSingleId"),singleValueSet:function(){var e=this.getData("moduledataUicomp");this.getData("relatedFieldComp");e.selectedId=this.getData("selectedSingle").id,e.lookupSingle=this.getData("lookupSingle"),this.setData("moduledataUicomp",e)}.observes("selectedSingle"),beforeShowFunc:function(e,t,o,a){var r=this,i=t.$node._callee.ltProp("value");if(!i){var s={page:1,per_page:10};return this.executeMethod("fetchRecords",this.data.module.id,Object.assign({},s)).then(function(e){e=e&&e.length?e:[],r.setData({record:e,ften:e,queryParamObject:s}),r.setData("showLoading",!1),r._modalOpened||(r.setData("initComp",!0),r._initRes&&r._initRes(),a&&a())},function(){r.initFromField=!1,r.setData("showLoading",!1),r._initRej&&r._initRej()})}this.setData("initComp",!0),this.onSearchFun(i,a,t.data.ltPropSelected||this.data.value?this.data.value.id:"")},showLookupFunc:function(e,t){if(this.getMethods("onBeforeShowLookup")&&0==this.executeMethod("onBeforeShowLookup"))return!1;("undefined"!=typeof commonUtils&&commonUtils.showHideLoadingDiv&&commonUtils.showHideLoadingDiv(!0),t||this.getData("renderLookup"))?(e.setData("show",!1),(e=t?e:this.$node.querySelector(this.lookupModalName).component).data.isSingle&&(e.records=[],e.lookupInit(e,e.getData("modId"),!0))):("lookup"===e.getData("moduledataUicomp").data_type?e.setData("isSingle",!0):e.setData("isSingle",!1),e.setData("renderLookup",!0),e.setData("dispInit",!0))},onSearchFun:function(e,t,o){var a=this.getData("displayField"),r={},i=this;r.filters=this.constructSearchFilter(a,e),r.page=1,r.per_page=10,a?this.executeMethod("fetchRecords",this.getData("modId"),Object.assign({},r)).then(function(a){i.setData("searchPerformed",!0),a=a||[],i.setData({ften:a,queryParamObject:r}),i.getData("cxPropMetaMoreRecords")&&i.getData("record").$&&(0==i.getData("record").$[i.getData("cxPropMetaMoreRecords")]||i.getData("record").$.meta&&0==i.getData("record").$.meta[i.getData("cxPropMetaMoreRecords")])?i.noMoreScroll=!0:i.noMoreScroll=!1,t&&t(),i._initRes&&i._initRes(),i.setData("showLoading",!1),i._modalOpened||i.$node.querySelector("lyte-dropdown").open();var s=i.$node.querySelector("input").value;s!=e&&i.$node.querySelector("lyte-autocomplete").setValue(s),i.$node.querySelector("lyte-dropdown").component.childComp&&i.$node.querySelector("lyte-dropdown").component.childComp.querySelector("[data-value='"+o+"']")&&i.$node.querySelector("lyte-dropdown").component.childComp.querySelector("[data-value='"+o+"']").setAttribute("selected",!0)},function(){i.setData("showLoading",!1)}):this.lookupInit(this,this.getData("moduledataUicomp").lookup.module.id,!1,void 0,this)},scrollRequest:function(e,t,o,a,r){if(!e.scrl&&o.scrollTop+o.offsetHeight>=o.scrollHeight-10){if(t.page+=1,t.per_page=10,e.scrl=!0,r){var i=e.$node.querySelector("#modalElem").component.childComp.querySelector(".lookupFetchLoad");i&&(i.style.display="block")}var s=e.data.module.id;this.executeMethod("fetchRecords",s,Object.assign({},t)).then(function(o){if(o){a=a.concat(o),e.setData("record",a),r?Lyte.arrayUtils(e.data.displayArray,"push",o):Lyte.arrayUtils(e.data.ften,"push",o),e.setData("queryParamObject",t),o={};var s=e.data.value?e.data.value.id:"";e.$node.querySelector("lyte-dropdown").component.childComp&&e.$node.querySelector("lyte-dropdown").component.childComp.querySelector("[data-value='"+s+"']")&&e.$node.querySelector("lyte-dropdown").component.childComp.querySelector("[data-value='"+s+"']").setAttribute("selected",!0)}else e.noMoreScroll=!0;setTimeout(function(){e.scrl=!1},20),r&&i&&(i.style.display="none")})}},didDestroy:function(){var e=document.getElementById("cruxLookupPopover");e&&e.remove()},getValue:function(){var e=this.getData("cxPropValue"),t=this.getData("value");if(t&&t.id){var o=this.$node.querySelector("lyte-input #"+this.data.cxPropInputId);return o&&o.value&&o.value.trim()==t.name?this.data.cxPropReturnFullObjectOnGet?this.data.selectedSingle:e:void 0}return e},validate:function(){var e=this.validateMandatory(void 0==this.$node.querySelector("input")||0==this.$node.querySelector("input").length||""==this.$node.querySelector("input").value||""==this.$node.querySelector("input").value.trim());return e&&(e=this.validateMandatory(!this.getValue(),function(){this.getMethods("onError")?this.executeMethod("onError",this.errorCodes.ERR02,this):this.setData("cxPropErrorMessage",_cruxUtils.getI18n("crm.field.valid.check",Lyte.Component.registeredHelpers.cruxEncodeHTML(this.getData("cxPropField").field_label)))}.bind(this))),e||(this.setData("cxPropValue",this.getValue()),this.$node.querySelector("lyte-autocomplete")&&this.$node.querySelector("lyte-autocomplete").focus()),e},observeErrorMessage:function(){this.setData("isError",""!=this.getData("cxPropErrorMessage"))}.observes("cxPropErrorMessage").on("init"),observeValue:function(){if("view"==this.getData("cxPropFrom"))if(e=this.data.cxPropValue){try{if("object"!=typeof JSON.parse(e))throw"number";e=JSON.parse(e),this.setData({lookupValue:e.name,lookupId:e.id}),this.setData("showEmptyValue",!1)}catch(t){this.setData("lookupValue",e)}"string"!=typeof e&&"object"!=typeof e&&(e=e.toString(),this.setData("lookupValue",e))}else this.getData("cxPropEmptyValue")&&this.setData("showEmptyValue",!0);if("create"==this.getData("cxPropFrom")&&this.getData("cxPropValue"))try{var e;(e=JSON.parse(this.data.cxPropValue)).name&&(this.setData("value",e),this.setData("lookupSingle",e.name))}catch(e){this.data.cxPropValue.name&&(this.setData("value",this.data.cxPropValue),this.setData("lookupSingle",this.data.value.name))}}.observes("cxPropValue","cxPropFrom").on("init"),refresh:function(e){if("crux-lookup-filter-modal"!==this.lookupModalName){var t=this.$node.querySelector(this.lookupModalName);if(t){t=t.component;var o={page:1,per_page:10};this.executeMethod("fetchRecords",this.getData("module").id,Object.assign({},o)).then(function(a){a=a&&a.length?a:[],e&&e.cxPropValue&&(this.setData({cxPropValue:e.cxPropValue,value:JSON.parse(e.cxPropValue),lookupSingle:JSON.parse(e.cxPropValue).name}),t.setData({lookupSingle:JSON.parse(e.cxPropValue).name,selectedSingle:JSON.parse(e.cxPropValue).id})),t.setData({record:a,queryParamObject:o}),a.length<10?t.setNavigator(a.length):t.setNavigator(a.length,!0),t.rendHome()}.bind(this))}}else this.setData("renderLookup",!0)},observeMandatory:function(){this.observeMandatoryMixin(".cxLookupComponent")}.observes("cxPropField.required"),observesdidConnect:function(){if("create"==this.getData("cxPropFrom")&&this.$node.classList.add("dB"),this.observeMandatoryMixin(".cxLookupComponent"),this.getData("cxPropToggle")){var e=this.$node.querySelector("lyte-autocomplete");e&&e.toggle()}}.observes("lyteViewPort").on("didConnect"),close:function(){this.$node.querySelector(this.lookupModalName).component.close()},observeIsError:function(){if("create"==this.getData("cxPropFrom")&&this.$node.querySelector("lyte-input")){var e=$L(this.$node),t=(e.find("lyte-input"),e.find(".cxBoxWithRightIcon")),o=e.find("crux-error-message");this.getData("isError")?(t.addClass("cxErrorBoxWithRightIcon"),o.hasClass("cxErrorMsgMultiLines")&&t.addClass("cxErrorMsgMultiLinesBoxInside")):(t.removeClass("cxErrorBoxWithRightIcon"),t.removeClass("cxErrorMsgMultiLinesBoxInside"))}}.observes("isError").on("didConnect"),observeFrom:function(){if("create"==this.getData("cxPropFrom")){this.setData("modulenameUicomp",this.data.cxPropModule);var e=this.getData("cxPropField");this.setData({columnName:e.column_name,moduledataUicomp:e,apiName:e.api_name}),"lookup"==e.data_type&&(this.getData("cxPropModule")==e.lookup.module.api_name&&"undefined"!=typeof moduleRecordMapping&&this.setData("module",moduleRecordMapping[this.data.cxPropModule]),this.setData({modId:e.lookup.module.id,isSingle:!0})),this.$node.refresh=function(e){return this.component.refresh(e)},this.$node.close=function(){return this.component.close()},this.getData("cxPropDisabled")&&!this.data.cxPropTooltip&&this.setData("cxPropTooltip",_cruxUtils.getI18n("crm.lable.read.only")),this.$node.clear=function(){this.component.clear()},this.$node.showLookup=function(){this.component.showLookupFunc(this.component)}}}.observes("cxPropFrom").on("init"),observeName:function(){"create"!=this.data.cxPropFrom||this.data.cxPropTooltip||(this.$node.querySelector("input")&&this.$node.querySelector("input").scrollWidth>this.$node.querySelector("input").offsetWidth?this.setData("tooltip",this.data.lookupSingle):this.setData("tooltip",""))}.observes("lookupSingle").on("didConnect"),observeTooltip:function(){this.setData("tooltip",this.data.cxPropTooltip)}.observes("cxPropTooltip").on("init"),ele:".cxLookupComponent",clear:function(){if(this.getMethods("onClear")&&0==this.executeMethod("onClear"))return!1;this.setData("selectedSingle",{}),this.setData("lookupSingle",""),this.$node.querySelector("lyte-autocomplete").ltProp("value",""),this.setData("selectedSingleId",""),this.setData("cxPropValue",""),this.$node.querySelector("lyte-autocomplete").ltProp("selected","");var e=this.getData("lookupCreateRecord");this.setData("ften",this.getData("record")),e&&e.module&&(e.createNew=!1,this.setData("lookupCreateRecord",e)),this.$node.querySelector("lyte-autocomplete lyte-input").focus(),this.setData("cxPropShowCloseIcon",!1),this.data.value=void 0}},{mixins:["crux-lookup-mixin","crux-element-validation"]}),Lyte.Component.register("crux-number-component",{_template:'<template tag-name="crux-number-component"> <template is="switch" value="{{cxPropFrom}}"><template case="create"> <template is="if" value="{{expHandlers(expHandlers(cxPropFrom,\'===\',&quot;create&quot;),\'&amp;&amp;\',cxPropField[cxPropFieldKey])}}"><template case="true"> <div class="cxElementLabel {{cxPropLabelClass}}"> {{cxPropField[cxPropFieldKey]}} <template is="if" value="{{cxPropInfoTooltip}}"><template case="true"> <span class="dIB vam cxInfoIcon" onmouseenter="{{action(\'showInfoTooltip\',this)}}"></span> <lyte-hovercard lt-prop-placement="topLeft" lt-prop-keep-alive="true" lt-prop-popover-wrapper-class="cxElementsHovercard" lt-prop-origin-elem=".cxCurrentHovercard" on-hovercard-hide="{{method(\'hideInfoTooltip\')}}"> <template is="registerYield" yield-name="hoverCardYield"> <lyte-hovercard-content class="cxElementsHoverCardContent"> {{cxPropInfoTooltip}} </lyte-hovercard-content> </template> </lyte-hovercard> </template></template> </div> </template></template> <template is="if" value="{{cxPropShowCalculator}}"><template case="true"> <div class="cxElementValue {{if(cxPropDisabled,\'cxElementDisabled\',\'\')}} pR"> <div class="cxBoxWithRightIcon"> <div class="cxBoxLeftContent"> <lyte-input lt-prop-name="{{cxPropName}}" id="{{cxPropId}}" lt-prop-title="{{cxPropTooltip}}" lt-prop-tooltip-config="{{cxPropTooltipConfig}}" lt-prop-tooltip-style="margin: 10px; font-size : 11px;" lt-prop-type="text" onpaste="{{action(\'onPaste\')}}" class="{{if(ifEquals(cxPropAppearance,\'box\'),\'cxBoxInput\',\'cxFlatInput\')}}" lt-prop-class="cxBoxNumberCompInput {{cxPropInputClass}}" lt-prop-value="{{lbind(cxPropValue)}}" lt-prop-direction="{{cxPropDirection}}" lt-prop-placeholder="{{cxPropPlaceholder}}" lt-prop-disabled="{{cxPropDisabled}}" lt-prop-readonly="{{cxPropReadonly}}" lt-prop-maxlength="{{maxlength}}" on-value-change="{{method(\'onChange\')}}" lt-prop-appearance="{{cxPropAppearance}}" onkeydown="{{action(\'checkLength\',this,event)}}" data-zcqa="{{cxPropZcqa}}" lt-prop-autofocus="{{cxPropAutofocus}}" lt-prop-tab-index="{{cxPropTabIndex}}" lt-prop-label="{{if(cruxAnd(ifEquals(cxPropFrom,\'criteria\'),cxPropCurrencyCode,currencyTypeField),cxPropCurrencyCode,if(cruxAnd(ifEquals(cxPropFrom,\'create\'),currencySymbol),currencySymbol))}}" onfocus="{{action(\'onFocusInput\')}}" onfocusout="{{action(\'onFocusInput\',true)}}" lt-prop-auto-update="{{cxPropEnableLbind}}" lt-prop-aria="{{cxPropAria}}" lt-prop-aria-attributes="{{cxPropAriaAttributes}}" onkeypress="{{action(\'checkLengthOnUp\')}}" lt-prop-tooltip-class="{{cxPropTooltipClass}}" lt-prop-wrapper-class="{{cxPropWrapperClass}}"> </lyte-input> </div> <template is="if" value="{{cxPropShowDisabledIcon}}"><template case="true"><span class="cxElementsDisabledIcon {{cxPropDisabledIconClass}}"></span></template></template> <template is="if" value="{{expHandlers(cxPropDisabled,\'!\')}}"><template case="true"> <div class="cxBoxRightIcon cxFlexCenter {{cxPropRightIconClass}}" onclick="{{action(\'showCalculatorInfo\',event)}}"> <div class="cxCalculatorIcon cP {{if(onFocus,\'cxPropFocus\',\'\')}} {{cxPropIconClass}}"></div> </div> </template></template> </div> <template is="if" value="{{isError}}"><template case="true"> <crux-error-message error-message="{{cxPropErrorMessage}}" cx-prop-error-yield="{{cxPropErrorYield}}" cx-prop-error-zcqa-prefix="{{cxPropErrorZcqaPrefix}}" cx-prop-field="{{cxPropField}}" cx-prop-error-zcqa-suffix="{{cxPropErrorZcqaSuffix}}" class="{{cxPropErrorClass}}" cx-prop-error-span-class="{{cxPropErrorSpanClass}}"> <template is="registerYield" yield-name="errorYield"><lyte-yield yield-name="errorYield" error-message="{{cxPropErrorMessage}}" cx-field="{{cxPropField}}"></lyte-yield></template> </crux-error-message> </template></template> </div> <template is="if" value="{{showResult.show}}"><template case="true"> <lyte-popover id="cxCalcultorResultPopover" lt-prop-origin-elem=".cxCalcultorResult" lt-prop-height="auto" lt-prop-duration="400" lt-prop-content-padding="" lt-prop-show="{{lbind(showResult.show)}}" lt-prop-type="box" lt-prop-freeze="false" lt-prop-show-close-button="false" lt-prop-close-on-escape="false" lt-prop-placement="bottomLeft" lt-prop-wrapper-class="cxNumberCalcPopup"> <template is="registerYield" yield-name="popover"> <lyte-popover-content class="cxNumResPopContent" data-zcqa="newCalcVal_Crm_{{cxPropModule}}_{{cxPropField.column_name}}"> = {{showResult.value}} </lyte-popover-content> </template> </lyte-popover> </template></template> <lyte-popover lt-prop-origin-elem=".cxCalculatorIcon.cxPropFocus" lt-prop-freeze="false" lt-prop-show-close-button="false" lt-prop-placement="bottomRight" lt-prop-content-padding="" lt-prop-wrapper-class="cxNumberCalcPopup cxNumInfoPop" lt-prop-scrollable="true" id="popovercalculator" on-close="{{method(\'popoverClosed\')}}"> <template is="registerYield" yield-name="popover"> <lyte-popover-content class="cxNumInfoPopContent {{if(showResult.infoDetails,\'\',\'cxNumDefaultInfo\')}}" onclick="{{action(\'hidePopover\')}}"> <template is="if" value="{{showResult.infoDetails}}"><template case="true"> <div class="cxNumInfoExpr cP">{{showResult.infoDetails}}</div> </template><template case="false"> {{unescape(cruxGetI18n(\'crm.createfield.calcinfo.new\'))}} </template></template> </lyte-popover-content> </template> </lyte-popover> </template><template case="false"> <div class="cxElementValue {{if(cxPropDisabled,\'cxElementDisabled\',\'\')}} pR"> <lyte-input lt-prop-name="{{cxPropName}}" id="{{cxPropId}}" lt-prop-title="{{cxPropTooltip}}" lt-prop-tooltip-config="{{cxPropTooltipConfig}}" lt-prop-tooltip-style="margin: 10px;" lt-prop-type="text" onpaste="{{method(\'onPaste\')}}" class="{{if(ifEquals(cxPropAppearance,\'box\'),\'cxBoxInput\',\'cxFlatInput\')}} w100per" lt-prop-class="f15 {{cxPropInputClass}}" lt-prop-value="{{lbind(cxPropValue)}}" lt-prop-direction="{{cxPropDirection}}" lt-prop-placeholder="{{cxPropPlaceholder}}" lt-prop-disabled="{{cxPropDisabled}}" lt-prop-readonly="{{cxPropReadonly}}" lt-prop-maxlength="{{maxlength}}" on-value-change="{{method(\'onChange\')}}" lt-prop-appearance="{{cxPropAppearance}}" onkeydown="{{action(\'checkLength\',this,event)}}" data-zcqa="{{cxPropZcqa}}" lt-prop-autofocus="{{cxPropAutofocus}}" lt-prop-tab-index="{{cxPropTabIndex}}" lt-prop-label="{{if(cruxAnd(ifEquals(cxPropFrom,\'criteria\'),cxPropCurrencyCode,currencyTypeField),cxPropCurrencyCode,if(cruxAnd(ifEquals(cxPropFrom,\'create\'),currencySymbol),currencySymbol))}}" lt-prop-auto-update="{{cxPropEnableLbind}}" lt-prop-aria="{{cxPropAria}}" lt-prop-aria-attributes="{{cxPropAriaAttributes}}" onkeypress="{{action(\'checkLengthOnUp\')}}" lt-prop-tooltip-class="{{cxPropTooltipClass}}" lt-prop-wrapper-class="{{cxPropWrapperClass}}"></lyte-input> <template is="if" value="{{cxPropShowDisabledIcon}}"><template case="true"><span class="cxElementsDisabledIcon {{cxPropDisabledIconClass}}"></span></template></template> <template is="if" value="{{isError}}"><template case="true"> <crux-error-message error-message="{{cxPropErrorMessage}}" cx-prop-error-yield="{{cxPropErrorYield}}" cx-prop-error-zcqa-prefix="{{cxPropErrorZcqaPrefix}}" cx-prop-field="{{cxPropField}}" cx-prop-error-zcqa-suffix="{{cxPropErrorZcqaSuffix}}" class="{{cxPropErrorClass}}" cx-prop-error-span-class="{{cxPropErrorSpanClass}}"> <template is="registerYield" yield-name="errorYield"><lyte-yield yield-name="errorYield" error-message="{{cxPropErrorMessage}}" cx-field="{{cxPropField}}"></lyte-yield></template> </crux-error-message> </template></template> </div> </template></template> </template><template case="filter"></template><template case="criteria"> <lyte-number lt-prop-increment="{{if(cxPropStep,true,false)}}" lt-prop-step="{{cxPropStep}}" lt-prop-name="{{cxPropName}}" lt-prop-wheel="false" id="{{cxPropId}}" lt-prop-validate-on-empty="false" on-before-paste="{{method(\'onPaste\')}}" lt-prop-value="{{cxPropValue}}" lt-prop-appearance="{{if(ifEquals(cxPropAppearance,\'box\'),\'box\',\'flat\')}}" class="{{if(ifEquals(cxPropAppearance,\'box\'),\'lyteInputBox cxBoxInput\',\'lyteInput cxFlatInput\')}} {{if(ifEquals(cxPropFrom,\'criteria\'),\'w100per\')}}" data-zcqa="{{cxPropZcqa}}" lt-prop-direction="{{if(ifEquals(cxPropFrom,\'criteria\'),\'horizontal\')}}" lt-prop-placeholder="{{cxPropPlaceholder}}" on-value-change="{{method(\'onChange\')}}" lt-prop-maxlength="{{cxPropMaxlength}}" onkeydown="{{action(\'checkLength\',this,event)}}" lt-prop-max="{{cxPropMaxvalue}}" lt-prop-min="{{cxPropMinvalue}}" on-before-max-min-validation="{{method(\'onBeforeMaxMinValidation\')}}" lt-prop-label="{{if(cruxAnd(ifEquals(cxPropFrom,\'criteria\'),cxPropCurrencyCode,currencyTypeField),cxPropCurrencyCode)}}" lt-prop-disabled="{{cxPropDisabled}}"></lyte-number> </template><template case="view"> <div id="{{cxPropId}}" data-zcqa="{{cxPropZcqa}}" class="{{if(currencyTypeField,\'numberDivCurrencyView\',\'numberDivNumberView\')}}"> <template is="if" value="{{cxPropTooltip}}"><template case="true"> <lyte-text lt-prop-tooltip-class="{{if(cxPropTooltipProps.class,cxPropTooltipProps.class,\'\')}}" lt-prop-tooltip-config="{{if(cxPropTooltipProps.config,cxPropTooltipProps.config)}}" lt-prop-value="{{value}}"></lyte-text> </template><template case="false"> {{value}} </template></template> <template is="if" value="{{cxPropViewInfoTooltip}}"><template case="true"> <crux-view-info-tooltip cx-prop-field="{{cxPropField}}" cx-prop-value="{{cxPropValue}}"> <template is="yield" yield-name="viewInfoTooltipYield"> <lyte-yield yield-name="viewInfoTooltipYield" prop-field="{{propField}}" prop-value="{{propValue}}"></lyte-yield> </template> </crux-view-info-tooltip> </template></template> </div> </template></template> </template>',_dynamicNodes:[{type:"attr",position:[1]},{type:"switch",position:[1],cases:{create:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,1]},{type:"attr",position:[1,3]},{type:"if",position:[1,3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[3]},{type:"registerYield",position:[3,1],dynamicNodes:[{type:"text",position:[1,1]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[3]}]}},default:{}}]}},default:{}},{type:"attr",position:[3]},{type:"if",position:[3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1,1,1]},{type:"componentDynamic",position:[1,1,1,1]},{type:"attr",position:[1,1,3]},{type:"if",position:[1,1,3],cases:{true:{dynamicNodes:[{type:"attr",position:[0]}]}},default:{}},{type:"attr",position:[1,1,5]},{type:"if",position:[1,1,5],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]}]}},default:{}},{type:"attr",position:[1,3]},{type:"if",position:[1,3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"attr",position:[0]},{type:"insertYield",position:[0]}]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"attr",position:[3]},{type:"if",position:[3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,1]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"attr",position:[5]},{type:"registerYield",position:[5,1],dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"if",position:[1,1],cases:{true:{dynamicNodes:[{type:"text",position:[1,0]}]},false:{dynamicNodes:[{type:"text",position:[1]}]}},default:{}},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[5]}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"componentDynamic",position:[1,1]},{type:"attr",position:[1,3]},{type:"if",position:[1,3],cases:{true:{dynamicNodes:[{type:"attr",position:[0]}]}},default:{}},{type:"attr",position:[1,5]},{type:"if",position:[1,5],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"attr",position:[0]},{type:"insertYield",position:[0]}]},{type:"componentDynamic",position:[1]}]}},default:{}}]}},default:{}}]},filter:{dynamicNodes:[],additional:{next:"criteria"}},criteria:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]},view:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"if",position:[1,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"text",position:[1]}]}},default:{}},{type:"attr",position:[1,3]},{type:"if",position:[1,3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"insertYield",position:[1]}]},{type:"componentDynamic",position:[1]}]}},default:{}}]}},default:{}}],_observedAttributes:["lyteViewPort","cxPropFrom","cxPropId","cxPropName","cxPropValue","cxPropEmptyValue","value","cxPropPlaceholder","cxPropDisabled","cxPropReadonly","cxPropMaxlength","cxPropMaxvalue","cxPropMinvalue","cxPropIsoCode","cxPropZcqa","cxPropClass","isError","cxPropIgnoreEmptyValue","cxPropCurrencyCode","currencySymbol","cxPropCurrencyDetails","cxPropDefaultRoundOff","cxPropDefaultOrgCurrency","cxPropAppearance","cxPropErrorMessage","viewClass","cxPropDecimalAllowed","currencyTypeField","cxPropField","cxPropFieldKey","cxPropClearErrorMessage","cxPropDirection","cxPropLabelClass","cxPropAllowNegativeValue","lyteUnbound","cxPropTabIndex","cxPropTooltip","allowNegative","cxPropExchangeRate","cxPropErrorYield","cxPropExchangeRateFinance","cxPropHomeCurrency","cxPropDisplayCurrency","cxPropFormattedCurrency","cxPropShowCalculator","showResult","cxPropInfoTooltip","result","onFocus","cxPropTooltip","cxPropTooltipProps","cxPropStep","cxPropEnableLbind","cxPropAria","cxPropAriaAttributes","maxlength","cxPropTooltipConfig","cxPropTooltipClass","cxPropErrorZcqaPrefix","cxPropErrorZcqaSuffix","cxPropErrorClass","cxPropWrapperClass","cxPropInputClass","cxPropErrorSpanClass","cxPropIconClass","cxPropRightIconClass","cxPropLayout","cxPropViewInfoTooltip","cxPropShowDisabledIcon","cxPropDisabledIconClass"],data:function(){return{lyteViewPort:Lyte.attr("boolean",{default:!1}),cxPropFrom:Lyte.attr("string",{default:"view"}),cxPropId:Lyte.attr("string",{default:""}),cxPropName:Lyte.attr("string",{default:""}),cxPropValue:Lyte.attr("string"),cxPropEmptyValue:Lyte.attr("string",{default:""}),value:Lyte.attr("string"),cxPropPlaceholder:Lyte.attr("string"),cxPropDisabled:Lyte.attr("boolean",{default:!1}),cxPropReadonly:Lyte.attr("boolean",{default:!1}),cxPropMaxlength:Lyte.attr("number"),cxPropMaxvalue:Lyte.attr("number",{default:9e18}),cxPropMinvalue:Lyte.attr("number"),cxPropIsoCode:Lyte.attr("string"),cxPropZcqa:Lyte.attr("string"),cxPropClass:Lyte.attr("string",{default:""}),isError:Lyte.attr("boolean",{default:!1}),cxPropIgnoreEmptyValue:Lyte.attr("boolean",{default:!1}),cxPropCurrencyCode:Lyte.attr("string",{default:""}),currencySymbol:Lyte.attr("string"),cxPropCurrencyDetails:Lyte.attr("object",{default:"undefined"!=typeof Crm?Crm.userDetails.CURRENCY_DETAILS:{}}),cxPropDefaultRoundOff:Lyte.attr("number",{default:"undefined"!=typeof Crm&&Crm.userDetails.defaultRoundOff?Crm.userDetails.defaultRoundOff:2}),cxPropDefaultOrgCurrency:Lyte.attr("string",{default:"undefined"!=typeof Crm?Crm.userDetails.defaultOrgCurrency:""}),cxPropAppearance:Lyte.attr("string",{default:"flat"}),cxPropErrorMessage:Lyte.attr("string",{default:""}),viewClass:Lyte.attr("string",{default:"numberDivNumberView"}),cxPropDecimalAllowed:Lyte.attr("boolean",{default:!0}),currencyTypeField:Lyte.attr("boolean",{default:!1}),cxPropField:Lyte.attr("object",{default:{}}),cxPropFieldKey:Lyte.attr("string",{default:""}),cxPropClearErrorMessage:Lyte.attr("boolean",{default:!0}),cxPropDirection:Lyte.attr("string",{default:"horizontal"}),cxPropLabelClass:Lyte.attr("string",{default:""}),cxPropAllowNegativeValue:Lyte.attr("boolean",{default:!0}),lyteUnbound:Lyte.attr("boolean",{default:!1}),cxPropTabIndex:Lyte.attr("string"),cxPropTooltip:Lyte.attr("string",{default:""}),allowNegative:Lyte.attr("boolean",{default:!0}),cxPropExchangeRate:Lyte.attr("number"),cxPropErrorYield:Lyte.attr("boolean",{default:!1}),cxPropExchangeRateFinance:Lyte.attr("number"),cxPropHomeCurrency:Lyte.attr("string"),cxPropDisplayCurrency:Lyte.attr("boolean",{default:!0}),cxPropFormattedCurrency:Lyte.attr("string"),cxPropShowCalculator:Lyte.attr("boolean",{default:!1}),showResult:Lyte.attr("object",{default:{show:!1}}),cxPropInfoTooltip:Lyte.attr("string",{default:""}),result:Lyte.attr("string"),onFocus:Lyte.attr("boolean",{default:!1}),cxPropTooltip:Lyte.attr("boolean",{default:!1}),cxPropTooltipProps:Lyte.attr("object"),cxPropStep:Lyte.attr("number"),cxPropEnableLbind:Lyte.attr("boolean",{default:!0}),cxPropAria:Lyte.attr("boolean",{default:!1}),cxPropAriaAttributes:Lyte.attr("object",{default:{}}),maxlength:Lyte.attr("number"),cxPropTooltipConfig:Lyte.attr("string",{default:'{"position": "followcursor", "appearance": "box"}'}),cxPropTooltipClass:Lyte.attr("string"),cxPropErrorZcqaPrefix:Lyte.attr("string",{default:""}),cxPropErrorZcqaSuffix:Lyte.attr("string",{default:"Error"}),cxPropErrorClass:Lyte.attr("string"),cxPropWrapperClass:Lyte.attr("string"),cxPropInputClass:Lyte.attr("string",{default:""}),cxPropErrorSpanClass:Lyte.attr("string"),cxPropIconClass:Lyte.attr("string"),cxPropRightIconClass:Lyte.attr("string"),cxPropLayout:Lyte.attr("string"),cxPropViewInfoTooltip:Lyte.attr("boolean",{default:!1}),cxPropShowDisabledIcon:Lyte.attr("boolean",{default:!1}),cxPropDisabledIconClass:Lyte.attr("string",{default:""})}},getValue:function(){if(this.$node.querySelector("#cruxLoadingElem"))return this.data.cxPropValue;if(this.$node.querySelector("input")){var e=this.$node.querySelector("input").value.trim();return e&&"."==e[0]&&(e="0"+e),e}return""},validate:function(){var e=this.getValue(),t=this.getData("cxPropField");if(this.setData("cxPropErrorMessage",""),"create"==this.getData("cxPropFrom")){var o=this.validateNumberField(e,t,this.data.maxlength,this.data.cxPropMaxvalue,this.data.cxPropMinvalue);return 0==o&&this.$node.querySelector("lyte-input")&&this.$node.querySelector("lyte-input").focus(),o}if(!(e&&!isNaN(parseInt(e))||this.data.cxPropIgnoreEmptyValue))return this.showAlert(_cruxUtils.getI18n("crm.field.valid.check",Lyte.Component.registeredHelpers.cruxEncodeHTML(t.field_label))),this.$node.querySelector("input").focus(),!1;if(!this.getData("cxPropAllowNegativeValue")&&(-1!=e.indexOf("-")||-1!=e.indexOf("+"))||!this.data.cxPropDecimalAllowed&&-1!=e.indexOf("."))return this.showAlert(_cruxUtils.getI18n("crm.mb.field.common.splc")),this.$node.querySelector("input").focus(),!1;if("autonumber"==t.data_type||"bigint"==t.data_type){if(e.indexOf(".")>-1)return this.showAlert(_cruxUtils.getI18n("crm.field.valid.check",Lyte.Component.registeredHelpers.cruxEncodeHTML(t.field_label))),this.$node.querySelector("input").focus(),!1}else{var a;if("integer"!=t.data_type)return(a=this.isValidDecimal(e))?(a=this.decimalLengthCheck(e))||(this.showAlert(_cruxUtils.getI18n("crm.field.valid.decimal.check2",Lyte.Component.registeredHelpers.cruxEncodeHTML(t.field_label),t.decimal_place)),this.$node.querySelector("input").focus()):this.showAlert(_cruxUtils.getI18n("crm.field.valid.check",Lyte.Component.registeredHelpers.cruxEncodeHTML(t.field_label))),a;if("criteria"==this.data.cxPropFrom)return(a=this.isValidDecimal(e))&&(a=this.decimalLengthCheck(e,{decimal_place:this.data.cxPropField.decimal_place?this.data.cxPropField.decimal_place:2})),a||this.showAlert(_cruxUtils.getI18n("crm.field.valid.check",Lyte.Component.registeredHelpers.cruxEncodeHTML(t.field_label))),a}return!0},init:function(){if(this.getData("cxPropMaxlength")||this.setData("cxPropMaxlength",19),""==this.data.cxPropCurrencyCode){var e="undefined"!=typeof Crm?Crm.userDetails.BASE_CURRENCY:"";"create"==this.data.cxPropFrom&&"undefined"!=typeof Crm&&void 0!==Crm.userDetails.PREFERRED_CURRENCY&&(e=Crm.userDetails.PREFERRED_CURRENCY),this.setData("cxPropCurrencyCode",e)}-1!==["filter","criteria","create"].indexOf(this.getData("cxPropFrom"))&&(("formula"==this.getData("cxPropField").data_type?-1!==["double","currency","bigint","integer"].indexOf(this.getData("cxPropField").formula.return_type):-1!==["double","currency","bigint","integer"].indexOf(this.getData("cxPropField").data_type))||this.data.cxPropField.history_tracking||this.data.cxPropField.allowNegativeValue||this.setData("cxPropAllowNegativeValue",!1),this.getData("cxPropDisabled")&&!this.data.cxPropTooltip&&this.setData("cxPropTooltip",_cruxUtils.getI18n("crm.lable.read.only"))),"create"==this.data.cxPropFrom&&this.setFocusUtil()},methods:{onChange:function(e,t){this.getData("cxPropClearErrorMessage")&&this.setData("cxPropErrorMessage",""),"criteria"!=this.data.cxPropFrom&&"filter"!=this.data.cxPropFrom||e.newValue&&19==e.newValue.length&&parseInt(e.newValue)>=this.data.cxPropMaxvalue&&(this.showMsgBox(_cruxUtils.getI18n("sentiment.criteria.wrongcriteria","9000000000000000000"),"error"),this.$node.querySelector("lyte-number").ltProp("value","9000000000000000000")),this.getMethods("onValueChange")&&this.executeMethod("onValueChange",this.getValue(),this.$node)},onBeforeMaxMinValidation:function(e,t,o){return"max"==e&&this.showMsgBox(_cruxUtils.getI18n("sentiment.criteria.wrongcriteria",this.data.cxPropMaxvalue),"error"),o&&19==o.length&&parseInt(o)>=this.data.cxPropMaxvalue?"9000000000000000000":o},onPaste:function(e,t,o){return"criteria"!=this.getData("cxPropFrom")&&(0==this.data.cxPropAllowNegativeValue?o.replace("-",""):void 0)},popoverClosed:function(){this.setData("onFocus",!1)},hideInfoTooltip:function(){this.showHideInfoTooltip()}},actions:{checkLength:function(e,t){if(-1==[38,40,69,187].indexOf(t.keyCode)||this.getData("cxPropShowCalculator")||t.preventDefault(),this.getData("cxPropDecimalAllowed")||-1==[187,190,110].indexOf(t.keyCode)||t.preventDefault(),e&&e.querySelector("input")&&e.querySelector("input").value.indexOf(".")>-1&&-1!=[190,110].indexOf(t.keyCode))for(var o=e.querySelector("input").value.split(/[+\-*/,]+/),a=e.querySelector("input").selectionStart-1,r=0,i=0;r<o.length;r++)if(!((i+=o[r].length)<a)){o[r].indexOf(".")>-1&&t.preventDefault();break}(!this.getData("cxPropAllowNegativeValue")||this.data.cxPropMinvalue>=0)&&(173!=t.keyCode&&189!=t.keyCode||t.preventDefault())},showCalculatorInfo:function(){if(this.data.cxPropReadonly)return!1;var e=void 0;this.getData("showResult").formula&&(e=this.getData("showResult").formula.trim()+" = "+this.getData("showResult").value),Lyte.objectUtils(this.getData("showResult"),"add","infoDetails",e),this.setData("onFocus",!0),this.$node.querySelector("#popovercalculator").setData("ltPropShow",!0)},hidePopover:function(){this.getData("showResult").formula&&(this.$node.querySelector("input").value=this.getData("showResult").formula,this.$node.querySelector("input").focus()),this.setData("onFocus",!1),this.$node.querySelector("#popovercalculator").setData("ltPropShow",!1),Lyte.objectUtils(this.getData("showResult"),"add","show",!0)},onPaste:function(){return this.actions.checkLengthOnUp.call(this,event.clipboardData.getData("Text")),!1},onFocusInput:function(e){e?this.$node.querySelector(".cxBoxWithRightIcon").classList.remove("cxBoxInputFocused"):this.$node.querySelector(".cxBoxWithRightIcon").classList.add("cxBoxInputFocused")},showInfoTooltip:function(e){this.showHideInfoTooltip(e)},checkLengthOnUp:function(e){if(this.data.cxPropDecimalAllowed&&this.data.cxPropMaxlength&&"integer"!=this.data.cxPropField.data_type){var t=e||this.$node.querySelector("input").value;t.indexOf(".")>-1||event&&46==event.keyCode&&-1==t.indexOf(".")&&event.srcElement.selectionStart!=this.data.maxlength?this.setData("maxlength",this.data.cxPropMaxlength+1):this.setData("maxlength",this.data.cxPropMaxlength)}}},observeErrorMessage:function(){this.setData("isError",""!=this.getData("cxPropErrorMessage"))}.observes("cxPropErrorMessage").on("init"),observeCurrencyCode:function(){var e=this.getData("cxPropField");if(this.data.cxPropDisplayCurrency)if("currency"==e.data_type||39==e.ui_type||36==e.ui_type||77==e.ui_type||"formula"==e.data_type&&"currency"==e.formula.return_type||e.rollup_summary&&"currency"==e.rollup_summary.return_type)if(this.setData("currencyTypeField",!0),this.getData("cxPropCurrencyCode")){var t=this.getData("cxPropCurrencyDetails");for(var o in t)if(o==this.getData("cxPropCurrencyCode")){this.setData("currencySymbol",t[o].symbol);break}}else"undefined"!=typeof Crm&&Crm.userDetails&&Crm.userDetails.DEFAULT_ORG_CURRENCY?this.setData("currencySymbol",Crm.userDetails.DEFAULT_ORG_CURRENCY.symbol):"undefined"!=typeof Crm&&Crm.userDetails&&Crm.userDetails.defaultOrgCurrency&&this.setData("currencySymbol",Crm.userDetails.defaultOrgCurrency);else this.setData({currencyTypeField:!1,currencySymbol:""})}.observes("cxPropCurrencyCode","cxPropField","cxPropField.data_type").on("init"),observeValue:function(){if("view"==this.getData("cxPropFrom"))if(!this.getData("cxPropValue")&&this.getData("cxPropEmptyValue"))this.setData("value",this.getData("cxPropEmptyValue"));else{var e=this.getData("cxPropValue");if(e&&"null"!=e&&"undefined"!=e){var t=this.getData("cxPropField"),o=t.data_type;("formula"==o||t.formula&&t.formula.return_type||t.dataparam&&t.dataparam.return_type||t.rollup_summary&&t.rollup_summary.return_type)&&(o=t.formula&&"currency"==t.formula.return_type||t.dataparam&&"currency"==t.dataparam.return_type||t.rollup_summary&&"currency"==t.rollup_summary.return_type?"currency":"number"),this.setData("value",this.getNumberValueForView(e,o,this.getData("cxPropIsoCode"),t.ui_type,void 0,void 0,void 0,this.getData("cxPropExchangeRate"),this.getData("cxPropExchangeRateFinance"),this.getData("cxPropHomeCurrency"),this.getData("cxPropDisplayCurrency"),this.getData("cxPropFormattedCurrency"),t.separator))}else this.setData("value","")}else this.operationPerformed||(this.data.showResult.value=this.data.cxPropValue)}.observes("cxPropValue","cxPropFormattedCurrency","cxPropFrom").on("init"),observeIsError:function(){if("create"==this.getData("cxPropFrom")&&this.$node.querySelector("lyte-input")){var e=$L(this.$node);if(this.getData("cxPropShowCalculator")){var t=e.find(".cxBoxWithRightIcon");this.getData("isError")?t.addClass("cxErrorBoxWithRightIcon"):t.removeClass("cxErrorBoxWithRightIcon")}else{var o=e.find("lyte-input");this.getData("isError")?o.addClass("cxErrorBox"):o.removeClass("cxErrorBox")}}}.observes("isError","lyteViewPort").on("didConnect"),observeMandatory:function(){this.observeMandatoryMixin("lyte-input")}.observes("cxPropField.required","lyteViewPort").on("didConnect"),observeCurrencyTypeField:function(){if(this.getData("currencyTypeField")&&"box"===this.getData("cxPropAppearance")&&("create"===this.getData("cxPropFrom")||"criteria"===this.getData("cxPropFrom"))&&(this.data.cxPropCurrencyCode||!this.data.cxPropCurrencyCode&&"create"==this.data.cxPropFrom)){var e=$L(this.$node),t=e.find("lyte-input");if(t.length>0)t.addClass("cxBoxInputInsideLabel");else{var o=e.find("lyte-number");o.length>0&&o.addClass("cxBoxInputInsideLabel")}}}.observes("currencyTypeField","lyteViewPort","cxPropFrom").on("didConnect"),obseredidConnect:function(){if("create"==this.getData("cxPropFrom")&&this.getData("cxPropShowCalculator")){var e=this;e.bindEvent=e.calculate.bind(e),["keyup","keypress","blur"].forEach(function(t){e.$node.querySelector("input")&&e.$node.querySelector("input").addEventListener(t,e.bindEvent)})}}.observes("lyteViewPort").on("didConnect"),calculate:function(e){var t=this.$node.querySelector("input");if(this.operationPerformed=!0,"keypress"==e.type){var o=e.which?e.which:e.keyCode;if(!([43,45,42,47,13,40,41,46,8,9].indexOf(o)>-1||o>=48&&o<=57))return e.preventDefault(),!1;if(13==o)return Lyte.objectUtils(this.getData("showResult"),"add","show",!1),this.$node.querySelector("lyte-input").classList.remove("cxCalcultorResult"),t.blur(),e.preventDefault(),!1}else if("keyup"==e.type){var a=t.value;if(-1==a.indexOf(",")&&""!=a&&!a.match(/[a-z]/i)){/^(\+|\*|\/)/.test(a)&&(a=a.substr(1));var r="";if(/^((?!([+\-*/.]{2,})).)*$/.test(a))if(1==Lyte.registeredMixins["crux-element-validation"].checkBrackets(a))if(-1==a.indexOf("()"))if(Lyte.registeredMixins["crux-element-validation"].checkCorrectInputEle(a))if(Lyte.registeredMixins["crux-element-validation"].checkDotCorrectInput(a)){var i=a.length-1,s=this.data.cxPropField&&this.data.cxPropField.decimal_place?this.data.cxPropField.decimal_place:2;-1==["+","-","*","/","."].indexOf(a[i])?(a=Lyte.registeredMixins["crux-element-validation"].clearLeadingZero(a),void 0!=(r=new Function("return "+a)())&&r%1!=0&&(r=Number(Math.round(r+"e"+s)+"e-"+s))):"."!=(a=a.slice(0,-1))&&(a=Lyte.registeredMixins["crux-element-validation"].clearLeadingZero(a),void 0!=(r=new Function("return "+a)())&&r%1!=0&&(r=Number(Math.round(r+"e"+s)+"e-"+s)))}}if(void 0!=r&&""!==r){1==/[+\-*/(]/.test(a)&&"+"!=a&&""!=a?(this.setData("showResult",{show:!0,value:r,formula:a}),this.$node.querySelector("lyte-input").classList.add("cxCalcultorResult")):this.setData("showResult",{show:!1,formula:a,value:r})}else Lyte.objectUtils(this.getData("showResult"),"add","show",!1),Lyte.objectUtils(this.getData("showResult"),"add","formula",void 0),""==a&&Lyte.objectUtils(this.data.showResult,"add","value",""),this.$node.querySelector("lyte-input").classList.remove("cxCalcultorResult")}else if("blur"==e.type){void 0!=this.getData("showResult").value&&this.setData("cxPropValue",this.getData("showResult").value);var l=this.$node.querySelector("#cxCalcultorResultPopover");l&&l.ltProp("show",!1),delete this.operationPerformed}},didDestroy:function(){if("create"==this.getData("cxPropFrom")&&this.getData("cxPropShowCalculator")){var e=this;e.$node.querySelector("input")&&["keyup","keypress","blur"].forEach(function(t){e.$node.querySelector("input").removeEventListener(t,e.bindEvent)})}},observeFrom:function(){this.getData("cxPropMaxlength")||("criteria"==this.getData("cxPropFrom")||"filter"==this.getData("cxPropFrom")?this.setData("cxPropMaxlength",19):this.setData("cxPropMaxlength",void 0))}.observes("cxPropFrom").on("init"),observeMaxlength:function(){var e=this.data.cxPropMaxlength;this.data.cxPropValue&&this.data.cxPropValue.indexOf(".")>-1&&e++,this.setData("maxlength",e)}.observes("cxPropMaxlength").on("init"),observeClass:function(e){if("view"!=this.data.cxPropFrom){var t=$L("lyte-number",this.$node);if(t.length||(t=$L("lyte-input",this.$node)),!t.length)return;e&&e.oldValue&&t.removeClass(e.oldValue),this.data.cxPropClass&&t.addClass(this.data.cxPropClass)}}.observes("cxPropClass","lyteViewPort").on("didConnect")},{mixins:["crux-element-validation"]}),Lyte.Component.register("crux-phone-component",{_template:'<template tag-name="crux-phone-component"> <template is="switch" value="{{cxPropFrom}}"><template case="view"> <template is="if" value="{{cxPropValue}}"><template case="true"> <template is="if" value="{{cxPropMaskingProperties}}"><template case="true">{{cruxMaskValue(cxPropValue,cxPropMaskingProperties)}} </template><template case="false"> <template is="if" value="{{expHandlers(expHandlers(cxPropCallAllowed,\'==\',false),\'||\',cxPropField.private.restricted)}}"><template case="true"> <div class="phoneRtl"> <span class="cxPhoneViewValue lvPhFld">{{cxPropDisplayValue}}</span> </div> </template><template case="false"><template is="if" value="{{outbound}}"><template case="true"> <div class="phoneRtl cxPhoneViewOutbound"> <span class="cxPhoneViewValue lvPhFld">{{cxPropDisplayValue}}</span> <span class="cxCalliconOuter" onclick="{{action(\'onClick\')}}"> <span class="cxCallIcon"></span> <span id="calllabel1" class="cxPhoneViewCallLabel">{{cruxGetI18n(\'Call\')}}</span> </span> </div> </template><template case="false"><template is="if" value="{{zpbEnabled}}"><template case="true"> <div class="phoneRtl cxPhoneViewZPBEnabled"> <span class="cxPhoneViewValue lvPhFld">{{cxPropDisplayValue}}</span> <span class="cxPhoneViewZPBEnabledIconWrap phoneRtlA"> <zpb-phone number="{{cxPropDisplayValue}}" module="{{cxPropModule}}" recordid="{{cxPropEntityId}}" callbackparamfn="asyncFn(crmCallsNew.getClick2CallPromise, \'{{cxPropEntityId}}\', \'{{cxPropModule}}\', \'{{cxPropEntityName}}\')"></zpb-phone> </span> </div> </template><template case="false"> <div onmouseover="{{action(\'onMouseOver\')}}" onmouseout="{{action(\'onMouseOut\')}}" class="phoneRtl"> <zpb-phone phoneno="{{cxPropValue}}" callbackparam="{&quot;module&quot;:&quot;{{module}}&quot;, &quot;searchid&quot;:&quot;{{entityId}}&quot;}"><span class="cxPhoneViewValue lvPhFld">{{cxPropDisplayValue}}</span></zpb-phone> <a class="pH2 phoneRtl vH" title="{{cxPropPhoneIconTooltip}}" href="skype:{{cxPropValue}}?call" onclick="sE();"></a> </div> </template></template></template></template></template></template> </template></template> <template is="if" value="{{cxPropViewInfoTooltip}}"><template case="true"> <crux-view-info-tooltip cx-prop-field="{{cxPropField}}" cx-prop-value="{{cxPropValue}}"> <template is="yield" yield-name="viewInfoTooltipYield"> <lyte-yield yield-name="viewInfoTooltipYield" prop-field="{{propField}}" prop-value="{{propValue}}"></lyte-yield> </template> </crux-view-info-tooltip> </template></template> </template><template case="false"><template is="if" value="{{cxPropEmptyValue}}"><template case="true">{{cxPropEmptyValue}}</template></template></template></template> </template><template case="create"> <template is="if" value="{{cxPropField[cxPropFieldKey]}}"><template case="true"> <div class="cxElementLabel {{cxPropLabelClass}}"> {{cxPropField[cxPropFieldKey]}} <template is="if" value="{{cxPropInfoTooltip}}"><template case="true"> <span class="dIB vam cxInfoIcon" onmouseenter="{{action(\'showInfoTooltip\',this)}}"></span> <lyte-hovercard lt-prop-placement="topLeft" lt-prop-keep-alive="true" lt-prop-popover-wrapper-class="cxElementsHovercard" lt-prop-origin-elem=".cxCurrentHovercard" on-hovercard-hide="{{method(\'hideInfoTooltip\')}}"> <template is="registerYield" yield-name="hoverCardYield"> <lyte-hovercard-content class="cxElementsHoverCardContent"> {{cxPropInfoTooltip}} </lyte-hovercard-content> </template> </lyte-hovercard> </template></template> </div> </template></template> <div class="cxElementValue {{if(cxPropDisabled,\'cxElementDisabled\',\'\')}}"> <div class="{{if(cxPropEnableCountryCode,\'cxDropdownInputGroup\',\'\')}}"> <template is="if" value="{{cxPropEnableCountryCode}}"><template case="true"> <template is="if" value="{{cxPropDropdownYield}}"><template case="true"> <lyte-dropdown lt-prop-options="{{countryList}}" lt-prop-system-value="{{cxPropSystemValue}}" lt-prop-user-value="{{cxPropUserValue}}" on-option-selected="{{method(\'onCCSelectChange\')}}" lt-prop-selected="{{lbind(selectedValue)}}"> <template is="registerYield" yield-name="yield"> <lyte-drop-button> <template is="if" value="{{cxPropDropdownButtonYield}}"><template case="true"><lyte-yield yield-name="phoneDropdownButtonYield" selected-code="{{selectedCode}}" selected-value="{{selectedValue}}"></lyte-yield></template></template> </lyte-drop-button> <lyte-drop-box class="{{cxPropBoxClass}}"> <template is="if" value="{{expHandlers(countryList.length,\'>\',7)}}"><template case="true"> <lyte-search lt-prop-query-selector="{&quot;scope&quot; : &quot;.parentscope_{{cxPropId}}&quot;, &quot;search&quot; : &quot;.countryListItem&quot;, &quot;target&quot; : &quot;lyte-drop-item.countryListItem&quot;}" lt-prop-placeholder="{{cxPropDropdownPlaceholder}}"></lyte-search> </template></template> <lyte-drop-body class="countryListBody {{concat(\'parentscope_\',cxPropId)}}"> <template is="for" items="{{countryList}}" item="country" index="index"> <lyte-drop-item data-value="{{country[cxPropSystemValue]}}" class="countryListItem"><lyte-yield yield-name="phoneDropdownYield" country-item="{{country}}"></lyte-yield></lyte-drop-item> </template> </lyte-drop-body> </lyte-drop-box> </template> </lyte-dropdown> </template><template case="false"> <crux-dropdown on-option-select="{{method(\'onCCSelectChange\')}}" cx-prop-options="{{countryList}}" cx-prop-system-value="{{cxPropSystemValue}}" cx-prop-user-value="{{cxPropUserValue}}" cx-prop-display-value="{{selectedCode}}" on-show="{{method(\'onBeforeOpen\')}}" cx-prop-selected="{{selectedCode}}" on-hide="{{method(\'setFocusClass\',false)}}" cx-prop-icon-class="{{cxPropDropdownIconClass}}" on-before-show="{{method(\'beforeShow\')}}"></crux-dropdown> </template></template> </template></template> <lyte-input lt-prop-name="{{cxPropName}}" id="{{cxPropId}}" lt-prop-title="{{cxPropTooltip}}" lt-prop-tooltip-config="{{cxPropTooltipConfig}}" class="w100per {{if(ifEquals(cxPropAppearance,\'box\'),\'cxBoxInput\',\'cxFlatInput\')}}" lt-prop-class="cxBorderBottom {{cxPropInputClass}}" lt-prop-type="text" lt-prop-value="{{lbind(cxPropValue)}}" lt-prop-placeholder="{{cxPropPlaceholder}}" lt-prop-maxlength="{{cxPropMaxlength}}" lt-prop-direction="{{cxPropDirection}}" lt-prop-disabled="{{cxPropDisabled}}" lt-prop-readonly="{{cxPropReadonly}}" on-value-change="{{method(\'onChange\')}}" lt-prop-appearance="{{cxPropAppearance}}" data-zcqa="{{cxPropZcqa}}" lt-prop-tab-index="{{cxPropTabIndex}}" lt-prop-autofocus="{{cxPropAutofocus}}" lt-prop-autocomplete="{{cxPropAutocomplete}}" lt-prop-auto-update="{{cxPropEnableLbind}}" lt-prop-aria="{{cxPropAria}}" lt-prop-aria-attributes="{{cxPropAriaAttributes}}" lt-prop-tooltip-class="cxElementsTooltip {{cxPropTooltipClass}}" onkeypress="{{action(\'onKeyPress\',event)}}" onkeyup="{{action(\'onKeyUp\',event)}}" onpaste="{{action(\'onInputValuePaste\',event)}}" on-focus="{{method(\'setFocusClass\',true)}}" on-blur="{{method(\'setFocusClass\',false)}}" lt-prop-wrapper-class="{{cxPropWrapperClass}}"></lyte-input><template is="if" value="{{cxPropButtonTextInsideElement}}"><template case="true"><lyte-button onclick="{{action(\'buttonClick\')}}"><template is="yield" yield-name="text">{{cxPropButtonTextInsideElement}}</template></lyte-button></template></template> <template is="if" value="{{cxPropShowDisabledIcon}}"><template case="true"><span class="cxElementsDisabledIcon {{cxPropDisabledIconClass}}"></span></template></template> </div> <template is="if" value="{{cxPropShowWarning}}"><template case="true"> <div class="cxFieldWarningMsg"><span class="cxPropWarningIconSpacing {{cxPropWarningIconClass}}"></span> <span class="cxPropWarningMsgTxt">{{unescape(cxPropWarningMessage)}}</span></div> </template><template case="false"><template is="if" value="{{isError}}"><template case="true"> <crux-error-message error-message="{{cxPropErrorMessage}}" cx-prop-error-yield="{{cxPropErrorYield}}" cx-prop-error-zcqa-prefix="{{cxPropErrorZcqaPrefix}}" cx-prop-field="{{cxPropField}}" cx-prop-error-zcqa-suffix="{{cxPropErrorZcqaSuffix}}" class="{{cxPropErrorClass}}" cx-prop-error-span-class="{{cxPropErrorSpanClass}}"> <template is="registerYield" yield-name="errorYield"><lyte-yield yield-name="errorYield" error-message="{{cxPropErrorMessage}}" cx-field="{{cxPropField}}"></lyte-yield></template> </crux-error-message> </template></template></template></template> </div> </template></template> </template>',_dynamicNodes:[{type:"attr",position:[1]},{type:"switch",position:[1],cases:{view:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"text",position:[0]}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"text",position:[1,1,0]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"text",position:[1,1,0]},{type:"attr",position:[1,3]},{type:"text",position:[1,3,3,0]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"text",position:[1,1,0]},{type:"attr",position:[1,3,1]},{type:"componentDynamic",position:[1,3,1]}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"text",position:[1,1,0,0]},{type:"componentDynamic",position:[1,1]},{type:"attr",position:[1,3]}]}},default:{}}]}},default:{}}]}},default:{}}]}},default:{}},{type:"attr",position:[3]},{type:"if",position:[3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"insertYield",position:[1]}]},{type:"componentDynamic",position:[1]}]}},default:{}}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"text",position:[0]}]}},default:{}}]}},default:{}}]},create:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,1]},{type:"attr",position:[1,3]},{type:"if",position:[1,3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[3]},{type:"registerYield",position:[3,1],dynamicNodes:[{type:"text",position:[1,1]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[3]}]}},default:{}}]}},default:{}},{type:"attr",position:[3]},{type:"attr",position:[3,1]},{type:"attr",position:[3,1,1]},{type:"if",position:[3,1,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"attr",position:[1,1]},{type:"if",position:[1,1],cases:{true:{dynamicNodes:[{type:"attr",position:[0]},{type:"insertYield",position:[0]}]}},default:{}},{type:"componentDynamic",position:[1]},{type:"attr",position:[3]},{type:"attr",position:[3,1]},{type:"if",position:[3,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"attr",position:[3,3]},{type:"attr",position:[3,3,1]},{type:"for",position:[3,3,1],dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,0]},{type:"insertYield",position:[1,0]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[3,3]},{type:"componentDynamic",position:[3]}]},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]}},default:{}}]}},default:{}},{type:"attr",position:[3,1,3]},{type:"componentDynamic",position:[3,1,3]},{type:"attr",position:[3,1,4]},{type:"if",position:[3,1,4],cases:{true:{dynamicNodes:[{type:"attr",position:[0]},{type:"registerYield",position:[0,0],dynamicNodes:[{type:"text",position:[0]}]},{type:"componentDynamic",position:[0]}]}},default:{}},{type:"attr",position:[3,1,6]},{type:"if",position:[3,1,6],cases:{true:{dynamicNodes:[{type:"attr",position:[0]}]}},default:{}},{type:"attr",position:[3,3]},{type:"if",position:[3,3],cases:{true:{dynamicNodes:[{type:"attr",position:[1,0]},{type:"text",position:[1,2,0]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"attr",position:[0]},{type:"insertYield",position:[0]}]},{type:"componentDynamic",position:[1]}]}},default:{}}]}},default:{}}]}},default:{}}],_observedAttributes:["lyteViewPort","cxPropValue","cxPropFrom","cxPropDisplayValue","outbound","cxPropField","cxPropCallAllowed","cxPropEmptyValue","cxPropPlaceholder","cxPropMaxlength","cxPropDisabled","cxPropReadonly","zpbEnabled","cxPropEntityId","cxPropEntityName","cxPropModule","isError","cxPropAppearance","cxPropErrorMessage","cxPropFieldKey","cxPropId","cxPropName","cxPropClearErrorMessage","cxPropDirection","cxPropLabelClass","cxPropClearErrorMessage","cxPropTabIndex","cxPropZcqa","lyteUnbound","cxPropClass","cxPropTooltip","cxPropErrorYield","cxPropInfoTooltip","cxPropAutocomplete","cxPropEnableLbind","cxPropAria","cxPropAriaAttributes","cxPropMaskingProperties","cxPropTooltipConfig","cxPropTooltipClass","cxPropErrorZcqaPrefix","cxPropErrorZcqaSuffix","cxPropEnableCountryCode","cxPropUserLocale","countryIsoCodeVsName","countryList","selectedCode","cxPropErrorClass","cxPropWrapperClass","cxPropInputClass","cxPropErrorSpanClass","cxPropDropdownIconClass","cxPropLayout","cxPropViewInfoTooltip","cxPropShowDisabledIcon","cxPropDisabledIconClass","cxPropPhoneIconTooltip","cxPropCountryList","cxPropDropdownYield","cxPropDropdownButtonYield","cxPropDropdownPlaceholder","cxPropUserValue","cxPropSystemValue","cxPropHideNoneOption","cxPropCodeValue","cxPropAllowAlphabets","cxPropBoxClass","selectedValue"],data:function(){return{lyteViewPort:Lyte.attr("boolean",{default:!1}),cxPropValue:Lyte.attr("string"),cxPropFrom:Lyte.attr("string",{default:"view"}),cxPropDisplayValue:Lyte.attr("string"),outbound:Lyte.attr("boolean",{default:!1}),cxPropField:Lyte.attr("object",{default:{}}),cxPropCallAllowed:Lyte.attr("boolean",{default:!0}),cxPropEmptyValue:Lyte.attr("string",{default:""}),cxPropPlaceholder:Lyte.attr("string"),cxPropMaxlength:Lyte.attr("number"),cxPropDisabled:Lyte.attr("boolean",{default:!1}),cxPropReadonly:Lyte.attr("boolean",{default:!1}),zpbEnabled:Lyte.attr("boolean",{default:"undefined"!=typeof Crm&&Crm.userDetails.ZPBENABLED}),cxPropEntityId:Lyte.attr("string"),cxPropEntityName:Lyte.attr("string"),cxPropModule:Lyte.attr("string"),isError:Lyte.attr("boolean",{default:!1}),cxPropAppearance:Lyte.attr("string",{default:"flat"}),cxPropErrorMessage:Lyte.attr("string",{default:""}),cxPropFieldKey:Lyte.attr("string",{default:""}),cxPropId:Lyte.attr("string",{default:""}),cxPropName:Lyte.attr("string",{default:""}),cxPropClearErrorMessage:Lyte.attr("boolean",{default:!0}),cxPropDirection:Lyte.attr("string",{default:"vertical"}),cxPropLabelClass:Lyte.attr("string",{default:""}),cxPropClearErrorMessage:Lyte.attr("boolean",{default:!0}),cxPropTabIndex:Lyte.attr("string"),cxPropZcqa:Lyte.attr("string"),lyteUnbound:Lyte.attr("boolean",{default:!1}),cxPropClass:Lyte.attr("string",{default:""}),cxPropTooltip:Lyte.attr("string",{default:""}),cxPropErrorYield:Lyte.attr("boolean",{default:!1}),cxPropInfoTooltip:Lyte.attr("string",{default:""}),cxPropAutocomplete:Lyte.attr("string",{default:"on"}),cxPropEnableLbind:Lyte.attr("boolean",{default:!0}),cxPropAria:Lyte.attr("boolean",{default:!1}),cxPropAriaAttributes:Lyte.attr("object",{default:{}}),cxPropMaskingProperties:Lyte.attr("object"),cxPropTooltipConfig:Lyte.attr("string",{default:'{"position": "followcursor", "appearance": "box"}'}),cxPropTooltipClass:Lyte.attr("string"),cxPropErrorZcqaPrefix:Lyte.attr("string",{default:""}),cxPropErrorZcqaSuffix:Lyte.attr("string",{default:"Error"}),cxPropEnableCountryCode:Lyte.attr("boolean",{default:!1}),cxPropUserLocale:Lyte.attr("string",{default:"undefined"!=typeof Crm?Crm.userDetails.COUNTRY_LOCALE:""}),countryIsoCodeVsName:Lyte.attr("object",{default:"undefined"!=typeof Crm?Crm.userDetails.countryISOCodeVsName:{}}),countryList:Lyte.attr("array",{default:[]}),selectedCode:Lyte.attr("string"),cxPropErrorClass:Lyte.attr("string"),cxPropWrapperClass:Lyte.attr("string"),cxPropInputClass:Lyte.attr("string",{default:""}),cxPropErrorSpanClass:Lyte.attr("string"),cxPropDropdownIconClass:Lyte.attr("string"),cxPropLayout:Lyte.attr("string"),cxPropViewInfoTooltip:Lyte.attr("boolean",{default:!1}),cxPropShowDisabledIcon:Lyte.attr("boolean",{default:!1}),cxPropDisabledIconClass:Lyte.attr("string",{default:""}),cxPropPhoneIconTooltip:Lyte.attr("string",{default:_cruxUtils.getI18n("crm.phoneNo.Link.Title")}),cxPropCountryList:Lyte.attr("array"),cxPropDropdownYield:Lyte.attr("boolean",{default:!1}),cxPropDropdownButtonYield:Lyte.attr("boolean"),cxPropDropdownPlaceholder:Lyte.attr("string"),cxPropUserValue:Lyte.attr("string",{default:"display_value"}),cxPropSystemValue:Lyte.attr("string",{default:"actual_value"}),cxPropHideNoneOption:Lyte.attr("boolean",{default:!1}),cxPropCodeValue:Lyte.attr("string",{default:"code"}),cxPropAllowAlphabets:Lyte.attr("boolean",{default:!0}),cxPropBoxClass:Lyte.attr("string"),selectedValue:Lyte.attr("string")}},actions:{onMouseOver:function(){var e=this.$node;e.querySelector("a")&&(e.querySelector("a").style.visibility="visible")},onMouseOut:function(){var e=this.$node;e.querySelector("a")&&(e.querySelector("a").style.visibility="hidden")},onClick:function(){this.phoneClick(this.getData("cxPropValue"),this.getData("cxPropEntityId"),this.getData("cxPropModule"),this.getData("cxPropEntityName"))},showInfoTooltip:function(e){this.showHideInfoTooltip(e)},onKeyPress:function(e){if(this.data.cxPropEnableCountryCode&&this.isBlockedChar(e))return e.preventDefault(),!1},onKeyUp:function(e){this.data.cxPropEnableCountryCode&&this.autoPopCountryCode(this.$node,$L(e.target))},onInputValuePaste:function(e){this.data.cxPropEnableCountryCode&&setTimeout(function(){this.removeBlockedChars($L(e.target)),this.setData("cxPropValue",$L(e.target)[0].value),this.autoPopCountryCode(this.$node,$L(e.target))}.bind(this))}},getValue:function(){if(this.data.cxPropDropdownButtonYield)return this.executeMethod("getValue",this.$node);var e="string"==typeof this.data.cxPropValue?this.getData("cxPropValue").trim():this.getData("cxPropValue");if("create"==this.data.cxPropFrom&&this.data.cxPropEnableCountryCode&&e){var t=this.$node.querySelector("crux-dropdown").getData("cxPropSelected");t&&"-None-"!=t&&t!=I18n.getMsg("-None-")&&"--"!=t&&(e=(t=t.split("(")[1].split(")")[0]).trim()+e)}return e},validate:function(){var e=this.data.cxPropEnableCountryCode?this.getValue():this.data.cxPropValue;return this.validatePhoneNumber(this.getData("cxPropField"),e)},methods:{onChange:function(){this.getData("cxPropClearErrorMessage")&&this.setData("cxPropErrorMessage",""),this.getMethods("onValueChange")&&this.executeMethod("onValueChange",this.getData("cxPropValue"))},zpbCallBackFn:function(){return'asyncFn(crmCallsNew.getClick2CallPromise,"'+this.getData("cxPropEntityId")+'","'+this.getData("cxPropModule")+'","'+this.getData("cxPropEntityName")+'")'},hideInfoTooltip:function(){this.showHideInfoTooltip()},onCCSelectChange:function(e,t,o,a){this.getMethods("onCountryCodeChange")&&this.executeMethod("onCountryCodeChange",e,t,o,a);var r=a.innerText.split(" +")[0];for(var i in this.data.countryIsoCodeVsName)if(this.data.countryIsoCodeVsName[i]==r){this.setData("selectedCode",i+"("+t+")");break}setTimeout(function(){this.$node.querySelector("input").focus()}.bind(this),0)},onBeforeOpen:function(){this.$node.querySelector(".cxDropdownInputGroup").classList.add("cxDropdownInputGroupFocused");var e=this.$node.querySelector("crux-dropdown"),t=this.data.selectedCode;setTimeout(function(){e.cxProp("displayValue",t)}),e.setData("preventSelectedObs",!0),e.cxProp("selected",t.split("(")[1].split(")")[0]),e.setData("preventSelectedObs",!1),this.selectOnce=!0,this.$node.querySelector("lyte-dropdown").component.childComp.querySelector("input").focus()},setFocusClass:function(e){this.data.cxPropEnableCountryCode&&(e?this.data.cxPropDisabled?this.$node.querySelector(".cxDropdownInputGroup").classList.add("cxDropdownInputGroupDisabled"):this.$node.querySelector(".cxDropdownInputGroup").classList.add("cxDropdownInputGroupFocused"):this.data.cxPropDisabled?this.$node.querySelector(".cxDropdownInputGroup").classList.remove("cxDropdownInputGroupDisabled"):this.$node.querySelector(".cxDropdownInputGroup").classList.remove("cxDropdownInputGroupFocused"))},beforeShow:function(){if(this.data.cxPropReadonly)return!1}},observeErrorMessage:function(){this.setData("isError",""!=this.getData("cxPropErrorMessage"))}.observes("cxPropErrorMessage").on("init"),observeIsError:function(){"create"==this.getData("cxPropFrom")&&this.$node.querySelector("lyte-input")&&(this.getData("isError")?this.data.cxPropEnableCountryCode?this.$node.querySelector(".cxDropdownInputGroup").classList.add("cxGroupErrorBox"):this.$node.querySelector("lyte-input").classList.add("cxErrorBox"):this.data.cxPropEnableCountryCode?this.$node.querySelector(".cxDropdownInputGroup").classList.remove("cxGroupErrorBox"):this.$node.querySelector("lyte-input").classList.remove("cxErrorBox"))}.observes("isError","lyteViewPort").on("didConnect"),observeMandatory:function(){this.observeMandatoryMixin(this.data.cxPropEnableCountryCode?".cxDropdownInputGroup":"lyte-input",this.data.cxPropEnableCountryCode?"cxGroupMandatoryField":void 0)}.observes("cxPropField.required","lyteViewPort","cxPropMandatory","cxPropFrom").on("didConnect"),observeValue:function(){var e=this.getData("cxPropValue");if("view"==this.getData("cxPropFrom")&&e&&(this.setData("cxPropDisplayValue",e),this.setData("outbound","undefined"!=typeof Crm&&Crm.userDetails.TELEPHONY_ENABLED)),this.getData("cxPropDisabled")&&!this.data.cxPropTooltip&&this.setData("cxPropTooltip",_cruxUtils.getI18n("crm.lable.read.only")),"create"==this.data.cxPropFrom){var t;if(this.data.cxPropEnableCountryCode)this.data.cxPropValue||!this.data.cxPropUserLocale||this.data.cxPropDisabled||(t=this.data.cxPropUserLocale.split("_")[1]),this.data.countryList&&this.data.countryList.length||this.appendPhoneNoCountryCodeOptions(t),this.autoPopCountryCode(this.$node,$L(this.$node.querySelector("input")),this.data.cxPropValue),this.selectOnce=!1;this.setFocusUtil()}}.observes("cxPropValue","cxPropFrom").on("init"),autoPopCountryCode:function(e,t,o){var a=o||t.val().trim();if(a.startsWith("+")){var r=a.length,i=a,s=!1,l=this.getRegionCodeForNumber(a);l&&(s=this.selectCountryByPCC(e,l))&&(i=a.substring(("+"+ZlibPhoneNumber.getCountryCodeForRegion(l)).length,r));for(var p=2;r>=p&&!s;)i=a.substring(p,r),s=this.selectCountryByPCC(e,a.substring(0,p),a),4!=p||s||(i=a.substring(1,r),s=!0),p++;s&&this.setData("cxPropValue",i)}else{var n=this.data.cxPropValue;n&&n.startsWith("+")&&this.isValidPNumber(n)&&this.selectCountryByPCC(e,this.getRegionCodeForNumber(n))}},isBlockedChar:function(e){var t=String.fromCharCode(e.which),o=$L(e.target).val();return!("+"===t&&validationUtils.isEmpty(o)||e.metaKey||e.ctrlKey)&&((!this.data.cxPropAllowAlphabets||!(e.which>=65&&e.which<=90||e.which>=97&&e.which<=122))&&(-1==="0123456789().,-;".indexOf(t)&&32!==e.which&&13!==e.which))},removeBlockedChars:function(e){var t=e.val(),o=t.replace(/[^0-9A-Za-z().,-;]/g,"");t.startsWith("+")&&(o="+"+o),e.val(o)},getRegionCodeForNumber:function(e){try{return ZlibPhoneNumber.getRegionCodeForNumber(e)}catch(e){"undefined"!=typeof murphy&&murphy.error(e)}return null},selectCountryByPCC:function(e,t,o){t=t||"";var a=e.querySelector("crux-dropdown");if(a&&a.getData("cxPropSelected")==t)return!0;var r=this.getRegionCodeForNumber(o);if(void 0==this.opList){for(var i=e.querySelector("lyte-dropdown"),s=0;s<this.data.countryList.length;s++)if(this.data.countryList[s][this.data.cxPropUserValue]==t){var l=this.data.countryList[s][this.data.cxPropSystemValue];return this.getMethods("onCountryCodeChange")&&i&&this.executeMethod("onCountryCodeChange",event,l,i.component),this.setData("selectedValue",l),this.setData("selectedCode",this.data.countryList[s][this.data.cxPropUserValue]),!0}}else{var p=this.opList.indexOf(t);if(p>-1&&this.opList[p]==t)return this.setData("selectedCode",r+"("+t+")"),!0}return!1},isValidPNumber:function(e){try{return ZlibPhoneNumber.isValidNumber(e)}catch(e){"undefined"!=typeof murphy&&murphy.error(e)}return!1},getCCSortedByName:function(){var e=this.data.countryIsoCodeVsName,t=[],o=ZlibPhoneNumber.getSupportedCountries();for(var a in e)e.hasOwnProperty(a)&&-1!==o.indexOf(a)&&t.push(e[a]);t=t.sort();var r=[];return Object.keys(e).forEach(function(a){var i=t.indexOf(e[a]);i>=0&&-1!==o.indexOf(a)&&(r[i]=a)}),r},appendPhoneNoCountryCodeOptions:function(e){for(var t=this.getCCSortedByName(),o=[{actual_value:"-None-",display_value:_cruxUtils.getI18n("None")}],a=t.length,r=[],i=0;i<a;i++){var s=t[i],l="+"+ZlibPhoneNumber.getCountryCodeForRegion(s),p=this.data.countryIsoCodeVsName[s]+" "+l;r.push(l),o.push({actual_value:l,display_value:p}),s==e&&(this.setData("selectedCode",e+"("+l+")"),this.setData("selectedValue",s))}this.setData("countryList",o),this.opList=r},getPlainPhoneNo:function(e){var t=e.length,o="";if(t<0)return o;if(!/^\d+(,(\d)+)*(\.\d{1,2})*$/.test(e))if(14===t){if(e.startsWith("(")&&e.indexOf("-")&&e.indexOf(")")&&e.indexOf(" ")){o=e;var a=e.indexOf(")"),r=e.indexOf(" "),i=e.indexOf("-");if(4===a&&5===r&&9===i)if(10===(e=(e=(e=(e=e.replace(" ","")).replace("(","")).replace(")","")).replace("-","")).length)return e.replace(" ","").replace("(","").replace(")","").replace("-","").length<10?o:e;return o}}else if(12===t){if(-1!==e.indexOf(" "))return e;if(e.startsWith("(")&&e.indexOf(")")&&e.indexOf("-")){o=e;var s=e.indexOf(")"),l=e.indexOf("-");if(6===s&&7===l)if(9===(e=(e=(e=e.replace("-","")).replace("(","")).replace(")","")).length)return e.replace("-","").replace("(","").replace(")","").length<9?o:e;return o}}return e},observeClass:function(e){if("create"==this.data.cxPropFrom){var t=$L("lyte-input",this.$node);if(!t.length)return;e&&e.oldValue&&t.removeClass(e.oldValue),this.data.cxPropClass&&t.addClass(this.data.cxPropClass)}}.observes("cxPropClass","lyteViewPort").on("didConnect")},{mixins:["crux-element-validation"]}),Lyte.Component.register("crux-picklist-component",{_template:'<template tag-name="crux-picklist-component"> <template is="switch" value="{{cxPropFrom}}"><template case="filter"></template><template case="criteria"></template><template case="create"> <template is="if" value="{{expHandlers(expHandlers(cxPropFrom,\'===\',&quot;create&quot;),\'&amp;&amp;\',cxPropField[cxPropFieldKey])}}"><template case="true"> <div class="cxElementLabel {{cxPropLabelClass}}"> {{cxPropField[cxPropFieldKey]}} <template is="if" value="{{cxPropInfoTooltip}}"><template case="true"> <span class="dIB vam cxInfoIcon" onmouseenter="{{action(\'showInfoTooltip\',this)}}"></span> <lyte-hovercard lt-prop-placement="topLeft" lt-prop-keep-alive="true" lt-prop-popover-wrapper-class="cxElementsHovercard" lt-prop-origin-elem=".cxCurrentHovercard" on-hovercard-hide="{{method(\'hideInfoTooltip\')}}"> <template is="registerYield" yield-name="hoverCardYield"> <lyte-hovercard-content class="cxElementsHoverCardContent"> {{cxPropInfoTooltip}} </lyte-hovercard-content> </template> </lyte-hovercard> </template></template> </div> </template></template> <div class="cxElementValue {{if(cxPropDisabled,\'cxElementDisabled\',\'\')}} {{pkColorEnabledClass}}"> <template is="if" value="{{cxPropIsColorCodeEnabled}}"><template case="true"> <span class="dIB activitesColor" id="selectColorComponent_{{cxPropField.id}}" data-zcqa="{{concat(cxPropField.field_label,\'_selectedColor\')}}" style="background:{{propDefaultColorCode}}"></span> </template></template> <lyte-dropdown id="{{cxPropId}}" lt-prop-title="{{tooltip}}" lt-prop-tooltip-config="{&quot;position&quot;: &quot;followcursor&quot;, &quot;appearance&quot;: &quot;box&quot;}" lt-prop-tooltip-style="margin: 10px; font-size : 11px;" lt-prop-boundary="{{cxPropBoundary}}" lt-prop-disabled-list="[&quot;cruxDisabled&quot;]" lt-prop-yield="true" lt-prop-type="{{cxPropType}}" lt-prop-tabindex="{{cxPropTabIndex}}" on-add="{{method(\'addToList\',cxPropField)}}" on-remove="{{method(\'removeFromList\',cxPropField)}}" lt-prop-selected="{{cxPropValue}}" lt-prop-disabled="{{cxPropDisabled}}" lt-prop-display-value="{{cxPropDisplayValue}}" on-option-selected="{{method(\'selectOption\')}}" lt-prop-placeholder="{{placeholder}}" lt-prop-search-delay="{{cxPropSearchDelay}}" on-before-show="{{method(\'openDropdown\')}}" on-hide="{{method(\'closeDropdown\')}}" lt-prop-readonly="{{cxPropReadonly}}" class="{{if(ifEquals(cxPropAppearance,\'flat\'),\'cxFlatDropdown\',\'cxBoxDropdown\')}} {{cxPropClass}}" lt-prop-no-result="" on-show="{{method(\'onDropdownOpen\')}}" lt-prop-freeze="{{cxPropFreeze}}" on-before-hide="{{method(\'beforeHide\')}}" data-zcqa="{{cxPropDropdownZcqa}}" lt-prop-scope="{{cxPropScope}}" lt-prop-aria="{{cxPropAria}}" lt-prop-aria-attributes="{{cxPropAriaAttributes}}" lt-prop-icon-class="{{cxPropDropdownIconClass}}" lt-prop-button-class="{{cxPropButtonClass}}" lt-prop-prevent-parent-scroll="{{cxPropPreventParentScroll}}"> <template is="registerYield" yield-name="yield"> <template is="if" value="{{expHandlers(cxPropType,\'!=\',&quot;single&quot;)}}"><template case="true"> <lyte-drop-button data-zcqa="{{if(cxPropDropdownZcqa,\'\',cxPropZcqa)}}"> <ul class="lyteMultipleSelect"> <template is="for" items="{{displayValue}}" item="item" index="index"> <li data-value="{{item}}"> <span class="lyteDropdownVisible" onmouseenter="{{action(\'setToolTip\',this)}}">{{unescape(cruxReplaceSpace(cruxEncodeHTML(item)))}}</span> <lyte-drop-remove class="lyteCloseIcon"></lyte-drop-remove> </li> </template> <li class="lyteMultiselectInput"> <lyte-search class="w100per" lt-prop-update-delay="{{cxPropUpdateDelay}}" lt-prop-search-delay="{{cxPropSearchDelay}}" lt-prop-type="text" lt-prop-query-selector="{&quot;scope&quot;:&quot;{{concat(&quot;.parentscope_&quot;,cxPropId,&quot;_&quot;,cruxConvertStringToValidSelector(cxPropField.api_name))}}&quot;, &quot;target&quot;:&quot;.picklist_values:not(.lyteDropdownActive)&quot;, &quot;search&quot;:&quot;lyte-drop-item.picklist_values:not(.lyteDropdownActive)&quot;}" lt-prop-maxlength="{{cxPropMaxlength}}" on-search="{{method(\'showNoResult\',cxPropField)}}" id="{{concat(&quot;search_&quot;,cxPropId,&quot;_&quot;,cruxConvertStringToValidSelector(cxPropField.api_name))}}" lt-prop-placeholder="{{if(displayValue.length,\'\',placeholder)}}" onclick="{{action(\'searchBoxClicked\')}}" on-focus="{{method(\'onSearchBoxFocused\')}}" onkeydown="{{action(\'preventDefault\',this,event)}}" lt-prop-trim="true"></lyte-search> </li> </ul> </lyte-drop-button> </template><template case="false"><template is="if" value="{{cxPropPicklistButtonYield}}"><template case="true"> <lyte-drop-button> <lyte-yield yield-name="picklistButtonYield"></lyte-yield> </lyte-drop-button> </template></template></template></template> <lyte-drop-box class="cxDropbox {{if(cxPropIsColorCodeEnabled,\'colorEnabledPKDropBox\',\'\')}} {{cxPropBoxClass}}"> <template is="if" value="{{expHandlers(expHandlers(cxPropType,\'==\',&quot;single&quot;),\'&amp;&amp;\',showSearchBox)}}"><template case="true"> <lyte-drop-header> <lyte-search class="w100per" lt-prop-query-selector="{&quot;scope&quot;:&quot;{{concat(&quot;.parentscope_&quot;,cxPropId,&quot;_&quot;,cruxConvertStringToValidSelector(cxPropField.api_name))}}&quot;, &quot;target&quot;:&quot;.picklist_values&quot;, &quot;search&quot;:&quot;lyte-drop-item.picklist_values&quot;}" lt-prop-maxlength="120" id="{{concat(\'searchsingle_\',cxPropId,\'_\',cxPropField.api_name)}}" on-search="{{method(\'singleSearch\')}}" lt-prop-trim="true"></lyte-search> </lyte-drop-header> </template></template> <lyte-drop-body id="{{cxPropField.api_name}}" class="{{concat(&quot;parentscope_&quot;,cxPropId,&quot;_&quot;,cruxConvertStringToValidSelector(cxPropField.api_name))}}"> <template is="if" value="{{showLoading}}"><template case="true"> <div class="loadingGifDiv aligncenter"> <img class="loadingGif" src="/recruit/CRMClient/images/crux-search-loader.svg"> </div> </template><template case="false"> <template is="for" items="{{pickListValues}}" item="item" index="indeval"> <template is="if" value="{{item.cxPropSelected}}"><template case="true"> <lyte-drop-item class="picklist_values {{if(item.extra,\'lyteDropdownSelection\',\'\')}} {{if(cruxAnd(ifEquals(cxPropIsColorCodeEnabled,\'true\'),ifEquals(item.actual_value,\'-None-\')),\'colorEnabledSelect2None\',\'\')}} {{if(item.cxDisableSelect,\'cxDropboxNoneItem\',\'\')}}" data-value="{{item[cxPropUserValue]}}" data-extra="{{item.extra}}" data-zcqa="{{concat(cxPropField.field_label,\'_\',item[cxPropZcqaSelector])}}" selected="true"> <template is="if" value="{{cxPropPicklistYield}}"><template case="true"> <lyte-yield yield-name="picklistYield" item-obj="{{item}}"></lyte-yield> </template><template case="false"> <template is="if" value="{{cxPropIsColorCodeEnabled}}"><template case="true"> <span class="dIB activitesColor" style="background:{{item.colour_code}}" data-zcqa="{{concat(cxPropField.field_label,\'_option_\',item[cxPropZcqaSelector])}}"> </span> </template></template> {{item[cxPropUserValue]}} </template></template> </lyte-drop-item> </template><template case="false"> <lyte-drop-item class="picklist_values {{if(item.extra,\'lyteDropdownSelection\',\'\')}} {{if(cruxAnd(ifEquals(cxPropIsColorCodeEnabled,\'true\'),ifEquals(item.actual_value,\'-None-\')),\'colorEnabledSelect2None\',\'\')}} {{if(item.cxDisableSelect,\'cxDropboxNoneItem\',\'\')}}" data-value="{{item[cxPropUserValue]}}" data-extra="{{item.extra}}" data-zcqa="{{concat(cxPropField.field_label,\'_\',item[cxPropZcqaSelector])}}"> <template is="if" value="{{cxPropPicklistYield}}"><template case="true"> <lyte-yield yield-name="picklistYield" item-obj="{{item}}"></lyte-yield> </template><template case="false"> <template is="if" value="{{cxPropIsColorCodeEnabled}}"><template case="true"> <span class="dIB activitesColor" style="background:{{item.colour_code}}" data-zcqa="{{concat(cxPropField.field_label,\'_option_\',item[cxPropZcqaSelector])}}"> </span> </template></template> {{item[cxPropUserValue]}} </template></template> </lyte-drop-item> </template></template> </template> <template is="if" value="{{showNoOption}}"><template case="true"><div class="cxDropdownNoResult" data-value="cruxDisabled">{{cruxGetI18n(\'crm.label.no.options.found\')}}</div></template></template> </template></template> </lyte-drop-body> <template is="if" value="{{cxPropFooterYield}}"><template case="true"><lyte-drop-footer><lyte-yield yield-name="footer"></lyte-yield></lyte-drop-footer></template></template> </lyte-drop-box> </template> </lyte-dropdown> <template is="if" value="{{cxPropShowDisabledIcon}}"><template case="true"><span class="cxElementsDisabledIcon {{cxPropDisabledIconClass}}"></span></template></template> <template is="if" value="{{isError}}"><template case="true"> <crux-error-message error-message="{{cxPropErrorMessage}}" cx-prop-error-yield="{{cxPropErrorYield}}" cx-prop-error-zcqa-prefix="{{cxPropErrorZcqaPrefix}}" cx-prop-field="{{cxPropField}}" cx-prop-error-zcqa-suffix="{{cxPropErrorZcqaSuffix}}" class="{{cxPropErrorClass}}" cx-prop-error-span-class="{{cxPropErrorSpanClass}}"> <template is="registerYield" yield-name="errorYield"><lyte-yield yield-name="errorYield" error-message="{{cxPropErrorMessage}}" cx-field="{{cxPropField}}"></lyte-yield></template> </crux-error-message> </template></template> </div> </template><template case="view"> <template is="if" value="{{cxPropIsColorCodeEnabled}}"><template case="true"> <span class="{{pkColorEnabledClass}}" data-zcqa="{{concat(\'colorcodespan_\',cxPropField.field_label,\'_\',viewValue)}}" style="{{propColorStyleObj}}"><lyte-text lt-prop-value="{{viewValue}}" lt-prop-tooltip-config="{&quot;showdelay&quot; : 600 }" lt-prop-tooltip-class="lvTooltipClass"></lyte-text></span> </template><template case="false"> <lyte-text lt-prop-value="{{viewValue}}" lt-prop-tooltip-config="{&quot;showdelay&quot; : 600 }" lt-prop-tooltip-class="lvTooltipClass"></lyte-text> </template></template> <template is="if" value="{{cxPropViewInfoTooltip}}"><template case="true"> <crux-view-info-tooltip cx-prop-field="{{cxPropField}}" cx-prop-value="{{cxPropValue}}"> <template is="yield" yield-name="viewInfoTooltipYield"> <lyte-yield yield-name="viewInfoTooltipYield" prop-field="{{propField}}" prop-value="{{propValue}}"></lyte-yield> </template> </crux-view-info-tooltip> </template></template> </template></template> </template>',_dynamicNodes:[{type:"attr",position:[1]},{type:"switch",position:[1],cases:{filter:{dynamicNodes:[],additional:{next:"criteria"}},criteria:{dynamicNodes:[],additional:{next:"create"}},create:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,1]},{type:"attr",position:[1,3]},{type:"if",position:[1,3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[3]},{type:"registerYield",position:[3,1],dynamicNodes:[{type:"text",position:[1,1]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[3]}]}},default:{}}]}},default:{}},{type:"attr",position:[3]},{type:"attr",position:[3,1]},{type:"if",position:[3,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1],attr:{style:{name:"style",helperInfo:{name:"concat",args:["'background:'","propDefaultColorCode"]}}}}]}},default:{}},{type:"attr",position:[3,3]},{type:"registerYield",position:[3,3,1],dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1,1]},{type:"for",position:[1,1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"text",position:[1,1,0]},{type:"componentDynamic",position:[1,3]}]},{type:"attr",position:[1,1,3,1]},{type:"componentDynamic",position:[1,1,3,1]},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"insertYield",position:[1,1]},{type:"componentDynamic",position:[1]}]}},default:{}}]}},default:{}},{type:"attr",position:[3]},{type:"attr",position:[3,1]},{type:"if",position:[3,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1,1]},{type:"componentDynamic",position:[1,1]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"attr",position:[3,3]},{type:"attr",position:[3,3,1]},{type:"if",position:[3,3,1],cases:{true:{dynamicNodes:[]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"for",position:[1],dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"if",position:[1,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"insertYield",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1],attr:{style:{name:"style",helperInfo:{name:"concat",args:["'background:'","item.colour_code"]}}}}]}},default:{}},{type:"text",position:[3]}]}},default:{}},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"if",position:[1,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"insertYield",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1],attr:{style:{name:"style",helperInfo:{name:"concat",args:["'background:'","item.colour_code"]}}}}]}},default:{}},{type:"text",position:[3]}]}},default:{}},{type:"componentDynamic",position:[1]}]}},default:{}}]},{type:"attr",position:[3]},{type:"if",position:[3],cases:{true:{dynamicNodes:[{type:"text",position:[0,0]}]}},default:{}}]}},default:{}},{type:"componentDynamic",position:[3,3]},{type:"attr",position:[3,5]},{type:"if",position:[3,5],cases:{true:{dynamicNodes:[{type:"insertYield",position:[0,0]},{type:"componentDynamic",position:[0]}]}},default:{}},{type:"componentDynamic",position:[3]}]},{type:"componentDynamic",position:[3,3]},{type:"attr",position:[3,5]},{type:"if",position:[3,5],cases:{true:{dynamicNodes:[{type:"attr",position:[0]}]}},default:{}},{type:"attr",position:[3,7]},{type:"if",position:[3,7],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"attr",position:[0]},{type:"insertYield",position:[0]}]},{type:"componentDynamic",position:[1]}]}},default:{}}]},view:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1],attr:{style:{name:"style",dynamicValue:"propColorStyleObj"}}},{type:"attr",position:[1,0]},{type:"componentDynamic",position:[1,0]}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"attr",position:[3]},{type:"if",position:[3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"insertYield",position:[1]}]},{type:"componentDynamic",position:[1]}]}},default:{}}]}},default:{}}],_observedAttributes:["lyteViewPort","cxPropFrom","cxPropField","cxPropValue","displayValue","pickListValues","origLen","showNoOption","disabledList","cxPropEmptyValue","placeholder","cxPropDisabled","cxPropOpenDropdown","cxPropDisplayValue","cxPropType","cxPropZcqa","cxPropErrorMessage","cxPropDisableExtraValue","cxPropFieldKey","cxPropId","cxPropDisableExtraValue","cxPropClearErrorMessage","cxPropDoNotSkipFirstValue","cxPropAppearance","cxPropBoundary","cxPropDirection","cxPropLabelClass","showSearchBox","cxPropIsColorCodeEnabled","propDefaultColorCode","propColorStyleObj","pkColorEnabledClass","cxPropId","cxPropPlaceholder","cxPropTabIndex","cxPropClass","cxPropLayout","cxPropTooltip","cxPropPicklistYield","cxPropPicklistButtonYield","isError","cxPropErrorYield","cxPropUserValue","cxPropSystemValue","cxPropPicklistValues","cxPropInfoTooltip","cxPropZcqaSelector","cxPropFreeze","cxPropDropdownZcqa","cxPropScope","cxPropSearchDelay","cxPropAria","cxPropAriaAttributes","cxPropModule","cxPropMaskingProperties","cxPropTooltipConfig","cxPropTooltipClass","viewValue","cxPropErrorZcqaPrefix","cxPropErrorZcqaSuffix","lyteUnbound","cxPropMaxlength","cxPropUpdateDelay","cxPropErrorClass","tooltip","cxPropErrorSpanClass","cxPropDropdownIconClass","cxPropMaxCount","cxPropReadonly","cxPropPreventParentScroll","cxPropBoxClass","cxPropShowUnused","cxPropLayout","cxPropFooterYield","cxPropViewInfoTooltip","cxPropShowDisabledIcon","cxPropDisabledIconClass"],data:function(){return{lyteViewPort:Lyte.attr("boolean",{default:!1}),cxPropFrom:Lyte.attr("string",{default:"view"}),cxPropField:Lyte.attr("object",{default:{}}),cxPropValue:Lyte.attr("string"),displayValue:Lyte.attr("array",{default:[]}),pickListValues:Lyte.attr("array"),origLen:Lyte.attr("number"),showNoOption:Lyte.attr("boolean",{default:!1}),disabledList:Lyte.attr("array",{default:["cruxDisabled"]}),cxPropEmptyValue:Lyte.attr("string",{default:""}),placeholder:Lyte.attr("string",{default:_cruxUtils.getI18n("None")}),cxPropDisabled:Lyte.attr("boolean",{default:!1}),cxPropOpenDropdown:Lyte.attr("boolean",{default:!1}),cxPropDisplayValue:Lyte.attr("string"),cxPropType:Lyte.attr("string"),cxPropZcqa:Lyte.attr("string"),cxPropErrorMessage:Lyte.attr("string",{default:""}),cxPropDisableExtraValue:Lyte.attr("boolean",{default:!1}),cxPropFieldKey:Lyte.attr("string",{default:""}),cxPropId:Lyte.attr("string",{default:""}),cxPropDisableExtraValue:Lyte.attr("boolean",{default:!1}),cxPropClearErrorMessage:Lyte.attr("boolean",{default:!0}),cxPropDoNotSkipFirstValue:Lyte.attr("boolean",{default:!1}),cxPropAppearance:Lyte.attr("string",{default:"flat"}),cxPropBoundary:Lyte.attr("object",{default:{}}),cxPropDirection:Lyte.attr("string",{default:"vertical"}),cxPropLabelClass:Lyte.attr("string",{default:""}),showSearchBox:Lyte.attr("boolean",{default:!1}),cxPropIsColorCodeEnabled:Lyte.attr("boolean",{default:!1}),propDefaultColorCode:Lyte.attr("string",{default:""}),propColorStyleObj:Lyte.attr("string",{default:""}),pkColorEnabledClass:Lyte.attr("string",{default:""}),cxPropId:Lyte.attr("string",{default:""}),cxPropPlaceholder:Lyte.attr("string",{default:""}),cxPropTabIndex:Lyte.attr("string",{default:"0"}),cxPropClass:Lyte.attr("string",{default:""}),cxPropLayout:Lyte.attr("string"),cxPropTooltip:Lyte.attr("string",{default:""}),cxPropPicklistYield:Lyte.attr("boolean",{default:!1}),cxPropPicklistButtonYield:Lyte.attr("boolean",{default:!1}),isError:Lyte.attr("boolean",{default:!1}),cxPropErrorYield:Lyte.attr("boolean",{default:!1}),cxPropUserValue:Lyte.attr("string",{default:"display_value"}),cxPropSystemValue:Lyte.attr("string",{default:"actual_value"}),cxPropPicklistValues:Lyte.attr("array"),cxPropInfoTooltip:Lyte.attr("string",{default:""}),cxPropZcqaSelector:Lyte.attr("string"),cxPropFreeze:Lyte.attr("boolean",{default:!1}),cxPropDropdownZcqa:Lyte.attr("string"),cxPropScope:Lyte.attr("string"),cxPropSearchDelay:Lyte.attr("number"),cxPropAria:Lyte.attr("boolean",{default:!1}),cxPropAriaAttributes:Lyte.attr("object",{default:{}}),cxPropModule:Lyte.attr("string"),cxPropMaskingProperties:Lyte.attr("object"),cxPropTooltipConfig:Lyte.attr("string"),cxPropTooltipClass:Lyte.attr("string"),viewValue:Lyte.attr("string"),cxPropErrorZcqaPrefix:Lyte.attr("string",{default:""}),cxPropErrorZcqaSuffix:Lyte.attr("string",{default:"Error"}),lyteUnbound:Lyte.attr("boolean",{default:!1}),cxPropMaxlength:Lyte.attr("number",{default:120}),cxPropUpdateDelay:Lyte.attr("number"),cxPropErrorClass:Lyte.attr("string"),tooltip:Lyte.attr("string"),cxPropErrorSpanClass:Lyte.attr("string"),cxPropDropdownIconClass:Lyte.attr("string",{default:"dropdown"}),cxPropMaxCount:Lyte.attr("number"),cxPropReadonly:Lyte.attr("boolean",{default:!1}),cxPropPreventParentScroll:Lyte.attr("boolean",{default:!1}),cxPropBoxClass:Lyte.attr("string",{default:""}),cxPropShowUnused:Lyte.attr("boolean",{default:!1}),cxPropLayout:Lyte.attr("string"),cxPropFooterYield:Lyte.attr("boolean",{default:!1}),cxPropViewInfoTooltip:Lyte.attr("boolean",{default:!1}),cxPropShowDisabledIcon:Lyte.attr("boolean",{default:!1}),cxPropDisabledIconClass:Lyte.attr("string",{default:""})}},methods:{onDropdownOpen:function(){this.getMethods("onShow")&&this.executeMethod("onShow",arguments[0],arguments[1]),this.$node.querySelector("lyte-dropdown").component.childComp&&this.$node.querySelector("lyte-dropdown").component.childComp.querySelector("input")&&this.$node.querySelector("lyte-dropdown").component.childComp.querySelector("input").focus()},showNoResult:function(e,t){this.closing;if(this.closing)this.closing=!1;else if(this.$node.querySelector("lyte-dropdown").component.childComp&&this.$node.querySelector("lyte-dropdown").component.childComp.classList.contains("lyteDropdownHidden")){if("input"==arguments[3].type)return;this.$node.querySelector("lyte-dropdown").toggle()}var o=arguments[2].querySelector("input").value;if(!(""==o.trim()&&(!this.adding&&this.getData("pickListValues")&&this.getData("pickListValues")[0]&&this.getData("pickListValues")[0].extra&&Lyte.arrayUtils(this.getData("pickListValues"),"shift"),this.adding=!1,this.setData("showNoOption",0==this.origLen),o.length>0))&&""!=o)if(0==this.getData("cxPropDisableExtraValue")){var a=o,r=o.toLowerCase().trim();if(r=r.replace(/\s+/g," "),1!=this.extraVals[r]){this.getData("pickListValues")&&this.getData("pickListValues")[0]&&this.getData("pickListValues")[0].extra&&Lyte.arrayUtils(this.getData("pickListValues"),"shift"),this.$node.querySelector("lyte-dropdown").component.childComp&&this.$node.querySelector("lyte-dropdown").component.childComp.querySelector(".lyteDropdownSelection")&&this.$node.querySelector("lyte-dropdown").component.childComp.querySelector(".lyteDropdownSelection").classList.remove("lyteDropdownSelection");var i={extra:"true"};i[this.getData("cxPropUserValue")]=a.replace(/\s+/g," "),i[this.getData("cxPropSystemValue")]=a.replace(/\s+/g," "),Lyte.arrayUtils(this.getData("pickListValues"),"unshift",[i]),this.setData("showNoOption",!1)}else{this.getData("pickListValues")&&this.getData("pickListValues")[0]&&this.getData("pickListValues")[0].extra&&Lyte.arrayUtils(this.getData("pickListValues"),"shift"),t.some(function(e){return"true"!=e.getAttribute("selected")&&"true"!=e.getAttribute("data-extra")})?0!=t.length&&this.setData("showNoOption",!1):this.setData("showNoOption",!0)}}else 0==t.length?this.setData("showNoOption",!0):this.setData("showNoOption",!1)},addToList:function(e,t,o){var a=this.getData("pickListValues");if(this.isEmoji(o))return this.$node.querySelector("lyte-dropdown").toggle(),this.showAlert(_cruxUtils.getI18n("crm.field.valid.check",Lyte.Component.registeredHelpers.cruxEncodeHTML(e.field_label))),!1;if(void 0!=this.data.cxPropMaxCount&&this.getData("displayValue").length>=this.data.cxPropMaxCount){var r=this.$node.querySelector("lyte-dropdown");return(s=JSON.parse(r.ltProp("selected"))).pop(),r.ltProp("selected",JSON.stringify(s)),r.toggle(),this.showAlert(_cruxUtils.getI18n("crm.alert.maximum.text.values.contains",this.data.cxPropMaxCount)),!1}if(this.getMethods("onBeforeAdd")){var i=t.srcElement?"true"==t.srcElement.getAttribute("data-extra"):!!t.target&&"true"==t.target.getAttribute("data-extra");if(0==this.executeMethod("onBeforeAdd",o,this.getValue(),i)){if(!i){var s;(s=JSON.parse(this.$node.querySelector("lyte-dropdown").ltProp("selected"))).pop();var l=this.$node.querySelector("lyte-dropdown");l.ltProp("selected",JSON.stringify(s)),l.component.childComp.querySelector(".lyteDropdownSelection").classList.remove("lyteDropdownSelection"),t.target.classList.add("lyteDropdownSelection")}return!1}}for(var p=!1,n=-1,c=0;c<a.length;c++){if(a[c][this.getData("cxPropUserValue")]==o){n>-1?Lyte.arrayUtils(this.getData("displayValue"),"insertAt",n+1,a[c][this.getData("cxPropUserValue")]):Lyte.arrayUtils(this.getData("displayValue"),"unshift",a[c][this.getData("cxPropUserValue")]),this.extraVals[o.toLowerCase()]=!0,"true"==a[c].extra?Lyte.arrayUtils(this.getData("pickListValues"),"shift"):(this.origLen=this.origLen-1,document.querySelector("[data-extra='true']")&&Lyte.arrayUtils(this.getData("pickListValues"),"shift")),this.setData("showNoOption",0==this.origLen),p=!0;break}this.data.displayValue.length&&this.data.displayValue.indexOf(a[c][this.getData("cxPropUserValue")])>-1&&(n=this.data.displayValue.indexOf(a[c][this.getData("cxPropUserValue")]))}p||(Lyte.arrayUtils(this.getData("displayValue"),"push",o),this.extraVals[o.toLowerCase()]=!0,this.setData("showNoOption",0==this.origLen)),this.setData("placeholder",this.data.cxPropPlaceholder?this.data.cxPropPlaceholder:"filter"==this.data.cxPropFrom?_cruxUtils.getI18n("crm.label.filter.typehere"):"");var d="#search_";this.getData("cxPropId")&&(d+=this.getData("cxPropId")),d+="_"+Lyte.Component.registeredHelpers.cruxConvertStringToValidSelector(e.api_name),this.adding=!0,this.$node.querySelector(d).setValue(""),this.data.cxPropClearErrorMessage&&this.setData("cxPropErrorMessage",""),this.getMethods("onValueChange")&&this.executeMethod("onValueChange",this.getValue()),this.$node.querySelector("lyte-dropdown").classList.remove("lyteDropNoOptSelected"),this.preventClose=!0},removeFromList:function(e,t,o){for(var a=this.getData("displayValue"),r=!1,i=0;i<a.length;i++)if(a[i]==o){var s=Lyte.arrayUtils(this.getData("displayValue"),"removeAt",i),l="#search_";this.getData("cxPropId")&&(l+=this.getData("cxPropId")),l+="_"+Lyte.Component.registeredHelpers.cruxConvertStringToValidSelector(e.api_name),this.$node.querySelector(l).setValue("");for(var p=0;void 0!=this.getData("pickListValues")&&p<this.getData("pickListValues").length;p++)if(this.getData("pickListValues")[p][this.getData("cxPropUserValue")]==s[0]){"true"!=this.getData("pickListValues")[p].extra&&(this.origLen=this.origLen+1,r=!0);break}break}r||(this.extraVals[o.toLowerCase()]=!1),0==a.length&&this.setData("placeholder",this.data.cxPropPlaceholder?this.data.cxPropPlaceholder:"filter"==this.data.cxPropFrom?_cruxUtils.getI18n("crm.label.filter.typehere"):""),this.data.cxPropClearErrorMessage&&this.setData("cxPropErrorMessage",""),this.getMethods("onValueChange")&&this.executeMethod("onValueChange",this.getValue()),0==this.getData("displayValue").length&&this.$node.querySelector("lyte-dropdown").classList.add("lyteDropNoOptSelected"),this.setData("showNoOption",0==this.origLen),void 0==this.$node.querySelector("lyte-dropdown").component.childComp&&this.$node.querySelector("lyte-dropdown lyte-drop-button").click()},selectOption:function(e,t){"create"==this.data.cxPropFrom&&"single"==this.data.cxPropType&&"-None-"==t?this.$node.querySelector("lyte-dropdown").classList.add("cxNoneSelected"):this.$node.querySelector("lyte-dropdown").classList.remove("cxNoneSelected");for(var o=0;o<this.data.pickListValues.length;o++)this.data.pickListValues[o][this.data.cxPropUserValue]==t?this.data.pickListValues[o].cxPropSelected=!0:this.data.pickListValues[o].cxPropSelected&&delete this.data.pickListValues[o].cxPropSelected;if(this.setData("cxPropValue",t),this.getMethods("onOptionSelected"))return this.executeMethod("onOptionSelected",e,t);this.getData("cxPropClearErrorMessage")&&this.setData("cxPropErrorMessage",""),this.getMethods("onValueChange")&&this.executeMethod("onValueChange",this.getData("cxPropValue"))},openDropdown:function(e,t){if(this.data.cxPropReadonly)return!1;var o;if(this.getMethods("onBeforeShow")&&this.executeMethod("onBeforeShow",e,t,this),void 0==(o=this.getData("cxPropPicklistValues")?this.getData("cxPropPicklistValues"):137==this.data.cxPropField.ui_type?this.data.cxPropLayout?this.data.cxPropField[this.data.cxPropLayout].allowed_modules:this.data.cxPropField.allowed_modules:this.getData("cxPropLayout")?this.getData("cxPropField")[this.getData("cxPropLayout")].pick_list_values:this.getData("cxPropField").pick_list_values)||0==o.length){this.setData("showLoading",!0);var a="undefined"!=typeof moduleRecordMapping?moduleRecordMapping[this.data.cxPropModule].api_name:this.data.cxPropModule;store.findRecord("field",this.data.cxPropField.id,{module:a},!0).then(function(e){this.setData("cxPropField",e[0]),this.openDropdownFn(),this.setData("showLoading",!1)}.bind(this))}else this.openDropdownFn()},closeDropdown:function(e,t){var o=this.$node.querySelector("lyte-search");this.closing=!0,(o=o||this.$node.querySelector("lyte-dropdown").component.childComp.querySelector("lyte-search"))&&o.setValue(""),this.getMethods("onHide")&&this.executeMethod("onHide",e,t)},singleSearch:function(e){this.setData("showNoOption",0==e.length)},beforeHide:function(e){if(this.preventClose&&(this.preventClose=!1,e&&"scroll"==e.type))return!1},hideInfoTooltip:function(){var e=this.$node.querySelector(".cxCurrentHovercard");$L(e).removeClass("cxCurrentHovercard")},onSearchBoxFocused:function(e,t){var o=this.$node.querySelector("lyte-dropdown");"criteria"!=this.data.cxPropFrom||o.ltProp("isOpen")||o.open()}},openDropdownFn:function(){if(void 0==this.getData("pickListValues")||0==this.getData("pickListValues").length){var e;this.getData("cxPropPicklistValues")?e=this.getData("cxPropPicklistValues"):137==this.data.cxPropField.ui_type?(e=this.data.cxPropLayout?this.data.cxPropField[this.data.cxPropLayout].allowed_modules:this.data.cxPropField.allowed_modules,this.setData("cxPropUserValue","plural_label")):e=this.getData("cxPropLayout")?this.getData("cxPropField")[this.getData("cxPropLayout")].pick_list_values:this.getData("cxPropField").pick_list_values,e.length>=10&&this.setData("showSearchBox",!0),this.data.cxPropShowUnused||(e=e.filter(function(e){return"unused"!=e.type}));for(var t=e.map(function(e){return e[this.getData("cxPropUserValue")]}.bind(this)),o=t.slice(0),a=[],r=0,i=0,s=[],l=this.getData("displayValue");r<t.length;r++)if(-1===t[r].indexOf("-None-")||"create"==this.getData("cxPropFrom")){var p=e[o.indexOf(t[r])];s.indexOf(p[this.data.cxPropUserValue])<0&&(l&&l.indexOf(p[this.getData("cxPropUserValue")])>-1?(i+=1,p.cxPropSelected=!0):delete p.cxPropSelected,this.extraVals[p[this.getData("cxPropUserValue")].toLowerCase()]=!0,a.push(p),s.push(p[this.data.cxPropUserValue]))}this.setData("pickListValues",a),this.origLen=a.length-i,i==a.length&&"single"!=this.getData("cxPropType")&&this.setData("showNoOption",!0)}},validate:function(){var e,t=this.getData("cxPropField"),o=this.getValue();if("create"==this.getData("cxPropFrom"))return!!this.validateMandatory(!o||0==o.length||"-None-"==o)&&(this.setData("cxPropErrorMessage",""),!0);if(!o||0==o.length)return this.showAlert(_cruxUtils.getI18n("crm.field.valid.check",Lyte.Component.registeredHelpers.cruxEncodeHTML(t.field_label))),!1;var a=o.length;for(e=0;e<a;e++)if(o[e].replace(/^\s+/g,"").replace(/\s+$/g,"").indexOf("*")>-1)return this.showAlert(_cruxUtils.getI18n("crm.alert.character.not.allowed","*")),!1;return!0},getValue:function(e){var t=this.getData("displayValue");if("single"==this.getData("cxPropType")){if(e==this.getData("cxPropSystemValue"))if((s=(r=(o=this.data.cxPropPicklistValues?this.data.cxPropPicklistValues:this.getData("cxPropLayout")?this.getData("cxPropField")[this.getData("cxPropLayout")].pick_list_values:this.getData("cxPropField").pick_list_values).map(function(e){return e[this.getData("cxPropUserValue")]}.bind(this))).indexOf(this.getData("cxPropValue")))>-1)return o[s][this.getData("cxPropSystemValue")];return this.getData("cxPropValue")}if(e==this.getData("cxPropSystemValue")){for(var o,a=[],r=(o=this.getData("cxPropLayout")?this.getData("cxPropField")[this.getData("cxPropLayout")].pick_list_values:this.getData("cxPropField").pick_list_values).map(function(e){return e[this.getData("cxPropUserValue")]}.bind(this)),i=0;i<t.length;i++){var s;(s=r.indexOf(t[i]))>-1&&a.push(o[s][this.getData("cxPropSystemValue")])}return a}return t},setColorCodeDatas:function(){var e,t=this.getData("cxPropFrom");this.getData("cxPropPicklistValues")?e=this.getData("cxPropPicklistValues"):this.getData("cxPropLayout")?e=this.getData("cxPropField")[this.getData("cxPropLayout")].pick_list_values:this.getData("cxPropField").pick_list_values&&(e=this.getData("cxPropField").pick_list_values);var o=this.getData("cxPropValue"),a=null,r=null;null!=o&&((r=e.filter(function(e){return e.display_value==o||e.display_label==o})).length<1&&this.data.cxPropField.pick_list_values&&(r=this.data.cxPropField.pick_list_values.filter(function(e){return e.display_value==o||e.display_label==o})),a=r.length>=1?r[0].colour_code:"#ffffff",this.setData("propDefaultColorCode",a));if("view"==t)if(null!=o&&"-None-"!==o){var i="black";if(a&&""!==a&&0===a.indexOf("#")){var s=a.substring(1);(299*parseInt(s.substr(0,2),16)+587*parseInt(s.substr(2,2),16)+114*parseInt(s.substr(4,2),16))/1e3<175&&(i="white")}var l="background-color:"+a+";color:"+i;"#ffffff"===a&&(l+=";border: 1px solid #C9C9C9"),this.setData("propColorStyleObj",l),this.setData("pkColorEnabledClass","colorAppliedPicklist")}else this.setData("propColorStyleObj",""),this.setData("pkColorEnabledClass","colorAppliedPicklist colorAppliedPKNone");else"create"==t&&(null==this.getData("cxPropValue")||""==this.getData("cxPropValue")||r&&r.length>=1&&"-None-"==r[0].actual_value?this.setData("pkColorEnabledClass","colorEnabledPicklist colorEnabledPKNone"):this.setData("pkColorEnabledClass","colorEnabledPicklist"))},observeField:function(){if("view"!=this.getData("cxPropFrom")&&this.getData("cxPropValue")){var e=this.getData("cxPropValue");if("single"==this.getData("cxPropType"))this.setData("cxPropDisplayValue",e),this.setData("displayValue",[e]);else{-1==e.indexOf("[")?(this.setData("cxPropValue",'["'+e+'"]'),e=[e]):e=JSON.parse(e);var t=e.length?[e[0]]:[],o=e.length?[e[0].toLowerCase().trim()]:[],a=0,r=[];this.data.pickListValues&&(r=this.data.pickListValues.map(function(e){return e.display_value}));for(var i=0;i<e.length;i++)i>0&&-1==o.indexOf(e[i].toLowerCase().trim())&&(t.push(e[i]),o.push(e[i].toLowerCase().trim())),r.indexOf(e[i])>-1&&a++;this.setData("displayValue",t),r.length&&(this.origLen=r.length-a),this.setData("showNoOption",0==this.origLen),"create"==this.getData("cxPropFrom")||this.getData("cxPropPlaceholder")?0==t.length?this.setData("placeholder",this.getData("cxPropPlaceholder")?this.getData("cxPropPlaceholder"):_cruxUtils.getI18n("None")):this.setData("placeholder",""):this.setData("placeholder",_cruxUtils.getI18n("crm.label.filter.typehere"))}}void 0!=this.getData("cxPropValue")&&""!=this.getData("cxPropValue")||this.setData("displayValue",[]),"view"==this.data.cxPropFrom&&(this.data.cxPropValue?this.data.cxPropMaskingProperties?this.setData("viewValue",Lyte.Component.registeredHelpers.cruxMaskValue(this.data.cxPropValue,this.data.cxPropMaskingProperties)):"single"!=this.data.cxPropType&&-1!=this.data.cxPropValue.indexOf("[")&&this.testParse(this.data.cxPropValue)?this.setData("viewValue",JSON.parse(this.data.cxPropValue).join("; ")):this.setData("viewValue",this.data.cxPropValue):this.data.cxPropEmptyValue&&this.setData("viewValue",this.data.cxPropEmptyValue)),!this.getData("cxPropIsColorCodeEnabled")||"create"!==this.data.cxPropFrom&&"view"!==this.data.cxPropFrom||this.setColorCodeDatas()}.observes("cxPropValue","cxPropMaskingProperties","cxPropFrom").on("init"),testParse:function(e){try{return JSON.parse(e),!0}catch(e){return!1}},init:function(){var e=this.getData("cxPropFrom");if("filter"==e&&void 0==this.getData("cxPropMaxCount")&&this.setData("cxPropMaxCount",50),"view"==e){if(999==this.getData("cxPropField").ui_type){var t=JSON.parse(this.getData("cxPropValue"));this.data.cxPropValue=t.join(", ")}}else"create"!=e||this.getData("cxPropType")?this.getData("cxPropType")&&"multiple"!=this.getData("cxPropType")||(this.data.cxPropType="multisearch"):this.data.cxPropType="single";this.getData("cxPropPlaceholder")&&(this.data.placeholder=this.getData("cxPropPlaceholder")),"create"==e&&(this.setData("cxPropDisableExtraValue",!0),"single"==this.data.cxPropType&&!this.data.cxPropPlaceholder&&this.data.cxPropField.pick_list_values&&this.data.cxPropField.pick_list_values[0]&&"-None-"==this.data.cxPropField.pick_list_values[0].actual_value&&(this.data.placeholder=this.data.cxPropField.pick_list_values[0].display_value),this.setFocusUtil()),this.getData("cxPropZcqaSelector")||this.setData("cxPropZcqaSelector",this.getData("cxPropUserValue")),this.getData("cxPropIsColorCodeEnabled")&&this.setColorCodeDatas(),this.extraVals={}},observeErrorMessage:function(){this.setData("isError",""!=this.getData("cxPropErrorMessage"))}.observes("cxPropErrorMessage").on("init"),actions:{searchBoxClicked:function(){if(this.getMethods("onSearchBoxClick")&&0==this.executeMethod("onSearchBoxClick",this.$node.querySelector("lyte-input")))return!1;if(1==this.$node.querySelector("lyte-dropdown").ltProp("isOpen"))return this.$node.querySelector("lyte-search").querySelector("input").value&&this.$node.querySelector("lyte-search").setValue(""),!1},preventDefault:function(e,t){13==t.keyCode&&t.preventDefault()},setToolTip:function(e){e.offsetWidth<e.scrollWidth?e.setAttribute("lt-prop-title",e.textContent):e.setAttribute("lt-prop-title","")},showInfoTooltip:function(e){this.showHideInfoTooltip(e)}},extraVals:{},observesdidConnect:function(){"view"!=this.getData("cxPropFrom")&&(this.$node.toggle=function(){this.querySelector("lyte-dropdown").toggle()}),"create"==this.data.cxPropFrom&&"single"==this.data.cxPropType&&this.$node.querySelector("lyte-dropdown")&&("-None-"==this.getData("cxPropValue")?this.$node.querySelector("lyte-dropdown").classList.add("cxNoneSelected"):this.$node.querySelector("lyte-dropdown").classList.remove("cxNoneSelected"))}.observes("lyteViewPort").on("didConnect"),observeMandatory:function(){this.observeMandatoryMixin("lyte-dropdown")}.observes("cxPropField.required","lyteViewPort").on("didConnect"),observePicklistValues:function(e){e.insertedItems&&!e.insertedItems[0].extra&&this.origLen++}.observes("pickListValues.[]"),observeZcqa:function(){"create"==this.getData("cxPropFrom")&&"single"==this.getData("cxPropType")&&this.$node.querySelector("lyte-drop-button")&&!this.getData("cxPropDropdownZcqa")&&this.$node.querySelector("lyte-drop-button").setAttribute("data-zcqa",this.getData("cxPropZcqa"))}.observes("cxPropZcqa","lyteViewPort").on("didConnect"),observePicklistValues_1:function(){this.setData("pickListValues",void 0)}.observes("cxPropPicklistValues","cxPropField.pick_list_values"),openDropdownObserver:function(){this.getData("cxPropOpenDropdown")&&setTimeout(function(){this.$node.querySelector("lyte-dropdown").open()}.bind(this),100)}.observes("cxPropOpenDropdown"),observeField_new:function(){this.$node.querySelector(".cxDropbox")&&this.$node.querySelector(".cxDropbox").classList.add("search"+this.getData("cxPropField").column_name),"create"!=this.data.cxPropFrom||"single"!=this.data.cxPropType||this.getData("cxPropValue")||this.getData("cxPropPlaceholder")||this.data.cxPropField.pick_list_values&&this.data.cxPropField.pick_list_values[0]&&"-None-"!=this.data.cxPropField.pick_list_values[0].actual_value&&(this.setData("cxPropDisplayValue",this.data.cxPropField.pick_list_values[0].display_value),this.setData("cxPropValue",this.data.cxPropField.pick_list_values[0].display_value))}.observes("cxPropField","lyteViewPort").on("didConnect"),observeField_new:function(){this.$node.querySelector("lyte-dropdown")&&(this.data.isError?this.$node.querySelector("lyte-dropdown").classList.add("cxErrorBox"):this.$node.querySelector("lyte-dropdown").classList.remove("cxErrorBox"))}.observes("isError","lyteViewPort").on("didConnect"),observePlaceholder:function(){this.setData("placeholder",this.getData("cxPropPlaceholder"))}.observes("cxPropPlaceholder"),observeDisabled:function(){"create"==this.data.cxPropFrom&&this.setData("tooltip",this.data.cxPropTooltip?this.data.cxPropTooltip:this.data.cxPropDisabled?_cruxUtils.getI18n("crm.lable.read.only"):"")}.observes("cxPropDisabled").on("init")},{mixins:["crux-element-validation"]}),Lyte.Component.registerHelper("cruxConvertStringToValidSelector",function(e){return e?(e.cruxFindAllIndexOf("$").forEach(function(t){e=e.cruxReplaceIndex(t,"_")}),e.replace(new RegExp("->","g"),"_").replace(new RegExp("[/.]","g"),"_")):""}),Lyte.Component.register("crux-tag-component",{_template:'<template tag-name="crux-tag-component"> <template is="switch" value="{{cxPropFrom}}"><template case="view"><template is="if" value="{{expHandlers(cxPropValue,\'&amp;&amp;\',cxPropValue.length)}}"><template case="true"> <ul id="{{cxPropId}}" class="listview_taglists w230 m0"> <template is="for" items="{{listValues}}" item="val" index="index"> <li style="background: {{if(ifEquals(val.color_code,\'noFill\'),\'transparent\',concat(val.color_code,\' !important;\'))}}; color : {{cruxGetPicklistFontColor(val.color_code)}}; display : {{if(val.hide,\'none;\',\'\')}}" lt-prop-title="{{if(val.showTooltip,val.name,if(cruxAnd(cxPropTooltip,ifNotEquals(cxPropTooltip,\'true\')),cxPropTooltip,\'\'))}}" lt-prop-tooltip-config="{{tooltipConfig}}" lt-prop-tooltip-class="lvTooltipClass" class="tagElementList f13 cxAddedTags dIB {{concat(\'cxTag\',cruxGetTagColorIndex(val.color_code))}} {{if(cxPropTriggerTagClick,\'cP\',\'\')}}" onclick="{{action(\'tagsTransition\',val)}}"><span class="{{if(val.showTooltip,\'cruxTagTitle\',\'\')}}">{{val.name}}</span></li> </template> <template is="if" value="{{showMoreForMaxCount}}"><template case="true"> <li class="moreTagOption dIB vam p0 mB7 mR3 f15 col666"> <span class="eventNone disable">{{cruxGetI18n(\'and\')}}</span> <span class="moreCount cP uline1" onclick="{{action(\'showMoreTags\')}}"> {{showMore}} {{cruxGetI18n(\'crm.label.More\')}}</span> </li> </template></template> </ul> <template is="if" value="{{cxPropViewInfoTooltip}}"><template case="true"> <crux-view-info-tooltip cx-prop-field="{{cxPropField}}" cx-prop-value="{{cxPropValue}}"> <template is="yield" yield-name="viewInfoTooltipYield"> <lyte-yield yield-name="viewInfoTooltipYield" prop-field="{{propField}}" prop-value="{{propValue}}"></lyte-yield> </template> </crux-view-info-tooltip> </template></template> </template><template case="false">{{cxPropEmptyValue}}</template></template></template><template case="filter"></template><template case="criteria"> <lyte-dropdown id="{{cxPropId}}" lt-prop-boundary="{{cxPropBoundary}}" lt-prop-yield="true" lt-prop-type="multisearch" lt-prop-tabindex="1" on-add="{{method(\'addToList\')}}" on-remove="{{method(\'removeFromList\')}}" on-before-show="{{method(\'openDropdown\')}}" lt-prop-selected="{{lbind(selectedIds)}}" on-hide="{{method(\'closeDropdown\')}}" class="{{if(ifEquals(cxPropAppearance,\'flat\'),\'cxFlatDropdown\',\'cxBoxDropdown\')}} " on-before-hide="{{method(\'beforeHide\')}}"> <template is="registerYield" yield-name="yield"> <lyte-drop-button data-zcqa="{{cxPropZcqa}}"> <ul class="lyteMultipleSelect"> <template is="for" items="{{cxPropValue}}" item="tag" index="index"> <li data-value="{{tag.id}}"> <span class="lyteDropdownVisible" onmouseenter="{{action(\'setToolTip\',this)}}">{{tag.name}}</span> <lyte-drop-remove class="lyteCloseIcon"></lyte-drop-remove> </li> </template> <li class="lyteMultiselectInput"> <lyte-search class="w100per" lt-prop-type="text" lt-prop-query-selector="{&quot;scope&quot;:&quot;.parentscope_{{cxPropId}}_{{cruxReplace(cruxReplace(cxPropField.api_name,&quot;->&quot;,&quot;_&quot;),&quot;[/.]&quot;,&quot;_&quot;)}}&quot;, &quot;target&quot;:&quot;.cruxTagList&quot;, &quot;search&quot;:&quot;lyte-drop-item&quot;}" on-search="{{method(\'showNoResult\')}}" id="search_Tag" lt-prop-placeholder="{{placeholder}}" on-focus="{{method(\'onSearchBoxFocused\')}}" onclick="{{action(\'searchBoxClicked\')}}" onkeydown="{{action(\'preventDefault\',this,event)}}"></lyte-search> </li> </ul> </lyte-drop-button> <lyte-drop-box class="cxDropbox"> <lyte-drop-body class="parentscope_{{cxPropId}}_{{cruxReplace(cruxReplace(cxPropField.api_name,&quot;->&quot;,&quot;_&quot;),&quot;[/.]&quot;,&quot;_&quot;)}}"> <template is="for" items="{{tags}}" item="tag" index="ind"> <lyte-drop-item class="picklist_values cruxTagList" data-value="{{tag.id}}" data-zcqa="{{concat(cxPropField[cxPropFieldKey],\'_\',tag.name)}}"> <span>{{tag.name}}</span> </lyte-drop-item> </template> <template is="if" value="{{expHandlers(tagsLength,\'!\')}}"><template case="true"> <div class="cxDropdownNoResult picklist_values lyteDropdown-disabled" style="padding : 6px 25px !important;">{{cruxGetI18n(\'crm.label.no.options.found\')}}</div> </template></template> </lyte-drop-body> </lyte-drop-box> </template> </lyte-dropdown> </template></template> </template>',_dynamicNodes:[{type:"attr",position:[1]},{type:"switch",position:[1],cases:{view:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"for",position:[1,1],dynamicNodes:[{type:"attr",position:[1],attr:{style:{name:"style",helperInfo:{name:"concat",args:["'background: '",{type:"helper",value:{name:"if",args:[{type:"helper",value:{name:"ifEquals",args:["val.color_code","'noFill'"]}},"'transparent'",{type:"helper",value:{name:"concat",args:["val.color_code","' !important;'"]}}]}},"'; color : '",{type:"helper",value:{name:"cruxGetPicklistFontColor",args:["val.color_code"]}},"'; display : '",{type:"helper",value:{name:"if",args:["val.hide","'none;'","''"]}}]}}}},{type:"attr",position:[1,0]},{type:"text",position:[1,0,0]}]},{type:"attr",position:[1,3]},{type:"if",position:[1,3],cases:{true:{dynamicNodes:[{type:"text",position:[1,1,0]},{type:"attr",position:[1,3]},{type:"text",position:[1,3,1]},{type:"text",position:[1,3,3]}]}},default:{}},{type:"attr",position:[3]},{type:"if",position:[3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"insertYield",position:[1]}]},{type:"componentDynamic",position:[1]}]}},default:{}}]},false:{dynamicNodes:[{type:"text",position:[0]}]}},default:{}}]},filter:{dynamicNodes:[],additional:{next:"criteria"}},criteria:{dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1,1]},{type:"for",position:[1,1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"text",position:[1,1,0]},{type:"componentDynamic",position:[1,3]}]},{type:"attr",position:[1,1,3,1]},{type:"componentDynamic",position:[1,1,3,1]},{type:"componentDynamic",position:[1]},{type:"attr",position:[3,1]},{type:"attr",position:[3,1,1]},{type:"for",position:[3,1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,1,0]},{type:"componentDynamic",position:[1]}]},{type:"attr",position:[3,1,3]},{type:"if",position:[3,1,3],cases:{true:{dynamicNodes:[{type:"text",position:[1,0]}]}},default:{}},{type:"componentDynamic",position:[3,1]},{type:"componentDynamic",position:[3]}]},{type:"componentDynamic",position:[1]}]}},default:{}}],_observedAttributes:["lyteViewPort","cxPropValue","cxPropFrom","cxPropModule","tags","value","tagsLength","disabledList","selectedIds","cxPropZcqa","placeholder","cxPropIgnoreEmptyValue","cxPropField","cxPropFieldKey","showMore","valueObj","valueObj","listValues","cxPropAppearance","cxPropBoundary","cxPropId","lyteUnbound","cxPropClass","cxPropClipMode","cxPropWidth","cxPropTooltip","tooltipConfig","cxPropViewInfoTooltip","cxPropTriggerTagClick","cxPropMaxCount","showMoreForMaxCount","cxPropEmptyValue"],data:function(){return{lyteViewPort:Lyte.attr("boolean",{default:!1}),cxPropValue:Lyte.attr("array",{default:[]}),cxPropFrom:Lyte.attr("string",{default:"view"}),cxPropModule:Lyte.attr("string"),tags:Lyte.attr("array"),value:Lyte.attr("array",{default:[]}),tagsLength:Lyte.attr("boolean",{default:!0}),disabledList:Lyte.attr("array",{default:["cruxDisabled"]}),selectedIds:Lyte.attr("array",{default:[]}),cxPropZcqa:Lyte.attr("string"),placeholder:Lyte.attr("string",{default:_cruxUtils.getI18n("None")}),cxPropIgnoreEmptyValue:Lyte.attr("boolean",{default:!1}),cxPropField:Lyte.attr("object",{default:{}}),cxPropFieldKey:Lyte.attr("string",{default:""}),showMore:Lyte.attr("number",{default:0}),valueObj:Lyte.attr("array",{default:[]}),valueObj:Lyte.attr("array",{default:[]}),listValues:Lyte.attr("array",{default:[]}),cxPropAppearance:Lyte.attr("string",{default:"flat"}),cxPropBoundary:Lyte.attr("object",{default:{}}),cxPropId:Lyte.attr("string",{default:""}),lyteUnbound:Lyte.attr("boolean",{default:!1}),cxPropClass:Lyte.attr("string",{default:""}),cxPropClipMode:Lyte.attr("boolean",{default:!1}),cxPropWidth:Lyte.attr("string",{default:"230px"}),cxPropTooltip:Lyte.attr("string"),tooltipConfig:Lyte.attr("object",{default:{appearance:"box"}}),cxPropViewInfoTooltip:Lyte.attr("boolean",{default:!1}),cxPropTriggerTagClick:Lyte.attr("boolean",{default:!1}),cxPropMaxCount:Lyte.attr("number",{default:0}),showMoreForMaxCount:Lyte.attr("boolean",{default:!0}),cxPropEmptyValue:Lyte.attr("string")}},init:function(){this.data.placeholder="filter"==this.data.cxPropFrom?_cruxUtils.getI18n("crm.label.filter.typehere"):"",this.$node.resize=this.resize.bind(this),this.preventToggle=!1},methods:{addToList:function(e,t,o){var a=this.data.tags,r=a.filter(function(e){return e.id==t})[0];Lyte.arrayUtils(this.data.cxPropValue,"push",{id:r.id,name:r.name,color_code:r.color_code}),(a.length==JSON.parse(o).length||this.$node.querySelector("lyte-dropdown").component.childComp.querySelectorAll(".lyteDropdownActive").length>1&&this.$node.querySelector("lyte-search").ltProp("value"))&&this.setData("tagsLength",!1),this.setData("placeholder","filter"==this.data.cxPropFrom?_cruxUtils.getI18n("crm.label.filter.typehere"):""),this.getMethods("onValueChange")&&this.executeMethod("onValueChange",this.getValue()),this.$node.querySelector("lyte-search").setValue(""),this.preventClose=!0},removeFromList:function(e,t){for(var o,a=this.data.cxPropValue,r=0;r<a.length;r++)if(a[r].id==t){o=r;break}Lyte.arrayUtils(this.data.cxPropValue,"removeAt",o,1),this.setData("tagsLength",!0),0==a.length&&this.setData("placeholder",_cruxUtils.getI18n("None")),this.getMethods("onValueChange")&&this.executeMethod("onValueChange",this.getValue())},showNoResult:function(e){this.preventToggle?this.preventToggle=!1:(void 0==this.$node.querySelector("lyte-dropdown").component.childComp||this.$node.querySelector("lyte-dropdown").component.childComp.classList.contains("lyteDropdownHidden"))&&this.$node.querySelector("lyte-dropdown").toggle();for(var t=0;t<e.length;t++)if(!e[t].classList.contains("lyteDropdownActive"))return void this.setData("tagsLength",!0);this.setData("tagsLength",!1)},openDropdown:function(){if(this.getMethods("onBeforeShow")&&this.executeMethod("onBeforeShow",arguments[0],arguments[1]),void 0==this.data.tags){if(this.requestFired)return!1;var e="undefined"!=typeof moduleRecordMapping?moduleRecordMapping[this.data.cxPropModule].api_name:this.data.cxPropModule;return this.requestFired=!0,store.findAll("tag",{module:e,fromPage:"view"},!0).then(function(t){this.requestFired=!1,this.setData("tags",store.peekAll("tag").filterBy({module_name:e}).sortBy("name")),this.setSelected(),this.$node.querySelector("lyte-dropdown").open()}.bind(this)),!1}},closeDropdown:function(){""!=this.$node.querySelector("lyte-search").ltProp("value")&&(this.preventToggle=!0,this.$node.querySelector("lyte-search").setValue(""),this.$node.querySelector("lyte-search").blur())},beforeHide:function(e){if(this.preventClose&&(this.preventClose=!1,e&&"scroll"==e.type))return!1},onSearchBoxFocused:function(e,t){var o=this.$node.querySelector("lyte-dropdown");"criteria"!=this.data.cxPropFrom||o.ltProp("isOpen")||o.open()},onSearchBoxBlured:function(e,t){var o=this.$node.querySelector("lyte-dropdown");"criteria"==this.data.cxPropFrom&&o.ltProp("isOpen")&&setTimeout(()=>{this.preventClose?this.preventClose=!1:o.close()},300)}},getValue:function(){return this.data.cxPropValue},validate:function(){return!!(void 0!=this.data.cxPropValue&&0!=this.data.cxPropValue.length||this.data.cxPropIgnoreEmptyValue)||(this.showAlert(_cruxUtils.getI18n("crm.field.valid.check",Lyte.Component.registeredHelpers.cruxEncodeHTML(this.data.cxPropField.field_label))),!1)},actions:{searchBoxClicked:function(){if(1==this.$node.querySelector("lyte-dropdown").ltProp("isOpen"))return this.$node.querySelector("lyte-search").querySelector("input").value&&this.$node.querySelector("lyte-search").setValue(""),!1},showMoreTags:function(){this.data.cxPropClipMode?this.mouseOverFn():this.clickFn()},preventDefault:function(e,t){13==t.keyCode&&t.preventDefault()},setToolTip:function(e){e.offsetWidth<e.scrollWidth?e.setAttribute("title",e.textContent):e.setAttribute("title","")},hideMoreTags:function(){this.hideTags()},tagsTransition:function(e){if(this.data.cxPropTriggerTagClick){var t=moduleRecordMapping?moduleRecordMapping[this.data.cxPropModule].custom_view.id:"",o=Lyte.Router.getURL({route:"crm.tab.module.custom-view.list",dynamicParams:[this.data.cxPropModule,t],queryParams:{filters:JSON.stringify({field:{id:"",api_name:"Tag"},comparator:"equal",value:[e]})}});window.open(o,"_blank")}}},setSelected:function(){var e=this.getData("tags");if(void 0!=e){this.getData("cxPropValue")||this.setData("cxPropValue",[]);var t=this.getData("cxPropValue").map(function(e){return e.id});this.setData("selectedIds",t),0!=e.length&&e.length!=t.length||this.setData("tagsLength",!1),this.$node.querySelector("lyte-dropdown").ltProp("selected",t)}},hideCount:0,findRowAndCallFixHeight:function(e){var t=document.querySelector("lyte-expresstable");if(t){for(;e&&"LYTE-EXPTABLE-TR"!=e.nodeName;)e=e.parentElement;e&&t.fixRowHeight(e)}},observeValue:function(e){"view"==this.data.cxPropFrom&&this.data.cxPropValue&&this.data.cxPropValue.length&&(e&&"change"==e.type&&"cxPropClipMode"==e.item?this.setValueFn1({cxPropClipMode:this.data.cxPropClipMode}):this.setValueFn1())}.observes("cxPropValue","cxPropClipMode").on("init"),observeValue1:function(){if("view"==this.data.cxPropFrom&&this.getData("cxPropValue"))if(this.getData("cxPropValue")&&this.getData("cxPropClipMode")){document.documentMode||/Edge/.test(navigator.userAgent);var e=0,t=0,o=-1;document.createElement("canvas");this.windowOuterWidth=window.outerWidth;var a=this.getData("cxPropWidth");a=a.split("px")[0],a-=105;var r=document.createElement("li");r.classList.add("tagElementList","f13","dIB","cxAddedTags"),document.body.appendChild(r);for(var i=0;i<this.getData("cxPropValue").length;i++){r.innerText=this.getData("cxPropValue")[i].name;var s=r.offsetWidth;if((e+=s+15)>a){if(1==t||this.getData("cxPropClipMode")){o=i;break}e=s+17,t=1}}r.remove();var l=0;this.hiddenElem=o;for(i=o;i>-1&&i<this.getData("cxPropValue").length;i++)this.getData("cxPropValue")[i].hide=!0,l++;this.setData("listValues",this.getData("cxPropValue")),this.remainingValues=this.getData("cxPropValue").slice(o),l>0&&this.setData("showMore",l)}else this.getData("cxPropValue")&&!this.getData("cxPropClipMode")&&this.setData("listValues",this.getData("cxPropValue"))},hideTags:function(){var e=this;clearTimeout(this.hideTimeout),this.hideTimeout=setTimeout(function(){var t=document.getElementById("cxTagPopover");t&&t.remove(),e.$node.querySelector("ul").classList.remove("cxPropOnFocusTag")},100)},resize:function(e){this.setValueFn1(e)},resize1:function(e){var t=void 0!=e.cxPropClipMode?e.cxPropClipMode:this.getData("cxPropClipMode");if(this.getData("cxPropValue")&&t){document.documentMode||/Edge/.test(navigator.userAgent);var o=0,a=0,r=-1;document.createElement("canvas");this.windowOuterWidth=window.outerWidth;var i=(e=e||{}).cxPropWidth?e.cxPropWidth:"230px";this.setData("cxPropWidth",i),i=i.split("px")[0],i-=105,(d=document.createElement("li")).classList.add("tagElementList","f13","dIB","cxAddedTags"),document.body.appendChild(d);for(var s=0;s<this.getData("cxPropValue").length&&t;s++){d.innerText=this.getData("cxPropValue")[s].name;var l=d.offsetWidth;if((o+=l+15)>i){if(1==a||t){r=s;break}o=l+17,a=1}}d.remove();var p=r,n=this.$node.querySelectorAll("li");if(this.hiddenElem<r&&this.hiddenElem>0||r<0){p<0&&(p=this.getData("cxPropValue").length);for(s=this.hiddenElem;s<p&&this.hiddenElem>=0;s++)n[s].style.display=""}else for(s=r;s<this.getData("cxPropValue").length;s++)n[s].style.display="none";var c=this.$node.querySelector(".uline1");r<0?this.$node.querySelector(".moreTagOption")&&(this.$node.querySelector(".moreTagOption").style.display="none"):(this.$node.querySelector(".moreTagOption")&&(this.$node.querySelector(".moreTagOption").style.display=""),c&&(c.innerText=" "+(this.getData("cxPropValue").length-r)+" "+_cruxUtils.getI18n("crm.label.More"))),t?(this.remainingValues=this.getData("cxPropValue").slice(r),c&&(c.removeAttribute("click"),c.addEventListener("mouseover",this.mouseOverEvent),c.addEventListener("mouseleave",this.mouseLeaveEvent),c.removeEventListener("click",this.clickEvent))):c&&(c.removeAttribute("mouseover"),c.removeAttribute("mouseleave"),c.removeEventListener("mouseover",this.mouseOverEvent),c.removeEventListener("mouseleave",this.mouseLeaveEvent),c.addEventListener("click",this.clickEvent)),this.hiddenElem=r}else if(this.data.cxPropValue&&!t){var d=this.$node.querySelectorAll("li");for(s=0;s<d.length;s++)d[s].style.display="";var u=this.$node.querySelector(".moreTagOption");u&&(u.style.display="none")}},mouseOverFn:function(){if(this.getMethods("onBeforeShowMoreTags")&&0==this.executeMethod("onBeforeShowMoreTags"))return!1;var e=document.getElementById("cxTagPopover"),t=this.$node.querySelector("ul");t.classList.contains("cxPropOnFocusTag")||(clearTimeout(this.newTimer),this.newTimer=setTimeout(function(){t.classList.add("cxPropOnFocusTag"),e?(e.setData("remainingValues",this.remainingValues),e.querySelector("lyte-popover").setData("ltPropShow",!0)):Lyte.Component.render("crux-tag-popover",{remainingValues:this.remainingValues,id:"cxTagPopover"},"body")}.bind(this),20))},didConnect:function(){this.mouseOverEvent=this.mouseOverFn.bind(this),this.mouseLeaveEvent=this.hideTags.bind(this),this.clickEvent=this.clickFn.bind(this)},clickFn:function(){for(var e=this.$node.querySelectorAll(".tagElementList"),t=this.hideCount;t<e.length;t++)e[t].style.display="";this.$node.querySelector(".moreTagOption").style.display="none",this.findRowAndCallFixHeight(this.$node),this.getMethods("onShowMoreTags")&&this.executeMethod("onShowMoreTags"),this.hiddenElem=this.getData("cxPropValue").length,event.stopPropagation()},setValueFn:function(e){var t=0,o=!1;e&&(o=!0,this.setData("cxPropClipMode",void 0!=e.cxPropClipMode?e.cxPropClipMode:this.data.cxPropClipMode),this.setData("cxPropWidth",e.cxPropWidth?e.cxPropWidth:this.data.cxPropWidth));var a,r,i=[];o?r=this.$node.querySelectorAll(".tagElementList"):((a=document.createElement("li")).classList.add("tagElementList","f12","bR2","dIB","bdr1px","pL20"),document.body.appendChild(a));var s=0,l=!1,p=this.data.cxPropWidth;try{p=p.split("px")[0]}catch(e){p=230}this.data.cxPropClipMode&&1!=this.data.cxPropValue.length?p-=130:p-=60;for(var n=0,c=0;c<this.data.cxPropValue.length;c++){var d;if(l)this.data.cxPropValue[c].hide=!0,o&&(r[c].style.display="none"),t++,i.push(this.data.cxPropValue[c]);else delete this.data.cxPropValue[c].hide,delete this.data.cxPropValue[c].showTooltip,delete this.data.cxPropValue[c].showTooltipWidth,o?(r[c].style.display="",r[c].querySelector("span").style.width="",r[c].setAttribute("lt-prop-title",""),r[c].querySelector("span").classList.remove("cruxTagTitle"),d=r[c].offsetWidth,d+=21):(a.innerText=this.data.cxPropValue[c].name,d=a.offsetWidth+15),(s+=d)+20>p?(this.data.cxPropClipMode?l=!0:s=0,this.data.cxPropClipMode&&c>0&&c==this.data.cxPropValue.length-1&&(p+=60),this.data.cxPropValue[c].showTooltip=!0,p-n<d-20&&(this.data.cxPropValue[c].showTooltipWidth=p-n-7+"px"),o&&p-n<d-20&&(r[c].setAttribute("lt-prop-title",r[c].innerText),r[c].querySelector("span").style.width=p-n-7+"px",r[c].querySelector("span").classList.add("cruxTagTitle")),n=0):n+=d}o||a.remove(),this.setData("showMore",t),this.setData("listValues",this.data.cxPropValue),o&&(t>0?(this.$node.querySelector(".moreTagOption").style.display="",this.$node.querySelector(".uline1").innerText=" "+t+" "+_cruxUtils.getI18n("crm.label.More")):this.$node.querySelector(".moreTagOption").style.display="none"),this.remainingValues=i},setValueFn1:function(e){var t=!1;if(e)t=!0,this.setData("cxPropClipMode",void 0!=e.cxPropClipMode?e.cxPropClipMode:this.data.cxPropClipMode),this.setData("cxPropWidth",e.cxPropWidth?e.cxPropWidth:this.data.cxPropWidth);else if(this.data.cxPropMaxCount){var o=this.data.cxPropValue.slice(0);this.remainingValues=[];for(var a=this.data.cxPropMaxCount;a<o.length;a++)o[a].hide=!0,this.remainingValues.push(o[a]);this.setData("listValues",o),this.setData("showMore",this.data.cxPropValue.length-this.data.cxPropMaxCount),this.setData("showMoreForMaxCount",this.data.showMore>0)}else this.setData("listValues",this.data.cxPropValue);this.extraWidth=20,this.data.cxPropMaxCount||$L.fastdom.measure(function(){var e=this.$node.querySelectorAll("li");if(!t){this.widths=[];for(var o=0;o<e.length-1;o++)this.widths.push(e[o].offsetWidth+this.extraWidth)}var a=this.data.cxPropWidth;try{a=Number.parseInt(a.split("px")[0]),a-=25}catch(e){a=230}230!=a&&this.$node.querySelector("ul").classList.remove("w230");var r=0,i=0;this.data.cxPropClipMode&&1!=this.data.cxPropValue.length?a-=85:a-=20,$L.fastdom.mutate(function(){for(var o=0;o<this.widths.length;o++)if(r+=this.widths[o],this.data.cxPropClipMode&&o==this.widths.length-1&&(a+=72),r>a){var s=e[o].textContent[0]===e[o].textContent[0].toLowerCase()?20:24;if(a-i>=s+this.extraWidth){var l=this.widths[o]-this.extraWidth-7,p=a-i-this.extraWidth-7;e[o].style.display="",e[o].setAttribute("lt-prop-title",e[o].textContent),e[o].querySelector("span").style.width=(p>l?l:p)+"px",e[o].querySelector("span").classList.add("cruxTagTitle")}else this.data.cxPropClipMode?o--:(e[o].style.display="",e[o].setAttribute("lt-prop-title",""),e[o].querySelector("span").style.width="",e[o].querySelector("span").classList.remove("cruxTagTitle"),i+=this.widths[o]);if(this.data.cxPropClipMode){o++;break}i=0,r=0}else e[o].style.display="",e[o].setAttribute("lt-prop-title",""),e[o].querySelector("span").style.width="",e[o].querySelector("span").classList.remove("cruxTagTitle"),i+=this.widths[o];for(var n=0,c=[],d=this.data.cxPropValue;o<e.length-1;o++)e[o].style.display="none",n++,c.push(d[o]);0==n?this.$node.querySelector(".moreTagOption").style.display="none":(this.$node.querySelector(".moreTagOption").style.display="",this.$node.querySelector(".moreCount").innerText=" "+n+" "+_cruxUtils.getI18n("crm.label.More")),this.remainingValues=c,!t&&this.getMethods("afterRender")&&this.executeMethod("afterRender",this)}.bind(this))}.bind(this))}},{mixins:["crux-element-validation"]}),Lyte.Component.register("crux-text-area-component",{_template:'<template tag-name="crux-text-area-component"> <template is="switch" value="{{cxPropFrom}}"><template case="view"> <template is="if" value="{{cxPropValue}}"><template case="true"> <pre id="{{cxPropId}}" class="proxima cxTextareaViewMode"><template is="for" items="{{displayArray}}" item="item" index="index"><template is="if" value="{{item.unescape}}"><template case="true">{{unescape(item.value)}}</template><template case="false">{{item}}</template></template></template><template is="if" value="{{showMore}}"><template case="true">... <a href="#" onclick="{{action(\'toggleShow\',false)}}" class="cxTextareaShowMore">{{cxPropShowMore}}</a></template><template case="false"><template is="if" value="{{showLess}}"><template case="true"> <a href="#" onclick="{{action(\'toggleShow\',true)}}" class="cxTextareaShowMore">{{cxPropShowLess}}</a></template></template></template></template></pre> <template is="if" value="{{cxPropViewInfoTooltip}}"><template case="true"> <crux-view-info-tooltip cx-prop-field="{{cxPropField}}" cx-prop-value="{{cxPropValue}}"> <template is="yield" yield-name="viewInfoTooltipYield"> <lyte-yield yield-name="viewInfoTooltipYield" prop-field="{{propField}}" prop-value="{{propValue}}"></lyte-yield> </template> </crux-view-info-tooltip> </template></template> </template><template case="false"><template is="if" value="{{cxPropEmptyValue}}"><template case="true">{{cxPropEmptyValue}}</template></template></template></template></template><template case="create"> <template is="if" value="{{cxPropField[cxPropFieldKey]}}"><template case="true"> <div class="cxElementLabel {{cxPropLabelClass}}"> {{cxPropField[cxPropFieldKey]}} <template is="if" value="{{cxPropInfoTooltip}}"><template case="true"> <span class="dIB vam cxInfoIcon" onmouseenter="{{action(\'showInfoTooltip\',this)}}"></span> <lyte-hovercard lt-prop-placement="topLeft" lt-prop-keep-alive="true" lt-prop-popover-wrapper-class="cxElementsHovercard" lt-prop-origin-elem=".cxCurrentHovercard" on-hovercard-hide="{{method(\'hideInfoTooltip\')}}"> <template is="registerYield" yield-name="hoverCardYield"> <lyte-hovercard-content class="cxElementsHoverCardContent"> {{cxPropInfoTooltip}} </lyte-hovercard-content> </template> </lyte-hovercard> </template></template> </div> </template></template> <div class="cxElementValue {{if(cxPropDisabled,\'cxElementDisabled\',\'\')}}"> <lyte-input lt-prop-name="{{cxPropName}}" id="{{cxPropId}}" lt-prop-title="{{cxPropTooltip}}" lt-prop-tooltip-config="{{cxPropTooltipConfig}}" lt-prop-tooltip-style="margin: 10px; font-size : 11px;" class="w100per {{if(ifEquals(cxPropAppearance,\'box\'),\'cxBoxInput\',\'cxFlatInput\')}} cxTextarea" lt-prop-type="textarea" lt-prop-disabled="{{cxPropDisabled}}" lt-prop-placeholder="{{cxPropPlaceholder}}" lt-prop-readonly="{{cxPropReadonly}}" lt-prop-value="{{lbind(cxPropValue)}}" lt-prop-maxlength="{{cxPropMaxlength}}" on-value-change="{{method(\'onChange\')}}" lt-prop-appearance="{{cxPropAppearance}}" data-zcqa="{{cxPropZcqa}}" lt-prop-autofocus="{{cxPropAutofocus}}" lt-prop-tab-index="{{cxPropTabIndex}}" lt-prop-text-area-resize="{{cxPropTextAreaResize}}" lt-prop-style="{{cxPropStyle}}" lt-prop-vertical="true" lt-prop-auto-update="{{cxPropEnableLbind}}" lt-prop-aria="{{cxPropAria}}" lt-prop-aria-attributes="{{cxPropAriaAttributes}}" lt-prop-tooltip-class="{{cxPropTooltipClass}}" lt-prop-update-delay="{{cxPropUpdateDelay}}" on-resize-end="{{method(\'onResizeEnd\')}}" onclick="{{action(\'onClickTextarea\')}}" onkeyup="{{action(\'onKeyup\')}}" lt-prop-wrapper-class="{{cxPropWrapperClass}}" lt-prop-class="{{cxPropInputClass}}" onfocus="{{action(\'focusCallback\',event)}}" style="max-height : {{cxPropResizeMaxHeight}}"></lyte-input> <template is="if" value="{{cxPropShowDisabledIcon}}"><template case="true"><span class="cxElementsDisabledIcon {{cxPropDisabledIconClass}}"></span></template></template> <template is="if" value="{{isError}}"><template case="true"> <crux-error-message error-message="{{cxPropErrorMessage}}" cx-prop-error-yield="{{cxPropErrorYield}}" cx-prop-error-zcqa-prefix="{{cxPropErrorZcqaPrefix}}" cx-prop-field="{{cxPropField}}" cx-prop-error-zcqa-suffix="{{cxPropErrorZcqaSuffix}}" class="{{cxPropErrorClass}}" cx-prop-error-span-class="{{cxPropErrorSpanClass}}"> <template is="registerYield" yield-name="errorYield"><lyte-yield yield-name="errorYield" error-message="{{cxPropErrorMessage}}" cx-field="{{cxPropField}}"></lyte-yield></template> </crux-error-message> </template></template> </div> </template></template> </template>',_dynamicNodes:[{type:"attr",position:[1]},{type:"switch",position:[1],cases:{view:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,0]},{type:"for",position:[1,0],dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"text",position:[0]}]},false:{dynamicNodes:[{type:"text",position:[0]}]}},default:{}}]},{type:"attr",position:[1,1]},{type:"if",position:[1,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,0]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,0]}]}},default:{}}]}},default:{}},{type:"attr",position:[3]},{type:"if",position:[3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"insertYield",position:[1]}]},{type:"componentDynamic",position:[1]}]}},default:{}}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"text",position:[0]}]}},default:{}}]}},default:{}}]},create:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,1]},{type:"attr",position:[1,3]},{type:"if",position:[1,3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[3]},{type:"registerYield",position:[3,1],dynamicNodes:[{type:"text",position:[1,1]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[3]}]}},default:{}}]}},default:{}},{type:"attr",position:[3]},{type:"attr",position:[3,1],attr:{style:{name:"style",helperInfo:{name:"concat",args:["'max-height : '","cxPropResizeMaxHeight"]}}}},{type:"componentDynamic",position:[3,1]},{type:"attr",position:[3,3]},{type:"if",position:[3,3],cases:{true:{dynamicNodes:[{type:"attr",position:[0]}]}},default:{}},{type:"attr",position:[3,5]},{type:"if",position:[3,5],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"attr",position:[0]},{type:"insertYield",position:[0]}]},{type:"componentDynamic",position:[1]}]}},default:{}}]}},default:{}}],_observedAttributes:["lyteViewPort","cxPropValue","cxPropEmptyValue","cxPropFrom","cxPropDisabled","cxPropPlaceholder","cxPropClass","cxPropMaxlength","cxPropReadonly","cxPropZcqa","cxPropAppearance","cxPropErrorMessage","cxPropMaxcharacter","displayValue","showMore","showLess","cxPropField","cxPropFieldKey","cxPropId","cxPropName","showLess","cxPropClearErrorMessage","cxPropMaxHeight","cxPropDirection","cxPropLabelClass","lyteUnbound","cxPropTabIndex","cxPropTextAreaResize","cxPropStyle","cxPropTooltip","isError","cxPropErrorYield","cxPropInfoTooltip","cxPropExpandTextArea","cxPropEnableLbind","cxPropAria","cxPropAriaAttributes","cxPropTooltipConfig","cxPropTooltipClass","cxPropUpdateDelay","cxPropPreventCollapse","cxPropErrorZcqaPrefix","cxPropErrorZcqaSuffix","cxPropHighlightUrl","cxPropShowMore","cxPropShowLess","cxPropErrorClass","displayArray","cxPropWrapperClass","cxPropInputClass","cxPropErrorSpanClass","cxPropHeight","cxPropLayout","cxPropResizeMaxHeight","cxPropViewInfoTooltip","cxPropShowDisabledIcon","cxPropDisabledIconClass"],data:function(){return{lyteViewPort:Lyte.attr("boolean",{default:!1}),cxPropValue:Lyte.attr("string"),cxPropEmptyValue:Lyte.attr("string",{default:""}),cxPropFrom:Lyte.attr("string",{default:"view"}),cxPropDisabled:Lyte.attr("boolean",{default:!1}),cxPropPlaceholder:Lyte.attr("string"),cxPropClass:Lyte.attr("string",{default:""}),cxPropMaxlength:Lyte.attr("number"),cxPropReadonly:Lyte.attr("boolean",{default:!1}),cxPropZcqa:Lyte.attr("string"),cxPropAppearance:Lyte.attr("string",{default:"flat"}),cxPropErrorMessage:Lyte.attr("string",{default:""}),cxPropMaxcharacter:Lyte.attr("number",{default:0}),displayValue:Lyte.attr("string"),showMore:Lyte.attr("boolean",{default:!1}),showLess:Lyte.attr("boolean",{default:!1}),cxPropField:Lyte.attr("object",{default:{}}),cxPropFieldKey:Lyte.attr("string",{default:""}),cxPropId:Lyte.attr("string",{default:""}),cxPropName:Lyte.attr("string",{default:""}),showLess:Lyte.attr("boolean",{default:!1}),cxPropClearErrorMessage:Lyte.attr("boolean",{default:!0}),cxPropMaxHeight:Lyte.attr("number",{default:354}),cxPropDirection:Lyte.attr("string",{default:"vertical"}),cxPropLabelClass:Lyte.attr("string",{default:""}),lyteUnbound:Lyte.attr("boolean",{default:!1}),cxPropTabIndex:Lyte.attr("string"),cxPropTextAreaResize:Lyte.attr("object",{default:{horizontal:!1,vertical:!0}}),cxPropStyle:Lyte.attr("string"),cxPropTooltip:Lyte.attr("string",{default:""}),isError:Lyte.attr("boolean",{default:!1}),cxPropErrorYield:Lyte.attr("boolean",{default:!1}),cxPropInfoTooltip:Lyte.attr("string",{default:""}),cxPropExpandTextArea:Lyte.attr("boolean",{default:!0}),cxPropEnableLbind:Lyte.attr("boolean",{default:!0}),cxPropAria:Lyte.attr("boolean",{default:!1}),cxPropAriaAttributes:Lyte.attr("object",{default:{}}),cxPropTooltipConfig:Lyte.attr("string",{default:'{"position": "followcursor", "appearance": "box"}'}),cxPropTooltipClass:Lyte.attr("string"),cxPropUpdateDelay:Lyte.attr("number",{default:250}),cxPropPreventCollapse:Lyte.attr("boolean",{default:!1}),cxPropErrorZcqaPrefix:Lyte.attr("string",{default:""}),cxPropErrorZcqaSuffix:Lyte.attr("string",{default:"Error"}),cxPropHighlightUrl:Lyte.attr("boolean",{default:!1}),cxPropShowMore:Lyte.attr("string",{default:_cruxUtils.getI18n("crm.wf.summary.label.ShowInstantActions")}),cxPropShowLess:Lyte.attr("string",{default:_cruxUtils.getI18n("crm.wf.summary.label.HideInstantActions")}),cxPropErrorClass:Lyte.attr("string"),displayArray:Lyte.attr("array"),cxPropWrapperClass:Lyte.attr("string"),cxPropInputClass:Lyte.attr("string"),cxPropErrorSpanClass:Lyte.attr("string"),cxPropHeight:Lyte.attr("string"),cxPropLayout:Lyte.attr("string"),cxPropResizeMaxHeight:Lyte.attr("string",{default:""}),cxPropViewInfoTooltip:Lyte.attr("boolean",{default:!1}),cxPropShowDisabledIcon:Lyte.attr("boolean",{default:!1}),cxPropDisabledIconClass:Lyte.attr("string",{default:""})}},getValue:function(){return this.$node.querySelector("#cruxLoadingElem")?this.data.cxPropValue:this.$node.querySelector("textarea").value},validate:function(){this.getData("cxPropField");return this.getData("cxPropValue")&&this.data.cxPropValue.trim()||this.validateMandatory(!0)?!(this.getData("cxPropValue")&&!this.validateLength(this.getData("cxPropValue")))&&(this.setData("cxPropErrorMessage",""),!0):(this.$node.querySelector("lyte-input").focus(),!1)},methods:{onChange:function(){this.getData("cxPropClearErrorMessage")&&this.setData("cxPropErrorMessage",""),this.getMethods("onValueChange")&&this.executeMethod("onValueChange",this.getData("cxPropValue"))},hideInfoTooltip:function(){this.showHideInfoTooltip()},onResizeEnd:function(){this.resized=!0}},observeErrorMessage:function(){this.setData("isError",""!=this.getData("cxPropErrorMessage"))}.observes("cxPropErrorMessage").on("init"),actions:{toggleShow:function(e){this.setData({displayArray:e?this.splitText(this.data.cxPropValue.substring(0,this.data.cxPropMaxcharacter)):this.splitText(this.data.cxPropValue),showMore:e,showLess:!e}),e&&(this.getMethods("onShowMore")?this.executeMethod("onShowMore",this):this.$node.querySelector("a").scrollIntoView()),event.preventDefault()},showInfoTooltip:function(e){this.showHideInfoTooltip(e)},onClickTextarea:function(){this.increaseHeight()},onKeyup:function(){(event&&"Tab"!=event.key||!event)&&this.increaseHeight()},focusCallback:function(e){this.getMethods("onFocus")&&this.executeMethod("onFocus",e,this.$node)}},expandTextarea:function(e,t){var o=this.getValue();if(!this.resized||!o){this.resized=!1;var a=document.createElement("span");a.innerText=o,document.body.appendChild(a);var r;0==a.offsetHeight&&e&&"focus"==e.type?r=54:0==a.offsetHeight&&e&&"focusout"==e.type?r=34:t||(r=a.offsetHeight/18*18+54);var i=this.getData("cxPropMaxHeight"),s=r>=i?i:r,l=this.$node.querySelector("textarea"),p=getComputedStyle(l),n=s+(parseInt(p.paddingTop)+parseInt(p.paddingBottom))+(parseInt(p.borderBottomWidth)+parseInt(p.borderTopWidth));e&&"focusout"==e.type?this.$node.classList.remove("cxBigTextarea"):this.$node.classList.add("cxBigTextarea"),setTimeout(function(){this.$node.querySelector("lyte-input").style.height=n+2+"px",l.style.height=n+"px"}.bind(this),60),document.body.removeChild(a)}},observeValue:function(){if("view"==this.getData("cxPropFrom"))if(this.setData("showLess",!1),this.getData("cxPropValue")){var e=this.getData("cxPropValue"),t=this.getData("cxPropMaxcharacter");0!=t&&e.length>t?(this.setData("displayArray",this.splitText(this.data.cxPropValue.substring(0,t))),this.setData("showMore",!0)):(this.setData("displayArray",this.splitText(this.data.cxPropValue)),this.setData("showMore",!1))}else this.setData("showMore",!1);else"create"==this.data.cxPropFrom&&this.data.cxPropDisabled&&(this.resized=!0)}.observes("cxPropValue","cxPropFrom").on("init"),observeIsError:function(){"create"==this.getData("cxPropFrom")&&this.$node.querySelector("lyte-input")&&(this.getData("isError")?this.$node.querySelector("lyte-input").classList.add("cxErrorBox"):this.$node.querySelector("lyte-input").classList.remove("cxErrorBox"))}.observes("isError","lyteViewPort").on("didConnect"),observeMandatory:function(){this.observeMandatoryMixin("lyte-input")}.observes("cxPropField.required","lyteViewPort").on("didConnect"),init:function(){this.getData("cxPropDisabled")&&!this.data.cxPropTooltip&&this.setData("cxPropTooltip",_cruxUtils.getI18n("crm.lable.read.only")),this.resized=!1,this.$node.reset=function(){this.resized=!1,this.data.cxPropValue?this.increaseHeight():(this.$node.querySelector("textarea").style.height="",this.$node.querySelector("textarea").addEventListener("transitionend",function e(){this.$node.querySelector("lyte-input").style.height="",this.$node.querySelector("textarea").removeEventListener("transitionend",e)}.bind(this)))}.bind(this),this.setFocusUtil()},increaseHeight:function(){if(!this.resized){var e=71;this.data.cxPropHeight&&(e=this.data.cxPropHeight.split("px")[0],e=parseInt(e)),this.$node.querySelector("textarea").style.height=e+"px",this.$node.querySelector("textarea").addEventListener("transitionend",function t(){this.$node.querySelector("lyte-input").style.height=e+2+"px",this.$node.querySelector("textarea").removeEventListener("transitionend",t)}.bind(this))}},observeFrom:function(){"create"==this.data.cxPropFrom&&this.data.cxPropValue&&this.increaseHeight()}.observes("cxPropFrom","lyteViewPort").on("didConnect"),highlighUrlInText:function(e){if(!this.data.cxPropHighlightUrl)return e;if(e){return e.replace(/((https?|ftp)(:|&#x3a;)(\/\/|&#x2f;&#x2f;))((www\.){0,1}[a-zA-Z0-9-_]+(\.[a-z0-9]+)+)((:|&#x3a;)[0-9]*(\.[a-z0-9]+)*)*(((\/|&#x2f;)[^\s]*)*)|www\.([a-zA-Z0-9-_]+(\.[a-z0-9]+)+)((:|&#x3a;)[0-9]*(\.[a-z0-9]+)*)*(((\/|&#x2f;)[^\s]*)*)/g,function(e){var t="";return-1===e.indexOf("http")&&-1===e.indexOf("ftp")&&(t="//"),'<a class="link" rel="noopener noreferrer" href="'+t+$ESAPI.encoder().encodeForHTMLAttribute(e)+'" target="_blank">'+$ESAPI.encoder().encodeForHTML(e)+"</a>"})}return""},observeClass:function(e){if("create"==this.data.cxPropFrom){var t=$L("lyte-input",this.$node);if(!t.length)return;e&&e.oldValue&&t.removeClass(e.oldValue),this.data.cxPropClass&&t.addClass(this.data.cxPropClass)}}.observes("cxPropClass","lyteViewPort").on("didConnect"),getATag:function(e){var t="";return-1===e.indexOf("http")&&-1===e.indexOf("ftp")&&(t="//"),'<a class="link" rel="noopener noreferrer" href="'+t+$ESAPI.encoder().encodeForHTMLAttribute(e)+'" target="_blank">'+$ESAPI.encoder().encodeForHTML(e)+"</a>"},splitText:function(e){if(!this.data.cxPropHighlightUrl||!e)return[e];var t=/((https?|ftp)(:|&#x3a;)(\/\/|&#x2f;&#x2f;))((www\.){0,1}[a-zA-Z0-9-_]+(\.[a-z0-9]+)+)((:|&#x3a;)[0-9]*(\.[a-z0-9]+)*)*(((\/|&#x2f;)[^\s]*)*)|www\.([a-zA-Z0-9-_]+(\.[a-z0-9]+)+)((:|&#x3a;)[0-9]*(\.[a-z0-9]+)*)*(((\/|&#x2f;)[^\s]*)*)/g,o=e.match(t);if(!o)return[e];var a=e.replace(t,"crux-text-area-component-url");a=a.split("crux-text-area-component-url");for(var r=1,i=0;r<a.length;r+=2,i++)a.splice(r,0,{unescape:!0,value:this.getATag(o[i])});return a}},{mixins:["crux-element-validation"]}),Lyte.Component.register("crux-text-component",{_template:'<template tag-name="crux-text-component"> <template is="switch" value="{{cxPropFrom}}"><template case="view"> <template is="if" value="{{expHandlers(cxPropValue,\'!\')}}"><template case="true"><template is="if" value="{{cxPropEmptyValue}}"><template case="true">{{cxPropEmptyValue}}</template></template></template><template case="false"><template is="if" value="{{cxPropMaskingProperties}}"><template case="true">{{cruxMaskValue(cxPropValue,cxPropMaskingProperties)}} </template><template case="false">{{cxPropValue}}<template is="if" value="{{cxPropViewInfoTooltip}}"><template case="true"> <crux-view-info-tooltip cx-prop-field="{{cxPropField}}" cx-prop-value="{{cxPropValue}}"> <template is="yield" yield-name="viewInfoTooltipYield"> <lyte-yield yield-name="viewInfoTooltipYield" prop-field="{{propField}}" prop-value="{{propValue}}"></lyte-yield> </template> </crux-view-info-tooltip> </template></template></template></template></template></template> </template><template case="criteria"></template><template case="filter"></template><template case="create"> <template is="if" value="{{expHandlers(expHandlers(cxPropFrom,\'===\',&quot;create&quot;),\'&amp;&amp;\',cxPropField[cxPropFieldKey])}}"><template case="true"> <div class="cxElementLabel {{cxPropLabelClass}}"> {{cxPropField[cxPropFieldKey]}} <template is="if" value="{{cxPropInfoTooltip}}"><template case="true"> <span class="dIB vam cxInfoIcon" onmouseenter="{{action(\'showInfoTooltip\',this)}}"></span> <lyte-hovercard lt-prop-placement="topLeft" lt-prop-keep-alive="true" lt-prop-popover-wrapper-class="cxElementsHovercard" lt-prop-origin-elem=".cxCurrentHovercard" on-hovercard-hide="{{method(\'hideInfoTooltip\')}}"> <template is="registerYield" yield-name="hoverCardYield"> <lyte-hovercard-content class="cxElementsHoverCardContent"> {{cxPropInfoTooltip}} </lyte-hovercard-content> </template> </lyte-hovercard> </template></template> </div> </template></template> <div class="cxElementValue {{if(cxPropDisabled,\'cxElementDisabled\',\'\')}}"> <template is="if" value="{{cxPropAutocompleteOptions.enable}}"><template case="true"> <div class="cxLookupComponent cxBoxWithRightIcon {{cxPropWrapperClass}}"> <div class="cxBoxLeftContent"> <lyte-autocomplete lt-prop-external-search="{{cxPropAutocompleteOptions.externalSearch}}" lt-prop-content="{{records}}" lt-prop-yield="{{cxPropAutocompleteOptions.yield}}" lt-prop-dropdown-height="250px" lt-prop-dropdown-class="cxLookupDropbox cxDropbox" lt-prop-min-length="{{cxPropAutocompleteOptions.minLength}}" on-ext-search="{{method(\'onExtSearchAutoComp\')}}" on-search="{{method(\'onSearchAutoComp\')}}" on-select="{{method(\'onSelectAutoComp\')}}" on-scroll="{{method(\'onScrollAutoComp\')}}" on-before-show="{{method(\'onBeforeOpenAutoComp\')}}" on-blur="{{method(\'onBlurAutoComp\')}}" lt-prop-appearance="{{cxPropAppearance}}" lt-prop-maxlength="{{cxPropMaxlength}}" after-render="{{method(\'afterRenderAutocomplete\')}}" lt-prop-method="{{cxPropAutocompleteOptions.method}}" lt-prop-label="name" lt-prop-value="{{cxPropValue}}" lt-prop-class="{{cxPropInputClass}}"> <template is="yield" yield-name="yield"> <lyte-drop-box> <lyte-drop-body class="cxVisibleLookup" style="{{if(ifEquals(records.length,0),\'display: none\',\'\')}}"> <template is="for" items="{{records}}" item="val" index="index"> <lyte-drop-item data-value="{{val[cxPropAutocompleteOptions.idField]}}" onmouseenter="{{action(\'showHideIcon1\',true,val)}}" onmouseleave="{{action(\'showHideIcon1\',false,val)}}"> <lyte-autocomplete-label> <span class="cxLookupDropboxLabel">{{val[cxPropAutocompleteOptions.displayField]}}</span> <span class="cxLookupInfoIcon {{if(val.cxPropShowIcon,\'cruxLookupPopover\')}}" onmouseenter="{{action(\'infoPop\',this,val,event)}}" onmouseleave="{{action(\'infoPop\',this,val,event)}}" style="{{if(val.cxPropShowIcon,\'visibility: visible;\',\'visibility: hidden\')}}"></span> </lyte-autocomplete-label> </lyte-drop-item> </template> </lyte-drop-body> </lyte-drop-box> </template> </lyte-autocomplete> <template is="if" value="{{cxPropShowDisabledIcon}}"><template case="true"><span class="cxElementsDisabledIcon {{cxPropDisabledIconClass}}"></span></template></template> <div class="cxBoxSpinWrapper cxFlexCenter"> <span class="cxElementsLoaderBg" style="display: none;"></span> </div> </div> </div> </template><template case="false"> <lyte-input lt-prop-name="{{cxPropName}}" id="{{cxPropId}}" lt-prop-update-delay="{{defaultUndefined}}" lt-prop-title="{{tooltip}}" lt-prop-tooltip-config="{{cxPropTooltipConfig}}" lt-prop-tooltip-style="margin: 10px; font-size : 11px;" lt-prop-class="cxBorderBottom {{cxPropInputClass}}" class="w100per {{if(ifEquals(cxPropAppearance,\'box\'),\'cxBoxInput\',\'cxFlatInput\')}}" lt-prop-direction="{{cxPropDirection}}" lt-prop-wrapper-style="{{cxPropWrapperStyle}}" lt-prop-value="{{lbind(cxPropValue)}}" lt-prop-placeholder="{{cxPropPlaceholder}}" lt-prop-maxlength="{{cxPropMaxlength}}" lt-prop-disabled="{{cxPropDisabled}}" lt-prop-readonly="{{cxPropReadonly}}" data-zcqa="{{cxPropZcqa}}" on-value-change="{{method(\'inputValueChange\')}}" lt-prop-appearance="{{cxPropAppearance}}" lt-prop-tab-index="{{cxPropTabIndex}}" lt-prop-autofocus="{{cxPropAutofocus}}" lt-prop-autocomplete="{{cxPropAutocomplete}}" lt-prop-auto-update="{{cxPropEnableLbind}}" lt-prop-aria="{{cxPropAria}}" lt-prop-aria-attributes="{{cxPropAriaAttributes}}" lt-prop-tooltip-class="{{cxPropTooltipClass}}" lt-prop-wrapper-class="{{cxPropWrapperClass}}" onfocus="{{action(\'focusCallback\',event)}}" lt-prop-type="{{cxPropType}}"></lyte-input> <template is="if" value="{{cxPropShowDisabledIcon}}"><template case="true"><span class="cxElementsDisabledIcon {{cxPropDisabledIconClass}}"></span></template></template> </template></template> <template is="if" value="{{isError}}"><template case="true"> <crux-error-message error-message="{{cxPropErrorMessage}}" cx-prop-error-yield="{{cxPropErrorYield}}" cx-prop-error-zcqa-prefix="{{cxPropErrorZcqaPrefix}}" cx-prop-field="{{cxPropField}}" cx-prop-error-zcqa-suffix="{{cxPropErrorZcqaSuffix}}" class="{{cxPropErrorClass}}" cx-prop-error-span-class="{{cxPropErrorSpanClass}}"> <template is="registerYield" yield-name="errorYield"><lyte-yield yield-name="errorYield" error-message="{{cxPropErrorMessage}}" cx-field="{{cxPropField}}"></lyte-yield></template> </crux-error-message> </template></template> </div> </template></template> </template>',_dynamicNodes:[{type:"attr",position:[1]},{type:"switch",position:[1],cases:{view:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"text",position:[0]}]}},default:{}}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"text",position:[0]}]},false:{dynamicNodes:[{type:"text",position:[0]},{type:"attr",position:[2]},{type:"if",position:[2],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"insertYield",position:[1]}]},{type:"componentDynamic",position:[1]}]}},default:{}}]}},default:{}}]}},default:{}}]},criteria:{dynamicNodes:[],additional:{next:"filter"}},filter:{dynamicNodes:[],additional:{next:"create"}},create:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,1]},{type:"attr",position:[1,3]},{type:"if",position:[1,3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[3]},{type:"registerYield",position:[3,1],dynamicNodes:[{type:"text",position:[1,1]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[3]}]}},default:{}}]}},default:{}},{type:"attr",position:[3]},{type:"attr",position:[3,1]},{type:"if",position:[3,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1,1]},{type:"registerYield",position:[1,1,1,1],dynamicNodes:[{type:"attr",position:[1,1],attr:{style:{name:"style",helperInfo:{name:"if",args:[{type:"helper",value:{name:"ifEquals",args:["records.length",0]}},"'display: none'","''"]}}}},{type:"attr",position:[1,1,1]},{type:"for",position:[1,1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,1,1,0]},{type:"attr",position:[1,1,3],attr:{style:{name:"style",helperInfo:{name:"if",args:["val.cxPropShowIcon","'visibility: visible;'","'visibility: hidden'"]}}}},{type:"componentDynamic",position:[1,1]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1,1]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1,1,1]},{type:"attr",position:[1,1,3]},{type:"if",position:[1,1,3],cases:{true:{dynamicNodes:[{type:"attr",position:[0]}]}},default:{}}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]},{type:"attr",position:[3]},{type:"if",position:[3],cases:{true:{dynamicNodes:[{type:"attr",position:[0]}]}},default:{}}]}},default:{}},{type:"attr",position:[3,3]},{type:"if",position:[3,3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"attr",position:[0]},{type:"insertYield",position:[0]}]},{type:"componentDynamic",position:[1]}]}},default:{}}]}},default:{}}],_observedAttributes:["lyteViewPort","cxPropValue","cxPropFrom","cxPropPlaceholder","cxPropField","cxPropMaxlength","cxPropDisabled","cxPropReadonly","cxPropWrapperStyle","cxPropClass","cxPropZcqa","cxPropIgnoreEmptyValue","cxPropAppearance","cxPropErrorMessage","cxPropDirection","cxPropFieldKey","cxPropId","cxPropName","cxPropClearErrorMessage","isError","cxPropTabIndex","lyteUnbound","cxPropLabelClass","cxPropEmptyValue","cxPropTooltip","defaultUndefined","cxPropErrorYield","cxPropInfoTooltip","cxPropAutocomplete","cxPropEnableLbind","cxPropAria","cxPropAriaAttributes","cxPropMaskingProperties","cxPropTooltipConfig","cxPropTooltipClass","cxPropImagePath","records","cxPropAutocompleteOptions","cxPropErrorZcqaPrefix","cxPropErrorZcqaSuffix","cxPropErrorClass","cxPropWrapperClass","cxPropInputClass","cxPropErrorSpanClass","cxPropLayout","cxPropViewInfoTooltip","cxPropShowDisabledIcon","cxPropDisabledIconClass","tooltip","cxPropType"],data:function(){return{lyteViewPort:Lyte.attr("boolean",{default:!1}),cxPropValue:Lyte.attr("string"),cxPropFrom:Lyte.attr("string",{default:"view"}),cxPropPlaceholder:Lyte.attr("string"),cxPropField:Lyte.attr("object",{default:{}}),cxPropMaxlength:Lyte.attr("number"),cxPropDisabled:Lyte.attr("boolean",{default:!1}),cxPropReadonly:Lyte.attr("boolean",{default:!1}),cxPropWrapperStyle:Lyte.attr("string"),cxPropClass:Lyte.attr("string",{default:""}),cxPropZcqa:Lyte.attr("string"),cxPropIgnoreEmptyValue:Lyte.attr("boolean",{default:!1}),cxPropAppearance:Lyte.attr("string",{default:"flat"}),cxPropErrorMessage:Lyte.attr("string",{default:""}),cxPropDirection:Lyte.attr("string",{default:"vertical"}),cxPropFieldKey:Lyte.attr("string",{default:""}),cxPropId:Lyte.attr("string",{default:""}),cxPropName:Lyte.attr("string",{default:""}),cxPropClearErrorMessage:Lyte.attr("boolean",{default:!0}),isError:Lyte.attr("boolean",{default:!1}),cxPropTabIndex:Lyte.attr("string"),lyteUnbound:Lyte.attr("boolean",{default:!1}),cxPropLabelClass:Lyte.attr("string",{default:""}),cxPropEmptyValue:Lyte.attr("string",{default:""}),cxPropTooltip:Lyte.attr("string",{default:""}),defaultUndefined:Lyte.attr("string"),cxPropErrorYield:Lyte.attr("boolean",{default:!1}),cxPropInfoTooltip:Lyte.attr("string",{default:""}),cxPropAutocomplete:Lyte.attr("string",{default:"on"}),cxPropEnableLbind:Lyte.attr("boolean",{default:!0}),cxPropAria:Lyte.attr("boolean",{default:!1}),cxPropAriaAttributes:Lyte.attr("object",{default:{}}),cxPropMaskingProperties:Lyte.attr("object"),cxPropTooltipConfig:Lyte.attr("string",{default:'{"position": "followcursor", "appearance": "box"}'}),cxPropTooltipClass:Lyte.attr("string"),cxPropImagePath:Lyte.attr("string",{default:"/recruit/CRMClient/images"}),records:Lyte.attr("array"),cxPropAutocompleteOptions:Lyte.attr("object",{default:{},hideAttr:!0}),cxPropErrorZcqaPrefix:Lyte.attr("string",{default:""}),cxPropErrorZcqaSuffix:Lyte.attr("string",{default:"Error"}),cxPropErrorClass:Lyte.attr("string"),cxPropWrapperClass:Lyte.attr("string"),cxPropInputClass:Lyte.attr("string",{default:""}),cxPropErrorSpanClass:Lyte.attr("string"),cxPropLayout:Lyte.attr("string"),cxPropViewInfoTooltip:Lyte.attr("boolean",{default:!1}),cxPropShowDisabledIcon:Lyte.attr("boolean",{default:!1}),cxPropDisabledIconClass:Lyte.attr("string",{default:""}),tooltip:Lyte.attr("string"),cxPropType:Lyte.attr("string",{default:"text"})}},validate:function(){var e=this.getData("cxPropValue"),t=this.getData("cxPropField");return"create"==this.getData("cxPropFrom")?this.validateText(t,e):"filter"!=this.getData("cxPropFrom")||(e&&""!=e.trim()||this.getData("cxPropIgnoreEmptyValue"))&&!this.isEmoji(e)?"criteria"!=this.getData("cxPropFrom")||e&&""!=e.trim()?!(e&&e.replace(/^\s+/g,"").replace(/\s+$/g,"").indexOf("*")>-1)||(this.showAlert(_cruxUtils.getI18n("crm.alert.character.not.allowed","*")),this.$node.querySelector("input").focus(),!1):(this.showAlert(_cruxUtils.getI18n("crm.field.valid.check",Lyte.Component.registeredHelpers.cruxEncodeHTML(t.field_label))),!1):(this.showAlert(_cruxUtils.getI18n("crm.field.valid.check",Lyte.Component.registeredHelpers.cruxEncodeHTML(t.field_label))),this.$node.querySelector("input").focus(),!1)},getValue:function(){if(("criteria"==this.getData("cxPropFrom")||"filter"==this.getData("cxPropFrom"))&&this.getData("cxPropValue")){var e=this.getData("cxPropValue");return"criteria"==this.data.cxPropFrom?this.SplitWord(e):e}return"create"==this.data.cxPropFrom&&this.data.cxPropAutocompleteOptions.enable&&this.$node.querySelector("lyte-autocomplete")?this.$node.querySelector("lyte-autocomplete").ltProp("value"):"string"==typeof this.data.cxPropValue?this.getData("cxPropValue").trim():this.getData("cxPropValue")},methods:{inputValueChange:function(e){this.getData("cxPropClearErrorMessage")&&this.setData("cxPropErrorMessage",""),e.newValue&&e.newValue.split(",").length>this.maxValuesForTextCond&&(this.showAlert(_cruxUtils.getI18n("crm.alert.maximum.text.values.contains",this.maxValuesForTextCond)),this.setData("cxPropValue",e.oldValue)),this.getMethods("onValueChange")&&this.executeMethod("onValueChange",this.getValue())},hideInfoTooltip:function(){this.showHideInfoTooltip()},onExtSearchAutoComp:function(e,t,o){this.pageIndex=1,this.searchText=e.trim(),this.scrollEnd=!1,this.onscroll=!1,this.makeRequest()},onSearchAutoComp:function(e){if(this.data.cxPropAutocompleteOptions.externalSearch)return!1;0==e.length&&this.$node.querySelector("lyte-autocomplete").toggle()},onSelectAutoComp:function(e,t,o){if(this.getData("cxPropClearErrorMessage")&&this.setData("cxPropErrorMessage",""),this.data.cxPropAutocompleteOptions.yield){for(var a=0;a<this.data.records.length;a++)if(this.data.records[a][this.data.cxPropAutocompleteOptions.idField]==e){this.setData("cxPropValue",this.data.records[a][this.data.cxPropAutocompleteOptions.displayField]),this.getMethods("onValueChange")&&this.executeMethod("onValueChange",this.data.records[a]);break}}else this.setData("cxPropValue",e.name),this.getMethods("onValueChange")&&this.executeMethod("onValueChange",e)},onScrollAutoComp:function(e){if(!this.scrollEnd&&this.data.cxPropAutocompleteOptions.externalSearch){var t=e.target;t.scrollHeight<=Math.ceil(t.offsetHeight)+Math.ceil(t.scrollTop)&&(this.pageIndex++,this.onscroll=!0,this.makeRequest())}},onBeforeOpenAutoComp:function(){if(void 0==this.data.records||0==this.data.records.length)return!1},onBlurAutoComp:function(){this.setData("cxPropValue",this.$node.querySelector("input").value),this.getMethods("onValueChange")&&this.executeMethod("onValueChange",this.$node.querySelector("input").value)},afterRenderAutocomplete:function(){if(this.$node.querySelector("lyte-input")){if("box"==this.getData("cxPropAppearance")&&this.$node.querySelector("lyte-input").classList.add("cxBoxInput"),!this.data.cxPropAutocompleteOptions.yield){if(this.data.cxPropAutocompleteOptions.content.length&&!this.data.cxPropAutocompleteOptions.content[0].name)for(var e=0;e<this.data.cxPropAutocompleteOptions.content.length;e++)this.data.cxPropAutocompleteOptions.content[e]={name:this.data.cxPropAutocompleteOptions.content[e]};this.setData("records",this.data.cxPropAutocompleteOptions.content)}this.data.cxPropAutocompleteOptions.method||Lyte.objectUtils(this.data.cxPropAutocompleteOptions,"add","method","contains")}}},actions:{showInfoTooltip:function(e){this.showHideInfoTooltip(e)},infoPop:function(e,t,o){var a=document.getElementById("cruxLookupPopover");"mouseenter"==o.type?(this.entered=!0,a||(a=Lyte.Component.render("crux-lookup-popup",{id:"cruxLookupPopover",fieldMapping:this.data.cxPropAutocompleteOptions.fieldMapping},"body")),a.setData({show:!0,module:moduleRecordMapping[this.data.cxPropAutocompleteOptions.module],data:t})):(this.entered=!1,a.setData("show",!1))},showHideIcon1:function(e,t){this.entered||Lyte.objectUtils(t,"add","cxPropShowIcon",e)},focusCallback:function(e){this.getMethods("onFocus")&&this.executeMethod("onFocus",e,this.$node)}},observeErrorMessage:function(){this.setData("isError",""!=this.getData("cxPropErrorMessage"))}.observes("cxPropErrorMessage").on("init"),maxValuesForTextCond:50,observeIsError:function(){"create"!=this.getData("cxPropFrom")&&"criteria"!=this.data.cxPropFrom||!this.$node.querySelector("lyte-input")||(this.getData("isError")?this.$node.querySelector("lyte-input").classList.add("cxErrorBox"):this.$node.querySelector("lyte-input")&&this.$node.querySelector("lyte-input").classList.remove("cxErrorBox"))}.observes("isError","lyteViewPort").on("didConnect"),observeMandatory:function(){this.observeMandatoryMixin(this.data.cxPropAutocompleteOptions.enable?".cxLookupComponent":"lyte-input")}.observes("cxPropField.required","lyteViewPort").on("didConnect"),init:function(){"create"!=this.data.cxPropFrom?this.data.cxPropAutocomplete="off":(this.setFocusUtil(),this.setSelectUtil())},makeRequest:function(){var e=this.$node.querySelector(".cxElementsLoaderBg");e.style.display="",this.executeMethod("fetchData",this.searchText,this.pageIndex,this.data.cxPropField).then(function(t){t&&0!=t.length||(this.scrollEnd=!0,this.onscroll||this.setData("records",[]),t=[]),this.onscroll?Lyte.arrayUtils(this.data.records,"push",t):this.setData("records",t),e.style.display="none",this.data.cxPropValue&&this.$node.querySelector("lyte-dropdown").component.childComp&&this.$node.querySelector("lyte-dropdown").component.childComp.querySelector("[data-value='"+this.data.cxPropValue+"']")&&this.$node.querySelector("lyte-dropdown").component.childComp.querySelector("[data-value='"+this.data.cxPropValue+"']").setAttribute("selected",!0)}.bind(this),function(){e.style.display="none"})},ele:"lyte-input",observeClass:function(e){if("create"==this.data.cxPropFrom){var t=$L("lyte-input",this.$node);if(!t.length)return;e&&e.oldValue&&t.removeClass(e.oldValue),this.data.cxPropClass&&t.addClass(this.data.cxPropClass)}}.observes("cxPropClass","lyteViewPort").on("didConnect"),observeDisabled:function(){this.data.cxPropTooltip?this.setData("tooltip",this.data.cxPropTooltip):this.data.cxPropDisabled?this.setData("tooltip",_cruxUtils.getI18n("crm.lable.read.only")):this.setData("tooltip","")}.observes("cxPropTooltip","cxPropDisabled").on("init")},{mixins:["crux-element-validation","crux-filter-utils"]}),Lyte.Component.register("crux-role-component",{_template:'<template tag-name="crux-role-component"> <div class="cxBoxWithRightIcon cxBoxContainsDropdown"> <div class="cxBoxLeftContent"> <lyte-dropdown on-before-show="{{method(\'onBeforeShow\')}}" on-show="{{method(\'roleDropBoxOnShow\')}}" on-hide="{{method(\'roleDropBoxOnHide\')}}" on-scroll="{{method(&quot;onBodyScroll&quot;)}}" lt-prop-yield="true" on-add="{{method(\'addToList\')}}" lt-prop-selected="{{dropdownSelected}}" on-remove="{{method(\'removeFromList\')}}" lt-prop-type="multisearch" lt-prop-tabindex="14" class="{{if(ifEquals(cxPropAppearance,\'flat\'),\'cxFlatDropdown\',\'cxBoxDropdown\')}}"> <template is="registerYield" yield-name="yield"> <lyte-drop-button> <ul class="lyteMultipleSelect"> <template is="for" items="{{renderItems}}" item="selitem" index="indeval"> <li data-value="{{selitem.id}}"> <lyte-text class="lyteDropdownVisible" lt-prop-value="{{selitem.name}}"></lyte-text> <lyte-drop-remove class="lyteCloseIcon"></lyte-drop-remove> </li> </template> <li class="lyteMultiselectInput"> <lyte-search class="w100per" lt-prop-type="text" lt-prop-query-selector="{&quot;scope&quot;:&quot;.cxRoleDropBody{{cxPropId}}&quot;, &quot;target&quot;:&quot;lyte-drop-item:not([selected=\\&quot;true\\&quot;])&quot;, &quot;search&quot;:&quot;lyte-drop-item:not([selected=\\&quot;true\\&quot;])&quot;}" on-search="{{method(\'showNoResult\')}}"></lyte-search> </li> </ul> </lyte-drop-button> <lyte-drop-box class="cxDropbox"> <lyte-drop-body class="cxRoleDropBody{{cxPropId}}"> <template is="if" value="{{showLoading}}"><template case="true"> <div class="cxRoleLoaderWrap aligncenter"> <span class="cxElementsLoaderBg cxRoleLoaderIcon"></span> </div> </template><template case="false"><template is="for" items="{{systemData}}" item="item" index="indeval"> <lyte-drop-item data-value="{{item.id}}" selected="{{if(cruxContains(selectedIds,item.id,selectedIds.length),true,false)}}"> {{item.name}} </lyte-drop-item> </template> <template is="if" value="{{expHandlers(noResult,\'||\',expHandlers(systemData.length,\'==\',renderItems.length))}}"><template case="true"> <div class="cxDropdownNoResult">{{cruxGetI18n(\'crm.label.no.options.found\')}}</div> </template></template> </template></template> </lyte-drop-body> </lyte-drop-box> </template> </lyte-dropdown> <lyte-modal lt-prop-offset="{&quot;top&quot;:&quot;0&quot;}" lt-prop-width="600px" lt-prop-wrapper-class="cxBoxModal cxRoleModalWrapper" on-close="{{method(\'onClose\')}}"> <template is="registerYield" yield-name="modal"> <lyte-modal-header>{{cruxGetI18n(\'crm.security.roles.list\')}}</lyte-modal-header> <lyte-modal-content> <p>{{cruxGetI18n(\'crm.security.roles.lookup.info\')}}</p> <lyte-tree class="cxRoleCompLyteTree" lt-prop-data="{{modalContent}}" lt-prop-open-class="open" lt-prop-close-class="close"> <template is="registerYield" yield-name="content"> <lyte-tree-content lt-prop-title="{{if(cruxContains(selectedIds,listValue.id,selectedIds.length),cruxGetI18n(\'crm.role.already.selected\'),\'\')}}"> <lyte-tree-icon lyte-custom-icon="true"> <div class="collapseBox"> <div class="arrow"></div> </div> </lyte-tree-icon> <p class="treeValue {{if(cruxContains(selectedIds,listValue.id,selectedIds.length),\'pEvents\',\'\')}}" onclick="{{action(\'onSelectRole\',listValue.id)}}"><lyte-text lt-prop-value="{{listValue.name}}"></lyte-text></p> </lyte-tree-content> </template> </lyte-tree> </lyte-modal-content> <lyte-modal-footer> <lyte-button onclick="{{action(\'closeModal\')}}" data-zcqa="cx_Role_Cancel"> <template is="registerYield" yield-name="text"> {{cruxGetI18n(\'crm.button.cancel\')}} </template> </lyte-button> </lyte-modal-footer> </template> </lyte-modal> </div> <template is="if" value="{{expHandlers(cxPropRequestModel,\'==\',\'role\')}}"><template case="true"> <div class="cxBoxRightIcon cxFlexCenter"> <span id="openRoleModal" class="cx_roleLookupIcon cx_roleIconPos" onclick="{{action(\'openRoleModal\')}}"></span> </div> </template></template> </div> </template>',_dynamicNodes:[{type:"attr",position:[1,1,1]},{type:"registerYield",position:[1,1,1,1],dynamicNodes:[{type:"attr",position:[1,1,1]},{type:"for",position:[1,1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"componentDynamic",position:[1,1]},{type:"componentDynamic",position:[1,3]}]},{type:"attr",position:[1,1,3,1]},{type:"componentDynamic",position:[1,1,3,1]},{type:"componentDynamic",position:[1]},{type:"attr",position:[3,1]},{type:"attr",position:[3,1,1]},{type:"if",position:[3,1,1],cases:{true:{dynamicNodes:[]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"for",position:[0],dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,1]},{type:"componentDynamic",position:[1]}]},{type:"attr",position:[2]},{type:"if",position:[2],cases:{true:{dynamicNodes:[{type:"text",position:[1,0]}]}},default:{}}]}},default:{}},{type:"componentDynamic",position:[3,1]},{type:"componentDynamic",position:[3]}]},{type:"componentDynamic",position:[1,1,1]},{type:"attr",position:[1,1,3]},{type:"registerYield",position:[1,1,3,1],dynamicNodes:[{type:"text",position:[1,0]},{type:"componentDynamic",position:[1]},{type:"text",position:[3,1,0]},{type:"attr",position:[3,3]},{type:"registerYield",position:[3,3,1],dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1,1]},{type:"attr",position:[1,3]},{type:"attr",position:[1,3,0]},{type:"componentDynamic",position:[1,3,0]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[3,3]},{type:"componentDynamic",position:[3]},{type:"attr",position:[5,1]},{type:"registerYield",position:[5,1,1],dynamicNodes:[{type:"text",position:[1]}]},{type:"componentDynamic",position:[5,1]},{type:"componentDynamic",position:[5]}]},{type:"componentDynamic",position:[1,1,3]},{type:"attr",position:[1,3]},{type:"if",position:[1,3],cases:{true:{dynamicNodes:[{type:"attr",position:[1,1]}]}},default:{}}],_observedAttributes:["systemData","renderItems","cxPropValue","showLoading","noResult","cxPropId","cxPropAppearance","cxPropRequestModel","selectedIds","dropdownSelected"],data:function(){return{systemData:Lyte.attr("array",{default:[]}),renderItems:Lyte.attr("array",{default:[]}),cxPropValue:Lyte.attr("array"),showLoading:Lyte.attr("boolean",{default:!0}),noResult:Lyte.attr("boolean",{default:!1}),cxPropId:Lyte.attr("string",{default:""}),cxPropAppearance:Lyte.attr("string",{default:"flat"}),cxPropRequestModel:Lyte.attr("string",{default:"role"}),selectedIds:Lyte.attr("array",{default:[]}),dropdownSelected:Lyte.attr("string")}},methods:{roleDropBoxOnShow:function(e,t){$L(".cxBoxWithRightIcon",this.$node).addClass("cxBoxDropdownOpened")},roleDropBoxOnHide:function(e,t){$L(".cxBoxWithRightIcon",this.$node).removeClass("cxBoxDropdownOpened")},addToList:function(e,t,o){this.$node.querySelector("lyte-search").setValue("");for(var a=this.getData("systemData"),r=0;r<a.length;r++)if(a[r].id==t){Lyte.arrayUtils(this.getData("renderItems"),"push",a[r]),Lyte.arrayUtils(this.data.selectedIds,"push",a[r].id);break}this.getMethods("onValueChange")&&this.executeMethod("onValueChange",this.getValue()),this.setData("dropdownSelected",JSON.stringify(this.data.selectedIds))},removeFromList:function(e,t,o){this.$node.querySelector("lyte-search").setValue("");for(var a=0;a<this.getData("renderItems").length;a++)this.getData("renderItems")[a].id==t&&(Lyte.arrayUtils(this.getData("renderItems"),"removeAt",a,1),Lyte.arrayUtils(this.data.selectedIds,"removeAt",a,1));this.getMethods("onValueChange")&&this.executeMethod("onValueChange",this.getValue()),this.setData("dropdownSelected",JSON.stringify(this.data.selectedIds))},onBeforeShow:function(){return(!event.target.getAttribute||"openRoleModal"!=event.target.getAttribute("id"))&&(this.getData("dataFetched")?void 0:(this.getDatas(),!1))},showNoResult:function(e,t,o,a){this.setData("noResult",""!=a&&0==e.length)},onClose:function(e){e.setData("ltPropBindToBody",!1)}},actions:{openRoleModal:function(){this.$node.querySelector("lyte-dropdown").close(),this.getData("dataFetched")?this.$node.querySelector("lyte-modal").ltProp("show",!0):this.getDatas(!0)},onSelectRole:function(e){for(var t=0,o=0;o<this.getData("renderItems").length;o++)this.getData("renderItems")[o].id==e&&(t=1);0==t&&(Lyte.arrayUtils(this.getData("renderItems"),"push",store.peekRecord(this.data.cxPropRequestModel,e)),Lyte.arrayUtils(this.data.selectedIds,"push",e)),this.$node.querySelector("lyte-modal").ltProp("show",!1),this.setData("dropdownSelected",JSON.stringify(this.data.selectedIds))},closeModal:function(){this.$node.querySelector("lyte-modal").ltProp("show",!1)}},getValue:function(){for(var e=[],t=0;t<this.getData("renderItems").length;t++)e.push({id:this.getData("renderItems")[t].id,name:this.getData("renderItems")[t].name});return e},validate:function(){return 0!=this.getData("renderItems").length||(this.showAlert(_cruxUtils.getI18n("crm.field.valid.check",Lyte.Component.registeredHelpers.cruxEncodeHTML(this.data.cxPropField.field_label))),!1)},setValue:function(){this.setData("selectedIds",[]),this.setData("renderItems",[]);for(var e=0;e<this.data.cxPropValue.length;e++)store.peekRecord(this.data.cxPropRequestModel,this.data.cxPropValue[e].id)&&(Lyte.arrayUtils(this.data.renderItems,"push",this.data.cxPropValue[e]),Lyte.arrayUtils(this.data.selectedIds,"push",this.data.cxPropValue[e].id))},getDatas:function(e){var t=this;store.findAll(this.data.cxPropRequestModel,!0,!0).then(function(o){t.setData("systemData",o),t.setData("dataFetched",!0),t.setData("showLoading",!1),e?t.$node.querySelector("lyte-modal").ltProp("show",!0):t.$node.querySelector("lyte-dropdown").open()})},observesValue:function(){this.data.cxPropField&&this.data.cxPropField.api_name.match(/profile/)?this.setData("cxPropRequestModel","profile"):this.setData("cxPropRequestModel","role");var e=this;this.getData("cxPropValue")&&(this.getData("dataFetched")?this.setValue():store.findAll(this.data.cxPropRequestModel,!0,!0).then(function(t){e.setData("systemData",t),e.setData("dataFetched",!0),e.setData("showLoading",!1),e.setValue()}))}.observes("cxPropValue.[]").on("init"),observesSystemData:function(){this.setData("modalContent",store.peekAll("role").filter(function(e){return!e.reporting_to}))}.observes("systemData.[]")},{mixins:["crux-element-validation"]}),Lyte.Component.register("crux-twitter-component",{_template:'<template tag-name="crux-twitter-component"> <template is="switch" value="{{cxPropFrom}}"><template case="view"><template is="if" value="{{cxPropValue}}"><template case="true"> <template is="if" value="{{cxPropMaskingProperties}}"><template case="true">{{cruxMaskValue(cxPropValue,cxPropMaskingProperties)}} </template><template case="false"> <a id="{{cxPropId}}" data-zcqa="dummy" class="link" href="{{cruxRebrandProperty(\'TW_URL\')}}/{{cruxEncodeURL(cxPropValue)}}" target="_blank" onclick="{{action(\'stopPropagation\')}}">{{cruxEncodeHTML(cxPropValue)}}</a> <template is="if" value="{{cxPropViewInfoTooltip}}"><template case="true"> <crux-view-info-tooltip cx-prop-field="{{cxPropField}}" cx-prop-value="{{cxPropValue}}"> <template is="yield" yield-name="viewInfoTooltipYield"> <lyte-yield yield-name="viewInfoTooltipYield" prop-field="{{propField}}" prop-value="{{propValue}}"></lyte-yield> </template> </crux-view-info-tooltip> </template></template> </template></template> </template><template case="false"><template is="if" value="{{cxPropEmptyValue}}"><template case="true"> {{cxPropEmptyValue}} </template></template></template></template></template><template case="create"> <template is="if" value="{{cxPropField[cxPropFieldKey]}}"><template case="true"> <div class="cxElementLabel {{cxPropLabelClass}}"> {{cxPropField[cxPropFieldKey]}} <template is="if" value="{{cxPropInfoTooltip}}"><template case="true"> <span class="dIB vam cxInfoIcon" onmouseenter="{{action(\'showInfoTooltip\',this)}}"></span> <lyte-hovercard lt-prop-placement="topLeft" lt-prop-keep-alive="true" lt-prop-popover-wrapper-class="cxElementsHovercard" lt-prop-origin-elem=".cxCurrentHovercard" on-hovercard-hide="{{method(\'hideInfoTooltip\')}}"> <template is="registerYield" yield-name="hoverCardYield"> <lyte-hovercard-content class="cxElementsHoverCardContent"> {{cxPropInfoTooltip}} </lyte-hovercard-content> </template> </lyte-hovercard> </template></template> </div> </template></template> <div class="cxElementValue cxTwitterInputWrapper {{if(cxPropDisabled,\'cxElementDisabled\',\'\')}}"> <lyte-input lt-prop-name="{{cxPropName}}" id="{{cxPropId}}" lt-prop-title="{{cxPropTooltip}}" lt-prop-tooltip-config="{{cxPropTooltipConfig}}" lt-prop-tooltip-style="margin: 10px; font-size : 11px;" class="w100per {{if(ifEquals(cxPropAppearance,\'box\'),\'cxBoxInput cxBoxInputInsideLabel\',\'cxFlatInput\')}}" lt-prop-type="text" lt-prop-value="{{lbind(cxPropValue)}}" lt-prop-placeholder="{{cxPropPlaceholder}}" lt-prop-maxlength="{{cxPropMaxlength}}" lt-prop-direction="horizontal" lt-prop-disabled="{{cxPropDisabled}}" lt-prop-readonly="{{cxPropReadonly}}" data-zcqa="{{cxPropZcqa}}" on-value-change="{{method(\'onChange\')}}" lt-prop-appearance="{{cxPropAppearance}}" lt-prop-tab-index="{{cxPropTabIndex}}" lt-prop-label="@" lt-prop-autocomplete="{{cxPropAutocomplete}}" lt-prop-auto-update="{{cxPropEnableLbind}}" lt-prop-aria="{{cxPropAria}}" lt-prop-aria-attributes="{{cxPropAriaAttributes}}" lt-prop-tooltip-class="{{cxPropTooltipClass}}" lt-prop-wrapper-class="{{cxPropWrapperClass}}" lt-prop-class="{{cxPropInputClass}}"></lyte-input> <template is="if" value="{{cxPropShowDisabledIcon}}"><template case="true"><span class="cxElementsDisabledIcon {{cxPropDisabledIconClass}}"></span></template></template> <template is="if" value="{{isError}}"><template case="true"> <crux-error-message error-message="{{cxPropErrorMessage}}" cx-prop-error-yield="{{cxPropErrorYield}}" cx-prop-error-zcqa-prefix="{{cxPropErrorZcqaPrefix}}" cx-prop-field="{{cxPropField}}" cx-prop-error-zcqa-suffix="{{cxPropErrorZcqaSuffix}}" class="{{cxPropErrorClass}}" cx-prop-error-span-class="{{cxPropErrorSpanClass}}"><template is="registerYield" yield-name="errorYield"><lyte-yield yield-name="errorYield" error-message="{{cxPropErrorMessage}}" cx-field="{{cxPropField}}"></lyte-yield></template></crux-error-message> </template></template> </div> </template></template> </template>',_dynamicNodes:[{type:"attr",position:[1]},{type:"switch",position:[1],cases:{view:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"text",position:[0]}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,0]},{type:"attr",position:[3]},{type:"if",position:[3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"insertYield",position:[1]}]},{type:"componentDynamic",position:[1]}]}},default:{}}]}},default:{}}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"text",position:[1]}]}},default:{}}]}},default:{}}]},create:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,1]},{type:"attr",position:[1,3]},{type:"if",position:[1,3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[3]},{type:"registerYield",position:[3,1],dynamicNodes:[{type:"text",position:[1,1]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[3]}]}},default:{}}]}},default:{}},{type:"attr",position:[3]},{type:"attr",position:[3,1]},{type:"componentDynamic",position:[3,1]},{type:"attr",position:[3,3]},{type:"if",position:[3,3],cases:{true:{dynamicNodes:[{type:"attr",position:[0]}]}},default:{}},{type:"attr",position:[3,5]},{type:"if",position:[3,5],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,0],dynamicNodes:[{type:"attr",position:[0]},{type:"insertYield",position:[0]}]},{type:"componentDynamic",position:[1]}]}},default:{}}]}},default:{}}],_observedAttributes:["lyteViewPort","cxPropValue","cxPropTwitterUrl","value","cxPropEmptyValue","cxPropFrom","cxPropPlaceholder","cxPropField","cxPropMaxlength","cxPropDisabled","cxPropReadonly","cxPropZcqa","isError","cxPropAppearance","cxPropErrorMessage","cxPropFieldKey","cxPropId","cxPropName","cxPropClearErrorMessage","cxPropDirection","cxPropLabelClass","cxPropErrorYield","cxPropTabIndex","lyteUnbound","cxPropClass","cxPropTooltip","cxPropInfoTooltip","cxPropAutocomplete","cxPropEnableLbind","cxPropAria","cxPropAriaAttributes","cxPropMaskingProperties","cxPropTooltipConfig","cxPropTooltipClass","cxPropErrorZcqaPrefix","cxPropErrorZcqaSuffix","cxPropErrorClass","cxPropWrapperClass","cxPropInputClass","cxPropErrorSpanClass","cxPropLayout","cxPropViewInfoTooltip","cxPropShowDisabledIcon","cxPropDisabledIconClass"],data:function(){return{lyteViewPort:Lyte.attr("boolean",{default:!1}),cxPropValue:Lyte.attr("string"),cxPropTwitterUrl:Lyte.attr("string"),value:Lyte.attr("object"),cxPropEmptyValue:Lyte.attr("string",{default:""}),cxPropFrom:Lyte.attr("string",{default:"view"}),cxPropPlaceholder:Lyte.attr("string"),cxPropField:Lyte.attr("object",{default:{}}),cxPropMaxlength:Lyte.attr("number"),cxPropDisabled:Lyte.attr("boolean",{default:!1}),cxPropReadonly:Lyte.attr("boolean",{default:!1}),cxPropZcqa:Lyte.attr("string"),isError:Lyte.attr("boolean",{default:!1}),cxPropAppearance:Lyte.attr("string",{default:"flat"}),cxPropErrorMessage:Lyte.attr("string",{default:""}),cxPropFieldKey:Lyte.attr("string",{default:""}),cxPropId:Lyte.attr("string",{default:""}),cxPropName:Lyte.attr("string",{default:""}),cxPropClearErrorMessage:Lyte.attr("boolean",{default:!0}),cxPropDirection:Lyte.attr("string",{default:"vertical"}),cxPropLabelClass:Lyte.attr("string",{default:""}),cxPropErrorYield:Lyte.attr("boolean",{default:!1}),cxPropTabIndex:Lyte.attr("string"),lyteUnbound:Lyte.attr("boolean",{default:!1}),cxPropClass:Lyte.attr("string",{default:""}),cxPropTooltip:Lyte.attr("string",{default:""}),cxPropInfoTooltip:Lyte.attr("string",{default:""}),cxPropAutocomplete:Lyte.attr("string",{default:"on"}),cxPropEnableLbind:Lyte.attr("boolean",{default:!0}),cxPropAria:Lyte.attr("boolean",{default:!1}),cxPropAriaAttributes:Lyte.attr("object",{default:{}}),cxPropMaskingProperties:Lyte.attr("object"),cxPropTooltipConfig:Lyte.attr("string",{default:'{"position": "followcursor", "appearance": "box"}'}),cxPropTooltipClass:Lyte.attr("string"),cxPropErrorZcqaPrefix:Lyte.attr("string",{default:""}),cxPropErrorZcqaSuffix:Lyte.attr("string",{default:"Error"}),cxPropErrorClass:Lyte.attr("string"),cxPropWrapperClass:Lyte.attr("string"),cxPropInputClass:Lyte.attr("string"),cxPropErrorSpanClass:Lyte.attr("string"),cxPropLayout:Lyte.attr("string"),cxPropViewInfoTooltip:Lyte.attr("boolean",{default:!1}),cxPropShowDisabledIcon:Lyte.attr("boolean",{default:!1}),cxPropDisabledIconClass:Lyte.attr("string",{default:""})}},actions:{stopPropagation:function(){event.stopPropagation()},showInfoTooltip:function(e){this.showHideInfoTooltip(e)}},getValue:function(){return this.getData("cxPropValue")},validate:function(){var e=this.getData("cxPropField"),t=this.getData("cxPropValue");if(!t||!t.trim())return this.validateMandatory(!0)?(this.setData("cxPropErrorMessage",""),!0):(this.$node.querySelector("lyte-input")&&this.$node.querySelector("lyte-input").focus(),!1);if(t&&!this.validateLength(t))return!1;var o=this.isValidTwitter(t);return o?this.setData("cxPropErrorMessage",""):(this.getMethods("onError")?this.executeMethod("onError",this.errorCodes.ERR02,this):this.setData("cxPropErrorMessage",_cruxUtils.getI18n("crm.field.valid.check",Lyte.Component.registeredHelpers.cruxEncodeHTML(e.field_label))),this.$node.querySelector("lyte-input")&&this.$node.querySelector("lyte-input").focus()),o},methods:{onChange:function(){this.getData("cxPropClearErrorMessage")&&this.setData("cxPropErrorMessage",""),this.getMethods("onValueChange")&&this.executeMethod("onValueChange",this.getData("cxPropValue"))},hideInfoTooltip:function(){this.showHideInfoTooltip()}},observeErrorMessage:function(){this.setData("isError",""!=this.getData("cxPropErrorMessage"))}.observes("cxPropErrorMessage").on("init"),observeIsError:function(){"create"==this.getData("cxPropFrom")&&this.$node.querySelector("lyte-input")&&(this.getData("isError")?this.$node.querySelector("lyte-input").classList.add("cxErrorBox"):this.$node.querySelector("lyte-input").classList.remove("cxErrorBox"))}.observes("isError","lyteViewPort").on("didConnect"),observeMandatory:function(){this.observeMandatoryMixin("lyte-input")}.observes("cxPropField.required","lyteViewPort").on("didConnect"),init:function(){this.getData("cxPropDisabled")&&!this.data.cxPropTooltip&&this.setData("cxPropTooltip",_cruxUtils.getI18n("crm.lable.read.only")),"create"==this.data.cxPropFrom&&this.setFocusUtil()},observeClass:function(e){if("create"==this.data.cxPropFrom){var t=$L("lyte-input",this.$node);if(!t.length)return;e&&e.oldValue&&t.removeClass(e.oldValue),this.data.cxPropClass&&t.addClass(this.data.cxPropClass)}}.observes("cxPropClass","lyteViewPort").on("didConnect")},{mixins:["crux-element-validation"]}),Lyte.Component.register("crux-user-component",{_template:'<template tag-name="crux-user-component"> <template is="switch" value="{{cxPropFrom}}"><template case="view"> <template is="if" value="{{cxPropValue}}"><template case="true"> <template is="if" value="{{cxPropMaskingProperties}}"><template case="true">{{cruxMaskValue(name,cxPropMaskingProperties)}} </template><template case="false"> <span class="lv_data_user cxViewUserValue vam dIB" onmouseover="{{action(\'showBCard\')}}" onmouseout="{{action(\'hideBCard\')}}"><lyte-text lt-prop-value="{{name}}" lt-prop-show="false"></lyte-text></span> <template is="if" value="{{cxPropViewInfoTooltip}}"><template case="true"> <crux-view-info-tooltip cx-prop-field="{{cxPropField}}" cx-prop-value="{{cxPropValue}}"> <template is="yield" yield-name="viewInfoTooltipYield"> <lyte-yield yield-name="viewInfoTooltipYield" prop-field="{{propField}}" prop-value="{{propValue}}"></lyte-yield> </template> </crux-view-info-tooltip> </template></template> </template></template> </template><template case="false">{{cxPropEmptyValue}}</template></template> </template><template case="criteria"></template><template case="filter"> <crux-user-dropdown cx-prop-class="{{cxPropClass}}" cx-prop-boundary="{{cxPropBoundary}}" cx-prop-type="{{cxPropType}}" cx-prop-searchable="true" cx-prop-selected-users="{{selectedUsers}}" cx-prop-no-user-label="{{if(ifEquals(cxPropType,\'multiple\'),if(cxPropPlaceholder,cxPropPlaceholder,cruxGetI18n(\'crm.label.select.user\')),\'\')}}" cx-prop-placeholder="{{if(ifEquals(cxPropType,\'single\'),if(cxPropPlaceholder,cxPropPlaceholder,cruxGetI18n(\'crm.label.select.user\')),\'\')}}" cx-prop-selected="{{selectedIds}}" cx-prop-zcqa="{{cxPropZcqa}}" on-user-add="{{method(\'onChange\',\'add\')}}" on-user-remove="{{method(\'onChange\',\'remove\')}}" cx-prop-login-user-required="{{cxPropLoginUser}}" cx-prop-filter-options="{{userFilter}}" cx-prop-selected-user="{{selectedUser}}" on-user-selected="{{method(\'onChange\',\'select\')}}" cx-prop-filter-selected="{{cxPropFilterSelected}}" cx-prop-filter-user-value="category" cx-prop-filter-system-value="id" cx-prop-appearance="{{cxPropAppearance}}" cx-prop-query-param="{{criteria}}" cx-prop-max-limit="{{cxPropMaxLimit}}" cx-prop-freeze="{{cxPropFreeze}}" on-user-before-show="{{method(\'beforeShowHandling\')}}" on-user-drop-limit-err="{{method(\'onUserDropLimitErr\')}}" cx-prop-dropdown-icon-class="{{cxPropDropdownIconClass}}" cx-prop-is-subordinate="{{cxPropIsSubordinate}}"></crux-user-dropdown> </template><template case="create"> <template is="if" value="{{cxPropField[cxPropFieldKey]}}"><template case="true"> <div class="cxFieldLabel {{cxPropLabelClass}}"> {{cxPropField[cxPropFieldKey]}} <template is="if" value="{{cxPropInfoTooltip}}"><template case="true"> <span class="dIB vam cxInfoIcon" onmouseenter="{{action(\'showInfoTooltip\',this)}}"></span> <lyte-hovercard lt-prop-placement="topLeft" lt-prop-keep-alive="true" lt-prop-popover-wrapper-class="cxElementsHovercard" lt-prop-origin-elem=".cxCurrentHovercard" on-hovercard-hide="{{method(\'hideInfoTooltip\')}}"> <template is="registerYield" yield-name="hoverCardYield"> <lyte-hovercard-content class="cxElementsHoverCardContent"> {{cxPropInfoTooltip}} </lyte-hovercard-content> </template> </lyte-hovercard> </template></template> </div> </template></template> <div class="cxElementValue {{if(cxPropDisabled,\'cxElementDisabled\',\'\')}}" style="{{if(cxPropWidth,concat(\'width: \',cxPropWidth),\'\')}}"> <div class="cxUserComponent cxBoxWithRightIcon cxBoxContainsDropdown {{if(cxPropShowCloseIcon,\'cxUserCompWithClearIcon\')}} {{cxPropWrapperClass}}"> <div class="cxBoxLeftContent"> <crux-user-dropdown id="{{cxPropId}}" lt-prop-title="{{cxPropTooltip}}" lt-prop-tooltip-config="{{cxPropTooltipConfig}}" lt-prop-tooltip-style="margin: 10px;" cx-prop-type="{{cxPropType}}" cx-prop-searchable="true" cx-prop-selected-users="{{selectedUsers}}" cx-prop-no-user-label="{{cxPropNoUserLabel}}" cx-prop-placeholder="{{cxPropPlaceholder}}" cx-prop-selected="{{selectedIds}}" cx-prop-zcqa="{{cxPropZcqa}}" on-user-add="{{method(\'addcruxuserMultiple\')}}" on-user-remove="{{method(\'removecruxuserMultiple\')}}" cx-prop-login-user-required="{{cxPropLoginUser}}" cx-prop-selected-user="{{selectedUser}}" on-user-selected="{{method(\'onChange\',\'select\')}}" cx-prop-disabled="{{cxPropDisabled}}" cx-prop-tabindex="{{cxPropTabIndex}}" cx-prop-criteria="{{userCriteria}}" cx-prop-search-criteria="{{cxPropUserSearchCriteria}}" cx-prop-filter-options="{{cxPropFilterOptions}}" cx-prop-filter-user-value="category" cx-prop-filter-system-value="id" cx-prop-filterable="{{cxPropFilterable}}" on-user-show="{{method(\'createUserDropdownShow\')}}" cx-prop-filter-selected="{{cxPropFilterSelected}}" class="{{cxPropClass}} {{if(isError,\'cxErrorBox\')}} {{if(expHandlers(cxPropValue,\'&amp;&amp;\',cxPropValue.name),\'cxUserCompValueSelected\')}}" cx-prop-exclude="{{cxPropExclude}}" lt-prop-aria="{{cxPropAria}}" lt-prop-aria-attributes="{{cxPropAriaAttributes}}" cx-prop-max-limit="{{cxPropMaxLimit}}" lt-prop-tooltip-class="{{cxPropTooltipClass}}" cx-prop-query-param="{{criteria}}" cx-prop-freeze="{{cxPropFreeze}}" cx-prop-dropdown-icon-class="{{cxPropDropdownIconClass}}" on-user-before-show="{{method(\'beforeShow\')}}" cx-prop-is-subordinate="{{cxPropIsSubordinate}}" onfocus="{{action(\'setFocusClass\')}}" onfocusout="{{action(\'setFocusClass\',\'hide\')}}" cx-prop-scope="{{cxPropScope}}" on-user-hide="{{method(\'userHide\')}}"></crux-user-dropdown> <crux-user-lookup class="{{cxPropClass}}" style="display: none;" cx-prop-criteria="{{userCriteria}}" cx-prop-search-criteria="{{cxPropUserSearchCriteria}}" cx-prop-filterable="{{cxPropFilterable}}" cx-prop-filter-options="{{cxPropFilterOptions}}" on-assign="{{method(\'onLookupSelected\')}}" cx-prop-selected-id="{{selectedUserString}}" cx-prop-type="{{cxPropType}}" cx-prop-selected-ids="{{selectedUsersString}}" cx-prop-exclude="{{cxPropExclude}}" lt-prop-aria="{{cxPropAria}}" lt-prop-aria-attributes="{{cxPropAriaAttributes}}" cx-prop-max-limit="{{cxPropMaxLimit}}" cx-prop-filter-system-value="{{cxPropFilterSystemValue}}" cx-prop-filter-user-value="{{cxPropFilterUserValue}}" cx-prop-query-params="{{criteria}}" on-custom-request="{{method(\'customRequest\')}}" cx-prop-custom-request="{{cxPropCustomRequest}}" on-body-before-show="{{method(\'beforeShow\')}}" cx-prop-is-subordinate="{{cxPropIsSubordinate}}" cx-prop-transition="{{cxPropTransition}}" cx-prop-offset="{{cxPropOffset}}"></crux-user-lookup> <template is="if" value="{{expHandlers(expHandlers(cxPropValue,\'&amp;&amp;\',cxPropValue.name),\'&amp;&amp;\',cxPropShowCloseIcon)}}"><template case="true"> <div class="cxBoxCloseIconWrap cxFlexCenter"> <div class="cxBoxCloseIcon cP {{cxPropClearIconClass}}" onclick="{{action(\'clearSelection\')}}"></div> </div> </template></template> </div> <template is="if" value="{{cxPropShowDisabledIcon}}"><template case="true"><span class="cxElementsDisabledIcon {{cxPropDisabledIconClass}}"></span></template></template> <div class="cxBoxRightIcon cxFlexCenter {{cxPropRightIconClass}}" data-zcqa="{{if(cxPropImgZcqa,cxPropImgZcqa,concat(\'img_lookup_\',cxPropZcqa))}}" onclick="{{action(\'showcruxuserLookup\')}}"> <div class="cxUserCompIcon {{if(cxPropDisabled,\'\',\'cP\')}} {{cxPropIconClass}}"></div> </div> </div> <template is="if" value="{{isError}}"><template case="true"> <crux-error-message error-message="{{cxPropErrorMessage}}" cx-prop-error-zcqa-prefix="{{cxPropErrorZcqaPrefix}}" cx-prop-field="{{cxPropField}}" cx-prop-error-zcqa-suffix="{{cxPropErrorZcqaSuffix}}" cx-prop-error-yield="{{cxPropErrorYield}}" class="{{cxPropErrorClass}}" cx-prop-error-span-class="{{cxPropErrorSpanClass}}"> <template is="registerYield" yield-name="errorYield"> <lyte-yield yield-name="errorYield" error-message="{{cxPropErrorMessage}}" cx-field="{{cxPropField}}"></lyte-yield></template> </crux-error-message> </template></template> </div> </template></template> </template>',_dynamicNodes:[{type:"attr",position:[1]},{type:"switch",position:[1],cases:{view:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"text",position:[0]}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,0]},{type:"componentDynamic",position:[1,0]},{type:"attr",position:[3]},{type:"if",position:[3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"insertYield",position:[1]}]},{type:"componentDynamic",position:[1]}]}},default:{}}]}},default:{}}]},false:{dynamicNodes:[{type:"text",position:[0]}]}},default:{}}]},criteria:{dynamicNodes:[],additional:{next:"filter"}},filter:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]},create:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,1]},{type:"attr",position:[1,3]},{type:"if",position:[1,3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[3]},{type:"registerYield",position:[3,1],dynamicNodes:[{type:"text",position:[1,1]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[3]}]}},default:{}}]}},default:{}},{type:"attr",position:[3],attr:{style:{name:"style",helperInfo:{name:"if",args:["cxPropWidth",{type:"helper",value:{name:"concat",args:["'width: '","cxPropWidth"]}},"''"]}}}},{type:"attr",position:[3,1]},{type:"attr",position:[3,1,1,1]},{type:"componentDynamic",position:[3,1,1,1]},{type:"attr",position:[3,1,1,3]},{type:"componentDynamic",position:[3,1,1,3]},{type:"attr",position:[3,1,1,5]},{type:"if",position:[3,1,1,5],cases:{true:{dynamicNodes:[{type:"attr",position:[1,1]}]}},default:{}},{type:"attr",position:[3,1,3]},{type:"if",position:[3,1,3],cases:{true:{dynamicNodes:[{type:"attr",position:[0]}]}},default:{}},{type:"attr",position:[3,1,5]},{type:"attr",position:[3,1,5,1]},{type:"attr",position:[3,3]},{type:"if",position:[3,3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"insertYield",position:[1]}]},{type:"componentDynamic",position:[1]}]}},default:{}}]}},default:{}}],_observedAttributes:["lyteViewPort","cxPropValue","cxPropIdSelector","cxPropNameSelector","cxPropFrom","cxPropEmptyValue","selectedUsers","selectedIds","cxPropZcqa","cxPropLoginUser","cxPropType","cxPropContactServerUrl","cxPropErrorMessage","filterOptions","cxPropIsBusinessCard","userFilter","cxPropField","cxPropFieldKey","selectedUser","cxPropId","userCriteria","cxPropUserSearchCriteria","cxPropFilterOptions","cxPropClearErrorMessage","cxPropFilterable","cxPropLabelClass","cxPropBoundary","userCriteria","cxPropDisableOnHoverForView","selectedUserString","selectedUsersString","cxPropTabIndex","lyteUnbound","cxPropClass","cxPropTooltip","isError","cxPropAppearance","cxPropErrorYield","cxPropInfoTooltip","cxPropPlaceholder","cxPropExclude","cxPropShowCloseIcon","cxPropImgZcqa","criteria","cxPropAria","cxPropAriaAttributes","cxPropMaxLimit","cxPropFilterSystemValue","cxPropFilterUserValue","cxPropShowBusCard","cxPropNoUserLabel","cxPropMaskingProperties","cxPropOpenDropdown","cxPropTooltipConfig","cxPropTooltipClass","cxPropDisabled","cxPropShowTooltip","cxPropShowBusinessCard","cxPropErrorZcqaPrefix","cxPropErrorZcqaSuffix","cxPropQueryParam","cxPropFilterSelected","cxPropReturnFullObjectOnGet","cxPropCustomRequest","cxPropErrorClass","cxPropFreeze","cxPropErrorSpanClass","cxPropClearIconClass","cxPropIconClass","cxPropDropdownIconClass","cxPropReadonly","cxPropRightIconClass","cxPropWrapperClass","cxPropLayout","cxPropWidth","cxPropIsSubordinate","cxPropAutocomplete","cxPropViewInfoTooltip","cxPropScope","cxPropShowDisabledIcon","cxPropDisabledIconClass","cxPropTransition","cxPropOffset"],data:function(){return{lyteViewPort:Lyte.attr("boolean",{default:!1}),cxPropValue:Lyte.attr("object"),cxPropIdSelector:Lyte.attr("string",{default:"id"}),cxPropNameSelector:Lyte.attr("string",{default:"name"}),cxPropFrom:Lyte.attr("string",{default:"view"}),cxPropEmptyValue:Lyte.attr("string",{default:""}),selectedUsers:Lyte.attr("array",{default:[]}),selectedIds:Lyte.attr("string"),cxPropZcqa:Lyte.attr("string"),cxPropLoginUser:Lyte.attr("boolean",{default:!1}),cxPropType:Lyte.attr("string"),cxPropContactServerUrl:Lyte.attr("string",{default:"undefined"!=typeof crmConstants?crmConstants.contactsPhotoURL:""}),cxPropErrorMessage:Lyte.attr("string",{default:""}),filterOptions:Lyte.attr("array",{default:[{id:"ActiveUsers",category:"Active"}]}),cxPropIsBusinessCard:Lyte.attr("boolean"),userFilter:Lyte.attr("array",{default:[{id:"AllUsers",category:_cruxUtils.getI18n("crm.globalsearch.option.all")},{id:"ActiveUsers",category:_cruxUtils.getI18n("webform.status.Active")},{id:"DeactiveUsers",category:_cruxUtils.getI18n("Inactive")},{id:"NotConfirmedUsers",category:_cruxUtils.getI18n("crm.user.component.unconfirmed")}]}),cxPropField:Lyte.attr("object",{default:{}}),cxPropFieldKey:Lyte.attr("string",{default:""}),selectedUser:Lyte.attr("object",{default:{}}),cxPropId:Lyte.attr("string",{default:""}),userCriteria:Lyte.attr("string"),cxPropUserSearchCriteria:Lyte.attr("string"),cxPropFilterOptions:Lyte.attr("array",{default:[]}),cxPropClearErrorMessage:Lyte.attr("boolean",{default:!0}),cxPropFilterable:Lyte.attr("boolean",{default:!0}),cxPropLabelClass:Lyte.attr("string",{default:""}),cxPropBoundary:Lyte.attr("object",{default:{}}),userCriteria:Lyte.attr("string",{default:""}),cxPropDisableOnHoverForView:Lyte.attr("boolean",{default:!1}),selectedUserString:Lyte.attr("string",{default:""}),selectedUsersString:Lyte.attr("array",{default:[]}),cxPropTabIndex:Lyte.attr("string",{default:"0"}),lyteUnbound:Lyte.attr("boolean",{default:!1}),cxPropClass:Lyte.attr("string",{default:""}),cxPropTooltip:Lyte.attr("string",{default:""}),isError:Lyte.attr("boolean",{default:!1}),cxPropAppearance:Lyte.attr("string",{default:"flat"}),cxPropErrorYield:Lyte.attr("boolean",{default:!1}),cxPropInfoTooltip:Lyte.attr("string",{default:""}),cxPropPlaceholder:Lyte.attr("string",{default:_cruxUtils.getI18n("crm.label.select.user")}),cxPropExclude:Lyte.attr("array",{default:[]}),cxPropShowCloseIcon:Lyte.attr("boolean",{default:!1}),cxPropImgZcqa:Lyte.attr("string"),criteria:Lyte.attr("object",{default:{}}),cxPropAria:Lyte.attr("boolean",{default:!1}),cxPropAriaAttributes:Lyte.attr("object",{default:{}}),cxPropMaxLimit:Lyte.attr("number",{default:500}),cxPropFilterSystemValue:Lyte.attr("string",{default:"id"}),cxPropFilterUserValue:Lyte.attr("string",{default:"category"}),cxPropShowBusCard:Lyte.attr("boolean"),cxPropNoUserLabel:Lyte.attr("string"),cxPropMaskingProperties:Lyte.attr("object"),cxPropOpenDropdown:Lyte.attr("boolean",{default:!1}),cxPropTooltipConfig:Lyte.attr("string",{default:'{"position": "followcursor", "appearance": "box"}'}),cxPropTooltipClass:Lyte.attr("string"),cxPropDisabled:Lyte.attr("boolean",{default:!1}),cxPropShowTooltip:Lyte.attr("boolean",{default:!0}),cxPropShowBusinessCard:Lyte.attr("boolean",{default:!0}),cxPropErrorZcqaPrefix:Lyte.attr("string",{default:""}),cxPropErrorZcqaSuffix:Lyte.attr("string",{default:"Error"}),cxPropQueryParam:Lyte.attr("object",{default:{}}),cxPropFilterSelected:Lyte.attr("string",{default:"ActiveUsers"}),cxPropReturnFullObjectOnGet:Lyte.attr("boolean",{default:!1}),cxPropCustomRequest:Lyte.attr("boolean",{default:!1}),cxPropErrorClass:Lyte.attr("string"),cxPropFreeze:Lyte.attr("boolean",{default:!1}),cxPropErrorSpanClass:Lyte.attr("string"),cxPropClearIconClass:Lyte.attr("string"),cxPropIconClass:Lyte.attr("string",{default:"dropdown"}),cxPropDropdownIconClass:Lyte.attr("string",{default:"dropdown"}),cxPropReadonly:Lyte.attr("boolean",{default:!1}),cxPropRightIconClass:Lyte.attr("string"),cxPropWrapperClass:Lyte.attr("string"),cxPropLayout:Lyte.attr("string"),cxPropWidth:Lyte.attr("string"),cxPropIsSubordinate:Lyte.attr("boolean",{default:!1}),cxPropAutocomplete:Lyte.attr("boolean",{default:!0}),cxPropViewInfoTooltip:Lyte.attr("boolean",{default:!1}),cxPropScope:Lyte.attr("string",{default:""}),cxPropShowDisabledIcon:Lyte.attr("boolean",{default:!1}),cxPropDisabledIconClass:Lyte.attr("string",{default:""}),cxPropTransition:Lyte.attr("object",{default:{animation:"slideFromTop",duration:"0.5"}}),cxPropOffset:Lyte.attr("object",{default:{top:"0px",left:"center"}})}},init:function(){var e=this.data.cxPropQueryParam||{};"create"!=this.getData("cxPropFrom")&&"view"!=this.data.cxPropFrom&&(this.data.cxPropType||(this.data.cxPropType="multiple"),this.getData("cxPropField")&&20==this.getData("cxPropField").ui_type?e.include_lite_users=!0:-1!=["filter","criteria"].indexOf(this.getData("cxPropFrom"))&&"undefined"!=typeof Crm&&Crm.userDetails&&Crm.userDetails.LITE&&Crm.userDetails.LITE.IS_LITE_USER&&this.setData("cxPropLoginUser",!1),"filter"===this.getData("cxPropFrom")&&Lyte.arrayUtils(this.getData("userFilter"),"push",{id:"DeletedUsers",category:_cruxUtils.getI18n("DeletedUser")})),this.setData("criteria",e),"create"==this.data.cxPropFrom&&this.setFocusUtil()},actions:{showBCard:function(){if(!(this.multiUsers||"undefined"!=typeof Crm&&Crm.userDetails.CLIENT_ACCOUNT)||this.data.cxPropShowBusCard){var e=this.getData("cxPropValue");if(e&&this.data.cxPropShowBusinessCard){var t=e[this.getData("cxPropIdSelector")],o=document.getElementById("popoverTooltip");o||((o=document.createElement("crux-user-tooltip")).setAttribute("id","popoverTooltip"),this.$node.append(o)),o.setData({userId:t,usermetaInfo:e}),o.component.show(this.$node.querySelector("span"),!this.getData("cxPropIsBusinessCard"))}}},hideBCard:function(){if(!this.multiUsers){var e=document.getElementById("popoverTooltip");e&&e.component.hide()}},showcruxuserLookup:function(){if(this.data.cxPropDisabled)return!1;var e=this.$node.querySelector("crux-user-lookup");e&&e.component.setData("cxPropShow",!0)},clearSelection:function(){this.setData("userRecord",{}),this.setData("cxPropValue",{}),this.$node.querySelector("crux-user-dropdown").setData("cxPropSelected",""),this.$node.querySelector("lyte-dropdown").setData("ltPropDisplayValue",_cruxUtils.getI18n("None")),this.getMethods("onClear")&&this.executeMethod("onClear")},showInfoTooltip:function(e){this.showHideInfoTooltip(e)},setFocusClass:function(e){"hide"==e?this.removeFocus():this.$node.querySelector(".cxUserComponent").classList.add("cxBoxDropdownFocused")}},getValue:function(){if(this.$node.querySelector("#cruxLoadingElem"))return this.data.cxPropValue&&this.data.cxPropValue.users?this.data.cxPropValue.users:this.data.cxPropValue;var e=this.$node.querySelector("crux-user-dropdown").cxProp("selectedUsers");return e&&e.length||"create"==this.data.cxPropFrom&&"multiple"==this.data.cxPropType?this.getValueToRet(e,!0):this.getValueToRet(this.$node.querySelector("crux-user-dropdown").cxProp("selectedUser"),!0)},valueObserver:function(){if("view"!=this.getData("cxPropFrom")){if(this.getData("cxPropValue"))if(this.getData("cxPropValue").hasOwnProperty("name"))"${CURRENTUSER}"==this.getData("cxPropValue").name?this.setData("selectedUser",{id:"${CURRENTUSER}",full_name:_cruxUtils.getI18n("current.logged.in.user")}):this.setData("selectedUser",Object.assign({full_name:this.data.cxPropValue.name},this.getValueToRet(this.data.cxPropValue)));else if(this.getData("cxPropValue").users&&this.getData("cxPropValue").users.hasOwnProperty("name"))"${CURRENTUSER}"==this.getData("cxPropValue").users.name?this.setData("selectedUsers",[{id:"${CURRENTUSER}",full_name:_cruxUtils.getI18n("current.logged.in.user")}]):this.setData("selectedUsers",[{id:this.getData("cxPropValue").users.id,full_name:this.getData("cxPropValue").users.name}]);else if(this.getData("cxPropValue").users){var e=[],t=!0,o=[];p=(p=store.peekRecord("field",this.data.cxPropField.id))||this.data.cxPropField;for(var a=0;a<this.getData("cxPropValue").users.length;a++)p&&this.data.cxPropValue.users[a][p.multiuserlookup?p.multiuserlookup.connectedlookup_apiname:p.api_name]?e.push({id:this.data.cxPropValue.users[a][p.multiuserlookup?p.multiuserlookup.connectedlookup_apiname:p.api_name].id,full_name:this.data.cxPropValue.users[a][p.multiuserlookup?p.multiuserlookup.connectedlookup_apiname:p.api_name].name}):this.getData("cxPropValue").users[a].name||"${CURRENTUSER}"==this.getData("cxPropValue").users[a].id||(t=!1,o.push(this.getData("cxPropValue").users[a].id)),"${CURRENTUSER}"==this.getData("cxPropValue").users[a].name||"${CURRENTUSER}"==this.getData("cxPropValue").users[a].id?e.push({id:"${CURRENTUSER}",full_name:_cruxUtils.getI18n("current.logged.in.user")}):this.getData("cxPropValue").users[a].name&&e.push({id:this.getData("cxPropValue").users[a].id,full_name:this.getData("cxPropValue").users[a].name});if(t)this.setData("selectedUsers",e);else{var r=this;store.findAll("user",{ids:o.join(",")}).then(function(){for(var t=0;t<r.getData("cxPropValue").users.length;t++)if("${CURRENTUSER}"!=r.getData("cxPropValue").users[t].id){var o=store.peekRecord("user",r.getData("cxPropValue").users[t].id);e.push({id:o.id,full_name:o.full_name})}r.setData("selectedUsers",e)},function(){r.setData("selectedUsers",e)})}}else if(this.data.cxPropValue.hasOwnProperty("id")){r=this;store.findRecord("user",this.data.cxPropValue.id).then(function(e){r.setData("selectedUser",e[0])})}else this.setData("selectedUser",{});if("create"==this.data.cxPropFrom){if(void 0==this.getData("cxPropType")&&(this.data.cxPropType="single"),this.getData("cxPropField")&&(8==this.getData("cxPropField").ui_type||"ownerlookup"==this.data.cxPropField.data_type)){var i=this.getData("cxPropField").module[0]?this.getData("cxPropField").module[0].profiles:this.getData("cxPropField").module.profiles;if(i){var s=[],l=[];for(a=0;a<i.length;a++)s.push(i[a].id),l.push(i[a].name);this.setData("userCriteria",JSON.stringify([{comparator:"in",field:"profile.id",value:s}])),this.data.cxPropUserSearchCriteria?this.setData("cxPropUserSearchCriteria","("+this.data.cxPropUserSearchCriteria+"and(profile:in:"+l.join()+"))"):this.setData("cxPropUserSearchCriteria","(profile:in:"+l.join()+")")}}this.getData("cxPropDisabled")&&!this.data.cxPropTooltip&&this.setData("cxPropTooltip",_cruxUtils.getI18n("crm.lable.read.only"))}}else{if(this.getData("cxPropValue"))if((e=this.getData("cxPropValue")).hasOwnProperty("id")||e.name&&"${CURRENTUSER}"==e.name)"${CURRENTUSER}"==e.name?(this.multiUsers=!0,this.setData("name",_cruxUtils.getI18n("current.logged.in.user"))):this.setData({id:e[this.getData("cxPropIdSelector")],name:e[this.getData("cxPropNameSelector")]});else{this.multiUsers=!0,e=e.users;var p,n=[];p=(p=store.peekRecord("field",this.data.cxPropField.id))||this.data.cxPropField;for(a=0;a<e.length;a++)n.push(e[a][p.multiuserlookup?p.multiuserlookup.connectedlookup_apiname:p.api_name][this.getData("cxPropNameSelector")]);this.setData("name",n.join(","))}}}.observes("cxPropValue","cxPropFrom").on("init"),validate:function(){var e=this.getData("cxPropField");return"create"==this.getData("cxPropFrom")?("single"!=this.data.cxPropType||this.validateMandatory(void 0==this.$node.querySelector("crux-user-dropdown")||0==this.$node.querySelector("crux-user-dropdown").length||0==Object.keys(this.$node.querySelector("crux-user-dropdown").cxProp("selectedUser")).length))&&("multiple"!=this.data.cxPropType||this.validateMandatory(void 0==this.$node.querySelector("crux-user-dropdown")||0==this.$node.querySelector("crux-user-dropdown").length||0==Object.keys(this.$node.querySelector("crux-user-dropdown").cxProp("selectedUsers")).length))?(this.setData("cxPropErrorMessage",""),!0):(this.setData("cxPropErrorMessage",_cruxUtils.getI18n("crm.field.empty.check",e.field_label)),!1):!this.$node.querySelector("crux-user-dropdown").cxProp("selectedUsers")||0!=this.$node.querySelector("crux-user-dropdown").cxProp("selectedUsers").length||"single"==this.data.cxPropType||(this.showAlert(_cruxUtils.getI18n("crm.field.valid.check",Lyte.Component.registeredHelpers.cruxEncodeHTML(e.field_label))),!1)},methods:{onChange:function(e,t,o,a){var r;this.getData("cxPropClearErrorMessage")&&this.setData("cxPropErrorMessage",""),r="single"==this.getData("cxPropType")?this.getValueToRet(o):this.getValueToRet(a),this.setData("cxPropValue",r),this.getMethods("onValueChange")&&("create"==this.getData("cxPropFrom")?this.executeMethod("onValueChange",r,e):this.executeMethod("onValueChange",r))},createUserDropdownShow:function(e,t){$L(t.$node).closest(".cxUserComponent").addClass("cxBoxDropdownOpened")},onLookupSelected:function(e){this.getData("cxPropClearErrorMessage")&&this.setData("cxPropErrorMessage","");var t=this.getData("cxPropField");if(void 0!=t&&445==t.ui_type||"single"!=this.getData("cxPropType"))this.setData("selectedUsers",e);else{var o=this.$node.querySelector("crux-user-lookup");o&&o.setData("cxPropSelectedId",e.id);var a=this.$node.querySelector("crux-user-dropdown");a&&a.setData("cxPropSelectedUser",e),this.setData("userRecord",e)}this.setData("cxPropValue",this.getValue()),this.getMethods("onValueChange")&&this.executeMethod("onValueChange",this.getValue(),"add")},addcruxuserMultiple:function(e,t,o){this.getData("cxPropClearErrorMessage")&&this.setData("cxPropErrorMessage",""),this.setData("selectedUsers",o),this.getMethods("onValueChange")&&this.executeMethod("onValueChange",this.getValue(),"add")},removecruxuserMultiple:function(e,t,o){this.getData("cxPropClearErrorMessage")&&this.setData("cxPropErrorMessage",""),this.setData("selectedUsers",o),this.getMethods("onValueChange")&&this.executeMethod("onValueChange",this.getValue(),"remove")},hideInfoTooltip:function(){this.showHideInfoTooltip()},customRequest:function(e,t,o,a,r){if(this.getMethods("onCustomRequest"))return this.executeMethod("onCustomRequest",e,t,o,a,r)},beforeShowHandling:function(){this.getMethods("onBeforeShow")&&this.executeMethod("onBeforeShow",arguments[0],arguments[1])},onUserDropLimitErr:function(){this.getMethods("maxUserDropLimitErr")&&this.executeMethod("maxUserDropLimitErr")},beforeShow:function(){if(this.data.cxPropReadonly)return!1;if(!this.data.cxPropAutocomplete){var e=this.$node.querySelector("crux-user-lookup");if(e)e.component.setData("cxPropShow",!0);return!1}return this.getMethods("onBeforeShow")?this.executeMethod("onBeforeShow"):void 0},hideUserDropdown:function(e,t){e&&"Tab"==e.key&&$L(t.$node).closest(".cxUserComponent").removeClass("cxBoxDropdownOpened")},userHide:function(){this.$node.querySelector(".cxUserComponent").classList.remove("cxBoxDropdownOpened")}},observeErrorMessage:function(){this.setData("isError",""!=this.getData("cxPropErrorMessage"));var e=$L(this.$node).find(".cxBoxWithRightIcon");this.getData("isError")?e.addClass("cxErrorBoxWithRightIcon"):e.removeClass("cxErrorBoxWithRightIcon")}.observes("cxPropErrorMessage"),getValueToRet:function(e,t){if(Array.isArray(e)){for(var o=[],a=0;a<e.length;a++)"${CURRENTUSER}"==e[a].id?o.push({name:e[a].id}):o.push({id:e[a].id,name:e[a].full_name});return o}return"${CURRENTUSER}"==e.id?{name:e.id}:e.id?this.data.cxPropReturnFullObjectOnGet?Object.assign(e,{name:e.full_name}):{id:e.id,name:e.full_name}:void 0},binduserLookup_multiple:function(e,t){var o=this.$node.querySelector("crux-user-dropdown");if(o){var a=[];if(o.component.getData("cxPropSelectedUsers").forEach(function(e){a.push(e.id)}),"add"==t)a.push(e.id);else{var r=a.indexOf(e.id);Lyte.arrayUtils(a,"removeAt",r,1)}a&&this.setData("userRecordids",a)}},observeSelectedUser:function(){var e=this.getData("selectedUser");if(0==Object.keys(e).length)if(this.getData("selectedUsers")&&this.getData("selectedUsers").length>0){var t=this.getData("selectedUsers").map(function(e){return e.id});this.setData("selectedUsersString",t)}else this.setData("selectedUserString",""),this.setData("selectedUsersString",[]);else this.setData("selectedUserString",e.id)}.observes("selectedUser","selectedUsers").on("init"),observeMandatory:function(){this.observeMandatoryMixin(".cxUserComponent")}.observes("cxPropField.required","lyteViewPort").on("didConnect"),openDropdownObserver:function(){this.getData("cxPropOpenDropdown")&&setTimeout(function(){this.$node.querySelector("lyte-dropdown").open()}.bind(this),100)}.observes("cxPropOpenDropdown").on("didConnect"),didConnect:function(){if("create"==this.data.cxPropFrom&&document.body.addEventListener("click",this.removeFocus.bind(this)),this.$node.querySelector("crux-user-dropdown")&&this.data.cxPropCustomRequest){var e=this;this.$node.querySelector("crux-user-dropdown").setMethods({onCustomUserRequest:function(t,o,a,r,i){return e.executeMethod("onCustomRequest",t,o,a,r,i)}})}if(this.$node.querySelector("crux-user-dropdown")&&this.data.cxPropCustomRequest){e=this;this.$node.querySelector("crux-user-dropdown").setMethods({onCustomUserRequest:function(t,o,a,r,i){return e.executeMethod("onCustomRequest",t,o,a,r,i)}})}},removeFocus:function(){var e=this.$node?this.$node.querySelector(".cxUserComponent"):null;e&&e.querySelector("lyte-dropdown")&&!e.querySelector("lyte-dropdown").getData("ltPropIsOpen")&&e.classList.remove("cxBoxDropdownFocused")},didDestroy:function(){"create"==this.data.cxPropFrom&&document.body.removeEventListener("click",this.removeFocus.bind(this))}},{mixins:["crux-element-validation"]}),Lyte.Component.register("crux-user-tooltip",{_template:'<template tag-name="crux-user-tooltip"> <lyte-popover lt-prop-origin-elem="{{originElem}}" lt-prop-show-close-button="false" lt-prop-freeze="false" lt-prop-scrollable="false" lt-prop-wrapper-class="cxInfoPopover" lt-prop-type="{{toolTipType}}" on-before-show="{{method(\'showPopover\')}}" lt-prop-duration="0" lt-prop-show="{{show}}" lt-prop-max-width="500px" lt-prop-content-padding="15px 10px" lt-prop-placement="{{placement}}"> <template is="registerYield" yield-name="popover"> <lyte-popover-content class="cxUserbcpopup"> <div class="crm-font-regular"> <template is="if" value="{{expHandlers(userData.status,\'===\',\'deleted\')}}"><template case="true"> <div class="p10 pT2 pB15 cxRedCol f14">{{cruxGetI18n(\'crm.user.deleted\')}}</div> </template></template> <template is="if" value="{{expHandlers(userData.status,\'===\',\'closed\')}}"><template case="true"> <div class="p10 pT2 pB15 cxRedCol f14">{{cruxGetI18n(\'crm.account.closed\')}}</div> </template></template> <div class="cxUpSpace"> <div class="tcell vat pT2"> <img class="cxUpSize vam" src="{{getCruxUsrImgUrlByZuid(userData.zuid)}}"> </div> <div class="tcell pL10 vam"> <div class="{{if(clientUser,\'\',\'cP\')}} dIB f15 mB2 color_2 wB" data-zcqa="cxUserName" onclick="{{action(\'openUserPage\')}}">{{userData.full_name}}</div> <template is="if" value="{{expHandlers(userData.role,\'&amp;&amp;\',userData.profile)}}"><template case="true"> <div class="f12 color_5 wB" data-zcqa="cxUserProf">{{userData.role.name}}, {{userData.profile.name}}</div> </template></template> </div> </div> <div class="cxUserbcInfo f13"> <template is="if" value="{{userData.email}}"><template case="true"> <div class="pT5 pB5"> <div class="w20 tcell aligncenter"> <span class="dIB cxEmailIcon vam"></span> </div> <span class="tcell pL10 wB" data-zcqa="cxUserMail"> <a class="cxMailLnk color_2" href="mailto:{{userData.email}}">{{userData.email}}</a> </span> </div> </template></template><template is="if" value="{{userData.phone}}"><template case="true"> <div class="pT5 pB5"> <div class="w20 tcell aligncenter vam pT2"> <span class="dIB cxPhoneIcon"></span> </div> <span class="tcell pL10 color_2 vam wB">{{userData.phone}}</span> </div> </template></template><template is="if" value="{{userData.mobile}}"><template case="true"> <div class="pT5 pB5"> <div class="w20 tcell aligncenter"> <span class="dIB cxMobileIcon vam"></span> </div> <span class="tcell pL10 color_2 vam wB">{{userData.mobile}}</span> </div> </template></template> </div> <template is="if" value="{{expHandlers(expHandlers(isChatEnabled,\'&amp;&amp;\',expHandlers(isCurrentUser,\'!\')),\'&amp;&amp;\',userData.zuid)}}"><template case="true"> <div class="cxDashBorder m10"></div> <div id="actionLayer" class="clearFix mL10"> <div class="cxBcActionIcons" lt-prop-title="{{cruxGetI18n(\'crm.start.chat\')}}" lt-prop-tooltip-config="{&quot;position&quot;:&quot;top&quot;}" onclick="{{action(\'chat\')}}" data-zcqa="cxUserChat"> <span class="cxBcChatIcon dIB"></span> </div> <div class="cxBcActionIcons" lt-prop-title="{{cruxGetI18n(\'crm.start.call\')}}" lt-prop-tooltip-config="{&quot;position&quot;:&quot;top&quot;}" onclick="{{action(\'call\')}}" data-zcqa="cxUserAudioCall"> <span class="cxBcCallIcon dIB"></span> </div> <div class="cxBcActionIcons" lt-prop-title="{{cruxGetI18n(\'crm.start.video.call\')}}" lt-prop-tooltip-config="{&quot;position&quot;:&quot;top&quot;}" onclick="{{action(\'videoCall\')}}" data-zcqa="cxUserVideoCall"> <span class="cxVideoCallIcon dIB"></span> </div> </div> </template></template> </div> </lyte-popover-content> </template> </lyte-popover> </template>',_dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"attr",position:[1,1,1]},{type:"if",position:[1,1,1],cases:{true:{dynamicNodes:[{type:"text",position:[1,0]}]}},default:{}},{type:"attr",position:[1,1,3]},{type:"if",position:[1,1,3],cases:{true:{dynamicNodes:[{type:"text",position:[1,0]}]}},default:{}},{type:"attr",position:[1,1,5,1,1]},{type:"attr",position:[1,1,5,3,1]},{type:"text",position:[1,1,5,3,1,0]},{type:"attr",position:[1,1,5,3,3]},{type:"if",position:[1,1,5,3,3],cases:{true:{dynamicNodes:[{type:"text",position:[1,0]},{type:"text",position:[1,2]}]}},default:{}},{type:"attr",position:[1,1,7,1]},{type:"if",position:[1,1,7,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1,3,1]},{type:"text",position:[1,3,1,0]}]}},default:{}},{type:"attr",position:[1,1,7,2]},{type:"if",position:[1,1,7,2],cases:{true:{dynamicNodes:[{type:"text",position:[1,3,0]}]}},default:{}},{type:"attr",position:[1,1,7,3]},{type:"if",position:[1,1,7,3],cases:{true:{dynamicNodes:[{type:"text",position:[1,3,0]}]}},default:{}},{type:"attr",position:[1,1,9]},{type:"if",position:[1,1,9],cases:{true:{dynamicNodes:[{type:"attr",position:[3,1]},{type:"attr",position:[3,3]},{type:"attr",position:[3,5]}]}},default:{}},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1]}],_observedAttributes:["originElem","originelemRef","toolTipType","show","userId","userData","usermetaInfo","isCurrentUser","isChatEnabled","inPopover"],data:function(){return{originElem:Lyte.attr("string"),originelemRef:Lyte.attr("string"),toolTipType:Lyte.attr("string"),show:Lyte.attr("boolean",{default:!1}),userId:Lyte.attr("string"),userData:Lyte.attr("object"),usermetaInfo:Lyte.attr("object",{default:{}}),isCurrentUser:Lyte.attr("boolean",{default:!1}),isChatEnabled:Lyte.attr("boolean",{default:!1}),inPopover:Lyte.attr("boolean",{default:!1})}},methods:{showPopover:function(){var e=this,t=this.getData("userId"),o=store.peekRecord("user",t);if(void 0==o)return store.findRecord("user",t,{},!1,!0,{tempApiVersion:"V2.1"}).then(function(o){if(!o||o&&!Object.keys(o).length){var a=e.getData("usermetaInfo");a&&a.name?(a.full_name=a.name,delete a.name):(a={}).full_name="PORTAL USER",a.id=t,a.client_user=!0,store.pushPayload("user",a)}this.setData("show",!0)}.bind(this)),this.setData("show",!1),!1;this.setData("isChatEnabled","undefined"!=typeof crmConstants&&crmConstants.isCliqEnabled),this.setData("isCurrentUser","undefined"!=typeof Crm&&t==Crm.userDetails.USER_ID),this.setData("userData",o),this.setData("clientUser",o.client_user)}},actions:{openUserPage:function(){this.getData("clientuser")||"undefined"!=typeof Crm&&Crm.userDetails.CLIENT_ACCOUNT||Crm.getCrmBasePath()&&-1!=Crm.getCrmBasePath().indexOf("crm")&&window.open(Crm.getCrmBasePath()+"/settings/users/"+this.getData("userId"),"_blank")},chat:function(){WebMessanger.chat(this.getData("userData").zuid)},call:function(){WebMessanger.startAudioCall(this.getData("userData").zuid)},videoCall:function(){WebMessanger.startVideoCall(this.getData("userData").zuid)}},show:function(e,t){if(clearTimeout(this.hideTimeout),e.isSameNode(this.getData("originElemRef"))||this.setData("show",!1),this.setOriginElem(e),this.setData("originElem",".userBcOrigin"),t){var o=e.getBoundingClientRect().x,a=window._lyteUiUtils&&window._lyteUiUtils.getRTL()?["right","left"]:["left","right"];t=a[0];(o-350<=0||o+e.offsetWidth+350<window.innerWidth)&&(t=a[1]),this.setData("placement",t),this.setData("toolTipType","callout")}else this.setData("toolTipType","box"),this.setData("placement",void 0);var r=this;this.hideTimeout=setTimeout(function(){if(r.setData("show",!0),!r.getData("listenersAdded")){var e=document.querySelector(".cxInfoPopover .lytePopover");e.addEventListener("mouseleave",r._leaveFunc),e.addEventListener("mouseenter",r._enterFunc),r.setData("listenersAdded",!0)}},300)},hide:function(){var e=this;clearTimeout(this.hideTimeout),this.hideTimeout=setTimeout(function(){e.removeOriginElem(),e.setData("show",!1)},300)},setOriginElem:function(e){this.removeOriginElem(),e.classList.add("userBcOrigin"),this.setData("originElemRef",e)},removeOriginElem:function(){for(var e=document.getElementsByClassName("userBcOrigin"),t=e.length,o=0;o<t;o++)e[0].classList.remove("userBcOrigin");this.setData("originElemRef",void 0)},_leaveFunc:function(){var e=document.getElementsByTagName("crux-user-tooltip")[0].component;e.setData("inPopover",!1),e.hide()},_enterFunc:function(){var e=document.getElementsByTagName("crux-user-tooltip")[0].component;clearTimeout(e.hideTimeout),e.setData("inPopover",!0),e.setData("show",!0)}}),Lyte.Component.registerHelper("getCruxUsrImgUrlByZuid",function(e){return"undefined"!=typeof RebrandLinkUtil?"//"+RebrandLinkUtil.getProperty("CONTACTS_URL")+"/file?ID="+e+"&fs=thumb":""}),Lyte.Component.register("crux-website-component",{_template:'<template tag-name="crux-website-component"> <template is="switch" value="{{cxPropFrom}}"><template case="view"> <template is="if" value="{{cxPropValue}}"><template case="true"> <template is="if" value="{{cxPropMaskingProperties}}"><template case="true">{{cruxMaskValue(cxPropValue,cxPropMaskingProperties)}} </template><template case="false"><a class="link" href="{{href}}" target="_blank" onclick="{{action(\'stopPropagation\')}}">{{cxPropValue}}</a><template is="if" value="{{cxPropViewInfoTooltip}}"><template case="true"> <crux-view-info-tooltip cx-prop-field="{{cxPropField}}" cx-prop-value="{{cxPropValue}}"> <template is="yield" yield-name="viewInfoTooltipYield"> <lyte-yield yield-name="viewInfoTooltipYield" prop-field="{{propField}}" prop-value="{{propValue}}"></lyte-yield> </template> </crux-view-info-tooltip> </template></template></template></template> </template><template case="false"><template is="if" value="{{cxPropEmptyValue}}"><template case="true">{{cxPropEmptyValue}}</template></template></template></template></template><template case="create"> <template is="if" value="{{cxPropField[cxPropFieldKey]}}"><template case="true"> <div class="cxElementLabel {{cxPropLabelClass}}"> {{cxPropField[cxPropFieldKey]}} <template is="if" value="{{cxPropInfoTooltip}}"><template case="true"> <span class="dIB vam cxInfoIcon" onmouseenter="{{action(\'showInfoTooltip\',this)}}"></span> <lyte-hovercard lt-prop-placement="topLeft" lt-prop-keep-alive="true" lt-prop-popover-wrapper-class="cxElementsHovercard" lt-prop-origin-elem=".cxCurrentHovercard" on-hovercard-hide="{{method(\'hideInfoTooltip\')}}"> <template is="registerYield" yield-name="hoverCardYield"> <lyte-hovercard-content class="cxElementsHoverCardContent"> {{cxPropInfoTooltip}} </lyte-hovercard-content> </template> </lyte-hovercard> </template></template> </div> </template></template> <div class="cxElementValue {{if(cxPropDisabled,\'cxElementDisabled\',\'\')}}"> <lyte-input lt-prop-name="{{cxPropName}}" id="{{cxPropId}}" lt-prop-title="{{cxPropTooltip}}" lt-prop-tooltip-config="{{cxPropTooltipConfig}}" lt-prop-tooltip-style="margin: 10px; font-size : 11px;" lt-prop-class="cxBorderBottom {{cxPropInputClass}}" class="w100per {{if(ifEquals(cxPropAppearance,\'box\'),\'cxBoxInput\',\'cxFlatInput\')}}" lt-prop-type="text" lt-prop-value="{{lbind(cxPropValue)}}" lt-prop-maxlength="{{cxPropMaxlength}}" lt-prop-direction="{{cxPropDirection}}" lt-prop-placeholder="{{cxPropPlaceholder}}" lt-prop-disabled="{{cxPropDisabled}}" lt-prop-readonly="{{cxPropReadonly}}" on-value-change="{{method(\'onChange\')}}" lt-prop-appearance="{{cxPropAppearance}}" data-zcqa="{{cxPropZcqa}}" lt-prop-tab-index="{{cxPropTabIndex}}" lt-prop-autofocus="{{cxPropAutofocus}}" lt-prop-autocomplete="{{cxPropAutocomplete}}" lt-prop-auto-update="{{cxPropEnableLbind}}" lt-prop-aria="{{cxPropAria}}" lt-prop-aria-attributes="{{cxPropAriaAttributes}}" lt-prop-tooltip-class="{{cxPropTooltipClass}}" lt-prop-wrapper-class="{{cxPropWrapperClass}}"></lyte-input> <template is="if" value="{{cxPropShowDisabledIcon}}"><template case="true"><span class="cxElementsDisabledIcon {{cxPropDisabledIconClass}}"></span></template></template> <template is="if" value="{{isError}}"><template case="true"> <crux-error-message error-message="{{cxPropErrorMessage}}" cx-prop-error-yield="{{cxPropErrorYield}}" cx-prop-error-zcqa-prefix="{{cxPropErrorZcqaPrefix}}" cx-prop-field="{{cxPropField}}" cx-prop-error-zcqa-suffix="{{cxPropErrorZcqaSuffix}}" class="{{cxPropErrorClass}}" cx-prop-error-span-class="{{cxPropErrorSpanClass}}"> <template is="registerYield" yield-name="errorYield"><lyte-yield yield-name="errorYield" error-message="{{cxPropErrorMessage}}" cx-field="{{cxPropField}}"></lyte-yield></template> </crux-error-message> </template></template> </div> </template></template> </template>',_dynamicNodes:[{type:"attr",position:[1]},{type:"switch",position:[1],cases:{view:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"text",position:[0]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"text",position:[0,0]},{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"insertYield",position:[1]}]},{type:"componentDynamic",position:[1]}]}},default:{}}]}},default:{}}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"text",position:[0]}]}},default:{}}]}},default:{}}]},create:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,1]},{type:"attr",position:[1,3]},{type:"if",position:[1,3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[3]},{type:"registerYield",position:[3,1],dynamicNodes:[{type:"text",position:[1,1]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[3]}]}},default:{}}]}},default:{}},{type:"attr",position:[3]},{type:"attr",position:[3,1]},{type:"componentDynamic",position:[3,1]},{type:"attr",position:[3,3]},{type:"if",position:[3,3],cases:{true:{dynamicNodes:[{type:"attr",position:[0]}]}},default:{}},{type:"attr",position:[3,5]},{type:"if",position:[3,5],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"attr",position:[0]},{type:"insertYield",position:[0]}]},{type:"componentDynamic",position:[1]}]}},default:{}}]}},default:{}}],_observedAttributes:["lyteViewPort","cxPropValue","cxPropEmptyValue","cxPropFrom","cxPropLabel","cxPropMaximumLength","cxPropPlaceholder","cxPropDisabled","cxPropReadonly","isError","cxPropAppearance","cxPropErrorMessage","cxPropField","cxPropFieldKey","cxPropId","cxPropName","cxPropClearErrorMessage","cxPropDirection","cxPropTabIndex","cxPropZcqa","cxPropClass","lyteUnbound","cxPropLabelClass","href","cxPropTooltip","cxPropMaxlength","cxPropErrorYield","cxPropInfoTooltip","cxPropAutocomplete","cxPropEnableLbind","cxPropAria","cxPropAriaAttributes","cxPropMaskingProperties","cxPropTooltipConfig","cxPropTooltipClass","cxPropErrorZcqaPrefix","cxPropErrorZcqaSuffix","cxPropErrorClass","cxPropWrapperClass","cxPropInputClass","cxPropErrorSpanClass","cxPropLayout","cxPropViewInfoTooltip","cxPropShowDisabledIcon","cxPropDisabledIconClass"],data:function(){return{lyteViewPort:Lyte.attr("boolean",{default:!1}),cxPropValue:Lyte.attr("string"),cxPropEmptyValue:Lyte.attr("string",{default:""}),cxPropFrom:Lyte.attr("string",{default:"view"}),cxPropLabel:Lyte.attr("string"),cxPropMaximumLength:Lyte.attr("number"),cxPropPlaceholder:Lyte.attr("string"),cxPropDisabled:Lyte.attr("boolean"),cxPropReadonly:Lyte.attr("boolean"),isError:Lyte.attr("boolean",{default:!1}),cxPropAppearance:Lyte.attr("string",{default:"flat"}),cxPropErrorMessage:Lyte.attr("string",{default:""}),cxPropField:Lyte.attr("object",{default:{}}),cxPropFieldKey:Lyte.attr("string",{default:""}),cxPropId:Lyte.attr("string",{default:""}),cxPropName:Lyte.attr("string",{default:""}),cxPropClearErrorMessage:Lyte.attr("boolean",{default:!0}),cxPropDirection:Lyte.attr("string",{default:"vertical"}),cxPropTabIndex:Lyte.attr("string"),cxPropZcqa:Lyte.attr("string"),cxPropClass:Lyte.attr("string",{default:""}),lyteUnbound:Lyte.attr("boolean",{default:!1}),cxPropLabelClass:Lyte.attr("string",{default:""}),href:Lyte.attr("string"),cxPropTooltip:Lyte.attr("string",{default:""}),cxPropMaxlength:Lyte.attr("number"),cxPropErrorYield:Lyte.attr("boolean",{default:!1}),cxPropInfoTooltip:Lyte.attr("string",{default:""}),cxPropAutocomplete:Lyte.attr("string",{default:"on"}),cxPropEnableLbind:Lyte.attr("boolean",{default:!0}),cxPropAria:Lyte.attr("boolean",{default:!1}),cxPropAriaAttributes:Lyte.attr("object",{default:{}}),cxPropMaskingProperties:Lyte.attr("object"),cxPropTooltipConfig:Lyte.attr("string",{default:'{"position": "followcursor", "appearance": "box"}'}),cxPropTooltipClass:Lyte.attr("string"),cxPropErrorZcqaPrefix:Lyte.attr("string",{default:""}),cxPropErrorZcqaSuffix:Lyte.attr("string",{default:"Error"}),cxPropErrorClass:Lyte.attr("string"),cxPropWrapperClass:Lyte.attr("string"),cxPropInputClass:Lyte.attr("string",{default:""}),cxPropErrorSpanClass:Lyte.attr("string"),cxPropLayout:Lyte.attr("string"),cxPropViewInfoTooltip:Lyte.attr("boolean",{default:!1}),cxPropShowDisabledIcon:Lyte.attr("boolean",{default:!1}),cxPropDisabledIconClass:Lyte.attr("string",{default:""})}},init:function(){this.getData("cxPropDisabled")&&!this.data.cxPropTooltip&&this.setData("cxPropTooltip",_cruxUtils.getI18n("crm.lable.read.only")),"create"==this.data.cxPropFrom&&this.setFocusUtil()},getValue:function(){return"string"==typeof this.data.cxPropValue?this.getData("cxPropValue").trim():this.getData("cxPropValue")},validate:function(){var e=this.getData("cxPropField"),t="string"==typeof this.data.cxPropValue?this.getData("cxPropValue").trim():this.getData("cxPropValue");if(!t||!t.trim())return this.validateMandatory(!0)?(this.setData("cxPropErrorMessage",""),!0):(this.$node.querySelector("lyte-input")&&this.$node.querySelector("lyte-input").focus(),!1);if(t&&!this.validateLength(t))return!1;var o=this.isValidWebUrl(t);return o?this.setData("cxPropErrorMessage",""):(this.getMethods("onError")?this.executeMethod("onError",this.errorCodes.ERR02,this):this.setData("cxPropErrorMessage",_cruxUtils.getI18n("crm.field.valid.check",Lyte.Component.registeredHelpers.cruxEncodeHTML(e.field_label))),this.$node.querySelector("lyte-input")&&this.$node.querySelector("lyte-input").focus()),o},methods:{onChange:function(){this.getData("cxPropClearErrorMessage")&&this.setData("cxPropErrorMessage",""),this.getMethods("onValueChange")&&this.executeMethod("onValueChange",this.getData("cxPropValue"))},hideInfoTooltip:function(){this.showHideInfoTooltip()}},observeErrorMessage:function(){this.setData("isError",""!=this.getData("cxPropErrorMessage"))}.observes("cxPropErrorMessage").on("init"),actions:{stopPropagation:function(){event.stopPropagation()},showInfoTooltip:function(e){this.showHideInfoTooltip(e)}},observeIsError:function(){"create"==this.getData("cxPropFrom")&&this.$node.querySelector("lyte-input")&&(this.getData("isError")?this.$node.querySelector("lyte-input").classList.add("cxErrorBox"):this.$node.querySelector("lyte-input").classList.remove("cxErrorBox"))}.observes("isError","lyteViewPort").on("didConnect"),observeMandatory:function(){this.observeMandatoryMixin("lyte-input")}.observes("cxPropField.required","lyteViewPort").on("didConnect"),observeClass:function(e){if("create"==this.data.cxPropFrom){var t=$L("lyte-input",this.$node);if(!t.length)return;e&&e.oldValue&&t.removeClass(e.oldValue),this.data.cxPropClass&&t.addClass(this.data.cxPropClass)}}.observes("cxPropClass","lyteViewPort").on("didConnect"),observeValue:function(){var e=this.getData("cxPropValue");e&&""!==e&&0!=e.indexOf("http")&&0!=e.indexOf("https")?this.setData("href","http://"+e):e&&this.setData("href",e)}.observes("cxPropValue").on("init")},{mixins:["crux-element-validation"]}),Lyte.Component.register("crux-image-component",{_template:'<template tag-name="crux-image-component"> <template is="switch" value="{{cxPropFrom}}"><template case="create"> <template is="if" value="{{cxPropField[cxPropFieldKey]}}"><template case="true"> <span class="cxFieldLabel {{cxPropLabelClass}}"> {{cxPropField[cxPropFieldKey]}} <template is="if" value="{{cxPropInfoTooltip}}"><template case="true"> <span class="dIB vam cxInfoIcon" onmouseenter="{{action(\'showInfoTooltip\',this)}}"></span> <lyte-hovercard lt-prop-placement="topLeft" lt-prop-keep-alive="true" lt-prop-popover-wrapper-class="cxElementsHovercard" lt-prop-origin-elem=".cxCurrentHovercard" on-hovercard-hide="{{method(\'hideInfoTooltip\')}}"> <template is="registerYield" yield-name="hoverCardYield"> <lyte-hovercard-content class="cxElementsHoverCardContent"> {{cxPropInfoTooltip}} </lyte-hovercard-content> </template> </lyte-hovercard> </template></template> </span> </template></template> <template is="if" value="{{cxPropValue}}"><template case="true"> <ul> <template is="for" items="{{cxPropValue}}" item="item" index="index"> <li class="cxImageSelector_{{cxPropId}} {{item.cxPropClass}} {{cxPropClass}}" data-zcqa="{{item[cxPropZcqaSelector]}}" onclick="{{action(\'showPreview\',item)}}" lt-prop-title="{{item[cxPropFileNameSelector]}}" lt-prop-tooltip-style="font-size: 1.2rem;" lt-prop-tooltip-config="{&quot;position&quot; : &quot;top&quot;, &quot;margin&quot; : &quot;2px&quot;, &quot;maxdisplaytime&quot;:3000}" data-lytecbox-title="{{item[cxPropFileNameSelector]}}" data-lytecbox-dlink="{{item[cxPropDownloadKey]}}" data-lytecbox-href="{{item[cxPropSourceKey]}}" data-sel-image="{{index}}"> <div class="cxImageEdit"> <span class="cxImagePreviewIcon"></span> <template is="if" value="{{expHandlers(cxPropReadOnly,\'!\')}}"><template case="true"> <span class="cxImageDeleteIcon" data-zcqa="fieldView_delete" onclick="{{action(\'removeThisImage\',item,index)}}"></span> </template></template> </div> <img src="{{item[cxPropSourceKey]}}" alt="{{item[cxPropSourceKey]}}"> </li> </template> <li class="cxAddNewImage {{if(maximumCountReached,\'disabled\')}}" data-zcqa="fieldView_openPopup" onclick="{{action(\'openUploadPopup\')}}" lt-prop-title="{{if(maximumCountReached,cruxGetI18n(\'crm.imageupload.allowed.field.length\'))}}"> <span class="cxPlusIcon">+</span> <span>{{cruxGetI18n(\'crm.image.header\')}}</span> </li> </ul> </template><template case="false"> <img src="{{concat(imgLoc,\'/cx_user_profile.svg\')}}" class="{{cxPropClass}}"> </template></template> </template><template case="view"> <template is="if" value="{{cxPropValue}}"><template case="true"> <template is="if" value="{{expHandlers(cxPropType,\'==\',\'single\')}}"><template case="true"> <a onclick="{{action(\'showImageOptions\')}}"> <div class="cxImageViewWrap {{cxPropClass}} cxSingleImgContainer_{{cxPropId}}" data-lytecbox-title="{{cxPropValue[0][cxPropFileNameSelector]}}" data-lytecbox-dlink="{{cxPropValue[0][cxPropDownloadKey]}}" data-lytecbox-href="{{cxPropValue[0][cxPropSourceKey]}}" data-sel-image="1"> <div class="cxImageViewOverlay cxFlexCenter"> <div class="cxImageCameraIcon"></div> </div> <template is="if" value="{{cxPropValue[0].alphabet}}"><template case="true"> <div class="cxImageViewNoImage {{noImageClass}}"> {{cxPropValue[0].alphabet}} </div> </template><template case="false"> <img src="{{cxPropValue[0][cxPropSourceKey]}}" alt="{{cxPropValue[0][cxPropSourceKey]}}" class="cxImageViewImgElem {{cxPropValue[0].cxPropClass}} {{cxPropClass}}" data-zcqa="{{cxPropValue[0][cxPropZcqaSelector]}}"> </template></template> </div> </a> <lyte-menu on-before-open="{{method(\'menuOnBeforeOpen\')}}" on-open="{{method(\'attachLinksOpen\')}}" on-close="{{method(\'onAttachMenuClose\')}}" lt-prop-wrapper-class="attachLinksMenu" lt-prop-yield="true" lt-prop-query=".cxSingleImgContainer_{{cxPropId}}" lt-prop-event="keyup" lt-prop-show="{{singleOptionShow}}" lt-prop-freeze="false" id="cxImgSingleOptions_{{cxPropId}}"> <template is="registerYield" yield-name="yield"> <lyte-menu-body class="cxImgOptionMenu" data-zcqa="cxImgOptionMenu"> <lyte-menu-item id="previewImage" onclick="{{action(\'singleImageDrop\',\'preview\')}}" class="crm-font-regular">Preview Image</lyte-menu-item> <lyte-menu-item id="uploadImage" onclick="{{action(\'singleImageDrop\',\'upload\')}}" class="crm-font-regular">Upload Image</lyte-menu-item> <lyte-menu-item id="removeImage" onclick="{{action(\'singleImageDrop\',\'remove\')}}" class="crm-font-regular">Remove</lyte-menu-item> </lyte-menu-body> </template> </lyte-menu> </template><template case="false"> <ul> <template is="for" items="{{cxPropValue}}" item="item" index="index"> <li class="{{item.cxPropClass}} {{cxPropClass}}" data-zcqa="{{item[cxPropZcqaSelector]}}" onclick="{{action(\'showPreview\',item)}}" lt-prop-title="{{item[cxPropFileNameSelector]}}" lt-prop-tooltip-style="font-size: 1.2rem;" lt-prop-tooltip-config="{&quot;position&quot; : &quot;top&quot;, &quot;margin&quot; : &quot;2px&quot;, &quot;maxdisplaytime&quot;:3000}" data-lytecbox-title="{{item.filename}}" data-lytecbox-dlink="{{constructDownloadUrl(item.original_src)}}" data-lytecbox-href="{{item.original_src}}" data-sel-image="{{index}}"> <img src="{{item[cxPropSourceKey]}}" alt="{{item[cxPropSourceKey]}}" class="{{item.cxPropClass}} {{cxPropClass}}" data-zcqa="{{item[cxPropZcqaSelector]}}" onclick="{{action(\'showPreview\',item)}}"> </li> </template> </ul> </template></template> </template><template case="false"> <img src="{{concat(imgLoc,\'/cx_user_profile.svg\')}}" class="{{cxPropClass}}"> </template></template> </template></template> <template is="if" value="{{showPreviewImage}}"><template case="true"> <crux-image-preview cx-prop-color-box-configuration="{{previewConfig}}" on-before-preview-close="{{method(\'previewCloseCallback\')}}"></crux-image-preview> </template></template> <template is="if" value="{{uploadImage}}"><template case="true"> <crux-file-upload cx-prop-file-type="image" on-cx-file-upload-success="{{method(\'imageUploadComplete\')}}" cx-prop-ajax="{{cxPropAjax}}" cx-prop-title="{{fileUploadTitle}}"></crux-file-upload> </template></template> </template>',_dynamicNodes:[{type:"attr",position:[1]},{type:"switch",position:[1],cases:{create:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,1]},{type:"attr",position:[1,3]},{type:"if",position:[1,3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[3]},{type:"registerYield",position:[3,1],dynamicNodes:[{type:"text",position:[1,1]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[3]}]}},default:{}}]}},default:{}},{type:"attr",position:[3]},{type:"if",position:[3],cases:{true:{dynamicNodes:[{type:"attr",position:[1,1]},{type:"for",position:[1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1,3]},{type:"if",position:[1,1,3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]}]}},default:{}},{type:"attr",position:[1,3]}]},{type:"attr",position:[1,3]},{type:"text",position:[1,3,3,0]}]},false:{dynamicNodes:[{type:"attr",position:[1]}]}},default:{}}]},view:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"attr",position:[1,1,3]},{type:"if",position:[1,1,3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,1]}]},false:{dynamicNodes:[{type:"attr",position:[1]}]}},default:{}},{type:"attr",position:[3]},{type:"registerYield",position:[3,1],dynamicNodes:[{type:"attr",position:[1,1]},{type:"componentDynamic",position:[1,1]},{type:"attr",position:[1,3]},{type:"componentDynamic",position:[1,3]},{type:"attr",position:[1,5]},{type:"componentDynamic",position:[1,5]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[3]}]},false:{dynamicNodes:[{type:"attr",position:[1,1]},{type:"for",position:[1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]}]}]}},default:{}}]},false:{dynamicNodes:[{type:"attr",position:[1]}]}},default:{}}]}},default:{}},{type:"attr",position:[3]},{type:"if",position:[3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"attr",position:[5]},{type:"if",position:[5],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]}},default:{}}],_observedAttributes:["lyteViewPort","cxPropFrom","cxPropDisabled","cxPropClass","cxPropValue","imgLoc","cxPropId","cxPropField","cxPropFieldKey","cxPropLabelClass","cxPropInfoTooltip","cxPropAllowedCount","cxPropAllowedTotalSize","cxPropAllowedSingleSize","maximumCountReached","cxPropFileNameSelector","cxPropZcqaSelector","cxPropDownloadKey","cxPropSourceKey","cxPropReadOnly","cxPropType","cxPropId","singleOptionShow","cxPropShowFileNameInPreview","cxPropShowDownloadOption","showPreviewImage","uploadImage","fileUploadTitle","cxPropAjax"],data:function(){return{lyteViewPort:Lyte.attr("boolean",{default:!1}),cxPropFrom:Lyte.attr("string",{default:"view"}),cxPropDisabled:Lyte.attr("boolean",{default:!1}),cxPropClass:Lyte.attr("string",{default:""}),cxPropValue:Lyte.attr("array"),imgLoc:Lyte.attr("string",{default:"dist/components/images"}),cxPropId:Lyte.attr("string",{default:""}),cxPropField:Lyte.attr("object",{default:{}}),cxPropFieldKey:Lyte.attr("string",{default:""}),cxPropLabelClass:Lyte.attr("string",{default:""}),cxPropInfoTooltip:Lyte.attr("string",{default:""}),cxPropAllowedCount:Lyte.attr("number",{default:5}),cxPropAllowedTotalSize:Lyte.attr("string",{default:"100MB"}),cxPropAllowedSingleSize:Lyte.attr("string",{default:"20MB"}),maximumCountReached:Lyte.attr("boolean",{default:!1}),cxPropFileNameSelector:Lyte.attr("string",{default:"filename"}),cxPropZcqaSelector:Lyte.attr("string",{default:"cxPropZcqa"}),cxPropDownloadKey:Lyte.attr("string",{default:"download_url"}),cxPropSourceKey:Lyte.attr("string",{default:"preview_url"}),cxPropReadOnly:Lyte.attr("boolean",{default:!1}),cxPropType:Lyte.attr("string",{default:"multiple"}),cxPropId:Lyte.attr("string",{default:"cxImage1"}),singleOptionShow:Lyte.attr("boolean",{default:!1}),cxPropShowFileNameInPreview:Lyte.attr("boolean"),cxPropShowDownloadOption:Lyte.attr("boolean",{default:!0}),showPreviewImage:Lyte.attr("boolean",{default:!1}),uploadImage:Lyte.attr("boolean",{default:!1}),fileUploadTitle:Lyte.attr("string",{default:_cruxUtils.getI18n("crm.attach.upload.image")}),cxPropAjax:Lyte.attr("object",{default:{url:"/Fileupload"}})}},init:function(){"undefined"!=typeof crmConstants&&(this.data.imgLoc=crmConstants.fp_imagesStaticPathForLyte),this.data.cxPropShowFileNameInPreview||this.setData("cxPropShowFileNameInPreview","multiple"==this.data.cxPropType),"single"==this.data.cxPropType&&this.setData("fileUploadTitle",_cruxUtils.getI18n("crm.general.select.photo")),this.setData("noImageClass","cxImageViewNoImage"+(Math.floor(9*Math.random())+1))},getValue:function(){return this.data.cxPropValue},methods:{hideInfoTooltip:function(){this.showHideInfoTooltip()},menuOnBeforeOpen:function(){return!0},attachLinksOpen:function(){},onAttachMenuClose:function(){this.setData("singleOptionShow",!1)},previewCloseCallback:function(){this.setData("showPreviewImage",!1)},imageUploadComplete:function(e){if("single"==this.data.cxPropType){var t=Object.assign({},{id:e[0].id});t[this.data.cxPropFileNameSelector]=e[0].name,t.file=e[0],t[this.data.cxPropSourceKey]=e[0].preview_url,t[this.data.cxPropDownloadKey]=e[0].preview_url,this.setData("cxPropValue",[t])}this.getMethods("onImageUpload")&&this.executeMethod("onImageUpload",this.data.cxPropValue,this)}},actions:{showInfoTooltip:function(e){this.showHideInfoTooltip(e)},showPreview:function(e){this.showImagePreview(e)},removeThisImage:function(e,t){Lyte.arrayUtils(this.data.cxPropValue,"removeAt",t,1)},showImageOptions:function(){this.data.cxPropValue[0].alphabet?this.uploadSingleImage():this.setData("singleOptionShow",!0)},singleImageDrop:function(e){if("preview"==e)this.showImagePreview();else if("upload"==e)this.uploadSingleImage();else{var t;this.getMethods("onRemoveImage")?(t=this.executeMethod("onRemoveImage",this.data.cxPropValue[0]))&&this.setData("cxPropValue",[{alphabet:t}]):console.warn("onRemoveImage method is not provided to the component. This is a mandatorym method.")}}},showImagePreview:function(){var e={showFileName:this.data.cxPropShowFileNameInPreview,showDownloadOption:this.data.cxPropShowDownloadOption,showThumbnails:!1,allowZoom:!1,selectors:".cxSingleImgContainer_"+this.data.cxPropId};this.setData("previewConfig",e),this.setData("showPreviewImage",!0),this.$node.querySelector("crux-image-preview").showPreview(this.$node.querySelector(".cxSingleImgContainer_"+this.data.cxPropId))},uploadSingleImage:function(){this.fileUploadComp||(this.setData("uploadImage",!0),this.fileUploadComp=this.$node.querySelector("crux-file-upload")),this.fileUploadComp.openFileUpload()},observesValue:function(){this.setData("maximumCountReached",this.data.cxPropValue.length>=this.data.cxPropAllowedCount)}.observes("cxPropValue").on("init")},{mixins:["crux-element-validation","crux-image-mixin"]}),Lyte.Component.register("crux-error-message",{_template:'<template tag-name="crux-error-message"> <template is="if" value="{{cxPropErrorYield}}"><template case="true"> <lyte-yield yield-name="errorYield" error-message="{{errorMessage}}" cx-field="{{cxPropField}}" data-zcqa="{{concat(cxPropErrorZcqaPrefix,cxPropField.api_name,cxPropErrorZcqaSuffix)}}"></lyte-yield> </template><template case="false"> <span id="{{cxPropId}}" class="cruxErrMsg cruxErrorMsgDesc {{cxPropErrorSpanClass}}" data-zcqa="{{concat(cxPropErrorZcqaPrefix,cxPropField.api_name,cxPropErrorZcqaSuffix)}}">{{unescape(errorMessage)}}</span> </template></template> </template>',_dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"insertYield",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,0]}]}},default:{}}],_observedAttributes:["errorMessage","cxPropId","cxPropErrorYield","cxPropField","cxPropErrorZcqaPrefix","cxPropErrorZcqaSuffix","cxPropErrorSpanClass"],data:function(){return{errorMessage:Lyte.attr("string"),cxPropId:Lyte.attr("string",{default:""}),cxPropErrorYield:Lyte.attr("boolean",{default:!1}),cxPropField:Lyte.attr("object"),cxPropErrorZcqaPrefix:Lyte.attr("string",{default:""}),cxPropErrorZcqaSuffix:Lyte.attr("string",{default:"Error"}),cxPropErrorSpanClass:Lyte.attr("string")}},observeMessage:function(){var e=this.$node,t=e.querySelector("span");this.data.errorMessage&&!this.data.cxPropErrorYield&&t.scrollWidth>e.offsetWidth&&$L(e).addClass("cxErrorMsgMultiLines")}.observes("errorMessage").on("didConnect")}),Lyte.Component.register("crux-lookup-popup",{_template:'<template tag-name="crux-lookup-popup"> <lyte-popover lt-prop-wrapper-class="cxLookupPopoverWrapper {{cxPropPopoverWrapperClass}}" lt-prop-show-close-button="false" lt-prop-show="{{show}}" lt-prop-freeze="false" lt-prop-type="callout" lt-prop-bind-to-body="true" lt-prop-content-padding="0px" lt-prop-origin-elem=".cxVisibleLookup .cruxLookupPopover" lt-prop-duration="{{undefinedValue}}" on-close="{{method(\'closePopver\')}}"> <template is="registerYield" yield-name="popover"> <lyte-popover-content> <div class="popElemTable"> <lyte-table lt-prop-yield="true" lt-prop-width="100%" lt-prop-height="100%" lt-prop-border="false"> <template is="registerYield" yield-name="yield"> <lyte-table-structure> <lyte-tbody> <template is="for" items="{{bcFields}}" item="field" index="index"> <lyte-tr> <lyte-td class="cxLookupPopTd">{{field.field_label}}</lyte-td> <lyte-td class="cxLookupPopTd"> <template is="if" value="{{data[field.api_name]}}"><template case="true"> <template is="if" value="{{data[field.api_name].name}}"><template case="true"> {{data[field.api_name].name}} </template><template case="false"><template is="if" value="{{expHandlers(field.data_type,\'==\',&quot;autonumber&quot;)}}"><template case="true"> {{data[field.api_name]}} </template><template case="false"><template is="if" value="{{expHandlers(expHandlers(fieldMapping[field.ui_type],\'&amp;&amp;\',expHandlers(fieldMapping[field.ui_type],\'!=\',&quot;text&quot;)),\'&amp;&amp;\',expHandlers(fieldMapping[field.ui_type],\'!=\',&quot;email&quot;))}}"><template case="true"> <template is="component" component-name="crux-{{fieldMapping[field.ui_type]}}-component" cx-prop-value="{{data[field.api_name]}}"></template> </template><template case="false"> {{data[field.api_name]}} </template></template></template></template></template></template> </template><template case="false">-</template></template> </lyte-td> </lyte-tr> </template> </lyte-tbody> </lyte-table-structure> </template> </lyte-table> </div> </lyte-popover-content> </template> </lyte-popover> </template>',_dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"registerYield",position:[1,1,1,1],dynamicNodes:[{type:"attr",position:[1,1,1]},{type:"for",position:[1,1,1],dynamicNodes:[{type:"text",position:[1,1,0]},{type:"componentDynamic",position:[1,1]},{type:"attr",position:[1,3,1]},{type:"if",position:[1,3,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"text",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"text",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"component",position:[1],dynamicNodes:[]}]},false:{dynamicNodes:[{type:"text",position:[1]}]}},default:{}}]}},default:{}}]}},default:{}}]},false:{dynamicNodes:[]}},default:{}},{type:"componentDynamic",position:[1,3]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1,1]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1,1,1]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1]}],_observedAttributes:["show","module","bcFields","fieldMapping","undefinedValue","cxPropPopoverWrapperClass"],data:function(){return{show:Lyte.attr("boolean",{default:!1}),module:Lyte.attr("object"),bcFields:Lyte.attr("array"),fieldMapping:Lyte.attr("object"),undefinedValue:Lyte.attr("number",{default:void 0}),cxPropPopoverWrapperClass:Lyte.attr("string",{default:""})}},observeModule:function(e){if(e&&"change"==e.type&&e.oldValue&&e.newValue.api_name!=e.oldValue.api_name&&this.setData("bcFields",void 0),this.getData("module")&&!this.data.bcFields){for(var t=this.getData("module").business_card_fields,o=[],a=1;a<t.length;a++){var r=store.peekRecord("field",t[a].id);r&&"ISCALLBILLABLE"!=r.column_name&&o.push(r)}this.setData("bcFields",o)}}.observes("module").on("init"),methods:{closePopver:function(){setTimeout(function(){this.$node.querySelector("lyte-popover").setData("ltPropBindToBody",!1)}.bind(this),1)}}}),Lyte.Component.register("crux-lookup-modal",{_template:'<template tag-name="crux-lookup-modal"> <lyte-modal id="modalElem" lt-prop-wrapper-class="cxLookupModal LookupModal cxBoxModal" lt-prop-show="{{lbind(show)}}" lt-prop-offset="{&quot;top&quot; : &quot;0&quot;, &quot;left&quot; : &quot;center&quot;}" lt-prop="{&quot;allowMultiple&quot; : &quot;true&quot;, &quot;width&quot; : &quot;80%&quot;, &quot;left&quot; : &quot;5%&quot;}" on-before-close="{{method(\'closeModal\')}}" on-before-show="{{method(\'openModal\')}}"> <template is="registerYield" yield-name="modal"> <lyte-modal-header> <template is="if" value="{{expHandlers(cxPropHeader,\'!\')}}"><template case="true">{{cruxGetI18n(\'crm.lookup.chooserecord\',module.singular_label)}}</template><template case="false">{{cxPropHeader}}</template></template> </lyte-modal-header> <lyte-modal-content> <div class="cxLookupModalbuttonLayer mT5 mB25"> <template is="if" value="{{cxPropRelatedId}}"><template case="true"> <template is="if" value="{{cxPropDontShowRelatedDropdown}}"><template case="true"> <div class="pL30"><span>{{headerOptions[0].name}}</span></div> </template><template case="false"> <div class="pL30 mR20 cxLookupModalRelatedDDWrap"> <span>{{cruxGetI18n("crm.button.mass.show")}}</span> <lyte-dropdown lt-prop-options="{{headerOptions}}" lt-prop-user-value="name" lt-prop-system-value="id" lt-prop-selected="{{lbind(selectedHeaderValue)}}" on-option-selected="{{method(\'setHeaderOption\')}}" class="pL10 oA"></lyte-dropdown></div> </template></template> </template></template> <lyte-input class="cxBoxInput cxLookupSearch cxBoxLeftPosSearch" lt-prop-id="filterbox" data-zcqa="lookupSearch" lt-prop-appearance="box" lt-prop-type="search" lt-prop-placeholder="{{cruxGetI18n(\'crm.globalsearch.search.title\')}}" onkeyup="{{action(\'searchSetValue\', event,, this)}}" after-render="{{method(\'associateSearchClick\')}}"></lyte-input> <template is="if" value="{{cxPropCreateYield}}"><template case="true"> <lyte-yield yield-name="createYield" class="cxMlAuto"></lyte-yield> </template></template> </div> <crux-table-component cx-prop-hide-header-on-no-content="{{cxPropHideHeaderOnNoContent}}" class="modalCruxtable cxTable" cx-prop-column-cell-class="lookupCriteriaLabelWrap1" cx-prop-header="{{header}}" cx-prop-row-zcqa="detailView" cx-prop-content="{{record}}" cx-prop-yield-for-prefix="true" cx-prop-sort-columns="true" cx-prop-no-records-message="{{cruxGetI18n(\'crm.module.empty.message\',module.plural_label)}}" on-sort="{{action(\'sort\')}}" cx-prop-sorted-column="{{sortedColumn}}" cx-prop-sorted-order="{{queryParamObject.sort_order}}" cx-prop-enable-body-scroll="false" cx-prop-field-type-mapping="{{fieldMapping}}" cx-prop-header-yield="{{headerYields}}" cx-prop-show-tooltip="false" cx-prop-no-content-class="aligncenter f14 norec" cx-prop-module="{{moduleName}}"> <template is="yield" yield-name="header-prefix-1"></template> <template is="yield" yield-name="body-prefix-1"> <lyte-radiobutton lt-prop-type="primary" lt-prop-name="record" lt-prop-value="{{recordObj.id}}" lt-prop-checked="{{ifEquals(recordObj.id,selectedSingle)}}" on-checked="{{method(\'selectSingle\',recordObj.id)}}" onclick="{{action(\'radioButtonClicked\',recordObj.id)}}"></lyte-radiobutton> </template> <template is="yield" yield-name="body-aTag"> <template is="if" value="{{recordObj[fieldObj.api_name]}}"><template case="true"> <span class="cP link1" onclick="{{action(\'selectSingle\',recordObj.id)}}"><template is="if" value="{{recordObj[fieldObj.api_name].name}}"><template case="true">{{recordObj[fieldObj.api_name].name}}</template><template case="false">{{recordObj[fieldObj.api_name]}}</template></template></span> </template></template> </template> <template is="yield" yield-name="body-phone"> {{recordObj[fieldObj.api_name]}} </template> <template is="yield" yield-name="body-lookup">{{recordObj[fieldObj.api_name].name}}</template> </crux-table-component> </lyte-modal-content> <lyte-modal-footer data-zcqa="mxnfooter"> <div class="cxLookupModalbuttonLayer"> <template is="if" value="{{lookupSingle}}"><template case="true"> <div class="cxSelectedSingle"> {{cruxGetI18n("crm.record.selected",module.singular_label)}}: {{lookupSingle}} </div> </template></template> <template is="if" value="{{expHandlers(record.length,\'||\',cxPropShowNavigator)}}"><template case="true"> <div class="cxMlAuto" data-zcqa="mxnnavigationlookup"> <lyte-navigator id="navigator" lt-prop-more-records="true" lt-prop-show-only-icon="true" lt-prop-value="0" lt-prop-per-page="{{perPage}}" on-next="{{method(\'rendNext\')}}" on-previous="{{method(\'rendPrev\')}}"></lyte-navigator> </div> </template></template> </div> </lyte-modal-footer> </template> </lyte-modal> </template>',_dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"attr",position:[1,1]},{type:"if",position:[1,1],cases:{true:{dynamicNodes:[{type:"text",position:[0]}]},false:{dynamicNodes:[{type:"text",position:[0]}]}},default:{}},{type:"componentDynamic",position:[1]},{type:"attr",position:[3,1,1]},{type:"if",position:[3,1,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"text",position:[1,0,0]}]},false:{dynamicNodes:[{type:"text",position:[1,1,0]},{type:"attr",position:[1,3]},{type:"componentDynamic",position:[1,3]}]}},default:{}}]}},default:{}},{type:"attr",position:[3,1,3]},{type:"componentDynamic",position:[3,1,3]},{type:"attr",position:[3,1,5]},{type:"if",position:[3,1,5],cases:{true:{dynamicNodes:[{type:"insertYield",position:[1]}]}},default:{}},{type:"attr",position:[3,3]},{type:"registerYield",position:[3,3,1],dynamicNodes:[]},{type:"registerYield",position:[3,3,3],dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]},{type:"registerYield",position:[3,3,5],dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,0]},{type:"if",position:[1,0],cases:{true:{dynamicNodes:[{type:"text",position:[0]}]},false:{dynamicNodes:[{type:"text",position:[0]}]}},default:{}}]}},default:{}}]},{type:"registerYield",position:[3,3,7],dynamicNodes:[{type:"text",position:[1]}]},{type:"registerYield",position:[3,3,9],dynamicNodes:[{type:"text",position:[0]}]},{type:"componentDynamic",position:[3,3]},{type:"componentDynamic",position:[3]},{type:"attr",position:[5,1,1]},{type:"if",position:[5,1,1],cases:{true:{dynamicNodes:[{type:"text",position:[1,1]},{type:"text",position:[1,3]}]}},default:{}},{type:"attr",position:[5,1,3]},{type:"if",position:[5,1,3],cases:{true:{dynamicNodes:[{type:"attr",position:[1,1]},{type:"componentDynamic",position:[1,1]}]}},default:{}},{type:"componentDynamic",position:[5]}]},{type:"componentDynamic",position:[1]}],_observedAttributes:["module","header","sortedColumn","queryParamObject","selectedSingle","lookupSingle","perPage","modId","relations","moduleName","displayField","record","show","next","currentPage","perPage","value","cxPropHideHeaderOnNoContent","cxPropCreateYield","fetchRecordsOnEnter","cxPropHeader","metaMoreRecords","cxPropFields","headerYields","cxPropRelatedId","headerOptions","selectedHeaderValue","cxPropRelatedModuleId","cxPropRelatedName","cxPropMetaMoreRecords","cxPropDontShowRelatedDropdown","fieldMapping","cxPropShowNavigator","cxPropReturnFullObjectOnGet"],data:function(){return{module:Lyte.attr("object",{default:{}}),header:Lyte.attr("array",{default:[]}),sortedColumn:Lyte.attr("string"),queryParamObject:Lyte.attr("object",{default:{}}),selectedSingle:Lyte.attr("string",{default:""}),lookupSingle:Lyte.attr("string",{default:""}),perPage:Lyte.attr("number",{default:10}),modId:Lyte.attr("string",{default:""}),relations:Lyte.attr("array",{default:[]}),moduleName:Lyte.attr("string",{default:""}),displayField:Lyte.attr("string",{default:""}),record:Lyte.attr("array",{default:[]}),show:Lyte.attr("boolean",{default:!1}),next:Lyte.attr("array",{default:[0,10]}),currentPage:Lyte.attr("number",{default:0}),perPage:Lyte.attr("number",{default:10}),value:Lyte.attr("object"),cxPropHideHeaderOnNoContent:Lyte.attr("boolean",{default:!0}),cxPropCreateYield:Lyte.attr("boolean",{default:!1}),fetchRecordsOnEnter:Lyte.attr("boolean",{default:!1}),cxPropHeader:Lyte.attr("string"),metaMoreRecords:Lyte.attr("string"),cxPropFields:Lyte.attr("array"),headerYields:Lyte.attr("object"),cxPropRelatedId:Lyte.attr("string"),headerOptions:Lyte.attr("array"),selectedHeaderValue:Lyte.attr("string"),cxPropRelatedModuleId:Lyte.attr("string"),cxPropRelatedName:Lyte.attr("string"),cxPropMetaMoreRecords:Lyte.attr("string"),cxPropDontShowRelatedDropdown:Lyte.attr("boolean",{default:!1}),fieldMapping:Lyte.attr("object",{default:{}}),cxPropShowNavigator:Lyte.attr("boolean",{default:!0}),cxPropReturnFullObjectOnGet:Lyte.attr("boolean",{default:!1})}},init:function(){this.records=[],this.getMethods("fetchModuleData")&&this.lookupInit(this,this.getData("modId"),!0),this.setData("headerYields",{prefix:[{fixed:"enable",class:"cxLookupWidthOnePerc"}]})},getRecs:function(){var e=this.getData("module"),t=e.fields,o=!1;this.getData("cxPropFields")?(o=!0,t=this.getData("cxPropFields")):e.custom_view&&e.custom_view.fields&&(o=!0,t=e.custom_view.fields);for(var a=function(e,t){return e.filter(function(e){return e.id==t})[0]},r=0;r<t.length;r++)if(o&&(t[r]=a(e.fields,t[r].id)),t[r]){if(t[r].id==e.display_field.id||"Full_Name"==e.display_field.api_name&&"LASTNAME"==t[r].column_name||"POTENTIAL_NAME"==t[r].column_name||"POTENTIALID"==t[r].column_name){if(t[r].yieldName="aTag",!o)break}else"lookup"==t[r].data_type?t[r].yieldName="lookup":"phone"==t[r].data_type&&(t[r].yieldName="phone");t[r].sortable||(t[r].cxPropClass="cursorDefault")}else t.splice(r,1),r--;this.setData("header",t);var i=this,s={page:1,per_page:10};this.data.selectedHeaderValue&&("2"!=this.data.selectedHeaderValue?(s.relatedId=this.data.selectedHeaderValue,s.relationId=this.getRelationId()):(delete s.relatedId,delete s.relationId)),this.executeMethod("fetchRecords",this.getData("modId"),s).then(function(e){e=e&&e.length?e:[],i.setData("record",e),i.setData("queryParamObject",Object.assign({},s)),i.$node&&i.$node._callee&&i.$node._callee.querySelector("lyte-dropdown")&&i.$node._callee.querySelector("lyte-dropdown").close(),i.setData("show",!0);var t=!(e.length<10);i.data.cxPropMetaMoreRecords&&e.$&&(t=!(0==e.$[i.data.cxPropMetaMoreRecords]||e.$.meta&&0==e.$.meta[i.data.cxPropMetaMoreRecords])),i.setSelected(e),i.setNavigator(e.length,t,!0),"undefined"!=typeof commonUtils&&commonUtils.showHideLoadingDiv&&commonUtils.showHideLoadingDiv()},function(){})},methods:{openModal:function(){var e=this.$node.querySelector("#modalElem").component.childComp;if(e){var t=e.querySelector(".lyteModalClose");t&&(t.dataZcqa="lookup_closeIcon")}this.setData("sortedColumn","")},closeModal:function(){this.setData("queryParamObject",{}),this.getMethods("onClose")&&this.executeMethod("onClose")},selectSingle:function(e,t,o,a){"script"!=a&&this.selectTheSingle(e)},rendNext:function(e,t){this.rendPage("next",e,t)},rendPrev:function(e,t){this.rendPage("prev",e,t)},associateSearchClick:function(e){var t=this;e.querySelector(".searchIcon").onclick=function(){var o=e.querySelector("input");t.actions.searchSetValue.call(t,void 0,void 0,void 0,o.value,!0)}},setHeaderOption:function(){this.records=[],this.rendPage("change")}},actions:{searchSetValue:function(e,t,o,a,r){if(!(this.getData("fetchRecordsOnEnter")&&(!e||13!=e.keyCode)||e&&27==e.keyCode)||r){clearTimeout(this.searchTimeout);var i=this;this.searchTimeout=setTimeout(function(){var t=(a=(a=a||(e?e.target.value:""))?a.trim():a)?{comparator:"contains",field:{api_name:i.getData("displayField")},value:a}:{},o=i.getData("queryParamObject");t.comparator&&(o.filters=i.constructSearchFilter(i.getData("displayField"),a)),o.page=1,o.per_page=10,o.sort_order||(delete o.sort_order,delete o.sort_by),i.setData("queryParamObject",o),i.data.selectedHeaderValue&&("2"!=i.data.selectedHeaderValue?(o.relatedId=i.data.selectedHeaderValue,o.relationId=i.getRelationId()):(delete o.relatedId,delete o.relationId));var r=i.getData("modId");a?i.executeMethod("fetchRecords",r,Object.assign({},o)).then(function(e){e=e||[],i.noMoreScroll=!1,i.setData("record",e);var t=!0;i.data.cxPropMetaMoreRecords&&e.$&&(t=!(0==e.$[i.data.cxPropMetaMoreRecords]||e.$.meta&&0==e.$.meta[i.data.cxPropMetaMoreRecords])),i.setSelected(e),i.setNavigator(e.length,t,!0),"undefined"!=typeof commonUtils&&commonUtils.showHideLoadingDiv&&commonUtils.showHideLoadingDiv(),i.$node.querySelector("lyte-modal").component.actualModalDiv.querySelector("lyte-input").ltProp("value")!=a&&i.$node.querySelector("lyte-modal").component.actualModalDiv.querySelector("lyte-input").ltProp("value",a)}):(delete o.filters,i.executeMethod("fetchRecords",r,Object.assign({},o)).then(function(e){e=e||[],i.setData("record",e);var t=!0;i.data.cxPropMetaMoreRecords&&e.$&&(t=!(0==e.$[i.data.cxPropMetaMoreRecords]||e.$.meta&&0==e.$.meta[i.data.cxPropMetaMoreRecords])),i.setSelected(e),i.setNavigator(e.length,t,!0),"undefined"!=typeof commonUtils&&commonUtils.showHideLoadingDiv&&commonUtils.showHideLoadingDiv(),i.$node.querySelector("lyte-modal").component.actualModalDiv.querySelector("lyte-input").ltProp("value","")}))},300)}},sort:function(e){if(e.sortable){var t=this.getData("record");if(3!=e.ui_type&&999!=e.ui_type&&208!=e.ui_type&&110!=e.ui_type&&1e3!=e.ui_type&&209!=e.ui_type||"Visits"==this.getData("module").module_name&&"SEID"==e.column_name&&t.length){var o=JSON.parse(JSON.stringify(this.getData("queryParamObject")));e.curSort=void 0==e.curSort||"desc"==e.curSort?"asc":"desc",o.sort_order=e.curSort,o.sort_by=e.api_name,o.page=1,o.per_page=10,this.setData("queryParamObject",o);var a=this;this.records=[],this.data.selectedHeaderValue&&("2"!=this.data.selectedHeaderValue?(o.relatedId=this.data.selectedHeaderValue,o.relationId=this.getRelationId()):(delete o.relatedId,delete o.relationId)),this.executeMethod("fetchRecords",this.getData("modId"),Object.assign({},o)).then(function(t){t=t&&t.length?t:[],a.setData("record",t),a.noMoreScroll=!1,a.setSelected(t);var o=!(t.length<10);a.data.cxPropMetaMoreRecords&&t.$&&(o=!(0==t.$[a.data.cxPropMetaMoreRecords]||t.$.meta&&0==t.$.meta[a.data.cxPropMetaMoreRecords])),a.setNavigator(t.length,o,!0),a.setData("sortedColumn",e.api_name),"undefined"!=typeof commonUtils&&commonUtils.showHideLoadingDiv&&commonUtils.showHideLoadingDiv()})}}},selectSingle:function(e){this.selectTheSingle(e)},radioButtonClicked:function(e){this.getData("selectedSingle")==e&&this.close()}},setNavigator:function(e,t,o){var a=this.$node.querySelector("#modalElem").component.childComp,r=a?a.querySelector("#navigator"):"";if(r){if(r.ltProp("moreRecords",!!t),this.records&&this.records.length){var i=0;this.records.forEach(function(e){return i+=e&&e.length?e.length:0}),e=i||e}r.ltProp("records",t?"":e),o&&r.ltProp("value",0)}},rendHome:function(e){this.rendPage("home",e),this.next=!1;var t=this.$node.querySelector("#modalElem").component.childComp;t&&(t=t.querySelectorAll("#navigator")[0])&&t.ltProp("value",0)},setSelected:function(e){var t=this.getData("selectedSingle");if(t){this.bool=!0;for(var o=this.$node.querySelector("#modalElem").component.childComp,a=o?o.querySelectorAll("lyte-radiobutton"):[],r=0;r<a.length;r++){if(a[r].ltProp("value")==t){e=this.getData("record").filter(function(e){return e.id==t})[0],a[r].ltProp("checked",!0);var i,s=this.getData("displayField");if(!e)return;i="Full_Name"==s?e.First_Name?e.First_Name+" "+e.Last_Name:e.Last_Name:e[s],this.setData("lookupSingle",i);break}1==a[r].ltProp("checked")&&a[r].ltProp("checked",!1)}this.bool=!1}},selectTheSingle:function(e){for(var t,o,a=this.getData("record"),r=this.getData("displayField"),i=0;i<a.length;i++)if(e==a[i].id){t="Full_Name"==r?a[i].First_Name?a[i].First_Name+" "+a[i].Last_Name:a[i].Last_Name:a[i][r],this.setData({lookupSingle:t,selectedSingle:e}),o=a[i];break}this.bool||(this.close(),this.getMethods("onSelect")&&this.executeMethod("onSelect"),this.getMethods("onValueChange")&&(this.setData("cxPropValue",{id:this.getData("selectedSingle"),name:this.getData("lookupSingle")}),o.name=this.getData("lookupSingle"),this.executeMethod("onValueChange",this.data.cxPropReturnFullObjectOnGet?o:JSON.stringify(this.getData("cxPropValue")))))},close:function(){this.setData("show",!1)},setNext:function(e,t,o,a,r,i){"next"==e?(t[o+2]=a,o+=1):"prev"==e?o-=1:(t=[0,a],o=0),this.setData({next:t,currentPage:o,currPage:o}),r=r||0,i&&i.ltProp("value",r)},rendPage:function(e,t,o){var a,r=this.getData("next"),i=this.getData("currentPage"),s=this.getData("queryParamObject"),l=s.page?s.page:0;"home"==e||"change"==e?a=0:"prev"==e?(a=r[i-1],s.page=l-1):(a=r[i+1],s.page=l+1);for(var p=this.getData("record"),n=this.getData("perPage"),c=[],d=0;a<p.length&&d<n&&p[a];a++,d++)c[d]=p[a];if("home"!=e){if(s.per_page=10,!this.next){this.next=!0;var u=this;p=[];this.data.selectedHeaderValue&&("2"!=this.data.selectedHeaderValue?(s.relatedId=this.data.selectedHeaderValue,s.relationId=this.getRelationId()):(delete s.relatedId,delete s.relationId)),this.executeMethod("fetchRecords",this.getData("modId"),Object.assign({},s)).then(function(l){if(l&&(p=p.concat(l)),p.length){for(u.setData("queryParamObject",s),u.setData("record",p),u.setData("show",!0);a<p.length&&d<n;a++,d++)c[d]=p[a];u.setSelected(c);var x=!(p.length<10);u.data.cxPropMetaMoreRecords&&l.$&&(x=!(0==l.$[u.data.cxPropMetaMoreRecords]||l.$.meta&&0==l.$.meta[u.data.cxPropMetaMoreRecords])),u.setNavigator(p.length,x),u.setNext(e,r,i,a,t,o)}else"change"!=e&&_cruxUtils.showCustomAlert({params:{ltPropContentAlign:"center",ltPropSecondaryMessage:I18n.getMsg("crm.label.no.more.records"),ltPropButtons:[{type:"accept",text:_cruxUtils.getI18n("crm.mb.newversion.msg4"),appearance:"primary"}]}});u.next=!1,"undefined"!=typeof commonUtils&&commonUtils.showHideLoadingDiv&&commonUtils.showHideLoadingDiv()})}}else(c.length||!c.length&&"next"!=e)&&(this.setNext(e,r,i,a,t,o),this.setData("show",!0),this.setSelected(c))},observeShow:function(){1==this.getData("show")&&this.$node.querySelector("lyte-modal").component.actualModalDiv.querySelector("lyte-input").ltProp("value","")}.observes("show"),observeRecords:function(){if(this.getData("queryParamObject").filters)this.records=[];else{var e=this.getData("queryParamObject").page?this.getData("queryParamObject").page:1;this.records[e]=this.getData("record")}}.observes("record"),records:[],observeValue:function(){if(this.getData("cxPropValue"))try{this.setData("value",JSON.parse(this.getData("cxPropValue"))),this.setData("selectedSingle",this.getData("value").id)}catch(e){this.setData("value",this.data.cxPropValue),this.setData("selectedSingle",this.data.value.id)}}.observes("cxPropValue").on("init"),observeAccountId:function(){if(this.data.cxPropRelatedId){idModuleMapping[this.data.cxPropRelatedModuleId];var e=[{id:this.data.cxPropRelatedId,name:_cruxUtils.getI18n("crm.related.contact.account",this.data.module.plural_label,this.data.cxPropRelatedName)},{id:"2",name:_cruxUtils.getI18n("crm.allcontact.show",this.data.module.plural_label)}];this.setData("headerOptions",e),this.setData("selectedHeaderValue",this.data.cxPropRelatedId),store.peekRecord("module",this.data.cxPropRelatedModuleId)||store.findRecord("module",this.data.cxPropRelatedModuleId)}}.observes("cxPropRelatedId").on("init"),getRelationId:function(){for(var e="",t=store.peekRecord("module",this.data.cxPropRelatedModuleId).related_lists,o=0;o<t.length;o++)if(t[o].api_name==this.data.module.api_name){e=t[o].id;break}return e}},{mixins:["crux-lookup-mixin"]}),Lyte.Component.register("crux-lookup-filter-modal",{_template:'<template tag-name="crux-lookup-filter-modal"> <lyte-modal id="modalElem" lt-prop-wrapper-class="cxLookupModal LookupModal cxBoxModal lookupListTable" lt-prop-show="{{lbind(show)}}" lt-prop-show-close-button="false" lt-prop-bind-to-body="{{ltPropBindToBody}}" lt-prop-offset="{&quot;top&quot; : &quot;0&quot;, &quot;left&quot; : &quot;center&quot;}" lt-prop="{&quot;allowMultiple&quot; : &quot;true&quot;, &quot;width&quot; : &quot;80%&quot;, &quot;left&quot; : &quot;5%&quot;}" on-before-close="{{method(&quot;closeModal&quot;)}}"> <template is="registerYield" yield-name="modal"> <div class="componentWrapper"> <crux-lookup-filter-view field-of-lookup-val="{{cxPropFieldOfLookupVal}}" parent-module="{{cxPropParentModule}}" default-criteria="{{cxPropDefaultCriteria}}" id="lookup_view_{{idIndex}}" module="{{lbind(module)}}" show="{{lbind(show)}}" disp-init="{{dispInit}}" on-data-loaded="{{method(\'onDataLoaded\')}}" mod-id="{{modId}}" is-single="{{isSingle}}" cx-prop-header="{{cxPropHeader}}" display-field="{{lbind(displayField)}}" record="{{lbind(record)}}" selected-single="{{selectedSingle.id}}" selected-single-record="{{lbind(selectedSingle)}}" lookup-single="{{lbind(lookupSingle)}}" module-name="{{lbind(moduleName)}}" on-value-change="{{method(\'onValueChange\')}}" cx-prop-value="{{cxPropValue}}" render-lookup="{{lbind(renderLookup)}}" fields-obj="{{fieldsObj}}" cx-prop-create-yield="{{cxPropCreateYield}}" temp-close="{{lbind(tempClose)}}" cx-prop-additional-params="{{cxPropAdditionalParams}}" disable-related-to="{{cxPropDontShowRelatedDropdown}}" related-record-data="{{relatedRecordData}}" cx-prop-field="{{cxPropField}}" cx-prop-return-full-object-on-get="{{cxPropReturnFullObjectOnGet}}" cx-prop-default-fields="{{cxPropDefaultFields}}"> <template is="yield" yield-name="createYield"><lyte-yield yield-name="createYield"></lyte-yield></template> </crux-lookup-filter-view> </div> </template> </lyte-modal> </template>',_dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"attr",position:[1,1]},{type:"registerYield",position:[1,1,1],dynamicNodes:[{type:"insertYield",position:[0]}]},{type:"componentDynamic",position:[1,1]}]},{type:"componentDynamic",position:[1]}],_observedAttributes:["cxPropDefaultCriteria","cxPropFieldOfLookupVal","cxPropParentModule","tempClose","fieldsObj","renderLookup","module","cxPropHeader","cxPropCreateYield","lookupSingle","sortedColumn","modId","show","cxPropHideHeaderOnNoContent","header","ltPropBindToBody","headerYields","relatedRecordData","cxPropDontShowRelatedDropdown","cxPropReturnFullObjectOnGet","cxPropDefaultFields"],data:function(){return{cxPropDefaultCriteria:Lyte.attr("array",{default:[]}),cxPropFieldOfLookupVal:Lyte.attr("array",{default:[]}),cxPropParentModule:Lyte.attr("string",{default:""}),tempClose:Lyte.attr("boolean",{default:!1}),fieldsObj:Lyte.attr("object",{default:{}}),renderLookup:Lyte.attr("boolean",{default:!1}),module:Lyte.attr("object",{default:{}}),cxPropHeader:Lyte.attr("string"),cxPropCreateYield:Lyte.attr("boolean",{default:!1}),lookupSingle:Lyte.attr("string",{default:""}),sortedColumn:Lyte.attr("string"),modId:Lyte.attr("string",{default:""}),show:Lyte.attr("boolean",{default:!1}),cxPropHideHeaderOnNoContent:Lyte.attr("boolean",{default:!0}),header:Lyte.attr("array",{default:[]}),ltPropBindToBody:Lyte.attr("boolean",{default:!1}),headerYields:Lyte.attr("object"),relatedRecordData:Lyte.attr("array",{default:[]}),cxPropDontShowRelatedDropdown:Lyte.attr("boolean",{default:!1}),cxPropReturnFullObjectOnGet:Lyte.attr("boolean",{default:!1}),cxPropDefaultFields:Lyte.attr("object",{default:{}})}},init:function(){this.setData("headerYields",{prefix:[{fixed:"enable",class:"cxLookupWidthOnePerc"}]}),this.setData("ltPropBindToBody",!0)},didConnect:function(){this.data.cxPropRelatedId&&this.data.relatedRecordData.length<1&&this.setRelatedDropDown(this.data.cxPropRelatedId,this.data.cxPropRelatedName,this.data.cxPropRelatedModuleId)},close:function(){this.setData("show",!1)},lookupInit:function(e,t,o,a,r){var i=this.$node.querySelector("crux-lookup-filter-view");i.lookupInit(i,elem.getData("modId"),!0,r)},openModalAfterQuickCreate:function(e){e.getRecs()},setRelatedDropDown(e,t,o){var a,r=[];switch(store.peekRecord("module",o).api_name){case"Accounts":a="Account_Name";break;case"Vendors":a="Vendor_Name";break;case"Contacts":a="Contact_Name"}r.push({apiName:a,id:e,name:_cruxUtils.getI18n("crm.related.contact.account",store.peekRecord("module",this.data.modId).plural_label,this.data.cxPropRelatedName)}),this.data.cxPropDontShowRelatedDropdown||r.push({id:"all",name:I18n.getMsg("crm.label.show")+" "+I18n.getMsg("crm.allcontact.show",store.peekRecord("module",this.data.modId).plural_label)}),this.setData("relatedRecordData",r)},methods:{onDataLoaded:function(){this.setData("show",!0)},closeModal:function(){this.setData({show:!1,renderLookup:!1})}}}),Lyte.Component.register("crux-lookup-filter-view",{_template:'<template tag-name="crux-lookup-filter-view"> <div class="f22 crm-font-bold fs pL20 pR20 pB10 clearAfterB"> <h4 class="dIB m0"><template is="if" value="{{expHandlers(cxPropHeader,\'!\')}}"><template case="true">{{cruxGetI18n(\'crm.lookup.chooserecord\',module.singular_label)}}</template><template case="false">{{cxPropHeader}}</template></template></h4> <template is="if" value="{{customCloseNeeded}}"><template case="true"> <div class="fR" data-zcqa="lookup_closeIcon" onclick="{{action(\'closeModal\')}}"> <span class="newPopupCloseIcon ico-close-small2 cP op08 dIB"></span> </div> </template></template> </div> <div class="alignright dF pB15 pL20 pR20 clearAfterB moduleRelatedDropdown"> <lyte-dropdown lt-prop-yield="true" lt-prop-selected="{{lbind(selectedRelatedRecordIndex)}}" data-zcqa="relatedRecord" lt-prop-disabled="{{disableRelatedTo}}" lt-prop-freeze="false" lt-prop-tabindex="1" class="dIB mR20 relatedDropdownLookup cxLookupFilterViewRelatedDropdown" on-option-selected="{{method(\'showRelatedRecords\')}}"> <template is="registerYield" yield-name="yield"> <lyte-drop-box> <lyte-drop-body> <template is="for" items="{{relatedRecordData}}" item="relatedRecord" index="relatedRecordIndex"> <lyte-drop-item data-zcqa="relatedRecord_{{relatedRecordIndex}}" data-value="{{relatedRecordIndex}}">{{relatedRecord.name}}</lyte-drop-item> </template> </lyte-drop-body> </lyte-drop-box> </template> </lyte-dropdown> <lyte-input class="lookupsearch dIB" lt-prop-id="filterbox" data-zcqa="lookupSearch" lt-prop-focus="true" lt-prop-appearance="box" lt-prop-type="search" lt-prop-value="{{lbind(searchBarAttr.searchValue)}}" lt-prop-placeholder="{{searchBarAttr.displayMsg}}" lt-prop-maxlength="200" lt-prop-autocomplete="off" on-value-change="{{method(\'searchBarSearch\')}}"></lyte-input> <template is="if" value="{{cxPropCreateYield}}"><template case="true"> <lyte-yield yield-name="createYield" class="cxMlAuto"></lyte-yield> </template></template> </div> <lyte-popover lt-prop-origin-elem="#coloumnSelectOrg" lt-prop-class="columnCustomizeWrap" lt-prop-wrapper-class="columnCustomizeWrap" lt-prop-animation="zoom" lt-prop-bind-to-body="false" lt-prop-show="{{showColList}}" lt-prop-header-padding="0px" lt-prop-content-padding="0px" lt-prop-footer-padding="0px" lt-prop-freeze="false" lt-prop-type="box" lt-prop-placement="bottomLeft" lt-prop-scrollable="false" lt-prop-show-close-button="false" lt-prop-close-on-body-click="true" on-close="{{method(&quot;closeColumnList&quot;)}}" on-show="{{method(&quot;setScrollableHeight&quot;)}}"> <template is="registerYield" yield-name="popover"> <lyte-popover-content class="lookupColumnCustomize"> <crux-column-list cx-prop-disable-sort-for-unselected-fields="true" cx-prop-selected-fields="{{header}}" class="lookupColumnCustComp" id="cruxColumnList" cx-prop-mandatory="mandatoryColumn" cx-prop-max-select-column="10" cx-prop-fields="{{availableFields}}" on-before-unchecked="{{method(\'uncheckColumn\')}}" on-search="{{method(\'OnColumnListSearch\')}}" cx-prop-zcqa-prefix="listView_" cx-prop-drag-zcqa-prefix="listViewDrag_"> </crux-column-list> </lyte-popover-content> <lyte-popover-footer class="lookupColumnCustButtons"> <div class="columnListBtn aligncenter pT15"> <template is="if" value="{{showColListFooter}}"><template case="true"> <lyte-button data-zcqa="columnListSaveButton" lt-prop-appearance="primary" class="mR10" onclick="{{action(\'closeColumnList\',\'SAVE\')}}"> <template is="registerYield" yield-name="text">{{getI18n(\'Save\')}}</template> </lyte-button> <lyte-button data-zcqa="columnListCancelButton" lt-prop-class="mR0" onclick="{{action(\'closeColumnList\',\'CANCEL\')}}"> <template is="registerYield" yield-name="text">{{getI18n(\'Cancel\')}}</template> </lyte-button> </template></template> </div> </lyte-popover-footer> </template> </lyte-popover> <div class="cxAdvanceLookupFilterField lookupFieldList pR"> <lyte-menu lt-prop-yield="true" lt-prop-show="{{showSortableOptions}}" lt-prop-event="click" id="sortOrderMenu" on-menu-click="{{method(\'sortColumnsInLookup\')}}" on-close="{{method(\'sortColumnsClose\')}}" lt-prop-query=".sortableTarget"> <template is="registerYield" yield-name="yield"> <lyte-menu-body> {{log(availableSort)}} <template is="for" items="{{availableSort}}" item="item" index="index"> <lyte-menu-item class="pL10 lookupSortItem" data-zcqa="sort_column_{{index}}" data-value="{{item}}"> <lyte-menu-label> <span class="dIB svgIconsImg sort_{{toLowerCase(item)}} mR5"></span> {{item}} </lyte-menu-label> </lyte-menu-item> </template> </lyte-menu-body> </template> </lyte-menu> <span class="dIB advanceFilter" data-zcqa="lookupAdvanceFilterIcon" lt-prop-title="{{if(showFilter,cruxGetI18n(\'crm.button.clear.filter\'),cruxGetI18n(\'crm.button.show.filter\'))}}" onclick="{{action(\'filterAction\',this)}}" lt-prop-tooltip-config="{&quot;position&quot; : &quot;default&quot;}"></span> <crux-table-component cx-prop-show-scroll-on="hover" cx-prop-zcqa-selector="field_label" cx-prop-module="{{moduleName}}" cx-prop-clip-mode="false" cx-prop-hide-header-on-no-content="false" class="lyteOuterTable dB entityLookupTable lyteFixedHeaderTable {{if(bigLookupTable,\'bigLookupTable\',\'\')}}" cx-prop-column-cell-class="lookupCriteriaLabelWrap1" cx-prop-header="{{header}}" cx-prop-show-business-card="false" cx-prop-row-zcqa="detailView" cx-prop-content="{{record}}" cx-prop-yield-for-prefix="true" cx-prop-sort-columns="true" cx-prop-table-class="lookupLyteTable" cx-prop-no-records-message="{{cruxGetI18n(\'crm.module.empty.message\',module.plural_label)}}" cx-prop-enable-body-scroll="false" cx-prop-show-tooltip="false" cx-prop-no-content-class="noresultstyle" cx-prop-field-type-mapping="{{uiTypeMapping}}" cx-prop-show-filter="{{showFilter}}" set-lookup-filter-conditions="{{method(\'setLookupFilterConditions\')}}" cx-prop-filter-component="crux-lookupfilter-component" apply-filter="{{method(\'applyFilter\')}}" clear-filter="{{method(\'clearFilter\')}}" header-fields="{{header}}" on-sort="{{action(\'sortColumn\')}}" cx-prop-sorted-column="{{sortedColumn}}" cx-prop-sorted-order="{{sortDetails.sort_order}}"> <template is="registerYield" yield-name="body-aTag"> <link-to data-zcqa="{{recordObj[fieldObj.api_name]}}" lt-prop-class="link" lt-prop-route="crm.tab.module.entity.detail" lt-prop-dp="[&quot;{{moduleName}}&quot;, &quot;{{recordObj.id}}&quot;]" onclick="{{action(&quot;selectSingle&quot;,recordObj.id,this,event)}}"> {{recordObj[fieldObj.api_name]}} </link-to> </template> <template is="yield" yield-name="header-prefix-1" cx-prop-fixed="enable"> <div class="lookupCriteriaLabelCol {{if(clientAccount,\'cD\',\'\')}}"> <span class="dIB coloumnSelect cP {{if(clientAccount,\'vH eventNone\',\'\')}}" data-zcqa="lookupColumnSelectIcon" id="coloumnSelectOrg" onclick="{{action(\'showColumnList\',event)}}" lt-prop-title="{{cruxGetI18n(\'crm.label.addColumn\')}}" lt-prop-tooltip-config="{&quot;position&quot; : &quot;followcursor&quot;}"></span> <div class="lookupCriteriaFilter mT10 w100per mL_20 dN"></div> </div> </template> <template is="yield" yield-name="body-prefix-1"> <lyte-radiobutton lt-prop-type="primary" lt-prop-name="record" data-zcqa="radioButon_{{recordObj.id}}" lt-prop-value="{{recordObj.id}}" lt-prop-checked="{{ifEquals(recordObj.id,selectedSingle)}}" onclick="{{action(\'selectSingle\',recordObj.id)}}"></lyte-radiobutton> </template> <template is="yield" yield-name="body-lookup">{{recordObj[fieldObj.api_name].name}}</template> <template is="yield" yield-name="body-territory"> <template is="for" items="{{recordObj[fieldObj.api_name]}}" item="item" index="index"> {{item.Name}} </template> </template> </crux-table-component> </div> <div class="cxLookupModalbuttonLayer pT20 pR20 pL20 pR {{if(scrollableTable,\'moreRecordsTable\',\'\')}}"> <template is="if" value="{{expHandlers(lookupSingle,\'&amp;&amp;\',selectedSingle)}}"><template case="true"> <div class="cxSelectedSingle"> {{cruxGetI18n("crm.record.selected",module.singular_label)}}: {{lookupSingle}} </div> </template></template> <template is="if" value="{{record.length}}"><template case="true"> <div class="cxMlAuto lookupPageNavigation" data-zcqa="lookupNavigation"> <lyte-navigator id="navigator" lt-prop-more-records="{{hasMoreRecords}}" lt-prop-show-only-icon="true" lt-prop-value="{{navigatedRec}}" lt-prop-records="{{navigatorRecordLen}}" lt-prop-per-page="{{perPage}}" on-next="{{method(\'rendNext\')}}" on-previous="{{method(\'rendPrev\')}}"></lyte-navigator> </div> </template></template> </div> </template>',_dynamicNodes:[{type:"attr",position:[1,1,0]},{type:"if",position:[1,1,0],cases:{true:{dynamicNodes:[{type:"text",position:[0]}]},false:{dynamicNodes:[{type:"text",position:[0]}]}},default:{}},{type:"attr",position:[1,3]},{type:"if",position:[1,3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]}]}},default:{}},{type:"attr",position:[3,1]},{type:"registerYield",position:[3,1,1],dynamicNodes:[{type:"attr",position:[1,1,1]},{type:"for",position:[1,1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,0]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1,1]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[3,1]},{type:"attr",position:[3,3]},{type:"componentDynamic",position:[3,3]},{type:"attr",position:[3,5]},{type:"if",position:[3,5],cases:{true:{dynamicNodes:[{type:"insertYield",position:[1]}]}},default:{}},{type:"attr",position:[5]},{type:"registerYield",position:[5,1],dynamicNodes:[{type:"attr",position:[1,1]},{type:"componentDynamic",position:[1,1]},{type:"componentDynamic",position:[1]},{type:"attr",position:[3,1,1]},{type:"if",position:[3,1,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"text",position:[0]}]},{type:"componentDynamic",position:[1]},{type:"attr",position:[3]},{type:"registerYield",position:[3,1],dynamicNodes:[{type:"text",position:[0]}]},{type:"componentDynamic",position:[3]}]}},default:{}},{type:"componentDynamic",position:[3]}]},{type:"componentDynamic",position:[5]},{type:"attr",position:[7,1]},{type:"registerYield",position:[7,1,1],dynamicNodes:[{type:"text",position:[1,1]},{type:"attr",position:[1,3]},{type:"for",position:[1,3],dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1,1]},{type:"text",position:[1,1,3]},{type:"componentDynamic",position:[1,1]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[7,1]},{type:"attr",position:[7,3]},{type:"attr",position:[7,5]},{type:"registerYield",position:[7,5,1],dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,1]},{type:"componentDynamic",position:[1]}]},{type:"registerYield",position:[7,5,3],dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]}]},{type:"registerYield",position:[7,5,5],dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]},{type:"registerYield",position:[7,5,7],dynamicNodes:[{type:"text",position:[0]}]},{type:"registerYield",position:[7,5,9],dynamicNodes:[{type:"attr",position:[1]},{type:"for",position:[1],dynamicNodes:[{type:"text",position:[1]}]}]},{type:"componentDynamic",position:[7,5]},{type:"attr",position:[9]},{type:"attr",position:[9,1]},{type:"if",position:[9,1],cases:{true:{dynamicNodes:[{type:"text",position:[1,1]},{type:"text",position:[1,3]}]}},default:{}},{type:"attr",position:[9,3]},{type:"if",position:[9,3],cases:{true:{dynamicNodes:[{type:"attr",position:[1,1]},{type:"componentDynamic",position:[1,1]}]}},default:{}}],_observedAttributes:["cxPropDefaultFields","cxPropAllFieldsNeeded","cxPropField","cxPropFrom","showSortableOptions","requiredFieldsForApi","availableFields","availableSort","renderLookupView","searchDoMode","fieldOfLookupVal","currentSelectedRecord","defaultCriteria","searchBarCriteria","targetElement","relatedRecordCriteria","flushView","bigLookupTable","selectedRelatedRecordIndex","relatedRecordData","tempClose","fieldsObj","renderLookup","displayField","selectedSingle","sortDetails","criteria","searchBarAttr","showFilter","customCloseNeeded","scrollableTable","selectedFields","currentSelectedFields","module","moduleName","header","cxPropHeader","cxPropCreateYield","lookupSingle","record","sortedColumn","cxPropHideHeaderOnNoContent","modId","comparator","next","navigatedRec","currentPage","tableScrollHeight","perPage","navigatorRecordLen","value","hasMoreRecords","uiTypeMapping","lookupViewRestrictedColumns","lookupViewRestrictedModuleVsColumn","appointmentHiddenFields","tasksHiddenFields","servicesHiddenFields","formulaReturnTypeComparators","lookupUitypeComparator","lookupDatatypeComparator","cxPropReturnFullObjectOnGet"],data:function(){return{cxPropDefaultFields:Lyte.attr("object",{default:{}}),cxPropAllFieldsNeeded:Lyte.attr("boolean",{default:!1}),cxPropField:Lyte.attr("object",{default:{}}),cxPropFrom:Lyte.attr("string",{default:""}),showSortableOptions:Lyte.attr("boolean",{default:!1}),requiredFieldsForApi:Lyte.attr("array",{default:[]}),availableFields:Lyte.attr("array",{default:[]}),availableSort:Lyte.attr("array",{default:[]}),renderLookupView:Lyte.attr("boolean",{default:!1}),searchDoMode:Lyte.attr("boolean",{default:!1}),fieldOfLookupVal:Lyte.attr("array",{default:[]}),currentSelectedRecord:Lyte.attr("object",{default:{}}),defaultCriteria:Lyte.attr("array",{default:[]}),searchBarCriteria:Lyte.attr("string",{default:""}),targetElement:Lyte.attr("string",{default:""}),relatedRecordCriteria:Lyte.attr("string",{default:""}),flushView:Lyte.attr("boolean",{default:!1}),bigLookupTable:Lyte.attr("boolean",{default:!1}),selectedRelatedRecordIndex:Lyte.attr("number",{default:0}),relatedRecordData:Lyte.attr("array",{default:[]}),tempClose:Lyte.attr("boolean",{default:!1}),fieldsObj:Lyte.attr("object",{default:{}}),renderLookup:Lyte.attr("boolean",{default:!1}),displayField:Lyte.attr("string",{default:""}),selectedSingle:Lyte.attr("string",{default:""}),sortDetails:Lyte.attr("object",{default:{}}),criteria:Lyte.attr("string",{default:""}),searchBarAttr:Lyte.attr("object",{default:{}}),showFilter:Lyte.attr("boolean",{default:!1}),customCloseNeeded:Lyte.attr("boolean",{default:!0}),scrollableTable:Lyte.attr("boolean",{default:!1}),selectedFields:Lyte.attr("object",{default:{}}),currentSelectedFields:Lyte.attr("object",{default:{}}),module:Lyte.attr("object",{default:{}}),moduleName:Lyte.attr("string",{default:""}),header:Lyte.attr("array",{default:[]}),cxPropHeader:Lyte.attr("string"),cxPropCreateYield:Lyte.attr("boolean",{default:!1}),lookupSingle:Lyte.attr("string",{default:""}),record:Lyte.attr("array",{default:[]}),sortedColumn:Lyte.attr("string"),cxPropHideHeaderOnNoContent:Lyte.attr("boolean",{default:!0}),modId:Lyte.attr("string",{default:""}),comparator:Lyte.attr("boolean",{default:!1}),next:Lyte.attr("array",{default:[0,10]}),navigatedRec:Lyte.attr("number",{default:0}),currentPage:Lyte.attr("number",{default:1}),tableScrollHeight:Lyte.attr("number",{default:200}),perPage:Lyte.attr("number",{default:10}),navigatorRecordLen:Lyte.attr("number",{default:0}),value:Lyte.attr("object"),hasMoreRecords:Lyte.attr("boolean",{default:!1}),uiTypeMapping:Lyte.attr("object",{default:"undefined"!=typeof crmConstants&&crmConstants.defaultUiTypeToCruxMapping?Lyte.deepCopyObject(crmConstants.defaultUiTypeToCruxMapping):{}}),lookupViewRestrictedColumns:Lyte.attr("array",{default:["CURRENCYISOCODE","SCORE","POSITIVE_SCORE","NEGATIVE_SCORE","TP_SCORE","TP_POSITIVE_SCORE","TP_NEGATIVE_SCORE","LEADSCORE"]}),lookupViewRestrictedModuleVsColumn:Lyte.attr("object",{default:{Leads:["QUALIFICATIONDURATION"],Products:["ACTIVE"]}}),appointmentHiddenFields:Lyte.attr("array",{default:["RESCHEDULEDFROM","REMINDER","ENDTIME"]}),tasksHiddenFields:Lyte.attr("array",{default:["REMINDAT","SENDNOTIFICATION"]}),servicesHiddenFields:Lyte.attr("array",{default:["AVAILABLE_DATES","AVAILABLE_DAYS","UNAVAILABLE_TILL","STARTING_DATE","CLOSING_DATE","JOBSHEETLAYOUT","APPOINTMENTFOR","SEID","APPOINTMENTLOCATION","APPOINTMENTID","APPOINTMENTADDRESS","APPOINTMENTDATEANDTIME","RESCHEDULEDFROM","SERVICEID","RESCHEDULEDTO","RESCHEDULEDREASON","RESCHEDULEDNOTE","CANCELLATIONREASON","CANCELLATIONNOTE","SERVICEAVAILABILITY","AVAILABLE_CUSTOM_TIMING","UNAVAILABLE_FROM"]}),formulaReturnTypeComparators:Lyte.attr("object",{default:{boolean:"equals",currency:"equals",double:"equals",text:"starts_with",datetime:"between",date:"equals"}}),lookupUitypeComparator:Lyte.attr("object",{default:{starts_with:[CrmField.UITYPES.SINGLE_LINE,CrmField.UITYPES.SKYPE_FIELD,CrmField.UITYPES.TEXT_FIELD,CrmField.UITYPES.TWITTER,CrmField.UITYPES.FIRST_NAME,CrmField.UITYPES.LAST_NAME,CrmField.UITYPES.TASK_SUBJECT,CrmField.UITYPES.MULTI_LINE_CF,CrmField.UITYPES.TEXT_AREA,CrmField.UITYPES.WEBSITE,CrmField.UITYPES.EMAIL,CrmField.UITYPES.ACCOUNT_NAME_LOOKUP,CrmField.UITYPES.CAMPAIGN_NAME_LOOKUP,CrmField.UITYPES.PRODUCT_NAME_LOOKUP,CrmField.UITYPES.CONTACT_LOOKUP,CrmField.UITYPES.VENDOR_NAME_LOOKUP,CrmField.UITYPES.POTENTIAL_ID,CrmField.UITYPES.SALESORDER_ID,CrmField.UITYPES.CONTACT_ID,CrmField.UITYPES.QUOTE_ID,CrmField.UITYPES.ROLE_NAME,CrmField.UITYPES.LOOK_UP_ENTITY,CrmField.UITYPES.MULTISELECT_LOOK_UP,CrmField.UITYPES.PHONE],equals:[CrmField.UITYPES.SERVICE_DURATION,CrmField.UITYPES.DATE,CrmField.UITYPES.DATE_LONG,CrmField.UITYPES.NUMERIC_FIELD,CrmField.UITYPES.LONG_INTEGER,CrmField.UITYPES.CURRENCY,CrmField.UITYPES.AGGREGATE_FIELD,CrmField.UITYPES.PERCENT,CrmField.UITYPES.DECIMAL,CrmField.UITYPES.BIG_DECIMAL,CrmField.UITYPES.RECORD_CURRENCY,98,CrmField.UITYPES.BOOLEAN_DEF,CrmField.UITYPES.BOOLEAN_DEF_NOT,CrmField.UITYPES.AUTONUMBER],in:[CrmField.UITYPES.PRODUCT_HANDLER,CrmField.UITYPES.GLOBAL_TAX,999,CrmField.UITYPES.STAGE,CrmField.UITYPES.USERLOOKUP,CrmField.UITYPES.TAGS,CrmField.UITYPES.MULTI_PICK_LIST,CrmField.UITYPES.PICK_LIST,CrmField.UITYPES.OWNER,CrmField.UITYPES.CREATED_BY,CrmField.UITYPES.WIZARD,CrmField.UITYPES.LAYOUT],between:[CrmField.UITYPES.DATE_TIME1,CrmField.UITYPES.CREATED_TIME,CrmField.UITYPES.DATETIME,CrmField.UITYPES.DATE_TIME2,CrmField.UITYPES.DATE_TIME_LONG]}}),lookupDatatypeComparator:Lyte.attr("object",{default:{starts_with:["text","textarea","phone","email","website","lookup"],equals:["boolean","currency","double","date","integer","bigint","autonumber","decimal"],in:["ownerlookup","picklist","userlookup","multiuserlookup","multiselectpicklist"],between:["datetime"],formula:["formula"],rollup_summary:["rollup_summary"]}}),cxPropReturnFullObjectOnGet:Lyte.attr("boolean",{default:!1})}},init:function(){var e=Object.assign(this.data.uiTypeMapping,{999:"layout",96:"picklist",80:"number",21:"text",22:"text",25:"text"});this.setData("uiTypeMapping",e),this.lookupInit(this,this.getData("modId"),!0)},didConnect:function(){this.lookupTableHeightCalc()},methods:{OnColumnListSearch:function(e){this.setData("showColListFooter",!!e.length)},setScrollableHeight:function(){var e=renderingUtils.windowHeight/2;$L(".lookupColumnCustComp .lyteSortableParent").css("max-height",e),$L("crux-column-list .divTopBorder").scrollTop(0),$L("crux-column-list lyte-search")[0].setValue("")},associateSearchClick:function(e){var t=this;e.querySelector(".searchIcon").onclick=function(){var o=e.querySelector("input");t.actions.searchSetValue.call(t,void 0,void 0,void 0,o.value,!0)}},fetchModuleData:function(e){return store.findRecord("module",e,{include:"custom_view,business_card_fields,lookup_field_properties"}).then(function(e){return"Contacts"!==e[0].api_name&&"Leads"!==e[0].api_name||(store.peekRecord("field",e[0].display_field.id).field_label="Contacts"===e[0].api_name?I18n.getMsg("Contact Name",e[0].singular_label):I18n.getMsg("Lead Name",e[0].singular_label)),e[0]})},uncheckColumn:function(e){if(e.display_field||"aTag"===e.yieldName)return!1},setLookupFilterConditions:function(e){var t=this.getData("lookupDatatypeComparator"),o={picklist:I18n.getMsg("crm.select"),user:I18n.getMsg("crm.options.none"),80:_cruxUtils.getI18n("crm.label.type.minutes")};e.setData({cxPropNoValidation:!0,cxPropShowClear:!0,cxPropDisableFilter:!0,filterAtfirst:!1,cxPropComparator:!1,cxPropDatatypeComparator:t,cxPropPlaceHolder:o,cxPropCurrency:Crm.userDetails.BASE_CURRENCY}),e.setMethods("picklistAdd",this.pickListValidator)},clearFilter:function(){this.getData("criteria")&&!this.fromSearchBar&&(this.setData({criteria:"",currentPage:1,navigatedRec:0}),this.validateSearchValue()&&this.renderPage())},applyFilter:function(e){var t,o=e.$node.component.getFilterQuery();if(this.filterValueIds=[],o&&o.group_operator){var a=o.group?o.group.length:0;t=a?"(":"";for(var r=0;r<a;r++){if(p=store.peekRecord("field",o.group[r].field.id),o.group[r].field.api_name.includes(".")&&(o.group[r].field.api_name=p.api_name),[999,208,207,209].includes(p.ui_type)&&(o.group[r].comparator="in"),0===o.group[r].value.indexOf(".")&&(["double","integer","currency"].includes(p.data_type)||["double","integer","currency"].includes(p.formula.return_type)||p.rollup_summary&&["double","integer","decimal","currency"].includes(p.rollup_summary.return_type))&&(o.group[r].value="0"+o.group[r].value),!this.validateSearchValue(o.group[r].value,p.field_label,"formula"===p.data_type||"rollup_summary"===p.data_type?"formula"===p.data_type?p.formula.return_type:p.rollup_summary.return_type:p.data_type,p))return void(this.filterValueIds=[]);if("object"==typeof o.group[r].value&&"object"==typeof o.group[r].value[0]){var i=[];if(209===p.ui_type)for(var s of o.group[r].value)s.name&&i.push(s.name);else for(var s of o.group[r].value)s.id&&i.push(s.id)}else if(96===p.ui_type){i=[];for(var l of o.group[r].value)i.push(p.pick_list_values.find(e=>e.display_value==l).id)}else("datetime"===p.data_type||"formula"===p.data_type&&"datetime"===p.formula.return_type||"rollup_summary"===p.data_type&&"datetime"===p.rollup_summary.return_type)&&!o.group[r].value.toString().includes("+")&&(o.group[r].value[0]+=Crm.userDetails.TIME_ZONE.replace(".",":"),o.group[r].value[1]+=Crm.userDetails.TIME_ZONE.replace(".",":"));i=(i=i&&i.length?i:o.group[r].value).toString().replace(/[(]/g,"\\(").replace(/[)]/g,"\\)"),t+="("+o.group[r].field.api_name+":"+("equal"===o.group[r].comparator?"equals":o.group[r].comparator)+":"+i+")",i="",t+=r<a-1?"and":")",this.filterValueIds.push(o.group[r].field.id)}}else if(o&&o.field){var p=store.peekRecord("field",o.field.id);if(o.field.api_name.includes(".")&&(o.field.api_name=p.api_name),[999,208,207,209].includes(p.ui_type)&&(o.comparator="in"),0===o.value.indexOf(".")&&(["double","integer","currency"].includes(p.data_type)||["double","integer","currency"].includes(p.formula.return_type)||p.rollup_summary&&["double","decimal","integer","currency"].includes(p.rollup_summary.return_type))&&(o.value="0"+o.value),!this.validateSearchValue(o.value,p.field_label,"formula"===p.data_type||"rollup_summary"===p.data_type?"formula"===p.data_type?p.formula.return_type:p.rollup_summary.return_type:p.data_type,p))return void(this.filterValueIds=[]);if("object"==typeof o.value&&"object"==typeof o.value[0]){i=[];if(209===p.ui_type)for(var s of o.value)s.name&&i.push(s.name);else for(var r of o.value)r.id&&i.push(r.id)}else if(96===p.ui_type){i=[];for(var l of o.value)i.push(p.pick_list_values.find(e=>e.display_value==l).id)}else("datetime"===p.data_type||"formula"===p.data_type&&"datetime"===p.formula.return_type||"rollup_summary"===p.data_type&&"datetime"===p.rollup_summary.return_type)&&!o.value.toString().includes("+")&&(o.value[0]+=Crm.userDetails.TIME_ZONE.replace(".",":"),o.value[1]+=Crm.userDetails.TIME_ZONE.replace(".",":"));i=(i=i&&i.length?i:o.value).toString().replace(/[(]/g,"\\(").replace(/[)]/g,"\\)"),t="("+o.field.api_name+":"+("equal"===o.comparator?"equals":o.comparator)+":"+i+")",this.filterValueIds.push(o.field.id)}t&&t.length?(this.setData({criteria:t,currentPage:1,navigatedRec:0}),this.fetchFilteredRecords()):(this.setData({criteria:"",currentPage:1,navigatedRec:0}),this.renderPage())},rendNext:function(e){this.renderPage("next",e)},rendPrev:function(e){this.renderPage("prev",e)},searchBarSearch:function(){clearTimeout(this._timeout),this._timeout=setTimeout(function(){var e=this.data.searchBarAttr.searchValue?this.data.searchBarAttr.searchValue.trim():"";this.errorLabel=void 0;var t=this.data.header.find(e=>e.api_name===this.data.searchBarAttr.apiName).field_label;if(!this.validateSearchValue(e,t))return this.errorLabel=t,!1;if(this.data.searchBarAttr&&e){e=e.replace(/[(]/g,"\\(").replace(/[)]/g,"\\)");var o="("+this.data.searchBarAttr.apiName+":starts_with:"+e+")";this.isProductCodeAvailable&&this.isProductCodeAvailable.api_name&&(o="("+o+"or("+this.isProductCodeAvailable.api_name+":starts_with:"+e+"))"),this.setData({searchBarCriteria:o,currentPage:1,navigatedRec:0}),this.fetchFilteredRecords()}else 0===e.length&&(this.setData({searchBarCriteria:"",currentPage:1,navigatedRec:0}),this.renderPage())}.bind(this),500)},sortColumnsInLookup:function(e){if(e===I18n.getMsg("crm.column.unsort"))this.setData({sortDetails:{},sortedColumn:"",currentPage:1,navigatedRec:0});else{var t=e===I18n.getMsg("crm.column.sort.desc")?"desc":"asc";this.setData("sortDetails",{sort_order:t,sort_by:this.currentSelectedSortColumn.api_name}),this.setData({sortedColumn:this.currentSelectedSortColumn.api_name,currentPage:1,navigatedRec:0})}delete this.currentSelectedSortColumn,this.renderPage()},sortColumnsClose:function(){$L(".sortableColumn").removeClass("sortableColumn"),this.setData({showSortableOptions:!1,availableSort:[]})},selectSingle:function(e,t){this.selectTheSingle(e,t)},showRelatedRecords:function(){this.showRelatedRecords()},closeColumnList:function(){this.saveColumn||$L("crux-column-list")[0].component.clearSelectedFields(),this.saveColumn=!1,this.closeColumnList()}},actions:{showColumnList:function(){this.setData("showColList",!0)},closeColumnList:function(e){"SAVE"===e?(this.saveColumn=!0,this.putModuleData(this.getData("modId"))):"CANCEL"===e&&(this.saveColumn=!1),this.closeColumnList()},filterAction:function(e){this.getData("showFilter")?(this.setData({criteria:"",currentPage:1,navigatedRec:0}),this.renderPage(),this.setData("showFilter",!1),$L(e).removeClass("lookupFilterOpen")):(this.setData("showFilter",!0),this.$node.querySelector("lyte-table").scrollTable(),$L(e).addClass("lookupFilterOpen"))},sortColumn:function(e){if(this.currentSelectedSortColumn=e,e.sortable&&e.api_name){$L(".sortableTarget").removeClass("sortableTarget");var t=document.getElementById(e.id).children[0];$L(t).addClass("sortableTarget");var o=[I18n.getMsg("crm.column.sort.asc"),I18n.getMsg("crm.column.sort.desc")];if(e.api_name===this.getData("sortDetails").sort_by&&this.getData("sortDetails").sort_order){var a=[];a.push("asc"===this.getData("sortDetails").sort_order?I18n.getMsg("crm.column.sort.desc"):I18n.getMsg("crm.column.sort.asc")),a.push(I18n.getMsg("crm.column.unsort")),this.setData("availableSort",a)}else this.setData("availableSort",o);this.setData("showSortableOptions",!0)}},selectSingle:function(e,t,o){this.selectTheSingle(e,t),o&&o.preventDefault()},closeModal:function(){this.close()}},isBigLookupTable:function(){var e=this.getData("header").length;$(".lookupFieldList");e>6?this.setData("bigLookupTable",!0):this.setData("bigLookupTable",!1)},getRecs:function(){var e=Lyte.deepCopyObject(this.getData("module")),t=e.fields,o=t.length,a=this.data.relatedRecordData.length,r="",i=[],s=Lyte.deepCopyObject(this.data.defaultCriteria);if(a&&"Campaigns"!=e.api_name){i=[];for(var l=0;l<a;l++)this.data.relatedRecordData[l].apiName&&!i.includes(this.data.relatedRecordData[l].apiName)&&i.push(this.data.relatedRecordData[l].apiName)}if(this.getData("parentModule")){var p,n=store.peekRecord("module",moduleRecordMapping[this.data.parentModule].id,void 0,void 0,void 0,{getFields:!0});p=(n=n&&n.fields?n.fields:"").length;for(l=0;l<p;l++)n[l].association_details&&Lyte.arrayUtils(this.data.fieldOfLookupVal,"push",n[l].association_details)}for(l=0;l<o;l++){if(17===t[l].show_type||0===t[l].show_type&&"FULLNAME"!==t[l].column_name||!t[l].filterable&&"DESCRIPTION"!==t[l].column_name&&"SHAREDTO"!==t[l].column_name&&"zohoshowtime__Total_Revenue"!==t[l].api_name||!t[l].searchable||t[l].virtual_field||null!==t[l].crypt||!t[l].visible||!t[l].available_in_user_layout||("Cases"===e.module_name||"Solutions"===e.module_name)&&"ADDCOMMENT"===t[l].column_name||"Tasks"===e.module_name&&this.data.tasksHiddenFields.indexOf(t[l].column_name)>-1||"Appointments"===e.module_name&&this.data.appointmentHiddenFields.indexOf(t[l].column_name)>-1||"Services"===e.module_name&&this.data.servicesHiddenFields.indexOf(t[l].column_name)>-1||e.module_name.startsWith("Orchestration")&&"SMOWNERID"===t[l].column_name||"DealHistory"===e.module_name&&"LASTACTIVITYTIME"===t[l].column_name)t.splice(l,1),l--,o--;else{if("Services"===e.module_name&&a&&"Status"===t[l].api_name&&t[l].pick_list_values.length)for(var c=0;c<a;c++)switch(c){case 0:this.data.relatedRecordData[c].id="multi",this.data.relatedRecordData[c].criteria="(("+this.data.relatedRecordData[c].apiName+":equals:"+t[l].pick_list_values[0].id+")or("+this.data.relatedRecordData[c].apiName+":equals:"+t[l].pick_list_values[1].id+"))";break;case 1:this.data.relatedRecordData[c].id="all";break;case 2:this.data.relatedRecordData[c].id=t[l].pick_list_values[0].id;break;case 3:this.data.relatedRecordData[c].id=t[l].pick_list_values[1].id;break;case 4:this.data.relatedRecordData[c].id=t[l].pick_list_values[2].id}if(s&&s.length)for(var d of s)(d.api_name==t[l].api_name||d.parentCriteria)&&(r=r.length?r+"and":r,r+="("+d.api_name+":"+d.comparator+":"+d.value+")",s.splice(s.indexOf(d),1));if(a&&i.length){var u=i.indexOf(t[l].api_name);u>-1&&i.splice(u,1)}t[l].cxPropFilterZcqa="lookupFiltersInput_"+t[l].api_name}}if(this.defaultCriteriaPattern=r||"",function(e){var t=this.getData("lookupViewRestrictedColumns"),o=this.getData("moduleName"),a=this.getData("lookupViewRestrictedModuleVsColumn");let r=e.length;for(var i=0;i<r;i++)(t.contains(e[i].column_name)||o in a&&a[o].contains(e[i].column_name)||13===e[i].show_type&&["Segment_Label","Recency","Frequency","Monetary"].includes(e[i].api_name))&&(e.splice(i,1),i--,r--)}.bind(this)(e.fields),this.setData("availableFields",e.fields),this.lookupFilterQueryHandling(),this.overRideFieldsForTable(),a&&i.length)for(l=0;l<a;l++)this.data.relatedRecordData[l].apiName&&i.includes(this.data.relatedRecordData[l].apiName)&&(Lyte.arrayUtils(this.getData("relatedRecordData"),"splice",l,1),l--,a--);1===a&&"all"===this.data.relatedRecordData[0].id&&(this.data.relatedRecordData="");var x=$(".relatedDropdownLookup");this.data.relatedRecordData.length?(this.setData("selectedRelatedRecordIndex","0"),x.attr("lt-prop-selected","1"),x.attr("lt-prop-selected","0"),this.showRelatedRecords(),x.show()):(x.hide(),this.renderPage())},renderPage:function(e,t){if(this.getData("criteria")||this.getData("relatedRecordCriteria")||this.getData("searchBarCriteria")||this.defaultCriteriaPattern)this.fetchFilteredRecords(e,t);else{var o=this.getData("currentPage");"next"===e?o++:"prev"===e&&o--;var a={page:o,per_page:this.getData("perPage"),fields:this.getData("requiredFieldsForApi"),approved:"both",approval_state:"approved,approval_process_pending,approval_process_rejected"};Object.keys(this.getData("sortDetails")).length>1&&Object.assign(a,{sort_order:this.getData("sortDetails").sort_order,sort_by:this.getData("sortDetails").sort_by}),Object.keys(this.lookupFilterQueryDetails).length&&this.lookupFilterQueryDetails.query_id&&(a.query_id=this.lookupFilterQueryDetails.query_id),"undefined"!=typeof commonUtils&&commonUtils.showHideLoadingDiv&&commonUtils.showHideLoadingDiv(!0),this.relatedListMode?this.fetchRelatedListRecords(moduleRecordMapping.Contacts.id,this.selectedRecord,this.getData("moduleName"),a).then(function(o){var a=o.data,r=!(!a||!o.meta.more_records)&&o.meta.more_records;this.updateNavigators(a,r,e,t)}.bind(this)):this.fetchRecords(this.getData("modId"),a).then(function(o){var a=o&&o.length;o=a?o:[];var r=!!a&&o.$.meta.more_records;this.updateNavigators(o,r,e,t)}.bind(this),function(){"undefined"!=typeof commonUtils&&commonUtils.showHideLoadingDiv&&commonUtils.showHideLoadingDiv(!1)})}},putModuleData:function(e){var t=this.$node.querySelector("lyte-popover").component.childComp.querySelector("CRUX-COLUMN-LIST"),o=store.peekRecord("module",e),a=t.component.getSelectedFields(),r=o.lookup_field_properties.fields;this.data.currentSelectedFields=a;var i={},s=[],l={},p=function(e){for(var t=e.length,o=[],a=0;a<t;a++)l={sequence_number:a+1,api_name:e[a].api_name,id:e[a].id},o.push(l);return o};if(s=p(a),this.getData("selectedFields").length||(this.data.selectedFields=p(o.lookup_field_properties.fields)),JSON.stringify(s)!==JSON.stringify(this.getData("selectedFields"))){for(var n=r.length,c=function(e,t){return e.filter(function(e){return e.id===t})[0]},d=0;d<n;d++)c(a,r[d].id)||(l={_delete:!0,api_name:r[d].api_name,id:r[d].id},s.push(l));this.fieldsToBeDeleted&&this.fieldsToBeDeleted.length&&(s=s.concat(this.fieldsToBeDeleted)),i.fields=s,o.$.set("lookup_field_properties",i),"undefined"!=typeof commonUtils&&commonUtils.showHideLoadingDiv&&commonUtils.showHideLoadingDiv(!0),o.$.save().then(function(){this.data.selectedFields=o.lookup_field_properties.fields,this.data.selectedFields.splice(this.getData("currentSelectedFields").length),o.lookup_field_properties.fields=this.getData("currentSelectedFields"),this.fieldsToBeDeleted=[],this.overRideFieldsForTable(),this.getData("showFilter")&&(this.setData({showFilter:!1,criteria:"",currentPage:1,navigatedRec:0}),$L(".lookupFilterOpen").removeClass("lookupFilterOpen")),this.renderPage()}.bind(this),function(){t.component.clearSelectedFields();var e=t.component.getSelectedFields();o.lookup_field_properties.fields=e,this.data.selectedFields={},"undefined"!=typeof commonUtils&&commonUtils.showHideLoadingDiv&&commonUtils.showHideLoadingDiv(!1),renderingUtils.displayPermissionDenied()}.bind(this))}},fetchRecords:function(e,t,o,a,r){return this.data.cxPropAdditionalParams&&Object.keys(this.data.cxPropAdditionalParams).length&&(t=Object.assign(t,this.data.cxPropAdditionalParams)),new Promise(function(a,i){var s=store.model[e].fieldList,l={};for(var p in s)s[p].type&&Lyte.Transform.hasOwnProperty(s[p].type)&&Lyte.Transform[s[p].type].deserialize&&(l[p]=s[p]);store.findAll(e,t,o,!1,r).then(function(t){for(var o=t[e],r=0;r<o.length;r++)for(var i in l)o[r][i]&&(o[r][i]=Lyte.Transform[l[i].type].deserialize(o[r][i],i,e,"id"));o.info=t.info,o.meta=t.meta,o.$={meta:t.info},a(o)},function(e){var t=JSON.parse(e.response);"NO_PERMISSION"===t.code?renderingUtils.displayPermissionDenied():"INVALID_QUERY"!==t.code&&"INVALID_DATA"!==t.code||(commonUtils.showHideLoadingDiv(!1),crmui.showMsgBand("error",I18n.getMsg("crm.lookup.advance.error.msg"),5e3)),i()})})},fetchRelatedListRecords:function(e,t,o,a){return new Promise(function(r,i){store.triggerAction(e,"fetchrelatedList",{entityid:t,relapiname:o},a).then(function(t){t.data=t.data?t.data:[],t.data=t.data?store.pushPayload(e,t.data):[],r(t)},function(e){"NO_PERMISSION"===JSON.parse(e.response).code&&renderingUtils.displayPermissionDenied(),i()})})},fetchFilteredRecords:function(e,t){var o=this.getData("criteria"),a=this.getData("currentPage"),r={type:"Search",from:"Lookup"};"next"===e?a++:"prev"===e&&a--;var i={page:a,per_page:this.getData("perPage"),fields:this.getData("requiredFieldsForApi"),approved:"both",approval_state:"approved,approval_process_pending,approval_process_rejected"};o&&o.length&&(r.criteria=o),this.getData("relatedRecordCriteria")&&this.getData("relatedRecordCriteria").length&&(r.criteria=r.criteria?r.criteria+"and"+this.getData("relatedRecordCriteria"):this.getData("relatedRecordCriteria")),this.getData("searchBarCriteria")&&this.getData("searchBarCriteria").length&&(r.criteria=r.criteria?r.criteria+"and"+this.getData("searchBarCriteria"):this.getData("searchBarCriteria")),this.getData("defaultCriteria")&&this.getData("defaultCriteria").length&&this.defaultCriteriaPattern&&(r.criteria=r.criteria?r.criteria+"and"+this.defaultCriteriaPattern:this.defaultCriteriaPattern),Object.keys(this.getData("sortDetails")).length>1&&Object.assign(i,{sort_order:this.getData("sortDetails").sort_order,sort_by:this.getData("sortDetails").sort_by}),Object.keys(this.lookupFilterQueryDetails).length&&this.lookupFilterQueryDetails.query_id&&(i.query_id=this.lookupFilterQueryDetails.query_id),"undefined"!=typeof commonUtils&&commonUtils.showHideLoadingDiv&&commonUtils.showHideLoadingDiv(!0),this.relatedListMode?this.searchUsingDO(r.criteria,i,e,t):this.fetchRecords(this.getData("modId"),i,!1,void 0,r).then(function(o){var a=o&&o.length;o=a?o:[];var r=!!a&&o.$.meta.more_records;this.updateNavigators(o,r,e,t)}.bind(this),function(){"undefined"!=typeof commonUtils&&commonUtils.showHideLoadingDiv&&commonUtils.showHideLoadingDiv(!1)})},selectTheSingle:function(e){for(var t,o,a=this.getData("record"),r=this.getData("displayField"),i=a.length,s=0;s<i;s++)if(e===a[s].id){t="Full_Name"===r?a[s][r]?a[s][r]:a[s].First_Name?a[s].First_Name+" "+a[s].Last_Name:a[s].Last_Name:a[s][r],this.setData({lookupSingle:t,selectedSingle:e,currentSelectedRecord:a[s]}),this.data.currentSelectedRecord.displayName=t,o=a[s];break}this.bool||(this.setData("renderLookup",!1),this.close(),this.getMethods("onSelect")&&this.executeMethod("onSelect"),this.getMethods("onValueChange")&&(this.setData("cxPropValue",{id:this.getData("selectedSingle"),name:this.getData("lookupSingle")}),o.name=this.getData("lookupSingle"),this.executeMethod("onValueChange",this.data.cxPropReturnFullObjectOnGet?o:this.getData("currentSelectedRecord"))))},close:function(){store.peekRecord("module",this.data.modId).lookup_field_properties=void 0,this.setData("show",!1)},updateNavigators:function(e,t,o,a){this.setData({record:e,hasMoreRecords:t}),"next"===o?(this.setData("currentPage",this.getData("currentPage")+1),this.setData("navigatedRec",a),this.setData("navigatorRecordLen",t?this.getData("navigatorRecordLen")+this.getData("perPage"):this.getData("navigatorRecordLen")+e.length-1)):"prev"===o&&(this.setData("currentPage",this.getData("currentPage")-1),this.setData("navigatedRec",a),this.setData("navigatorRecordLen",t?this.getData("currentPage")*this.getData("perPage")+1:this.getData("perPage")*(this.getData("currentPage")-1)+recs.length)),1!==this.getData("currentPage")||"false"!==t&&t?1===this.getData("currentPage")&&t&&this.setData("navigatorRecordLen",this.getData("perPage")+1):this.setData("navigatorRecordLen",e.length),this.getData("currentPage")>=100&&this.setData({hasMoreRecords:!1,navigatorRecordLen:e.length}),"undefined"!=typeof commonUtils&&commonUtils.showHideLoadingDiv&&commonUtils.showHideLoadingDiv(!1),this.executeMethod("onDataLoaded")},searchUsingDO:function(e,t,o,a){var r=this.getData("lookupUrlForCampaign"),i=e?"searchcriteria=":"",s=t.page,l=t.sort_order?"sort_"+t.sort_order:void 0,p=t.sort_by;r+="&luceneSearch=true&isFromFilterView=true",s&&(r+="&FROM_INDEX="+(s*this.data.perPage-9)+"&TO_INDEX="+s*this.data.perPage),l&&p&&(r+="&sortColumnString="+p+"&sortOrderString="+l),$L("#navigateBack, #navigateForward").addClass("pEvents"),i+=e?encodeURIComponent(e):"";$.ajax({url:r,type:"POST",data:i,success:function(e){if("error"===e.status)crmui.showMsgBand("error",I18n.getMsg("crm.lookup.advance.error.msg"),5e3);else{e.body=e.body?e.body:[],e.body=e.body?store.pushPayload(this.data.modId,e.body):[],this.setData("record",e.body),this.setData("hasMoreRecords",!!e.hasMoreRecords&&e.hasMoreRecords),this.executeMethod("onDataLoaded");var t=e.body?e.body:[],r=!!e.hasMoreRecords&&e.hasMoreRecords;this.updateNavigators(t,r,o,a)}$L("#navigateBack, #navigateForward").removeClass("pEvents"),$L(".entityLookupTable .lyteTableScroll").resetScrollbar()}.bind(this),error:function(e){commonUtils.showHideLoadingDiv(!1),401===e.status&&(renderingUtils.displayPermissionDenied(),$("crm-entity-lookup")[0].component.setData("ltPropShow",!1)),$L("#navigateBack, #navigateForward").removeClass("pEvents")}})},validateSearchValue:function(e,t,o,a){if(this.errorLabel)return _cruxUtils.showCustomAlert({params:{ltPropSecondaryMessage:I18n.getValueForFields("crm.field.valid.check",this.errorLabel),ltPropWrapperClass:"lookupErrorMsg"}}),!1;if("string"==typeof e&&/[\uD800-\uDBFF][\uDC00-\uDFFF]+$/gi.test(e)){if(0===(e=e.replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/gi,"")).trim().length)return _cruxUtils.showCustomAlert({params:{ltPropSecondaryMessage:I18n.getValueForFields("crm.field.valid.check",t),ltPropWrapperClass:"lookupErrorMsg"}}),!1}else"string"==typeof e&&e.length&&(e=e.replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/gi,"").trim());return"date"===o&&!Utils.isValidDate("YYYY-MM-DD",e)||"datetime"===o&&!Utils.compareDateandTime(e[0],e[1])?(_cruxUtils.showCustomAlert({params:{ltPropSecondaryMessage:I18n.getValueForFields("crm.field.valid.check",t),ltPropWrapperClass:"lookupErrorMsg"}}),!1):"string"==typeof e&&/^[`~!@#$%^&*()\-_=+\\|\][{}'";:/?.,><]+$/.test(e)&&"date"!==o&&"datetime"!==o&&"picklist"!==o&&"double"!==o&&"currency"!==o?(_cruxUtils.showCustomAlert({params:{ltPropSecondaryMessage:I18n.getValueForFields("crm.field.valid.check",t),ltPropWrapperClass:"lookupErrorMsg"}}),!1):(this.errorLabel=void 0,!0)},showRelatedRecords:function(){this.relatedListMode=!1;var e=this.getData("relatedRecordData")[this.data.selectedRelatedRecordIndex];if(this.setData({searchDoMode:!1,currentPage:1,navigatedRec:0}),"multi"===e.id&&e.criteria)this.setData("relatedRecordCriteria",e.criteria);else if(this.data.lookupUrlForCampaign&&this.getData("lookupUrlForCampaign").length&&"all"!==e.id)this.relatedListMode=!0,this.selectedRecord=e.id;else if(e.id&&"all"!==e.id){var t="("+e.apiName+":equals:"+e.id+")";this.setData("relatedRecordCriteria",t)}else this.getData("criteria")?this.setData({relatedRecordCriteria:""}):this.setData({relatedRecordCriteria:"",criteria:""});this.renderPage()},closeColumnList:function(){this.setData("showColList",!1),this.isBigLookupTable()},pickListValidator:function(e,t,o){return!(o.length>19)||(crmui.showMsgBand("error",_cruxUtils.getI18n("crm.las.error.picklist.maxlimit"),3e3),!1)},lookupTableHeightCalc:function(){var e=renderingUtils.windowHeight,t=e/100*70-30;$L(this.$node).find(".entityLookupTable").css("max-height",e/2),setTimeout(function(){$L(".lookupLyteTable .cruxTableStructure").height()>=t?this.setData("scrollableTable",!0):this.setData("scrollableTable",!1)}.bind(this),1e3)},overRideFieldsForTable:function(){var e,t=this.getData("module"),o=!1;this.getData("cxPropFields")?(o=!0,e=this.getData("cxPropFields")):t.lookup_field_properties&&t.lookup_field_properties.fields&&(o=!0,e=t.lookup_field_properties.fields);var a=function(e,t){return e.filter(function(e){return e.id===t})[0]};let r=e.length;this.fieldsToBeDeleted=[];for(var i=0;i<r;i++){if(o){var s=a(this.data.availableFields,e[i].id);s||this.fieldsToBeDeleted.push({_delete:!0,api_name:e[i].api_name,id:e[i].id}),e[i]=s}if(e[i]){if(e[i].yieldName&&delete e[i].yieldName,e[i].id===t.display_field.id||"POTENTIAL_NAME"===e[i].column_name||"POTENTIALID"===e[i].column_name){if(e[i].yieldName="aTag",e[i].mandatoryColumn="true",e[i].id===t.display_field.id&&e[i].field_label){e[i].display_field=!0;var l={displayMsg:I18n.getMsg("crm.lookup.searchby.placeholder",e[i].field_label),apiName:e[i].api_name};if("Products"===this.data.module.api_name){for(var p of this.data.availableFields)if("Product_Code"===p.api_name&&(p.profiles&&p.profiles[0]&&"hidden"!==p.profiles[0].permission_type||p.visible)){this.isProductCodeAvailable=p;break}this.isProductCodeAvailable&&(l.displayMsg+=" / "+this.isProductCodeAvailable.field_label)}this.data.searchBarAttr.displayMsg!==l.displayMsg&&this.setData("searchBarAttr",l)}if(!o)break}"lookup"===e[i].data_type?e[i].yieldName="lookup":999===e[i].ui_type?e[i].yieldName="territory":"integer"!==e[i].data_type&&"bigint"!==e[i].data_type||(e[i].cxPropDecimalAllowed=!1),e[i].sortable||(e[i].cxPropClass="cursorDefault"),this.getData("lookupUitypeComparator").in.includes(e[i].ui_type)?(e[i].freeze=!0,8!==e[i].ui_type&&221!==e[i].ui_type&&20!==e[i].ui_type&&55!==e[i].ui_type&&e[i].ui_type!==CrmField.UITYPES.LAYOUT&&e[i].ui_type!==CrmField.UITYPES.WIZARD&&(e[i].noOverride=!0),e[i].ui_type===CrmField.UITYPES.LAYOUT||e[i].ui_type===CrmField.UITYPES.WIZARD||999===e[i].ui_type?e[i].type="multisearch":e[i].type="multiple",999===e[i].ui_type&&(e[i].cxTypeMapping="layout",e[i].modelReq="territory"),e[i].filterClass="preventWheel",e[i].maxLimit="20",e[i].disableExtraValue=!0):this.getData("lookupUitypeComparator").starts_with.includes(e[i].ui_type)?e[i].maxLength=200:this.getData("lookupUitypeComparator").equals.includes(e[i].ui_type)&&(e[i].maxLength=20),209===e[i].ui_type&&(e[i].tagWidth="90px")}else e.splice(i,1),i--,r--}this.setData("header",e),setTimeout(function(){this.isBigLookupTable()}.bind(this),210)},rollBackFilterComponent:function(){var e=this.$node.querySelector("crux-lookupfilter-component");if(e&&this.getData("showFilter")&&this.filterValueIds){for(var t,o=(e=e.component).getBackupFilter(this.data.header),a=o.length,r=0;r<a;r++)this.filterValueIds.includes(o[r].id)||(o.splice(r,1),r--,a--,t=!0);t&&(e.setData("getBackfilter",o),this.fromSearchBar=!0,e.$node.querySelector(".cxLookupClearFilter").click(),this.fromSearchBar=!1,e.displayFilter())}},lookupFilterQueryHandling(){var e=this.data.cxPropField;this.lookupFilterQueryDetails={},e&&e.lookup&&e.lookup.query_details&&(this.lookupFilterQueryDetails=e.lookup.query_details)},observeValue:function(){if(this.getData("cxPropValue"))try{this.setData("value",JSON.parse(this.getData("cxPropValue"))),this.setData("selectedSingle",this.getData("value").id)}catch(e){this.setData("value",this.data.cxPropValue),this.setData("selectedSingle",this.data.value.id)}}.observes("cxPropValue").on("init"),observeFieldsForApi:function(){this.setData("requiredFieldsForApi",[]);var e=this.getData("header");for(var t of(this.getData("cxPropAllFieldsNeeded")&&(e=this.getData("module").fields),e))this.data.requiredFieldsForApi.push(t.api_name);var o=this.getData("cxPropDefaultFields")&&this.getData("cxPropDefaultFields").api_names?this.getData("cxPropDefaultFields").api_names:[],a=this.getData("cxPropDefaultFields")&&this.getData("cxPropDefaultFields").id?this.getData("cxPropDefaultFields").id:[];if(Object.keys(a))for(var r of a){var i=store.peekRecord("field",r);i&&i.api_name&&(o.includes(i.api_name)||o.push(i.api_name))}if(Object.keys(o))for(var s of o)this.data.requiredFieldsForApi.includes(s)||this.data.requiredFieldsForApi.push(s);var l=this.getData("lookupFieldId")?this.getData("lookupFieldId"):this.data.cxPropField&&this.data.cxPropField.id?this.data.cxPropField.id:"";if(l){for(var p of this.data.fieldOfLookupVal)p.lookup_field.id==l&&(this.data.requiredFieldsForApi.includes(p.related_field.api_name)||this.data.requiredFieldsForApi.push(p.related_field.api_name));this.data.requiredFieldsForApi.includes("Currency")||this.data.requiredFieldsForApi.push("Currency")}}.observes("header"),flushDataofComponent:function(){delete this.relatedListMode,delete this.selectedRecord,this.setData({record:[],selectedRelatedRecordIndex:0,relatedRecordData:[],criteria:"",relatedRecordCriteria:"",searchBarCriteria:"",ltPropBindToBody:!1,selectedSingle:"",lookupUrlForCampaign:"",flushView:!1,fieldOfLookupVal:[],lookupSingle:""})}.observes("flushView")},{mixins:["crux-lookup-mixin"]}),Lyte.Component.register("crux-grouper-radio-component",{_template:'<template tag-name="crux-grouper-radio-component"> <template is="switch" value="{{cxPropFrom}}"><template case="view">{{cxPropValue}}</template><template case="create"> <template is="if" value="{{expHandlers(expHandlers(cxPropFrom,\'===\',&quot;create&quot;),\'&amp;&amp;\',cxPropField[cxPropFieldKey])}}"><template case="true"> <div class="cxElementLabel {{cxPropFieldLabelClass}}"> {{cxPropField[cxPropFieldKey]}} <template is="if" value="{{cxPropInfoTooltip}}"><template case="true"> <span class="dIB vam cxInfoIcon" onmouseenter="{{action(\'showInfoTooltip\',this)}}"></span> <lyte-hovercard lt-prop-placement="topLeft" lt-prop-keep-alive="true" lt-prop-popover-wrapper-class="cxElementsHovercard" lt-prop-origin-elem=".cxCurrentHovercard" on-hovercard-hide="{{method(\'hideInfoTooltip\')}}"> <template is="registerYield" yield-name="hoverCardYield"> <lyte-hovercard-content class="cxElementsHoverCardContent"> {{cxPropInfoTooltip}} </lyte-hovercard-content> </template> </lyte-hovercard> </template></template> </div> </template></template> <div class="cxElementValue {{if(ifEquals(cxPropDirection,\'vertical\'),\'cxGrouperVertical\',\'cxGrouperHorizontal\')}}"> <template is="for" items="{{cxPropOptions}}" item="item" index="index"> <lyte-radiobutton lt-prop-type="{{cxPropType}}" id="{{cxPropId}}" lt-prop-class="{{cxPropClass}}" class="radio_button" lt-prop-title="{{cxPropTooltip}}" lt-prop-tooltip-config="{&quot;position&quot;: &quot;followcursor&quot;, &quot;appearance&quot;: &quot;box&quot;}" lt-prop-tooltip-style="margin: 10px;" lt-prop-name="{{cxPropName}}" lt-prop-fire-on-init="{{cxPropFireOnInit}}" lt-prop-value="{{item[cxPropDisplayValue]}}" lt-prop-label="{{item[cxPropDisplayValue]}}" lt-prop-label-class="{{cxPropLabelClass}}" lt-prop-disabled="{{cxPropDisabled}}" data-zcqa="{{cxPropZcqa}}_{{item[cxPropDisplayValue]}}" on-changed="{{method(\'onRadioValueChanged\',item[cxPropDisplayValue])}}" on-before-checked="{{method(\'beforeCheckedRadio\',item[cxPropDisplayValue])}}" on-checked="{{method(\'onCheckedRadio\',item[cxPropDisplayValue])}}" on-before-unchecked="{{method(\'beforeUnchecked\',item[cxPropDisplayValue])}}" on-unchecked="{{method(\'onUncheckedRadio\',item[cxPropDisplayValue])}}"></lyte-radiobutton> </template><template is="if" value="{{isError}}"><template case="true"> <crux-error-message error-message="{{cxPropErrorMessage}}" cx-prop-error-yield="{{cxPropErrorYield}}" class="{{cxPropErrorClass}}"> <template is="registerYield" yield-name="errorYield"><lyte-yield yield-name="errorYield"></lyte-yield></template> </crux-error-message> </template></template> </div> </template></template> </template>',_dynamicNodes:[{type:"attr",position:[1]},{type:"switch",position:[1],cases:{view:{dynamicNodes:[{type:"text",position:[0]}]},create:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,1]},{type:"attr",position:[1,3]},{type:"if",position:[1,3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[3]},{type:"registerYield",position:[3,1],dynamicNodes:[{type:"text",position:[1,1]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[3]}]}},default:{}}]}},default:{}},{type:"attr",position:[3]},{type:"attr",position:[3,1]},{type:"for",position:[3,1],dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]},{type:"attr",position:[3,2]},{type:"if",position:[3,2],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"insertYield",position:[0]}]},{type:"componentDynamic",position:[1]}]}},default:{}}]}},default:{}}],_observedAttributes:["lyteViewPort","cxPropValue","cxPropFrom","cxPropField","cxPropOptions","cxPropDisabled","cxPropFieldKey","cxPropZcqa","cxPropId","cxPropName","cxPropType","cxPropErrorMessage","cxPropClass","cxPropLabelClass","cxPropFieldLabelClass","cxPropDisplayValue","selectedValue","isError","cxPropClearErrorMessage","cxPropErrorYield","cxPropEmptyValue","cxPropDirection","cxPropInfoTooltip","cxPropTooltip","selected","cxPropErrorClass"],data:function(){return{lyteViewPort:Lyte.attr("boolean",{default:!1}),cxPropValue:Lyte.attr("string"),cxPropFrom:Lyte.attr("string",{default:"view"}),cxPropField:Lyte.attr("object",{default:{}}),cxPropOptions:Lyte.attr("array"),cxPropDisabled:Lyte.attr("boolean",{default:!1}),cxPropFieldKey:Lyte.attr("string",{default:""}),cxPropZcqa:Lyte.attr("string",{default:""}),cxPropId:Lyte.attr("string",{default:""}),cxPropName:Lyte.attr("string",{default:""}),cxPropType:Lyte.attr("string",{default:"default"}),cxPropErrorMessage:Lyte.attr("string"),cxPropClass:Lyte.attr("string"),cxPropLabelClass:Lyte.attr("string"),cxPropFieldLabelClass:Lyte.attr("string",{default:""}),cxPropDisplayValue:Lyte.attr("string",{default:"display_label"}),selectedValue:Lyte.attr("string"),isError:Lyte.attr("boolean",{default:!1}),cxPropClearErrorMessage:Lyte.attr("boolean",{default:!0}),cxPropErrorYield:Lyte.attr("boolean",{default:!1}),cxPropEmptyValue:Lyte.attr("string"),cxPropDirection:Lyte.attr("string",{default:"horizontal"}),cxPropInfoTooltip:Lyte.attr("string",{default:""}),cxPropTooltip:Lyte.attr("string",{default:""}),selected:Lyte.attr("string"),cxPropErrorClass:Lyte.attr("string")}},init:function(){var e=this.getData("cxPropFrom");"view"==e&&!this.getData("cxPropValue")&&this.getData("cxPropEmptyValue")?this.setData("cxPropValue",this.getData("cxPropEmptyValue")):"create"===e&&this.getData("cxPropDisabled")&&this.setData("cxPropTooltip",_cruxUtils.getI18n("crm.lable.read.only"))},getValue:function(){return this.getData("selected")},validate:function(){return!(!this.getData("selected")&&this.getData("cxPropField").required)||(this.getMethods("onError")?this.executeMethod("onError",this.errorCodes.ERR01,this):(this.getData("cxPropErrorMessage")||this.setData("cxPropErrorMessage",_cruxUtils.getI18n("crm.field.valid.check",Lyte.Component.registeredHelpers.cruxEncodeHTML(_this.getData("cxPropField").field_label))),this.setData("isError",!0)),!1)},obsValue:function(){var e=this.getData("cxPropValue");if(e&&"create"===this.getData("cxPropFrom")){var t=this.$node.getElementsByClassName("radio_button");if(t[0])for(var o=0;o<t.length;o++){t[o].getAttribute("lt-prop-value")===e&&t[o].setAttribute("lt-prop-checked",!0)}}}.observes("cxPropValue","lyteViewPort").on("didConnect"),actions:{showInfoTooltip:function(e){this.showHideInfoTooltip(e)}},methods:{onRadioValueChanged:function(e,t,o){this.getMethods("onChanged")&&this.executeMethod("onChanged",e,t,o)},beforeCheckedRadio:function(e,t,o){this.getMethods("onBeforeChecked")&&this.executeMethod("onBeforeChecked",e,t,o)},onCheckedRadio:function(e,t,o){this.setData("selected",e),this.getData("cxPropClearErrorMessage")&&this.setData("isError",!1),this.getMethods("onChecked")&&this.executeMethod("onChecked",e,t,o)},beforeUnchecked:function(e,t,o){this.getMethods("onBeforeUnchecked")&&this.executeMethod("onBeforeUnchecked",e,t,o)},onUncheckedRadio:function(e,t,o){this.getMethods("onUnchecked")&&this.executeMethod("onUnchecked",e,t,o)},hideInfoTooltip:function(){this.showHideInfoTooltip()}}},{mixins:["crux-element-validation"]}),Lyte.Component.register("crux-grouper-checkbox-component",{_template:'<template tag-name="crux-grouper-checkbox-component"> <template is="switch" value="{{cxPropFrom}}"><template case="view">{{cxPropValue}}</template><template case="create"> <template is="if" value="{{expHandlers(expHandlers(cxPropFrom,\'===\',&quot;create&quot;),\'&amp;&amp;\',cxPropField[cxPropFieldKey])}}"><template case="true"> <div class="cxElementLabel {{cxPropFieldLabelClass}}"> {{cxPropField[cxPropFieldKey]}} <template is="if" value="{{cxPropInfoTooltip}}"><template case="true"> <span class="dIB vam cxInfoIcon" onmouseenter="{{action(\'showInfoTooltip\',this)}}"></span> <lyte-hovercard lt-prop-placement="topLeft" lt-prop-keep-alive="true" lt-prop-popover-wrapper-class="cxElementsHovercard" lt-prop-origin-elem=".cxCurrentHovercard" on-hovercard-hide="{{method(\'hideInfoTooltip\')}}"> <template is="registerYield" yield-name="hoverCardYield"> <lyte-hovercard-content class="cxElementsHoverCardContent"> {{cxPropInfoTooltip}} </lyte-hovercard-content> </template> </lyte-hovercard> </template></template> </div> </template></template> <div class="cxElementValue {{if(ifEquals(cxPropDirection,\'vertical\'),\'cxGrouperVertical\',\'cxGrouperHorizontal\')}}"> <template is="for" items="{{cxPropOptions}}" item="item" index="index"> <lyte-checkbox lt-prop-type="{{cxPropType}}" id="{{cxPropId}}" lt-prop-read-only="{{cxPropReadOnly}}" class="checkbox_input" lt-prop-class="{{cxPropClass}}" lt-prop-title="{{cxPropTooltip}}" lt-prop-tooltip-config="{&quot;position&quot;: &quot;followcursor&quot;, &quot;appearance&quot;: &quot;box&quot;}" lt-prop-tooltip-style="margin: 10px;" lt-prop-name="{{cxPropName}}" lt-prop-value="{{item[cxPropDisplayValue]}}" lt-prop-label="{{item[cxPropDisplayValue]}}" lt-prop-label-class="{{cxPropLabelClass}}" lt-prop-disabled="{{cxPropDisabled}}" data-zcqa="{{cxPropZcqa}}_{{item[cxPropDisplayValue]}}" on-changed="{{method(\'onCheckboxValueChanged\',item[cxPropDisplayValue])}}" on-before-checked="{{method(\'beforeCheckedCheckbox\',item[cxPropDisplayValue])}}" on-checked="{{method(\'onCheckedCheckbox\',item[cxPropDisplayValue])}}" on-before-unchecked="{{method(\'beforeUnchecked\',item[cxPropDisplayValue])}}" on-unchecked="{{method(\'onUncheckedCheckbox\',item[cxPropDisplayValue])}}"></lyte-checkbox> </template><template is="if" value="{{isError}}"><template case="true"> <crux-error-message error-message="{{cxPropErrorMessage}}" cx-prop-error-yield="{{cxPropErrorYield}}" class="{{cxPropErrorClass}}"> <template is="registerYield" yield-name="errorYield"><lyte-yield yield-name="errorYield"></lyte-yield></template> </crux-error-message> </template></template> </div> </template></template> </template>',_dynamicNodes:[{type:"attr",position:[1]},{type:"switch",position:[1],cases:{view:{dynamicNodes:[{type:"text",position:[0]}]},create:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,1]},{type:"attr",position:[1,3]},{type:"if",position:[1,3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[3]},{type:"registerYield",position:[3,1],dynamicNodes:[{type:"text",position:[1,1]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[3]}]}},default:{}}]}},default:{}},{type:"attr",position:[3]},{type:"attr",position:[3,1]},{type:"for",position:[3,1],dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]},{type:"attr",position:[3,2]},{type:"if",position:[3,2],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"insertYield",position:[0]}]},{type:"componentDynamic",position:[1]}]}},default:{}}]}},default:{}}],_observedAttributes:["lyteViewPort","cxPropValue","cxPropFrom","cxPropField","cxPropOptions","cxPropDisabled","cxPropFieldKey","cxPropZcqa","cxPropId","cxPropName","cxPropType","cxPropErrorMessage","cxPropClass","cxPropLabelClass","cxPropFieldLabelClass","cxPropDisplayValue","selectedValue","isError","cxPropClearErrorMessage","cxPropErrorYield","cxPropEmptyValue","cxPropDirection","cxPropInfoTooltip","cxPropTooltip","cxPropReadOnly","selected","cxPropErrorClass"],data:function(){return{lyteViewPort:Lyte.attr("boolean",{default:!1}),cxPropValue:Lyte.attr("string"),cxPropFrom:Lyte.attr("string",{default:"view"}),cxPropField:Lyte.attr("object",{default:{}}),cxPropOptions:Lyte.attr("array"),cxPropDisabled:Lyte.attr("boolean",{default:!1}),cxPropFieldKey:Lyte.attr("string",{default:""}),cxPropZcqa:Lyte.attr("string",{default:""}),cxPropId:Lyte.attr("string",{default:""}),cxPropName:Lyte.attr("string",{default:""}),cxPropType:Lyte.attr("string",{default:"default"}),cxPropErrorMessage:Lyte.attr("string"),cxPropClass:Lyte.attr("string"),cxPropLabelClass:Lyte.attr("string"),cxPropFieldLabelClass:Lyte.attr("string",{default:""}),cxPropDisplayValue:Lyte.attr("string",{default:"display_label"}),selectedValue:Lyte.attr("string"),isError:Lyte.attr("boolean",{default:!1}),cxPropClearErrorMessage:Lyte.attr("boolean",{default:!0}),cxPropErrorYield:Lyte.attr("boolean",{default:!1}),cxPropEmptyValue:Lyte.attr("string",{default:""}),cxPropDirection:Lyte.attr("string",{default:"horizontal"}),cxPropInfoTooltip:Lyte.attr("string",{default:""}),cxPropTooltip:Lyte.attr("string",{default:""}),cxPropReadOnly:Lyte.attr("boolean",{default:!1}),selected:Lyte.attr("string"),cxPropErrorClass:Lyte.attr("string")}},init:function(){var e=this.getData("cxPropFrom");"view"==(e=this.getData("cxPropFrom"))&&!this.getData("cxPropValue")&&this.getData("cxPropEmptyValue")?this.setData("cxPropValue",this.getData("cxPropEmptyValue")):"create"===e&&(this.getData("cxPropDisabled")||this.getData("cxPropReadOnly"))&&this.setData("cxPropTooltip",_cruxUtils.getI18n("crm.lable.read.only"))},getValue:function(){return this.getData("selected")},validate:function(){return!(!this.getData("selected")&&this.getData("cxPropField").required)||(this.getMethods("onError")?this.executeMethod("onError",this.errorCodes.ERR01,this):(this.getData("cxPropErrorMessage")||this.setData("cxPropErrorMessage",_cruxUtils.getI18n("crm.field.valid.check",Lyte.Component.registeredHelpers.cruxEncodeHTML(_this.getData("cxPropField").field_label))),this.setData("isError",!0)),!1)},obsValue:function(){var e=this.getData("cxPropValue");if(e&&"create"===this.getData("cxPropFrom")){var t=this.$node.getElementsByClassName("checkbox_input");if(t[0])for(var o=0;o<t.length;o++){t[o].getAttribute("lt-prop-value")===e&&t[o].setAttribute("lt-prop-checked",!0)}}}.observes("cxPropValue","lyteViewPort").on("didConnect"),actions:{showInfoTooltip:function(e){this.showHideInfoTooltip(e)}},methods:{onCheckboxValueChanged:function(e,t,o){this.getMethods("onValueChange")&&this.executeMethod("onValueChange",e,t,o)},beforeCheckedCheckbox:function(e,t,o){this.getMethods("onBeforeChecked")&&this.executeMethod("onBeforeChecked",e,t,o)},onCheckedCheckbox:function(e,t,o){this.setData("selected",e),this.getData("cxPropClearErrorMessage")&&this.setData("isError",!1),this.getMethods("onChecked")&&this.executeMethod("onChecked",e,t,o)},beforeUnchecked:function(e,t,o){this.getMethods("onBeforeUnchecked")&&this.executeMethod("onBeforeUnchecked",e,t,o)},onUncheckedCheckbox:function(e,t,o){this.getMethods("onUnchecked")&&this.executeMethod("onUnchecked",e,t,o)},hideInfoTooltip:function(){this.showHideInfoTooltip()}}},{mixins:["crux-element-validation"]}),Lyte.Component.register("crux-tag-popover",{_template:'<template tag-name="crux-tag-popover"> <lyte-popover lt-prop-origin-elem=".cxPropOnFocusTag .moreTagOption" class="moreTagOptionPopover" lt-prop-freeze="false" lt-prop-show-close-button="false" lt-prop-show="true" lt-prop-type="box" lt-prop-max-width="200" lt-prop-width="200" lt-prop-wrapper-class="nLvTagsMoreOptionhandle" lt-prop-duration="{{durationUndefined}}" on-close="{{method(\'closePopover\')}}"> <template is="registerYield" yield-name="popover"> <lyte-popover-content class="tagPopoverLab"> <div> <ul class="listview_taglists m0 dIB"> <template is="for" items="{{remainingValues}}" item="val" index="index"> <li class="pL0"> <span class="tagElementList f13 dIB cxAddedTags {{concat(\'cxTag\',cruxGetTagColorIndex(val.color_code))}}" style="background: {{if(ifEquals(val.color_code,\'noFill\'),\'transparent\',concat(val.color_code,\' !important;\'))}}; color : {{cruxGetPicklistFontColor(val.color_code)}}">{{val.name}}</span> </li> </template> </ul> </div> </lyte-popover-content> </template> </lyte-popover> </template>',_dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"attr",position:[1,1,1,1]},{type:"for",position:[1,1,1,1],dynamicNodes:[{type:"attr",position:[1,1],attr:{style:{name:"style",helperInfo:{name:"concat",args:["'background: '",{type:"helper",value:{name:"if",args:[{type:"helper",value:{name:"ifEquals",args:["val.color_code","'noFill'"]}},"'transparent'",{type:"helper",value:{name:"concat",args:["val.color_code","' !important;'"]}}]}},"'; color : '",{type:"helper",value:{name:"cruxGetPicklistFontColor",args:["val.color_code"]}}]}}}},{type:"text",position:[1,1,0]}]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1]}],_observedAttributes:["durationUndefined"],data:function(){return{durationUndefined:Lyte.attr("number",{default:void 0})}},actions:{showMoreTags:function(){clearTimeout(this.getData("cxParent").hideTimeout)},hideMoreTags:function(){this.getData("cxParent").hideTags()}},methods:{closePopover:function(){setTimeout(function(){document.querySelector(".cxPropOnFocusTag").classList.remove("cxPropOnFocusTag")},10)}}}),Lyte.Component.register("crux-lookup-view-popup",{_template:'<template tag-name="crux-lookup-view-popup"> <lyte-popover lt-prop-show="{{showPopover}}" lt-prop-freeze="false" lt-prop-show-close-button="false" lt-prop-origin-elem=".cxLookupBc" lt-prop-position="right" lt-prop-duration="{{undefinedNumber}}" lt-prop-content-padding="15px"> <template is="yield" yield-name="popover"> <lyte-popover-content> <div onmouseover="{{action(\'mouseOver\',true)}}" onmouseout="{{action(\'mouseOver\')}}"> <div class="cxLookupViewTopSection"> <template is="if" value="{{record.Record_Image}}"><template case="true"> <div id="imgContainer" class="emptyLCPhoto mR10 dIB vam" style="background-position: 0px 0px;"> <img style="border-radius: 50%; height: 48px;" src="{{cxPropRecordImageSrc}}"> </div> </template><template case="false"> <div id="imgContainer" class="cxLookupViewLetterCircle">{{cruxLookupGetFirstChar(record,fields[0].api_name,module)}}</div> </template></template> <div class="cxLookupViewTopContentWrap"> <div class="cxLookupViewTopHeading"> <template is="component" component-name="crux-{{fields[0].cxTypeMapping}}-component" cx-prop-value="{{cruxGetValue(record,fields[0].api_name)}}"></template> </div> <template is="if" value="{{expHandlers(fields[1].businesscard_supported,\'!\')}}"><template case="true"> <span class="cxLookupViewTopDesc"> <template is="if" value="{{expHandlers(fields[2].businesscard_supported,\'!\')}}"><template case="true"> <template is="component" component-name="crux-{{fields[1].cxTypeMapping}}-component" cx-prop-value="{{cruxGetValue(record,fields[1].api_name)}}"></template> - <template is="component" component-name="crux-{{fields[2].cxTypeMapping}}-component" cx-prop-value="{{cruxGetValue(record,fields[2].api_name)}}"></template> </template><template case="false"> <template is="component" component-name="crux-{{fields[1].cxTypeMapping}}-component" cx-prop-value="{{cruxGetValue(record,fields[1].api_name)}}"></template> </template></template> </span> </template></template> </div> </div> <div> <div class="cxDivTable cxLookupExtraDetailsTbl"> <template is="for" items="{{fields}}" item="field" index="index"> <template is="if" value="{{expHandlers(index,\'!=\',0)}}"><template case="true"> <template is="if" value="{{expHandlers(field.businesscard_supported,\'&amp;&amp;\',expHandlers(field.column_name,\'!=\',&quot;ISCALLBILLABLE&quot;))}}"><template case="true"> <div class="cxDivTr"> <div class="cxDivTd cxLookupViewLabel"> {{field.field_label}} </div> <div class="cxDivTd cxLookupViewValue"> <span class="dIB"> <template is="if" value="{{expHandlers(record[field.api_name],\'&amp;&amp;\',record[field.api_name].name)}}"><template case="true"> {{record[field.api_name].name}} </template><template case="false"> <template is="component" component-name="crux-{{field.cxTypeMapping}}-component" cx-prop-value="{{cruxGetValue(record,field.api_name)}}"></template> </template></template> </span> </div> </div> </template></template> </template></template> </template> </div> </div> </div> </lyte-popover-content> </template> </lyte-popover> </template>',_dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"attr",position:[1,1]},{type:"attr",position:[1,1,1,1]},{type:"if",position:[1,1,1,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1,1]}]},false:{dynamicNodes:[{type:"text",position:[1,0]}]}},default:{}},{type:"attr",position:[1,1,1,3,1,1]},{type:"component",position:[1,1,1,3,1,1],dynamicNodes:[]},{type:"attr",position:[1,1,1,3,3]},{type:"if",position:[1,1,1,3,3],cases:{true:{dynamicNodes:[{type:"attr",position:[1,1]},{type:"if",position:[1,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"component",position:[1],dynamicNodes:[]},{type:"attr",position:[3]},{type:"component",position:[3],dynamicNodes:[]}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"component",position:[1],dynamicNodes:[]}]}},default:{}}]}},default:{}},{type:"attr",position:[1,1,3,1,1]},{type:"for",position:[1,1,3,1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"text",position:[1,1,1]},{type:"attr",position:[1,3,1,1]},{type:"if",position:[1,3,1,1],cases:{true:{dynamicNodes:[{type:"text",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"component",position:[1],dynamicNodes:[]}]}},default:{}}]}},default:{}}]}},default:{}}]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[1]}],_observedAttributes:["show","entityId","fields","record","cxPropBasePath","module","showPopover","cxPropTypeMapping","cxPropRecordImageSrc","undefinedNumber"],data:function(){return{show:Lyte.attr("boolean",{default:!1}),entityId:Lyte.attr("string"),fields:Lyte.attr("array"),record:Lyte.attr("object"),cxPropBasePath:Lyte.attr("string",{default:"undefined"!=typeof Crm&&Crm.getBasePath?Crm.getBasePath():""}),module:Lyte.attr("string"),showPopover:Lyte.attr("boolean",{default:!1}),cxPropTypeMapping:Lyte.attr("object"),cxPropRecordImageSrc:Lyte.attr("string"),undefinedNumber:Lyte.attr("number",{default:void 0})}},observeShow:function(){if(1==this.data.show)if(this.data.entityId!=this._id){this._id=this.data.entityId;var e,t=this,o="undefined"!=typeof moduleApiMapping?moduleApiMapping:{},a="undefined"!=typeof moduleRecordMapping?moduleRecordMapping:{};this.data.module?(this.setData("module",o[this.data.module]),e=a[this.data.module].id):(this.setData("module",o[this.data.field.lookup.module.api_name]),e=this.data.field.lookup.module.id),this.getMethods("onLookupHoverFetchBcDataPopup")?this.executeMethod("onLookupHoverFetchBcDataPopup",e,t.data.entityId).then(function(e){this.setPopoverData(e.record,e.bcFields)}.bind(this)):store.modelFor(e)?t.fetchRecordData(e):store.findRecord("module",e).then(function(){t.fetchRecordData(e)})}else this.setData("showPopover",!0);else this.setData("showPopover",!1)}.observes("show").on("init"),actions:{mouseOver:function(e){e?(clearTimeout(this.popoverTimeout),clearTimeout(this.$node.closest("crux-lookup-component").component.popoverTimeout)):(clearTimeout(this.popoverTimeout),this.popoverTimeout=setTimeout(function(){this.setData("show",!1),this.$node.closest("crux-lookup-component").classList.remove("cxLookupBc")}.bind(this),100))}},fetchRecordData:function(e){var t=this;store.findRecord(e,t.data.entityId,{approved:"both",apply_fields:"business_card",include:"fields",fields:"Record_Image"},!1,!1).then(function(o){t.setPopoverData(o[e][0],o.fields)})},setPopoverData:function(e,t){for(var o=t,a=0;a<o.length;a++)this.data.cxPropTypeMapping&&this.data.cxPropTypeMapping[o[a].ui_type]?o[a].cxTypeMapping=this.data.cxPropTypeMapping[o[a].ui_type]:o[a].cxTypeMapping="text";this.setData("record",e),this.setData("fields",o),!this.data.cxPropRecordImageSrc&&e.Record_Image&&this.setData("cxPropRecordImageSrc",this.data.cxPropBasePath+"/EntityImageAttach.do?action_module="+this.data.module+"&entityId="+e.id+"&actionName=readImage&fileId="+e.Record_Image),this.setData("showPopover",!0)}}),Lyte.Component.registerHelper("cruxLookupGetFirstChar",function(e,t,o){var a=e[t];return"Leads"!=o&&"Contacts"!=o||(e.First_Name?a=e.First_Name:e.Last_Name&&(a=e.Last_Name)),a.charAt(0)}),Lyte.Component.registerHelper("cruxGetValue",function(e,t){return e&&t?e[t]:""}),Lyte.Component.register("crux-view-info-tooltip",{_template:'<template tag-name="crux-view-info-tooltip"> <i class="cxIconClassAnuja" lyte-hovercard="true" id="{{cxPropField.api_name}}_icon"></i> <lyte-hovercard lt-prop-origin-elem="#{{cxPropField.api_name}}_icon" lt-prop-auto-show="true"> <template is="yield" yield-name="hoverCardYield"> <lyte-hovercard-content> <lyte-yield yield-name="viewInfoTooltipYield" prop-field="{{cxPropField}}" prop-value="{{cxPropValue}}"></lyte-yield> </lyte-hovercard-content> </template> </lyte-hovercard> </template>',_dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[3]},{type:"registerYield",position:[3,1],dynamicNodes:[{type:"attr",position:[1,1]},{type:"insertYield",position:[1,1]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[3]}],data:function(){return{}},actions:{},methods:{}});
//# sourceMappingURL=crux-elements.js.b2421a4317284084039f677150ba347a.map