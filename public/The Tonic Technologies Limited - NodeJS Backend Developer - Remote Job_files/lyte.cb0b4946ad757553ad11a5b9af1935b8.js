if(function(e){"use strict";function t(){return p.createDocumentFragment()}function r(e){return p.createElement(e)}function o(e,t){if(!e)throw new Error("Failed to construct "+t+": 1 argument required, but only 0 present.")}function n(e){if(1===e.length)return i(e[0]);for(var r=t(),o=I.call(e),n=0;n<e.length;n++)r.appendChild(i(o[n]));return r}function i(e){return"string"==typeof e?p.createTextNode(e):e}for(var a,s,l,d,c,p=e.document,u=Object.prototype.hasOwnProperty,f=Object.defineProperty||function(e,t,r){return u.call(r,"value")?e[t]=r.value:(u.call(r,"get")&&e.__defineGetter__(t,r.get),u.call(r,"set")&&e.__defineSetter__(t,r.set)),e},h=[].indexOf||function(e){for(var t=this.length;t--&&this[t]!==e;);return t},y=function(e){var t=void 0===e.className,r=t?e.getAttribute("class")||"":e.className,o=t||"object"==typeof r,n=(o?t?r:r.baseVal:r).replace(_,"");n.length&&D.push.apply(this,n.split(g)),this._isSVG=o,this._=e},v={get:function(){return new y(this)},set:function(){}},m="dom4-tmp-".concat(Math.random()*+new Date).replace(".","-"),_=/^\s+|\s+$/g,g=/\s+/,b=function(e,t){return this.contains(e)?t||this.remove(e):(void 0===t||t)&&(t=!0,this.add(e)),!!t},L=e.DocumentFragment&&DocumentFragment.prototype,A=e.Node,$=(A||Element).prototype,E=e.CharacterData||A,T=E&&E.prototype,R=e.DocumentType,O=R&&R.prototype,w=(e.Element||A||e.HTMLElement).prototype,S=e.HTMLSelectElement||r("select").constructor,C=S.prototype.remove,P=e.ShadowRoot,k=e.SVGElement,N=/ /g,x=function(e){var t="querySelectorAll"===e;return function(r){var o,n,i,a,s,l,d=this.parentNode;if(d){for(a=(i=this.getAttribute("id")||m)===m?i:i.replace(N,"\\ "),l=r.split(","),n=0;n<l.length;n++)l[n]="#"+a+" "+l[n];r=l.join(",")}if(i===m&&this.setAttribute("id",i),s=(d||this)[e](r),i===m&&this.removeAttribute("id"),t)for(n=s.length,o=new Array(n);n--;)o[n]=s[n];else o=s;return o}},j=function(e){"query"in e||(e.query=w.query),"queryAll"in e||(e.queryAll=w.queryAll)},D=["matches",w.matchesSelector||w.webkitMatchesSelector||w.khtmlMatchesSelector||w.mozMatchesSelector||w.msMatchesSelector||w.oMatchesSelector||function(e){var t=this.parentNode;return!!t&&-1<h.call(t.querySelectorAll(e),this)},"closest",function(e){for(var t,r=this;(t=r&&r.matches)&&!r.matches(e);)r=r.parentNode;return t?r:null},"prepend",function(){var e=this.firstChild,t=n(arguments);e?this.insertBefore(t,e):this.appendChild(t)},"append",function(){this.appendChild(n(arguments))},"before",function(){var e=this.parentNode;e&&e.insertBefore(n(arguments),this)},"after",function(){var e=this.parentNode,t=this.nextSibling,r=n(arguments);e&&(t?e.insertBefore(r,t):e.appendChild(r))},"replace",function(){this.replaceWith.apply(this,arguments)},"replaceWith",function(){var e=this.parentNode;e&&e.replaceChild(n(arguments),this)},"remove",function(){var e=this.parentNode;e&&e.removeChild(this)},"query",x("querySelector"),"queryAll",x("querySelectorAll")],I=D.slice,B=D.length;B;B-=2)if((s=D[B-2])in w||(w[s]=D[B-1]),"remove"===s&&(S.prototype[s]=function(){return 0<arguments.length?C.apply(this,arguments):w.remove.call(this)}),/^(?:before|after|replace|replaceWith|remove)$/.test(s)&&(!E||s in T||(T[s]=D[B-1]),!R||s in O||(O[s]=D[B-1])),/^(?:append|prepend)$/.test(s))if(L)s in L||(L[s]=D[B-1]);else try{t().constructor.prototype[s]=D[B-1]}catch(e){}if(j(p),L)j(L);else try{j(t().constructor.prototype)}catch(e){}var M;P&&j(P.prototype),r("a").matches("a")||(w[s]=(M=w[s],function(e){return M.call(this.parentNode?this:t().appendChild(this),e)})),y.prototype={length:0,add:function(){for(var e,t=0;t<arguments.length;t++)e=arguments[t],this.contains(e)||D.push.call(this,s);this._isSVG?this._.setAttribute("class",""+this):this._.className=""+this},contains:function(e){return function(t){return-1<(B=e.call(this,s=function(e){if(!e)throw"SyntaxError";if(g.test(e))throw"InvalidCharacterError";return e}(t)))}}([].indexOf||function(e){for(B=this.length;B--&&this[B]!==e;);return B}),item:function(e){return this[e]||null},remove:function(){for(var e,t=0;t<arguments.length;t++)e=arguments[t],this.contains(e)&&D.splice.call(this,B,1);this._isSVG?this._.setAttribute("class",""+this):this._.className=""+this},toggle:b,toString:function(){return D.join.call(this," ")}},!k||"classList"in k.prototype||f(k.prototype,"classList",v),"classList"in p.documentElement?((d=r("div").classList).add("a","b","a"),"a b"!=d&&("add"in(l=d.constructor.prototype)||(l=e.TemporaryTokenList.prototype),c=function(e){return function(){for(var t=0;t<arguments.length;)e.call(this,arguments[t++])}},l.add=c(l.add),l.remove=c(l.remove),l.toggle=b)):f(w,"classList",v),"contains"in $||f($,"contains",{value:function(e){for(;e&&e!==this;)e=e.parentNode;return this===e}}),"head"in p||f(p,"head",{get:function(){return a||(a=p.getElementsByTagName("head")[0])}}),function(){for(var t,r=e.requestAnimationFrame,o=e.cancelAnimationFrame,n=["o","ms","moz","webkit"],i=n.length;!o&&i--;)r=r||e[n[i]+"RequestAnimationFrame"],o=e[n[i]+"CancelAnimationFrame"]||e[n[i]+"CancelRequestAnimationFrame"];o||(r?(t=r,r=function(e){var r=!0;return t((function(){r&&e.apply(this,arguments)})),function(){r=!1}},o=function(e){e()}):(r=function(e){return setTimeout(e,15,15)},o=function(e){clearTimeout(e)})),e.requestAnimationFrame=r,e.cancelAnimationFrame=o}();try{new e.CustomEvent("?")}catch(t){e.CustomEvent=function(e,t){function r(e,t,r,o){this.initEvent(e,t,r),this.detail=o}return function(o,n){var i=p.createEvent(e);if("string"!=typeof o)throw new Error("An event name must be provided");return"Event"==e&&(i.initCustomEvent=r),null==n&&(n=t),i.initCustomEvent(o,n.bubbles,n.cancelable,n.detail),i}}(e.CustomEvent?"CustomEvent":"Event",{bubbles:!1,cancelable:!1,detail:null})}try{new Event("_")}catch(t){if(t=function(e){function t(e,t){o(arguments.length,"Event");var r=p.createEvent("Event");return t||(t={}),r.initEvent(e,!!t.bubbles,!!t.cancelable),r}return t.prototype=e.prototype,t}(e.Event||function(){}),e.Event){var F=e.Event;Object.keys(F).forEach((function(e,r){t[e]=F[e]}))}f(e,"Event",{value:t}),Event!==t&&(Event=t)}try{new KeyboardEvent("_",{})}catch(t){t=function(t){var r,n=0,i={char:"",key:"",location:0,ctrlKey:!1,shiftKey:!1,altKey:!1,metaKey:!1,altGraphKey:!1,repeat:!1,locale:navigator.language,detail:0,bubbles:!1,cancelable:!1,keyCode:0,charCode:0,which:0};try{var a=p.createEvent("KeyboardEvent");a.initKeyboardEvent("keyup",!1,!1,e,"+",3,!0,!1,!0,!1,!1),n="+"==(a.keyIdentifier||a.key)&&3==(a.keyLocation||a.location)&&(a.ctrlKey?a.altKey?1:3:a.shiftKey?2:4)||9}catch(e){}function s(e,t,r){try{t[e]=r[e]}catch(e){}}function l(t,a){o(arguments.length,"KeyboardEvent"),a=function(e,t){for(var r in t)t.hasOwnProperty(r)&&!t.hasOwnProperty.call(e,r)&&(e[r]=t[r]);return e}(a||{},i);var l,d=p.createEvent(r),c=a.ctrlKey,u=a.shiftKey,f=a.altKey,h=a.metaKey,y=a.altGraphKey,v=n>3?function(e){for(var t=[],r=["ctrlKey","Control","shiftKey","Shift","altKey","Alt","metaKey","Meta","altGraphKey","AltGraph"],o=0;o<r.length;o+=2)e[r[o]]&&t.push(r[o+1]);return t.join(" ")}(a):null,m=String(a.key),_=String(a.char),g=a.location,b=a.keyCode||(a.keyCode=m)&&m.charCodeAt(0)||0,L=a.charCode||(a.charCode=_)&&_.charCodeAt(0)||0,A=a.bubbles,$=a.cancelable,E=a.repeat,T=a.locale,R=a.view||e;if(a.which||(a.which=a.keyCode),"initKeyEvent"in d)d.initKeyEvent(t,A,$,R,c,f,u,h,b,L);else if(0<n&&"initKeyboardEvent"in d){switch(l=[t,A,$,R],n){case 1:l.push(m,g,c,u,f,h,y);break;case 2:l.push(c,f,u,h,b,L);break;case 3:l.push(m,g,c,f,u,h,y);break;case 4:l.push(m,g,v,E,T);break;default:l.push(char,m,g,v,E,T)}d.initKeyboardEvent.apply(d,l)}else d.initEvent(t,A,$);for(m in d)i.hasOwnProperty(m)&&d[m]!==a[m]&&s(m,d,a);return d}return r=0<n?"KeyboardEvent":"Event",l.prototype=t.prototype,l}(e.KeyboardEvent||function(){}),f(e,"KeyboardEvent",{value:t}),KeyboardEvent!==t&&(KeyboardEvent=t)}try{new MouseEvent("_",{})}catch(t){t=function(t){function r(t,r){o(arguments.length,"MouseEvent");var n=p.createEvent("MouseEvent");return r||(r={}),n.initMouseEvent(t,!!r.bubbles,!!r.cancelable,r.view||e,r.detail||1,r.screenX||0,r.screenY||0,r.clientX||0,r.clientY||0,!!r.ctrlKey,!!r.altKey,!!r.shiftKey,!!r.metaKey,r.button||0,r.relatedTarget||null),n}return r.prototype=t.prototype,r}(e.MouseEvent||function(){}),f(e,"MouseEvent",{value:t}),MouseEvent!==t&&(MouseEvent=t)}}(window),function(e){function t(e,t){function r(e){if(!this||this.constructor!==r)return new r(e);this._keys=[],this._values=[],this._itp=[],this.objectOnly=t,e&&function(e){this.add?e.forEach(this.add,this):e.forEach((function(e){this.set(e[0],e[1])}),this)}.call(this,e)}return t||y(e,"size",{get:u}),e.constructor=r,r.prototype=e,r}function r(e){return this.has(e)&&(this._keys.splice(h,1),this._values.splice(h,1),this._itp.forEach((function(e){h<e[0]&&e[0]--}))),-1<h}function o(e){return this.has(e)?this._values[h]:void 0}function n(e,t){if(this.objectOnly&&t!==Object(t))throw new TypeError("Invalid value used as weak collection key");if(t!=t||0===t)for(h=e.length;h--&&!v(e[h],t););else h=e.indexOf(t);return-1<h}function i(e){return n.call(this,this._values,e)}function a(e){return n.call(this,this._keys,e)}function s(e,t){return this.has(e)?this._values[h]=t:this._values[this._keys.push(e)-1]=t,this}function l(e){return this.has(e)||this._values.push(e),this}function d(){(this._keys||0).length=this._values.length=0}function c(){return p(this._itp,this._values)}function p(e,t,r){var o=[0],n=!1;return e.push(o),{next:function(){var i,a=o[0];return!n&&a<t.length?(i=r?[t[a],r[a]]:t[a],o[0]++):(n=!0,e.splice(e.indexOf(o),1)),{done:n,value:i}}}}function u(){return this._values.length}function f(e,t){for(var r=this.entries();;){var o=r.next();if(o.done)break;e.call(t,o.value[1],o.value[0],this)}}var h,y=Object.defineProperty,v=function(e,t){return isNaN(e)?isNaN(t):e===t};"undefined"==typeof WeakMap&&(e.WeakMap=t({delete:r,clear:d,get:o,has:a,set:s},!0)),"undefined"!=typeof Map&&"function"==typeof(new Map).values&&(new Map).values().next||(e.Map=t({delete:r,has:a,get:o,set:s,keys:function(){return p(this._itp,this._keys)},values:c,entries:function(){return p(this._itp,this._keys,this._values)},forEach:f,clear:d})),"undefined"!=typeof Set&&"function"==typeof(new Set).values&&(new Set).values().next||(e.Set=t({has:i,add:l,delete:r,clear:d,keys:c,values:c,entries:function(){return p(this._itp,this._values,this._values)},forEach:f})),"undefined"==typeof WeakSet&&(e.WeakSet=t({delete:r,add:l,clear:d,has:i},!0))}("undefined"!=typeof exports&&"undefined"!=typeof global?global:window),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.ES6Promise=t()}(this,(function(){"use strict";function e(e){return"function"==typeof e}function t(){var e=setTimeout;return function(){return e(r,1)}}function r(){for(var e=0;e<b;e+=2)(0,S[e])(S[e+1]),S[e]=void 0,S[e+1]=void 0;b=0}function o(e,t){var r=arguments,o=this,n=new this.constructor(i);void 0===n[P]&&v(n);var a=o._state;return a?function(){var e=r[a-1];$((function(){return y(a,n,e,o._result)}))}():u(o,n,e,t),n}function n(e){if(e&&"object"==typeof e&&e.constructor===this)return e;var t=new this(i);return l(t,e),t}function i(){}function a(e){try{return e.then}catch(e){return j.error=e,j}}function s(t,r,i){r.constructor===t.constructor&&i===o&&r.constructor.resolve===n?function(e,t){t._state===N?c(e,t._result):t._state===x?p(e,t._result):u(t,void 0,(function(t){return l(e,t)}),(function(t){return p(e,t)}))}(t,r):i===j?(p(t,j.error),j.error=null):void 0===i?c(t,r):e(i)?function(e,t,r){$((function(e){var o=!1,n=function(e,t,r,o){try{e.call(t,r,o)}catch(e){return e}}(r,t,(function(r){o||(o=!0,t!==r?l(e,r):c(e,r))}),(function(t){o||(o=!0,p(e,t))}),e._label);!o&&n&&(o=!0,p(e,n))}),e)}(t,r,i):c(t,r)}function l(e,t){e===t?p(e,new TypeError("You cannot resolve a promise with itself")):function(e){var t=typeof e;return null!==e&&("object"===t||"function"===t)}(t)?s(e,t,a(t)):c(e,t)}function d(e){e._onerror&&e._onerror(e._result),f(e)}function c(e,t){e._state===k&&(e._result=t,e._state=N,0!==e._subscribers.length&&$(f,e))}function p(e,t){e._state===k&&(e._state=x,e._result=t,$(d,e))}function u(e,t,r,o){var n=e._subscribers,i=n.length;e._onerror=null,n[i]=t,n[i+N]=r,n[i+x]=o,0===i&&e._state&&$(f,e)}function f(e){var t=e._subscribers,r=e._state;if(0!==t.length){for(var o=void 0,n=void 0,i=e._result,a=0;a<t.length;a+=3)o=t[a],n=t[a+r],o?y(r,o,n,i):n(i);e._subscribers.length=0}}function h(){this.error=null}function y(t,r,o,n){var i=e(o),a=void 0,s=void 0,d=void 0,u=void 0;if(i){if((a=function(e,t){try{return e(t)}catch(e){return D.error=e,D}}(o,n))===D?(u=!0,s=a.error,a.error=null):d=!0,r===a)return void p(r,new TypeError("A promises callback cannot return that same promise."))}else a=n,d=!0;r._state!==k||(i&&d?l(r,a):u?p(r,s):t===N?c(r,a):t===x&&p(r,a))}function v(e){e[P]=I++,e._state=void 0,e._result=void 0,e._subscribers=[]}function m(e,t){this._instanceConstructor=e,this.promise=new e(i),this.promise[P]||v(this.promise),g(t)?(this.length=t.length,this._remaining=t.length,this._result=new Array(this.length),0===this.length?c(this.promise,this._result):(this.length=this.length||0,this._enumerate(t),0===this._remaining&&c(this.promise,this._result))):p(this.promise,new Error("Array Methods must be provided an Array"))}function _(e){this[P]=I++,this._result=this._state=void 0,this._subscribers=[],i!==e&&("function"!=typeof e&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof _?function(e,t){try{t((function(t){l(e,t)}),(function(t){p(e,t)}))}catch(t){p(e,t)}}(this,e):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}var g=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},b=0,L=void 0,A=void 0,$=function(e,t){S[b]=e,S[b+1]=t,2===(b+=2)&&(A?A(r):C())},E="undefined"!=typeof window?window:void 0,T=E||{},R=T.MutationObserver||T.WebKitMutationObserver,O="undefined"==typeof self&&"undefined"!=typeof process&&"[object process]"==={}.toString.call(process),w="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,S=new Array(1e3),C=void 0;C=O?function(){return process.nextTick(r)}:R?function(){var e=0,t=new R(r),o=document.createTextNode("");return t.observe(o,{characterData:!0}),function(){o.data=e=++e%2}}():w?function(){var e=new MessageChannel;return e.port1.onmessage=r,function(){return e.port2.postMessage(0)}}():void 0===E&&"function"==typeof require?function(){try{var e=require("vertx");return void 0!==(L=e.runOnLoop||e.runOnContext)?function(){L(r)}:t()}catch(e){return t()}}():t();var P=Math.random().toString(36).substring(16),k=void 0,N=1,x=2,j=new h,D=new h,I=0;return m.prototype._enumerate=function(e){for(var t=0;this._state===k&&t<e.length;t++)this._eachEntry(e[t],t)},m.prototype._eachEntry=function(e,t){var r=this._instanceConstructor,l=r.resolve;if(l===n){var d=a(e);if(d===o&&e._state!==k)this._settledAt(e._state,t,e._result);else if("function"!=typeof d)this._remaining--,this._result[t]=e;else if(r===_){var c=new r(i);s(c,e,d),this._willSettleAt(c,t)}else this._willSettleAt(new r((function(t){return t(e)})),t)}else this._willSettleAt(l(e),t)},m.prototype._settledAt=function(e,t,r){var o=this.promise;o._state===k&&(this._remaining--,e===x?p(o,r):this._result[t]=r),0===this._remaining&&c(o,this._result)},m.prototype._willSettleAt=function(e,t){var r=this;u(e,void 0,(function(e){return r._settledAt(N,t,e)}),(function(e){return r._settledAt(x,t,e)}))},_.all=function(e){return new m(this,e).promise},_.race=function(e){var t=this;return new t(g(e)?function(r,o){for(var n=e.length,i=0;i<n;i++)t.resolve(e[i]).then(r,o)}:function(e,t){return t(new TypeError("You must pass an array to race."))})},_.resolve=n,_.reject=function(e){var t=new this(i);return p(t,e),t},_._setScheduler=function(e){A=e},_._setAsap=function(e){$=e},_._asap=$,_.prototype={constructor:_,then:o,catch:function(e){return this.then(null,e)}},_.polyfill=function(){var e=void 0;if("undefined"!=typeof global)e=global;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise;if(t){var r=null;try{r=Object.prototype.toString.call(t.resolve())}catch(e){}if("[object Promise]"===r&&!t.cast)return}e.Promise=_},_.Promise=_,_})),void 0===window.Promise&&(window.Promise=window.ES6Promise),function(e){"use strict";var t;if((t=document.createEvent("Event")).initEvent("foo",!0,!0),t.preventDefault(),!t.defaultPrevented){var r=Event.prototype.preventDefault;Event.prototype.preventDefault=function(){this.cancelable&&(r.call(this),Object.defineProperty(this,"defaultPrevented",{get:function(){return!0},configurable:!0}))}}var o=/Trident/.test(navigator.userAgent);if((!window.CustomEvent||o&&"function"!=typeof window.CustomEvent)&&(window.CustomEvent=function(e,t){t=t||{};var r=document.createEvent("CustomEvent");return r.initCustomEvent(e,Boolean(t.bubbles),Boolean(t.cancelable),t.detail),r},window.CustomEvent.prototype=window.Event.prototype),!window.Event||o&&"function"!=typeof window.Event){var n=window.Event;if(window.Event=function(e,t){t=t||{};var r=document.createEvent("Event");return r.initEvent(e,Boolean(t.bubbles),Boolean(t.cancelable)),r},n)for(var i in n)window.Event[i]=n[i];window.Event.prototype=n.prototype}if(!window.MouseEvent||o&&"function"!=typeof window.MouseEvent){var a=window.MouseEvent;if(window.MouseEvent=function(e,t){t=t||{};var r=document.createEvent("MouseEvent");return r.initMouseEvent(e,Boolean(t.bubbles),Boolean(t.cancelable),t.view||window,t.detail,t.screenX,t.screenY,t.clientX,t.clientY,t.ctrlKey,t.altKey,t.shiftKey,t.metaKey,t.button,t.relatedTarget),r},a)for(var i in a)window.MouseEvent[i]=a[i];window.MouseEvent.prototype=a.prototype}if(Array.from||(Array.from=function(e){return[].slice.call(e)}),!Object.assign){var s=function(e,t){for(var r,o=Object.keys(t),n=0;n<o.length;n++)e[r=o[n]]=t[r]};Object.assign=function(e,t){for(var r,o=[].slice.call(arguments,1),n=0;n<o.length;n++)(r=o[n])&&s(e,r);return e}}}(window.WebComponents),function(){var e="undefined"==typeof HTMLTemplateElement;/Trident/.test(navigator.userAgent)&&function(){var e=Document.prototype.importNode;Document.prototype.importNode=function(){var t=e.apply(this,arguments);if(t.nodeType===Node.DOCUMENT_FRAGMENT_NODE){var r=this.createDocumentFragment();return r.appendChild(t),r}return t}}();var t=Node.prototype.cloneNode,r=Document.prototype.createElement,o=Document.prototype.importNode,n=function(){if(!e){var t=document.createElement("template"),r=document.createElement("template");r.content.appendChild(document.createElement("div")),t.content.appendChild(r);var o=t.cloneNode(!0);return 0===o.content.childNodes.length||0===o.content.firstChild.content.childNodes.length||!(document.createDocumentFragment().cloneNode()instanceof DocumentFragment)}}(),i=function(){};if(e){var a=document.implementation.createHTMLDocument("template"),s=!0,l=document.createElement("style");l.textContent="template{display:none;}";var d=document.head;d.insertBefore(l,d.firstElementChild),i.prototype=Object.create(HTMLElement.prototype);var c=!document.createElement("div").hasOwnProperty("innerHTML");function p(e){Object.defineProperty(e,"innerHTML",{get:function(){for(var e="",t=this.content.firstChild;t;t=t.nextSibling)e+=t.outerHTML||t.data.replace(u,f);return e},set:function(e){for(a.body.innerHTML=e,i.bootstrap(a);this.content.firstChild;)this.content.removeChild(this.content.firstChild);for(;a.body.firstChild;)this.content.appendChild(a.body.firstChild)},configurable:!0})}i.decorate=function(e){if(!e.content){var t;for(e.content=a.createDocumentFragment();t=e.firstChild;)e.content.appendChild(t);if(c)e.__proto__=i.prototype;else if(e.cloneNode=function(e){return i._cloneNode(this,e)},s)try{p(e)}catch(e){s=!1}i.bootstrap(e.content)}},p(i.prototype),i.bootstrap=function(e){for(var t,r=e.querySelectorAll("template"),o=0,n=r.length;o<n&&(t=r[o]);o++)i.decorate(t)},document.addEventListener("DOMContentLoaded",(function(){i.bootstrap(document)})),Document.prototype.createElement=function(){"use strict";var e=r.apply(this,arguments);return"template"===e.localName&&i.decorate(e),e};var u=/[&\u00A0<>]/g;function f(e){switch(e){case"&":return"&amp;";case"<":return"&lt;";case">":return"&gt;";case"Â ":return"&nbsp;"}}}(e||n)&&(i._cloneNode=function(e,r){var o=t.call(e,!1);return this.decorate&&this.decorate(o),r&&(o.content.appendChild(t.call(e.content,!0)),this.fixClonedDom(o.content,e.content)),o},i.prototype.cloneNode=function(e){return i._cloneNode(this,e)},i.fixClonedDom=function(e,t){if(t.querySelectorAll)for(var r,o,n=t.querySelectorAll("template"),i=e.querySelectorAll("template"),a=0,s=i.length;a<s;a++)o=n[a],r=i[a],this.decorate&&this.decorate(o),r.parentNode.replaceChild(o.cloneNode(!0),r)},Node.prototype.cloneNode=function(e){var r;if(this instanceof DocumentFragment){if(!e)return this.ownerDocument.createDocumentFragment();r=this.ownerDocument.importNode(this,!0)}else r=t.call(this,e);return e&&i.fixClonedDom(r,this),r},Document.prototype.importNode=function(e,t){if("template"===e.localName)return i._cloneNode(e,t);var r=o.call(this,e,t);return t&&i.fixClonedDom(r,e),r},n&&(window.HTMLTemplateElement.prototype.cloneNode=function(e){return i._cloneNode(this,e)})),e&&(window.HTMLTemplateElement=i)}(),function(){"use strict";var e=new function(){},t=new Set("annotation-xml color-profile font-face font-face-src font-face-uri font-face-format font-face-name missing-glyph".split(" "));function r(e){var r=t.has(e);return e=/^[a-z][.0-9_a-z]*-[\-.0-9_a-z]*$/.test(e),!r&&e}function o(e){var t=e.isConnected;if(void 0!==t)return t;for(;e&&!(e.__CE_isImportDocument||e instanceof Document);)e=e.parentNode||(window.ShadowRoot&&e instanceof ShadowRoot?e.host:void 0);return!(!e||!(e.__CE_isImportDocument||e instanceof Document))}function n(e,t){for(;t&&t!==e&&!t.nextSibling;)t=t.parentNode;return t&&t!==e?t.nextSibling:null}function i(e,t,r){r=r||new Set;for(var o=e;o;){if(o.nodeType===Node.ELEMENT_NODE){var a=o;t(a);var s=a.localName;if("link"===s&&"import"===a.getAttribute("rel")){if((o=a.import)instanceof Node&&!r.has(o))for(r.add(o),o=o.firstChild;o;o=o.nextSibling)i(o,t,r);o=n(e,a);continue}if("template"===s){o=n(e,a);continue}if(a=a.__CE_shadowRoot)for(a=a.firstChild;a;a=a.nextSibling)i(a,t,r)}o=o.firstChild?o.firstChild:n(e,o)}}function a(e,t,r){e[t]=r}function s(){this.a=new Map,this.o=new Map,this.f=[],this.b=!1}function l(e,t){e.b=!0,e.f.push(t)}function d(e,t){e.b&&i(t,(function(t){return c(e,t)}))}function c(e,t){if(e.b&&!t.__CE_patched){t.__CE_patched=!0;for(var r=0;r<e.f.length;r++)e.f[r](t)}}function p(e,t){var r=[];for(i(t,(function(e){return r.push(e)})),t=0;t<r.length;t++){var o=r[t];1===o.__CE_state?e.connectedCallback(o):h(e,o)}}function u(e,t){var r=[];for(i(t,(function(e){return r.push(e)})),t=0;t<r.length;t++){var o=r[t];1===o.__CE_state&&e.disconnectedCallback(o)}}function f(e,t,r){var o=(r=r||{}).w||new Set,n=r.s||function(t){return h(e,t)},a=[];if(i(t,(function(t){if("link"===t.localName&&"import"===t.getAttribute("rel")){var r=t.import;r instanceof Node&&(r.__CE_isImportDocument=!0,r.__CE_hasRegistry=!0),r&&"complete"===r.readyState?r.__CE_documentLoadHandled=!0:t.addEventListener("load",(function(){var r=t.import;if(!r.__CE_documentLoadHandled){r.__CE_documentLoadHandled=!0;var i=new Set(o);i.delete(r),f(e,r,{w:i,s:n})}}))}else a.push(t)}),o),e.b)for(t=0;t<a.length;t++)c(e,a[t]);for(t=0;t<a.length;t++)n(a[t])}function h(e,t){if(void 0===t.__CE_state){var r=t.ownerDocument;if((r.defaultView||r.__CE_isImportDocument&&r.__CE_hasRegistry)&&(r=e.a.get(t.localName))){r.constructionStack.push(t);var n=r.constructor;try{try{if(new n!==t)throw Error("The custom element constructor did not produce the element being upgraded.")}finally{r.constructionStack.pop()}}catch(e){throw t.__CE_state=2,e}if(t.__CE_state=1,t.__CE_definition=r,r.attributeChangedCallback)for(r=r.observedAttributes,n=0;n<r.length;n++){var i=r[n],a=t.getAttribute(i);null!==a&&e.attributeChangedCallback(t,i,null,a,null)}o(t)&&e.connectedCallback(t)}}}function y(e,t){this.c=e,this.a=t,this.b=void 0,f(this.c,this.a),"loading"===this.a.readyState&&(this.b=new MutationObserver(this.f.bind(this)),this.b.observe(this.a,{childList:!0,subtree:!0}))}function v(e){e.b&&e.b.disconnect()}function m(){var e=this;this.b=this.a=void 0,this.f=new Promise((function(t){e.b=t,e.a&&t(e.a)}))}function _(e){if(e.a)throw Error("Already resolved.");e.a=void 0,e.b&&e.b(void 0)}function g(e){this.i=!1,this.c=e,this.m=new Map,this.j=function(e){return e()},this.g=!1,this.l=[],this.u=new y(e,document)}s.prototype.connectedCallback=function(e){var t=e.__CE_definition;t.connectedCallback&&t.connectedCallback.call(e)},s.prototype.disconnectedCallback=function(e){var t=e.__CE_definition;t.disconnectedCallback&&t.disconnectedCallback.call(e)},s.prototype.attributeChangedCallback=function(e,t,r,o,n){var i=e.__CE_definition;i.attributeChangedCallback&&-1<i.observedAttributes.indexOf(t)&&i.attributeChangedCallback.call(e,t,r,o,n)},y.prototype.f=function(e){var t=this.a.readyState;for("interactive"!==t&&"complete"!==t||v(this),t=0;t<e.length;t++)for(var r=e[t].addedNodes,o=0;o<r.length;o++)f(this.c,r[o])},g.prototype.define=function(e,t){var o,n,i,a,s,l=this;if(!(t instanceof Function))throw new TypeError("Custom element constructors must be functions.");if(!r(e))throw new SyntaxError("The element name '"+e+"' is not valid.");if(this.c.a.get(e))throw Error("A custom element with name '"+e+"' has already been defined.");if(this.i)throw Error("A custom element is already being defined.");this.i=!0;try{var d=function(e){var t=c[e];if(void 0!==t&&!(t instanceof Function))throw Error("The '"+e+"' callback must be a function.");return t},c=t.prototype;if(!(c instanceof Object))throw new TypeError("The custom element constructor's prototype is not an object.");o=d("connectedCallback"),n=d("disconnectedCallback"),i=d("adoptedCallback"),a=d("attributeChangedCallback"),s=t.observedAttributes||[]}catch(e){return}finally{this.i=!1}t={localName:e,constructor:t,connectedCallback:o,disconnectedCallback:n,adoptedCallback:i,attributeChangedCallback:a,observedAttributes:s,constructionStack:[]},function(e,t,r){e.a.set(t,r),e.o.set(r.constructor,r)}(this.c,e,t),this.l.push(t),this.g||(this.g=!0,this.j((function(){return function(e){if(!1!==e.g){e.g=!1;for(var t=e.l,r=[],o=new Map,n=0;n<t.length;n++)o.set(t[n].localName,[]);for(f(e.c,document,{s:function(t){if(void 0===t.__CE_state){var n=t.localName,i=o.get(n);i?i.push(t):e.c.a.get(n)&&r.push(t)}}}),n=0;n<r.length;n++)h(e.c,r[n]);for(;0<t.length;){n=(i=t.shift()).localName;for(var i=o.get(i.localName),a=0;a<i.length;a++)h(e.c,i[a]);(n=e.m.get(n))&&_(n)}}}(l)})))},g.prototype.get=function(e){if(e=this.c.a.get(e))return e.constructor},g.prototype.whenDefined=function(e){if(!r(e))return Promise.reject(new SyntaxError("'"+e+"' is not a valid custom element name."));var t=this.m.get(e);return t||(t=new m,this.m.set(e,t),this.c.a.get(e)&&!this.l.some((function(t){return t.localName===e}))&&_(t)),t.f},g.prototype.v=function(e){v(this.u);var t=this.j;this.j=function(r){return e((function(){return t(r)}))}},window.CustomElementRegistry=g,g.prototype.define=g.prototype.define,g.prototype.get=g.prototype.get,g.prototype.whenDefined=g.prototype.whenDefined,g.prototype.polyfillWrapFlushCallback=g.prototype.v;var b=window.Document.prototype.createElement,L=window.Document.prototype.createElementNS,A=window.Document.prototype.importNode,$=window.Document.prototype.prepend,E=window.Document.prototype.append,T=window.DocumentFragment.prototype.prepend,R=window.DocumentFragment.prototype.append,O=window.Node.prototype.cloneNode,w=window.Node.prototype.appendChild,S=window.Node.prototype.insertBefore,C=window.Node.prototype.removeChild,P=window.Node.prototype.replaceChild,k=Object.getOwnPropertyDescriptor(window.Node.prototype,"textContent"),N=window.Element.prototype.attachShadow,x=Object.getOwnPropertyDescriptor(window.Element.prototype,"innerHTML"),j=window.Element.prototype.getAttribute,D=window.Element.prototype.setAttribute,I=window.Element.prototype.removeAttribute,B=window.Element.prototype.getAttributeNS,M=window.Element.prototype.setAttributeNS,F=window.Element.prototype.removeAttributeNS,K=window.Element.prototype.insertAdjacentElement,H=window.Element.prototype.prepend,q=window.Element.prototype.append,U=window.Element.prototype.before,z=window.Element.prototype.after,V=window.Element.prototype.replaceWith,G=window.Element.prototype.remove,W=window.HTMLElement,J=Object.getOwnPropertyDescriptor(window.HTMLElement.prototype,"innerHTML"),Y=window.HTMLElement.prototype.insertAdjacentElement;function Q(e,t,r){function n(t){return function(r){for(var n=[],i=0;i<arguments.length;++i)n[i-0]=arguments[i];i=[];for(var a=[],s=0;s<n.length;s++){var l=n[s];if(l instanceof Element&&o(l)&&a.push(l),l instanceof DocumentFragment)for(l=l.firstChild;l;l=l.nextSibling)i.push(l);else i.push(l)}for(t.apply(this,n),n=0;n<a.length;n++)u(e,a[n]);if(o(this))for(n=0;n<i.length;n++)(a=i[n])instanceof Element&&p(e,a)}}r.h&&(t.prepend=n(r.h)),r.append&&(t.append=n(r.append))}var X,Z=window.customElements;if(!Z||Z.forcePolyfill||"function"!=typeof Z.define||"function"!=typeof Z.get){var ee=new s;X=ee,window.HTMLElement=function(){function t(){var t=this.constructor;if(!(o=X.o.get(t)))throw Error("The custom element being constructed was not registered with `customElements`.");var r=o.constructionStack;if(!r.length)return r=b.call(document,o.localName),Object.setPrototypeOf(r,t.prototype),r.__CE_state=1,r.__CE_definition=o,c(X,r),r;var o,n=r[o=r.length-1];if(n===e)throw Error("The HTMLElement constructor was either called reentrantly for this constructor or called multiple times.");return r[o]=e,Object.setPrototypeOf(n,t.prototype),c(X,n),n}return t.prototype=W.prototype,t}(),function(){var e=ee;a(Document.prototype,"createElement",(function(t){if(this.__CE_hasRegistry){var r=e.a.get(t);if(r)return new r.constructor}return t=b.call(this,t),c(e,t),t})),a(Document.prototype,"importNode",(function(t,r){return t=A.call(this,t,r),this.__CE_hasRegistry?f(e,t):d(e,t),t})),a(Document.prototype,"createElementNS",(function(t,r){if(this.__CE_hasRegistry&&(null===t||"http://www.w3.org/1999/xhtml"===t)){var o=e.a.get(r);if(o)return new o.constructor}return t=L.call(this,t,r),c(e,t),t})),Q(e,Document.prototype,{h:$,append:E})}(),Q(ee,DocumentFragment.prototype,{h:T,append:R}),function(){var e=ee;function t(t,r){Object.defineProperty(t,"textContent",{enumerable:r.enumerable,configurable:!0,get:r.get,set:function(t){if(this.nodeType===Node.TEXT_NODE)r.set.call(this,t);else{var n=void 0;if(this.firstChild){var i=this.childNodes,a=i.length;if(0<a&&o(this)){n=Array(a);for(var s=0;s<a;s++)n[s]=i[s]}}if(r.set.call(this,t),n)for(t=0;t<n.length;t++)u(e,n[t])}}})}a(Node.prototype,"insertBefore",(function(t,r){if(t instanceof DocumentFragment){var n=Array.prototype.slice.apply(t.childNodes);if(t=S.call(this,t,r),o(this))for(r=0;r<n.length;r++)p(e,n[r]);return t}return n=o(t),r=S.call(this,t,r),n&&u(e,t),o(this)&&p(e,t),r})),a(Node.prototype,"appendChild",(function(t){if(t instanceof DocumentFragment){var r=Array.prototype.slice.apply(t.childNodes);if(t=w.call(this,t),o(this))for(var n=0;n<r.length;n++)p(e,r[n]);return t}return r=o(t),n=w.call(this,t),r&&u(e,t),o(this)&&p(e,t),n})),a(Node.prototype,"cloneNode",(function(t,r){return t=O.call(this,t),r||(this.ownerDocument.__CE_hasRegistry?f(e,t):d(e,t)),t})),a(Node.prototype,"removeChild",(function(t){var r=o(t),n=C.call(this,t);return r&&u(e,t),n})),a(Node.prototype,"replaceChild",(function(t,r){if(t instanceof DocumentFragment){var n=Array.prototype.slice.apply(t.childNodes);if(t=P.call(this,t,r),o(this))for(u(e,r),r=0;r<n.length;r++)p(e,n[r]);return t}n=o(t);var i=P.call(this,t,r),a=o(this);return a&&u(e,r),n&&u(e,t),a&&p(e,t),i})),k&&k.get?t(Node.prototype,k):l(e,(function(e){t(e,{enumerable:!0,configurable:!0,get:function(){for(var e=[],t=0;t<this.childNodes.length;t++)e.push(this.childNodes[t].textContent);return e.join("")},set:function(e){for(;this.firstChild;)C.call(this,this.firstChild);w.call(this,document.createTextNode(e))}})}))}(),function(){var e=ee;function t(t,r){Object.defineProperty(t,"innerHTML",{enumerable:r.enumerable,configurable:!0,get:r.get,set:function(t){var n=this,a=void 0;if(o(this)&&(a=[],i(this,(function(e){e!==n&&a.push(e)}))),r.set.call(this,t),a)for(var s=0;s<a.length;s++){var l=a[s];1===l.__CE_state&&e.disconnectedCallback(l)}return this.ownerDocument.__CE_hasRegistry?f(e,this):d(e,this),t}})}function r(t,r){a(t,"insertAdjacentElement",(function(t,n){var i=o(n);return t=r.call(this,t,n),i&&u(e,n),o(t)&&p(e,n),t}))}N&&a(Element.prototype,"attachShadow",(function(e){return this.__CE_shadowRoot=N.call(this,e)})),x&&x.get?t(Element.prototype,x):J&&J.get?t(HTMLElement.prototype,J):l(e,(function(e){t(e,{enumerable:!0,configurable:!0,get:function(){return O.call(this,!0).innerHTML},set:function(e){var t="template"===this.localName,r=t?this.content:this,o=b.call(document,this.localName);for(o.innerHTML=e;0<r.childNodes.length;)C.call(r,r.childNodes[0]);for(e=t?o.content:o;0<e.childNodes.length;)w.call(r,e.childNodes[0])}})})),a(Element.prototype,"setAttribute",(function(t,r){if(1!==this.__CE_state)return D.call(this,t,r);var o=j.call(this,t);D.call(this,t,r),r=j.call(this,t),e.attributeChangedCallback(this,t,o,r,null)})),a(Element.prototype,"setAttributeNS",(function(t,r,o){if(1!==this.__CE_state)return M.call(this,t,r,o);var n=B.call(this,t,r);M.call(this,t,r,o),o=B.call(this,t,r),e.attributeChangedCallback(this,r,n,o,t)})),a(Element.prototype,"removeAttribute",(function(t){if(1!==this.__CE_state)return I.call(this,t);var r=j.call(this,t);I.call(this,t),null!==r&&e.attributeChangedCallback(this,t,r,null,null)})),a(Element.prototype,"removeAttributeNS",(function(t,r){if(1!==this.__CE_state)return F.call(this,t,r);var o=B.call(this,t,r);F.call(this,t,r);var n=B.call(this,t,r);o!==n&&e.attributeChangedCallback(this,r,o,n,t)})),Y?r(HTMLElement.prototype,Y):K?r(Element.prototype,K):console.warn("Custom Elements: `Element#insertAdjacentElement` was not patched."),Q(e,Element.prototype,{h:H,append:q}),function(e){var t=Element.prototype;function r(t){return function(r){for(var n=[],i=0;i<arguments.length;++i)n[i-0]=arguments[i];i=[];for(var a=[],s=0;s<n.length;s++){var l=n[s];if(l instanceof Element&&o(l)&&a.push(l),l instanceof DocumentFragment)for(l=l.firstChild;l;l=l.nextSibling)i.push(l);else i.push(l)}for(t.apply(this,n),n=0;n<a.length;n++)u(e,a[n]);if(o(this))for(n=0;n<i.length;n++)(a=i[n])instanceof Element&&p(e,a)}}U&&(t.before=r(U)),U&&(t.after=r(z)),V&&a(t,"replaceWith",(function(t){for(var r=[],n=0;n<arguments.length;++n)r[n-0]=arguments[n];n=[];for(var i=[],a=0;a<r.length;a++){var s=r[a];if(s instanceof Element&&o(s)&&i.push(s),s instanceof DocumentFragment)for(s=s.firstChild;s;s=s.nextSibling)n.push(s);else n.push(s)}for(a=o(this),V.apply(this,r),r=0;r<i.length;r++)u(e,i[r]);if(a)for(u(e,this),r=0;r<n.length;r++)(i=n[r])instanceof Element&&p(e,i)})),G&&a(t,"remove",(function(){var t=o(this);G.call(this),t&&u(e,this)}))}(e)}(),document.__CE_hasRegistry=!0;var te=new g(ee);Object.defineProperty(window,"customElements",{configurable:!0,enumerable:!0,value:te})}}.call(self),!window.ZSEC){if(window.ZSEC||Object.defineProperty(window,"ZSEC",{value:{},writable:!1,configurable:!1,enumerable:!1}),Object.defineProperty(ZSEC,"util",{value:{},writable:!1,configurable:!1,enumerable:!1}),function(){if(!Object.defineProperty||!function(){try{return Object.defineProperty({},"x",{}),!0}catch(e){return!1}}()){var e=Object.defineProperty;Object.defineProperty=function(t,r,o){if(e)try{return e(t,r,o)}catch(e){}if(t!==Object(t))throw TypeError("Object.defineProperty called on non-object");return Object.prototype.__defineGetter__&&"get"in o&&Object.prototype.__defineGetter__.call(t,r,o.get),Object.prototype.__defineSetter__&&"set"in o&&Object.prototype.__defineSetter__.call(t,r,o.set),"value"in o&&(t[r]=o.value),t}}}(),ZSEC.util.defineProperty=function(e,t,r,o,n,i,a){if(o||!(t in e))return n=1==n,i=1==i,a=1==a,Object.defineProperty(e,t,{value:r,writable:n,configurable:i,enumerable:a})},ZSEC.util.defineProperty(ZSEC,"version","4.0",!0),ZSEC.util.defineProperty(ZSEC,"constants",ZSEC.constants||{},!0),ZSEC.util.ArrayIndexOf=Array.prototype.indexOf,ZSEC.util.ArrayIndexOf||(ZSEC.util.ArrayIndexOf=function(e){if(null==this)throw TypeError();var t=Object(this),r=t.length>>>0;if(0===r)return-1;var o=0;if(arguments.length>0&&(o=Number(arguments[1]),isNaN(o)?o=0:0!==o&&o!==1/0&&o!==-1/0&&(o=(o>0||-1)*Math.floor(Math.abs(o)))),o>=r)return-1;for(var n=o>=0?o:Math.max(r-Math.abs(o),0);n<r;n++)if(n in t&&t.charAt(n)===e)return n;return-1}),String.prototype.codePointAt)ZSEC.util.defineProperty(String.prototype,"codePointAt",String.prototype.codePointAt,!0);else{var codePointAt=function(e){if(null==this)throw TypeError();var t=String(this),r=t.length,o=e?Number(e):0;if(o!=o&&(o=0),!(o<0||o>=r)){var n,i=t.charCodeAt(o);return i>=55296&&i<=56319&&r>o+1&&(n=t.charCodeAt(o+1))>=56320&&n<=57343?1024*(i-55296)+n-56320+65536:i}};ZSEC.util.defineProperty(String.prototype,"codePointAt",codePointAt,!1)}if(String.fromCodePoint)ZSEC.util.defineProperty(String,"fromCodePoint",String.fromCodePoint,!0);else{var stringFromCharCode=String.fromCharCode,floor=Math.floor,fromCodePoint=function(){var e,t,r=[],o=-1,n=arguments.length;if(!n)return"";for(var i="";++o<n;){var a=Number(arguments[o]);if(!isFinite(a)||a<0||a>1114111||floor(a)!=a)throw RangeError("Invalid code point: "+a);a<=65535?r.push(a):(e=55296+((a-=65536)>>10),t=a%1024+56320,r.push(e,t)),(o+1==n||r.length>16384)&&(i+=stringFromCharCode.apply(null,r),r.length=0)}return i};ZSEC.util.defineProperty(String,"fromCodePoint",fromCodePoint,!1)}!function(){var e={log:function(e){if(navigator&&navigator.userAgent){var t=navigator.userAgent.match(/opera|chrome|safari|firefox|msie|trident(?=\/)/i);if(t&&t[0].search(/trident|msie/i)<0)return window.console.log("%cSTOP!","color:red;font-size:xx-large;font-weight:bold;"),void window.console.log("%cThis is a browser feature intended for developers. Do not enter or paste code which you don't understand. It may allow attackers to steal your information or impersonate you.\nSee https://en.wikipedia.org/wiki/Self-XSS for more details","font-size:large;")}window.console.log("STOP!\nThis is a browser feature intended for developers. Do not enter or paste code which you don't understand. It may allow attackers to steal your information or impersonate you.\nSee https://en.wikipedia.org/wiki/Self-XSS for more details")}};ZSEC.util.defineProperty(ZSEC,"Console",e,!0,!1,!1,!0)}(),ZSEC.Console.log()}if(window.DOMPurifyCopy=window.DOMPurify?window.DOMPurify:void 0,!window.ZSEC.HTMLPurifier){function addToSet(e,t){for(var r=t.length;r--;)e[t[r]]=!0;return e}function addObjsToSet(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=!0);return e}function removeFromSet(e,t){var r={};for(var o in e)e.hasOwnProperty(o)&&o!=t&&(r[o]=e[o]);return r}window.DOMPurify=function e(t){var r=function(t){return e(t)};if(r.version="0.8.5",r.removed=[],!t||!t.document||9!==t.document.nodeType)return r.isSupported=!1,r;var o=t.document,n=o,i=t.DocumentFragment,a=t.HTMLTemplateElement,s=t.Node,l=t.NodeFilter,d=t.NamedNodeMap||t.MozNamedAttrMap,c=t.Text,p=t.Comment,u=t.DOMParser;if("function"==typeof a){var f=o.createElement("template");f.content&&f.content.ownerDocument&&(o=f.content.ownerDocument)}var h=o.implementation,y=o.createNodeIterator,v=o.getElementsByTagName,m=o.createDocumentFragment,_=n.importNode,g={};r.isSupported=void 0!==h.createHTMLDocument&&9!==o.documentMode;var b=function(e,t){for(var r=t.length;r--;)"string"==typeof t[r]&&(t[r]=t[r].toLowerCase()),e[t[r]]=!0;return e},L=null,A=b({},[]),$=null,E=b({},[]),T=null,R=null,O=!0,w=!0,S=!1,C=!1,P=!1,k=/\{\{[\s\S]*|[\s\S]*\}\}/gm,N=/<%[\s\S]*|[\s\S]*%>/gm,x=!1,j=!0,D=!1,I=!1,B=!1,M=!0,F=!0,K=b({},["audio","head","math","script","svg","video","style"]),H=b({},["audio","video","img","source","image"]),q=b({},["alt","class","for","id","label","name","pattern","placeholder","summary","title","value","style","xmlns"]),U=null,z=o.createElement("form"),V=function(e){"object"!=typeof e&&(e={}),L="ALLOWED_TAGS"in e?b({},e.ALLOWED_TAGS):A,$="ALLOWED_ATTR"in e?b({},e.ALLOWED_ATTR):E,T="FORBID_TAGS"in e?b({},e.FORBID_TAGS):{},R="FORBID_ATTR"in e?b({},e.FORBID_ATTR):{},O=!1!==e.ALLOW_ARIA_ATTR,w=!1!==e.ALLOW_DATA_ATTR,S=e.ALLOW_UNKNOWN_PROTOCOLS||!1,C=e.SAFE_FOR_JQUERY||!1,P=e.SAFE_FOR_TEMPLATES||!1,x=e.WHOLE_DOCUMENT||!1,D=e.RETURN_DOM||!1,I=e.RETURN_DOM_FRAGMENT||!1,B=e.RETURN_DOM_IMPORT||!1,j=!1!==e.FORCE_BODY,M=!1!==e.SANITIZE_DOM,F=!1!==e.KEEP_CONTENT,P&&(w=!1),I&&(D=!0),e.ADD_URI_SAFE_ATTR&&b(q,e.ADD_URI_SAFE_ATTR),F&&(L["#text"]=!0),Object&&"freeze"in Object&&Object.freeze(e),U=e},G=function(e){r.removed.push({element:e});try{e.parentNode.removeChild(e)}catch(t){e.outerHTML=""}},W=function(e,t){r.removed.push({attribute:t.getAttributeNode(e),from:t}),t.removeAttribute(e)},J=function(e){var t,r;j&&(e="<remove></remove>"+e);try{t=(new u).parseFromString(e,"text/html")}catch(e){}return t&&t.documentElement||((r=(t=h.createHTMLDocument("")).body).parentNode.removeChild(r.parentNode.firstElementChild),r.outerHTML=e),"function"==typeof t.getElementsByTagName?t.getElementsByTagName(x?"html":"body")[0]:v.call(t,x?"html":"body")[0]},Y=function(e){return y.call(e.ownerDocument||e,e,l.SHOW_ELEMENT|l.SHOW_COMMENT|l.SHOW_TEXT,(function(){return l.FILTER_ACCEPT}),!1)},Q=function(e){return!(e instanceof c||e instanceof p||"string"==typeof e.nodeName&&"string"==typeof e.textContent&&"function"==typeof e.removeChild&&e.attributes instanceof d&&"function"==typeof e.removeAttribute&&"function"==typeof e.setAttribute)},X=function(e){return"object"==typeof s?e instanceof s:e&&"object"==typeof e&&"number"==typeof e.nodeType&&"string"==typeof e.nodeName},Z=function(e){var t,o;if(se("beforeSanitizeElements",e,null),Q(e))return G(e),!0;if(t=e.nodeName.toLowerCase(),se("uponSanitizeElement",e,{tagName:t,allowedTags:L}),!L[t]||T[t]){if(F&&!K[t]&&"function"==typeof e.insertAdjacentHTML)try{e.insertAdjacentHTML("AfterEnd",e.innerHTML)}catch(e){}return G(e),!0}return"style"!=t?(!C||e.firstElementChild||e.content&&e.content.firstElementChild||!/</g.test(e.textContent)||(r.removed.push({element:e.cloneNode()}),e.innerHTML=e.textContent.replace(/</g,"&lt;")),P&&3===e.nodeType&&(o=(o=(o=e.textContent).replace(k," ")).replace(N," "),e.textContent!==o&&(r.removed.push({element:e.cloneNode()}),e.textContent=o))):!C||e.firstElementChild||e.content&&e.content.firstElementChild||!/</g.test(e.textContent)||(r.removed.push({element:e.cloneNode()}),e.innerHTML=e.textContent.replace(/</g,"\\3c ")),se("afterSanitizeElements",e,null),!1},ee=/^data-[-\w.\u00B7-\uFFFF]/,te=/^aria-[-\w]+$/,re=/^(?:(?:https?|mailto|tel):|[^a-z]|[a-z+.-]+(?:[^a-z+.:-]|$))/i,oe=/^(?:\w+script|data):/i,ne=/[\x00-\x20\xA0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,ie=function(e){var t,n,i,a,s,l,d,c;if(se("beforeSanitizeAttributes",e,null),l=e.attributes){for(d={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:$},c=l.length;c--;)if(n=(t=l[c]).name,i=t.value.trim(),a=n.toLowerCase(),d.attrName=a,d.attrValue=i,d.keepAttr=!0,se("uponSanitizeAttribute",e,d),i=d.attrValue,"name"===a&&"IMG"===e.nodeName&&l.id?(s=l.id,l=Array.prototype.slice.apply(l),W("id",e),W(n,e),l.indexOf(s)>c&&e.setAttribute("id",s.value)):("id"===n&&e.setAttribute(n,""),W(n,e)),d.keepAttr&&(!M||"id"!==a&&"name"!==a||!(i in o)&&!(i in z))){if(P&&(i=(i=i.replace(k," ")).replace(N," ")),w&&ee.test(a));else if(O&&te.test(a));else{if(!$[a]||R[a])continue;if(q[a]);else if(re.test(i.replace(ne,"")));else if("src"!==a&&"xlink:href"!==a||0!==i.indexOf("data:")||!H[e.nodeName.toLowerCase()])if(S&&!oe.test(i.replace(ne,"")));else if(i)continue}try{e.setAttribute(n,i),r.removed.pop()}catch(e){}}se("afterSanitizeAttributes",e,null)}},ae=function(e){var t,r=Y(e);for(se("beforeSanitizeShadowDOM",e,null);t=r.nextNode();)se("uponSanitizeShadowNode",t,null),Z(t)||(t.content instanceof i&&ae(t.content),ie(t));se("afterSanitizeShadowDOM",e,null)},se=function(e,t,o){g[e]&&g[e].forEach((function(e){e.call(r,t,o,U)}))};return r.sanitize=function(e,o){var a,l,d,c,p,u;if(e||(e="\x3c!--\x3e"),"string"!=typeof e&&!X(e)){if("function"!=typeof e.toString)throw new TypeError("toString is not a function");e=e.toString()}if(!r.isSupported){if("object"==typeof t.toStaticHTML||"function"==typeof t.toStaticHTML){if("string"==typeof e)return t.toStaticHTML(e);if(X(e))return t.toStaticHTML(e.outerHTML)}return e}if(V(o),r.removed=[],e instanceof s)1===(l=(a=J("\x3c!--\x3e")).ownerDocument.importNode(e,!0)).nodeType&&"BODY"===l.nodeName?a=l:a.appendChild(l);else{if(!D&&!x&&-1===e.indexOf("<"))return e;if(!(a=J(e)))return D?null:""}for(j&&G(a.firstChild),p=Y(a);d=p.nextNode();)3===d.nodeType&&d===c||Z(d)||(d.content instanceof i&&ae(d.content),ie(d),c=d);if(D){if(I)for(u=m.call(a.ownerDocument);a.firstChild;)u.appendChild(a.firstChild);else u=a;return B&&(u=_.call(n,u,!0)),u}return x?a.outerHTML:a.innerHTML},r.addHook=function(e,t){"function"==typeof t&&(g[e]=g[e]||[],g[e].push(t))},r.removeHook=function(e){g[e]&&g[e].pop()},r.removeHooks=function(e){g[e]&&(g[e]=[])},r.removeAllHooks=function(){g={}},r}(window),function(e){var t={ALLOW_ARIA_ATTR:!0,ALLOW_DATA_ATTR:!0,ALLOW_UNKNOWN_PROTOCOLS:!1,SAFE_FOR_JQUERY:!1,SAFE_FOR_TEMPLATES:!1,WHOLE_DOCUMENT:!1,RETURN_DOM:!1,RETURN_DOM_FRAGMENT:!1,RETURN_DOM_IMPORT:!1,FORCE_BODY:!0,SANITIZE_DOM:!0,KEEP_CONTENT:!0,STYLE_VALIDATION:!0,REMOVE_ONEVENTS:!0,ALLOWED_STYLE:"NONE"};t.ALLOWED_TAGS="a|abbr|acronym|address|area|article|aside|audio|b|bdi|bdo|big|blink|blockquote|body|br|button|canvas|caption|center|cite|code|col|colgroup|content|data|datalist|dd|decorator|del|details|dfn|dir|div|dl|dt|element|em|fieldset|figcaption|figure|font|footer|form|h1|h2|h3|h4|h5|h6|head|header|hgroup|hr|html|i|img|input|ins|kbd|label|legend|li|main|map|mark|marquee|menu|menuitem|meter|nav|nobr|ol|optgroup|option|output|p|pre|progress|q|rp|rt|ruby|s|samp|section|select|shadow|small|source|spacer|span|strike|strong|sub|summary|sup|table|tbody|td|template|textarea|tfoot|th|thead|time|title|tr|track|tt|u|ul|var|video|wbr|#text".split("|"),t.ALLOWED_ATTR="accept|action|align|alt|autocomplete|background|bgcolor|border|cellpadding|cellspacing|checked|cite|class|clear|color|cols|colspan|coords|datetime|default|dir|disabled|download|enctype|face|for|headers|height|hidden|high|href|hreflang|id|ismap|label|lang|list|loop|low|max|maxlength|media|method|min|multiple|name|noshade|novalidate|nowrap|open|optimum|pattern|placeholder|poster|preload|pubdate|radiogroup|readonly|rel|required|rev|reversed|role|rows|rowspan|spellcheck|scope|selected|shape|size|span|srclang|start|src|step|summary|tabindex|title|target|type|usemap|valign|value|width|xmlns|sandbox".split("|"),t.ALLOWED_STYLE_PROPS="azimuth|background|background-attachment|background-color|background-image|background-position|content|background-repeat|border-collapse|border-color|border-top-color|border-right-color|border-bottom-color|border-left-color|bottom|caption-side|clear|color|cue-after|cue-before|direction|display|elevation|empty-cells|float|font-size|font-size-adjust|font-stretch|font-style|font-variant|font-weight|height|left|letter-spacing|line-height|list-style-image|list-style-position|list-style-type|marker-offset|max-height|max-width|min-height|min-width|orphans|outline-color|overflow|page-break-after|page-break-before|page-break-inside|pause-after|pause-before|pitch|pitch-range|position|richness|right|size|speak|speak-header|speak-numeral|speak-punctuation|speech-rate|stress|table-layout|text-indent|text-transform|top|unicode-bidi|vertical-align|visibility|volume|white-space|widows|width|word-spacing|border-style|border-top-style|border-right-style|border-bottom-style|border-left-style|border-top-width|border-right-width|border-bottom-width|border-left-width|border-width|margin|margin-top|margin-right|margin-bottom|margin-left|outline-style|outline-width|padding|padding-top|padding-right|padding-bottom|padding-left|border|border-top|border-right|border-bottom|border-left|cue|list-style|marks|outline|pause|text-decoration|border-spacing|clip|counter-increment|clip|cursor|text-shadow|font|font-family|page|play-during|text-align|voice-family".split("|"),t.FORBID_TAGS=[],t.FORBID_ATTR=[],t.ALLOWED_TAGS_OBJ={},t.ALLOWED_ATTR_OBJ={},t.FORBID_TAGS_OBJ={},t.FORBID_ATTR_OBJ={},t.ADD_URI_SAFE_ATTR=[],t.EXTENDS=["GLOBAL_ATTRIBUTES","GLOBAL_TAGS","FORBID_TAGS","FORBID_ATTR","GLOBAL_APPEND_ATTRIBUTES","GLOBAL_ATTRIBUTE_RULES","ADD_URI_SAFE_ATTR","TAG_RULES"],t.TAG_RULES={a:{APPEND_ATTRIBUTES:[{NAME:"rel",VALUE:"noopener noreferrer",CRITERIA:[{NAME:"target",CONTAINS:"_blank"}]}]}},t.GLOBAL_APPEND_ATTRIBUTES=[],t.GLOBAL_ATTRIBUTE_RULES={},ZSEC.util.defineProperty(ZSEC,"HTMLPurifier",function e(t,r){function o(e){if(!e||e.constructor!==Object)return t;var r={};for(var o in t)t.hasOwnProperty(o)&&(o in e?o in $&&(1==e[o]||0==e[o]?r[o]=e[o]:r[o]=t[o]):r[o]=t[o]);return r.SAFE_FOR_TEMPLATES&&(r.ALLOW_DATA_ATTR=!1),r.RETURN_DOM_FRAGMENT&&(r.RETURN_DOM=!0),r.KEEP_CONTENT&&(r.ALLOWED_TAGS_OBJ["#text"]=!0),r}function n(e){for(var t in e)e.hasOwnProperty(t)&&e[t].constructor==String&&(e[t]&&S[t]?!0:e[t]&&("cssText"==t||/^\d.*/.test(t)||(e[t]="",R=!0)))}function i(e){for(var t=e.length-1;t>=0;t--){var r=e[t];1==r.type&&r.selectorText||8==r.type&&r.keyText?r.style&&n(r.style):4!=r.type&&7!=r.type||!r.cssRules||i(r.cssRules)}}function a(e,t){for(var r=t.length-1;r>=0;r--)1!=t[r].type&&4!=t[r].type&&7!=t[r].type||e.push(t[r].cssText)}function s(e,t,r){r=null==r?e.IS_MANDATORY:r;if(e.NAME&&!t.hasAttribute(e.NAME.toLowerCase()))return e.IS_FORBIDDEN||!r;if(e.IS_FORBIDDEN)return!1;var o=t.getAttribute(e.NAME.toLowerCase());if(null!=o||(o=""),o.constructor==String){if(e.DONT_TRIM||(o=o.trim()),e.CASE_SENSITIVE||(o=o.toLowerCase()),e.MAX_LENGTH&&o.length>e.MAX_LENGTH)return!1;if(e.MIN_LENGTH&&o.length<e.MIN_LENGTH)return!1;if(null!=e.REGEX){if(e.REGEX.constructor==RegExp&&-1==o.search(e.REGEX))return!1;if(e.REGEX.constructor==Array)for(i=0;i<e.REGEX.length;i++)if(-1==o.search(e.REGEX[i]))return!1}}if(e.LIST&&-1==e.LIST.indexOf(o))return!1;if("INTEGER"==e.TYPE||"FLOAT"==e.TYPE){var n;try{n="INTEGER"==e.TYPE?window.parseInt(o,10):window.parseFloat(o)}catch(e){return!1}if(window.isNaN(n))return!1;if(null!=e.GREATER_THAN&&n<=e.GREATER_THAN)return!1;if(null!=e.GREATER_THAN_OR_EQUAL&&n<e.GREATER_THAN_OR_EQUAL)return!1;if(null!=e.LESSER_THAN&&n>=e.LESSER_THAN)return!1;if(null!=e.LESSER_THAN_OR_EQUAL&&n>e.LESSER_THAN_OR_EQUAL)return!1;if(null!=e.EQUAL&&n!=e.EQUAL)return!1;if(null!=e.NOT_EQUAL&&n==e.NOT_EQUAL)return!1}else if(o.constructor==String){if(null!=e.STARTS_WITH&&0!=o.indexOf(e.STARTS_WITH))return!1;if(null!=e.ENDS_WITH&&o.lastIndexOf(e.ENDS_WITH)!=o.length-e.ENDS_WITH.length)return!1;if(null!=e.CONTAINS){if(e.CONTAINS.constructor==String&&-1==o.indexOf(e.CONTAINS))return!1;if(e.CONTAINS.constructor==Array)for(i=0;i<e.CONTAINS.length;i++)if(-1==o.indexOf(e.CONTAINS[i]))return!1}if(null!=e.NOT_CONTAINS){if(e.NOT_CONTAINS.constructor==String&&o.indexOf(e.NOT_CONTAINS)>-1)return!1;if(e.NOT_CONTAINS.constructor==Array)for(var i=0;i<e.NOT_CONTAINS.length;i++)if(o.indexOf(e.NOT_CONTAINS[i])>-1)return!1}if(null!=e.EQUAL&&o!==e.EQUAL)return!1;if(null!=e.NOT_EQUAL&&o===e.NOT_EQUAL)return!1}return!0}function l(e){if(!e)return e;if(e.constructor==Object)for(var t in e)e.hasOwnProperty(t)&&(e[t]=c(e[t]));return e}function d(e){if(!e)return e;if(e.constructor==Array)for(var t=0;t<e.length;t++)if(e[t].CRITERIA)for(var r=0;r<e[t].CRITERIA.length;r++)e[t].CRITERIA[r]=c(e[t].CRITERIA[r]);return e}function c(e){if(e){var t=["STARTS_WITH","ENDS_WITH","CONTAINS","EQUAL","NOT_EQUAL","LIST"];if(!e.CASE_SENSITIVE)for(var r=0;r<t.length;r++){var o=t[r];e[o]&&(e[o]=p(e[o]))}}return e}function p(e){if(e&&e.constructor==String)return e.toLowerCase();if(e.constructor==Array)for(var t=0;t<e.length;t++)e[t]=p(e[t]);return e}function u(e,t){if(!e||e.constructor==Object)return e;for(var r={},o=0;o<e.length;o++){var n=e[o];r[n[t]]=n}return r}function f(e,t){if(e)for(var r=0;r<e.length;r++){var o=e[r];if(!t.hasAttribute(o.NAME.toLowerCase())){var n=!0;if(o.CRITERIA)for(var i=0;i<o.CRITERIA.length;i++)if(!s(o.CRITERIA[i],t,!0)){n=!1;break}n?t.setAttribute(o.NAME,o.VALUE):null!=o.DEFAULT_VALUE&&t.setAttribute(o.NAME,o.DEFAULT_VALUE)}}}function h(e,t){if(!t||t.constructor!==Object)return e;if(!e||e.constructor!==Object)return t;for(var r in t)t.hasOwnProperty(r)&&r in e?(null==e[r].APPEND_ATTRIBUTES&&(e[r].APPEND_ATTRIBUTES=t[r].APPEND_ATTRIBUTES),null==e[r].ATTRIBUTE_RULES&&(e[r].ATTRIBUTE_RULES=t[r].ATTRIBUTE_RULES)):e[r]=t[r];return e}function y(e,t,r){return!(t&&!s(t,e)&&(void 0!==t.DEFAULT_VALUE?e.setAttribute(r,t.DEFAULT_VALUE):e.removeAttribute(r),1))}function v(e){if("object"==typeof e){for(var r in e.ALLOWED_TAGS=e.GLOBAL_TAGS,e.ALLOWED_ATTR=e.GLOBAL_ATTRIBUTES,O)!O.hasOwnProperty(r)||null!=e[r]||r in T||(e[r]=t[r]);if(e.TAG_RULES=u(e.TAG_RULES,"NAME"),e.TAG_RULES&&e.TAG_RULES.constructor==Object)for(var o in e.TAG_RULES)if(e.TAG_RULES.hasOwnProperty(o)){var n=e.TAG_RULES[o];n.ATTRIBUTE_RULES=l(u(n.ATTRIBUTE_RULES,"NAME")),n.APPEND_ATTRIBUTES=d(n.APPEND_ATTRIBUTES)}if(e.GLOBAL_ATTRIBUTE_RULES=l(u(e.GLOBAL_ATTRIBUTE_RULES,"NAME")),e.GLOBAL_APPEND_ATTRIBUTES=d(e.GLOBAL_APPEND_ATTRIBUTES),e.EXTENDS)for(var i=0;i<e.EXTENDS.length;i++){var a=e.EXTENDS[i];switch("GLOBAL_TAGS"==a&&(a="ALLOWED_TAGS"),"GLOBAL_ATTRIBUTES"==a&&(a="ALLOWED_ATTR"),a){case"ALLOWED_TAGS":case"ALLOWED_ATTR":case"FORBID_TAGS":case"FORBID_ATTR":e[a+="_OBJ"]={},t[a]&&(e[a]=addObjsToSet(e[a],t[a]));break;case"ADD_URI_SAFE_ATTR":case"GLOBAL_APPEND_ATTRIBUTES":if(e[a]||(e[a]=[]),!t[a]||t[a].constructor!==Array)break;e[a]=e[a].concat(t[a]);break;case"GLOBAL_ATTRIBUTE_RULES":if(e.GLOBAL_ATTRIBUTE_RULES||(e.GLOBAL_ATTRIBUTE_RULES={}),t.GLOBAL_ATTRIBUTE_RULES&&t.GLOBAL_ATTRIBUTE_RULES.constructor==Object)for(var s in t.GLOBAL_ATTRIBUTE_RULES)t.GLOBAL_ATTRIBUTE_RULES.hasOwnProperty(s)&&!e.GLOBAL_ATTRIBUTE_RULES[s]&&(e.GLOBAL_ATTRIBUTE_RULES[s]=t.GLOBAL_ATTRIBUTE_RULES[s]);break;case"TAG_RULES":e.TAG_RULES||(e.TAG_RULES={}),e.TAG_RULES=h(e.TAG_RULES,t.TAG_RULES)}}for(var c in E)E.hasOwnProperty(c)&&(e[c+"_OBJ"]||(e[c+"_OBJ"]={}),null!=e[c]?e[c].constructor===Array&&(e[c+"_OBJ"]=addToSet(e[c+"_OBJ"],e[c])):e[c]=[]);for(var p=0;p<A.length;p++){var f=A[p];e[f]||(e[f]=[])}for(var y in"ALL"==e.ALLOWED_STYLE?(e.FORBID_TAGS_OBJ=removeFromSet(e.FORBID_TAGS_OBJ,"style"),e.FORBID_ATTR_OBJ=removeFromSet(e.FORBID_ATTR_OBJ,"style"),e.ALLOWED_TAGS_OBJ=addToSet(e.ALLOWED_TAGS_OBJ,["style"]),e.ALLOWED_ATTR_OBJ=addToSet(e.ALLOWED_ATTR_OBJ,["style"])):"INLINE"==e.ALLOWED_STYLE?(e.FORBID_ATTR_OBJ=removeFromSet(e.FORBID_ATTR_OBJ,"style"),e.ALLOWED_ATTR_OBJ=addToSet(e.ALLOWED_ATTR_OBJ,["style"]),e.FORBID_TAGS_OBJ=addToSet(e.FORBID_TAGS_OBJ,["style"]),e.ALLOWED_TAGS_OBJ=removeFromSet(e.ALLOWED_TAGS_OBJ,"style")):"INTERNAL"==e.ALLOWED_STYLE?(e.FORBID_TAGS_OBJ=removeFromSet(e.FORBID_TAGS_OBJ,"style"),e.ALLOWED_TAGS_OBJ=addToSet(e.ALLOWED_TAGS_OBJ,["style"]),e.FORBID_ATTR_OBJ=addToSet(e.FORBID_ATTR_OBJ,["style"]),e.ALLOWED_ATTR_OBJ=removeFromSet(e.ALLOWED_ATTR_OBJ,"style")):"NONE"==e.ALLOWED_STYLE&&(e.FORBID_TAGS_OBJ=addToSet(e.FORBID_TAGS_OBJ,["style"]),e.FORBID_ATTR_OBJ=addToSet(e.FORBID_ATTR_OBJ,["style"]),e.ALLOWED_TAGS_OBJ=removeFromSet(e.ALLOWED_TAGS_OBJ,"style"),e.ALLOWED_ATTR_OBJ=removeFromSet(e.ALLOWED_ATTR_OBJ,"style")),E)if(E.hasOwnProperty(y)){for(var v in e[y+"_OBJ"])e[y+"_OBJ"].hasOwnProperty(v)&&e[y].push(v);e[y+"_OBJ"]=addToSet(e[y+"_OBJ"],e[y])}ZSEC.configValidator&&ZSEC.configValidator.HTMLPurifierValidation(e,O,E,m,_)}else for(var g in e={},t)t.hasOwnProperty(g)&&(e[g]=t[g].valueOf());return e}var m=addToSet({},["script"]),_=addToSet({},[]),g=["ALLOW_ARIA_ATTR","ALLOW_DATA_ATTR","ALLOW_UNKNOWN_PROTOCOLS","SAFE_FOR_JQUERY","SAFE_FOR_TEMPLATES","WHOLE_DOCUMENT","RETURN_DOM","RETURN_DOM_FRAGMENT","RETURN_DOM_IMPORT","FORCE_BODY","SANITIZE_DOM","KEEP_CONTENT","ALLOWED_STYLE_PROPS"],b=["ALLOWED_TAGS","ALLOWED_ATTR","FORBID_TAGS","FORBID_ATTR"],L=["ALLOWED_TAGS_OBJ","ALLOWED_ATTR_OBJ","FORBID_TAGS_OBJ","FORBID_ATTR_OBJ"],A=["ADD_URI_SAFE_ATTR","GLOBAL_APPEND_ATTRIBUTES","GLOBAL_ATTRIBUTE_RULES","TAG_RULES"],$=addToSet({},g),E=addToSet({},b),T=(addToSet({},L),addToSet({},A));T=addToSet(T,b),T=addToSet(T,L);var R,O=addToSet({},g.concat(["STYLE_VALIDATION","ALLOWED_STYLE","EXTENDS","REMOVE_ONEVENTS","GLOBAL_ATTRIBUTES","GLOBAL_TAGS"],b,L,A)),w={iframe:{NAME:"iframe",ATTRIBUTE_RULES:{sandbox:{NAME:"sandbox",NOT_CONTAINS:["allow-top-navigation","allow-popups-to-escape-sandbox"],DEFAULT_VALUE:"allow-popups allow-forms allow-scripts allow-same-origin"}},APPEND_ATTRIBUTES:[{NAME:"sandbox",VALUE:"allow-popups allow-forms allow-scripts allow-same-origin"}]}},S=addToSet({},t.ALLOWED_STYLE_PROPS);!function(){for(var e in t.FORBID_TAGS_OBJ=addObjsToSet(t.FORBID_TAGS_OBJ,m),t.FORBID_ATTR_OBJ=addObjsToSet(t.FORBID_ATTR_OBJ,_),E)E.hasOwnProperty(e)&&(t[e+"_OBJ"]=addToSet(t[e+"_OBJ"],t[e]));r.removeAllHooks(),R=!1,"NONE"==t.ALLOWED_STYLE&&(t.FORBID_TAGS_OBJ=addToSet(t.FORBID_TAGS_OBJ,["style"]),t.FORBID_ATTR_OBJ=addToSet(t.FORBID_ATTR_OBJ,["style"])),"INLINE"!=t.ALLOWED_STYLE&&"ALL"!=t.ALLOWED_STYLE||(t.STYLE_VALIDATION&&r.addHook("afterSanitizeAttributes",(function(e){if(!e.ownerDocument.baseURI){var t=document.createElement("base");t.href=document.baseURI,e.ownerDocument.head.appendChild(t)}if(e.hasAttribute("style")){var r="";R=!1,n(e.style),(r=R?e.style.cssText:e.getAttribute("style")).length?e.setAttribute("style",r):e.removeAttribute("style")}})),"INLINE"==t.ALLOWED_STYLE&&(t.FORBID_TAGS_OBJ=addToSet(t.FORBID_TAGS_OBJ,["style"]),t.FORBID_ATTR_OBJ=removeFromSet(t.FORBID_ATTR_OBJ,"style"))),"INTERNAL"!=t.ALLOWED_STYLE&&"ALL"!=t.ALLOWED_STYLE||(t.STYLE_VALIDATION&&r.addHook("uponSanitizeElement",(function(e,t){if("style"===t.tagName&&null!=e.sheet){var r=e.sheet.cssRules;if(R=!1,i(r),R){var o=[];a(o,r),e.textContent=o.join("\n")}}})),"INTERNAL"==t.ALLOWED_STYLE&&(t.FORBID_ATTR_OBJ=addToSet(t.FORBID_ATTR_OBJ,["style"]),t.FORBID_TAGS_OBJ=removeFromSet(t.FORBID_TAGS_OBJ,"style"))),"ALL"==t.ALLOWED_STYLE&&(t.FORBID_TAGS_OBJ=removeFromSet(t.FORBID_TAGS_OBJ,"style"),t.FORBID_ATTR_OBJ=removeFromSet(t.FORBID_ATTR_OBJ,"style")),(t.GLOBAL_ATTRIBUTE_RULES||t.TAG_RULES)&&r.addHook("afterSanitizeAttributes",(function(e){for(var r=e.nodeName.toLowerCase(),o=t.GLOBAL_ATTRIBUTE_RULES,n=t.TAG_RULES&&t.TAG_RULES[r]&&t.TAG_RULES[r].ATTRIBUTE_RULES,i=w&&w[r]&&w[r].ATTRIBUTE_RULES,a=e.attributes.length;a--;){var s=e.attributes[a].name;y(e,n&&n[s]||o&&o[s],s)&&y(e,i&&i[s],s)}})),(t.GLOBAL_APPEND_ATTRIBUTES||t.TAG_RULES)&&r.addHook("afterSanitizeAttributes",(function(e){var r=e.nodeName.toLowerCase();f(t.TAG_RULES&&t.TAG_RULES[r]&&t.TAG_RULES[r].APPEND_ATTRIBUTES,e),f(t.GLOBAL_APPEND_ATTRIBUTES,e),f(w&&w[r]&&w[r].APPEND_ATTRIBUTES,e)})),t.REMOVE_ONEVENTS&&r.addHook("uponSanitizeAttribute",(function(e,t){0==t.attrName.indexOf("on")&&(t.keepAttr=!1)}))}();var C=function(t){return t=v(t),e(t,r(window))};return C.isSupported=r.isSupported,C.removed="",ZSEC.util.defineProperty(C,"sanitize",(function(e,t){var n=o(t),i=r.sanitize(e,n);return C.removed=r.removed,i}),!1,!1,!0),C}(t,DOMPurify(window)),!0,!1,!1,!0),delete window.DOMPurify}()}window.DOMPurifyCopy&&(window.DOMPurify=window.DOMPurifyCopy,window.DOMPurifyCopy=void 0),window.ZSEC.Encoder||function(e){function t(e){for(var t=[],r=0;r<e.length;r++)t.push(e[r].charCodeAt(0));return t}var r={},o="34=&quot|38=&amp|60=&lt|62=&gt|160=&nbsp|161=&iexcl|162=&cent|163=&pound|164=&curren|165=&yen|166=&brvbar|167=&sect|168=&uml|169=&copy|170=&ordf|171=&laquo|172=&not|173=&shy|174=&reg|175=&macr|176=&deg|177=&plusmn|178=&sup2|179=&sup3|180=&acute|181=&micro|182=&para|183=&middot|184=&cedil|185=&sup1|186=&ordm|187=&raquo|188=&frac14|189=&frac12|190=&frac34|191=&iquest|192=&Agrave|193=&Aacute|194=&Acirc|195=&Atilde|196=&Auml|197=&Aring|198=&AElig|199=&Ccedil|200=&Egrave|201=&Eacute|202=&Ecirc|203=&Euml|204=&Igrave|205=&Iacute|206=&Icirc|207=&Iuml|208=&ETH|209=&Ntilde|210=&Ograve|211=&Oacute|212=&Ocirc|213=&Otilde|214=&Ouml|215=&times|216=&Oslash|217=&Ugrave|218=&Uacute|219=&Ucirc|220=&Uuml|221=&Yacute|222=&THORN|223=&szlig|224=&agrave|225=&aacute|226=&acirc|227=&atilde|228=&auml|229=&aring|230=&aelig|231=&ccedil|232=&egrave|233=&eacute|234=&ecirc|235=&euml|236=&igrave|237=&iacute|238=&icirc|239=&iuml|240=&eth|241=&ntilde|242=&ograve|243=&oacute|244=&ocirc|245=&otilde|246=&ouml|247=&divide|248=&oslash|249=&ugrave|250=&uacute|251=&ucirc|252=&uuml|253=&yacute|254=&thorn|255=&yuml|338=&OElig|339=&oelig|352=&Scaron|353=&scaron|376=&Yuml|402=&fnof|710=&circ|732=&tilde|913=&Alpha|914=&Beta|915=&Gamma|916=&Delta|917=&Epsilon|918=&Zeta|919=&Eta|920=&Theta|921=&Iota|922=&Kappa|923=&Lambda|924=&Mu|925=&Nu|926=&Xi|927=&Omicron|928=&Pi|929=&Rho|931=&Sigma|932=&Tau|933=&Upsilon|934=&Phi|935=&Chi|936=&Psi|937=&Omega|945=&alpha|946=&beta|947=&gamma|948=&delta|949=&epsilon|950=&zeta|951=&eta|952=&theta|953=&iota|954=&kappa|955=&lambda|956=&mu|957=&nu|958=&xi|959=&omicron|960=&pi|961=&rho|962=&sigmaf|963=&sigma|964=&tau|965=&upsilon|966=&phi|967=&chi|968=&psi|969=&omega|977=&thetasym|978=&upsih|982=&piv|8194=&ensp|8195=&emsp|8201=&thinsp|8204=&zwnj|8205=&zwj|8206=&lrm|8207=&rlm|8211=&ndash|8212=&mdash|8216=&lsquo|8217=&rsquo|8218=&sbquo|8220=&ldquo|8221=&rdquo|8222=&bdquo|8224=&dagger|8225=&Dagger|8226=&bull|8230=&hellip|8240=&permil|8242=&prime|8243=&Prime|8249=&lsaquo|8250=&rsaquo|8254=&oline|8260=&frasl|8364=&euro|8465=&image|8472=&weierp|8476=&real|8482=&trade|8501=&alefsym|8592=&larr|8593=&uarr|8594=&rarr|8595=&darr|8596=&harr|8629=&crarr|8656=&lArr|8657=&uArr|8658=&rArr|8659=&dArr|8660=&hArr|8704=&forall|8706=&part|8707=&exist|8709=&empty|8711=&nabla|8712=&isin|8713=&notin|8715=&ni|8719=&prod|8721=&sum|8722=&minus|8727=&lowast|8730=&radic|8733=&prop|8734=&infin|8736=&ang|8743=&and|8744=&or|8745=&cap|8746=&cup|8747=&int|8756=&there4|8764=&sim|8773=&cong|8776=&asymp|8800=&ne|8801=&equiv|8804=&le|8805=&ge|8834=&sub|8835=&sup|8836=&nsub|8838=&sube|8839=&supe|8853=&oplus|8855=&otimes|8869=&perp|8901=&sdot|8968=&lceil|8969=&rceil|8970=&lfloor|8971=&rfloor|10216=&lang|10217=&rang|9674=&loz|9824=&spades|9827=&clubs|9829=&hearts|9830=&diams";o=o.split("|");for(var n=0;n<o.length;n++){var i=o[n].split("=");r[i[0]]=i[1]}var a={characterToEntityMap:r,IMMUNE_HTML:t(new Array(",",".","-","_"," ")),IMMUNE_HTMLATTR:t(new Array(",",".","-","_")),IMMUNE_CSS:t(new Array),IMMUNE_JAVASCRIPT:t(new Array(",",".","_"))};ZSEC.util.defineProperty(ZSEC,"Encoder",function(e){function t(e,t,r,o){if(null==t||null==t||"string"!=typeof t)return t;for(var n="",i=0;i<t.length;i++)if(o){var a=t.codePointAt(i);n+=r(e,a,o),a>65535&&i++}else n+=r(e,t.charCodeAt(i));return n}for(var r={},o=e.characterToEntityMap,n=[],i=0;i<255;i++)n[i]=i>=48&&i<=57||i>=65&&i<=90||i>=97&&i<=122?null:i.toString(16);var a=function(e){return e<256?n[e]:e.toString(16)},s=function(e,t){if(-1!=ZSEC.util.ArrayIndexOf.call(e,t))return String.fromCodePoint(t);var r=a(t);if(null==r)return String.fromCodePoint(t);if(t<=31&&"\t"!=t&&"\n"!=t&&"\r"!=t||t>=127&&t<=159||" "==t)return" ";var n=o[t];return null!=n?n+";":"&#x"+r+";"},l=function(e,t){if(-1!=ZSEC.util.ArrayIndexOf.call(e,t))return String.fromCharCode(t);if(null==a(t))return String.fromCharCode(t);var r=t.toString(16);if(t<256){var o="00".substr(r.length);return"\\x"+o+r.toUpperCase()}return"\\u"+(o="0000".substr(r.length))+r.toUpperCase()},d=function(e,t){if(-1!=ZSEC.util.ArrayIndexOf.call(e,t))return String.fromCodePoint(t);var r=a(t);return null==r?String.fromCodePoint(t):"\\"+r+" "};return r.encodeForHTML=function(r){return t(e.IMMUNE_HTML,r,s,!0)},r.encodeForHTMLAttribute=function(r){return t(e.IMMUNE_HTMLATTR,r,s,!0)},r.encodeForJavaScript=function(r){return t(e.IMMUNE_JAVASCRIPT,r,l,!1)},r.encodeForCSS=function(r){return t(e.IMMUNE_CSS,r,d,!0)},Object.freeze&&Object.freeze(r),r}(a),!0,!1,!1,!0)}();var _createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,r,o){return r&&e(t.prototype,r),o&&e(t,o),t}}(),_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function _defineProperty(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function ReplaceWith(e){var t=this.parentNode,r=arguments.length,o=+(t&&"object"===(void 0===e?"undefined":_typeof(e)));if(t){for(;r-- >o;)t&&"object"!==_typeof(arguments[r])&&(arguments[r]=document.createTextNode(arguments[r])),t||!arguments[r].parentNode?t.insertBefore(this.previousSibling,arguments[r]):arguments[r].parentNode.removeChild(arguments[r]);o&&t.replaceChild(this,e)}}[Element.prototype,CharacterData.prototype,DocumentType.prototype].forEach((function(e){e.hasOwnProperty("after")||Object.defineProperty(e,"after",{configurable:!0,enumerable:!0,writable:!0,value:function(){var e=Array.prototype.slice.call(arguments),t=document.createDocumentFragment();e.forEach((function(e){var r=e instanceof Node;t.appendChild(r?e:document.createTextNode(String(e)))})),this.parentNode.insertBefore(t,this.nextSibling)}})})),Element.prototype.replaceWith||(Element.prototype.replaceWith=ReplaceWith),CharacterData.prototype.replaceWith||(CharacterData.prototype.replaceWith=ReplaceWith),DocumentType.prototype.replaceWith||(DocumentType.prototype.replaceWith=ReplaceWith),String.prototype.startsWith||(String.prototype.startsWith=function(e,t){return t=t||0,this.indexOf(e,t)===t}),String.prototype.endsWith||(String.prototype.endsWith=function(e,t){return(void 0===t||t>this.length)&&(t=this.length),this.substring(t-e.length,t)===e}),window.Lyte={version:"3.3.4",$:{consoleTime:[]},registeredMixins:{},registeredServices:{},requiredServices:{},toBeInjectedServices:{},_registeredComponents:{},_keywords:{component:["init","didConnect","didDestroy","constructor","onError","actions","methods","data"],adapter:["namespace","actionNamespace","host","withCredentials","buildURL","methodForRequest","headersForRequest","reloadRecord","reloadRecord","reloadAll","processRequest","parseResponse","parseRequest","super"],serializer:["normalize","normalizeResponse","serialize","serializeKey","deserializeKey","extractMeta","payloadKey","serializeRecord","normalizeRecord","super"],route:["getDependencies","getResources","beforeModel","model","afterModel","redirect","renderTemplate","afterRender","beforeExit","didDestroy","queryParams","title","routeName","component","parent","currentModel","forceFetch","setTitle","setQueryParams","getQueryParams","setDynamicParam","getDynamicParam","removeFromCache","refresh","transitionTo","replaceWith","actions"],is:function(e,t){var r=["component","adapter","serializer","route"];t&&(r=[t]);for(var o=r.length,n=0;n<o;n++){var i=this[r[n]];if(i&&-1!=i.indexOf(e))return!0}return!1}},Mixin:{},Service:{},debug:!1,performance:!1,toBeRegistered:[],browser:{},registeredCustomComponent:{},Globals:{}},function(){var e=Lyte.$.userAgent=window.userAgent=navigator.userAgent;if(e.match(/rv:11/)&&(Lyte.browser.ie=!0,window.action=function(){}),e.match("Edge")){var t=createElement("div");t.innerHTML="<template><div>c</div></template>",t.querySelector("template").childNodes.length?Lyte.browser.ie=!0:Lyte.browser.edge=!0,t.remove()}Object.defineProperty(Lyte,"__gl",{value:{}}),Lyte.Globals.set=function(e,t){Lyte.Component.set(Lyte.__gl,e,t)},Lyte.Globals.get=function(e){return Lyte.Component._get(Lyte.__gl,e)},Lyte.$.assetsDiv=document.createElement("div"),Lyte.$.assetsDiv.setAttribute("id","lyteAssetsDiv"),Lyte.assetsDivContainer=document.head,Lyte.domContentLoaded=function(e){"complete"===document.readyState||"interactive"===document.readyState?e():window.addEventListener("DOMContentLoaded",(function(){e()}))},Lyte.createApplication=function(e,t){t.init&&t.init.apply(Lyte)},Lyte.registerErrorCodes=function(e){Object.assign(Lyte.errorCodes,e)},Lyte.establishObserverBindings=function(e,t,r,o){var n=this;t&&(n=t);for(var i=0;i<e.length;i++)for(var a=e[i].properties,s=0;s<a.length;s++){var l,d=!1;if("string"==typeof a[s]){if(-1!==a[s].indexOf(".[]"))d=!0,l=Lyte.getProperty.call(this,a[s].substring(0,a[s].indexOf(".[]")),t,r);else{if(-1!==a[s].indexOf(".*")){var c=a[s].split(".")[0];if(!(!t&&this.component.__data[c]&&this.component.__data[c].watch||t&&o&&o.fieldList&&o.fieldList[c]&&o.fieldList[c].watch))continue}l=Lyte.getProperty.call(this,a[s],t,r)}l._observers||Object.defineProperty(l,"_observers",{value:new Set,enumerable:!1,writable:!0,configurable:!0}),l._observers.add({callee:n,observer:e[i],isArrayObserver:d})}else Lyte.warn("ERR27",JSON.stringify(a[s]),e[i].fnName,this.tagName)}},Lyte.getProperty=function(e,t,r){var o=e.match(/([^[\].]+|\[\])/g),n=this;t?(n=r,r[o[0]]||(r[o[0]]={}),n=r[o[0]]):(n._properties[o[0]]||(n._properties[o[0]]={}),n=n._properties[o[0]]),Object.defineProperty(n,"_path",{enumerable:!1,value:o[0]});for(var i=1;i<o.length;i++)(o[i].startsWith("'")||o[i].startsWith('"'))&&(o[i]=o[i].substring(1,o[i].length-1)),n[o[i]]||(n[o[i]]={},Object.defineProperty(n[o[i]],"_path",{enumerable:!1,value:n._path+"."+o[i]})),n=n[o[i]];return n},Lyte.getErrorMessage=function(e){var t=Array.from(arguments).slice(1);return Lyte.errorCodes[e]?Lyte.errorCodes[e].replace(/{(\d+)}/g,(function(e,r){return t[r]})):e},Lyte.error=function(){var e=arguments[0],t=e.stack;e=t?e:Error(Lyte.getErrorMessage.apply(Lyte,arguments)),Lyte.onerror&&Lyte.onerror.call(this,e,arguments[1]),Lyte.triggerEvent("error",e,arguments[1]);var r=e.stack&&-1==e.stack.indexOf(e.message);t&&!r&&(e=JSON.parse(JSON.stringify(e,Object.getOwnPropertyNames(e)))),arguments[1]?console.error(e.stack?r?e:e.stack:e.message,arguments[1]):console.error(e.stack?r?e:e.stack:e.message)},Lyte.warn=function(){var e=arguments[0];e=e.stack?JSON.parse(JSON.stringify(e,Object.getOwnPropertyNames(e))):Error(Lyte.getErrorMessage.apply(Lyte,arguments)),console.warn(e.stack?-1!=e.stack.indexOf(e.message)?e.stack.replace("Error: ",""):e:e.message)};var r={};function o(e){return e.match(/\.[a-zA-Z]+(?=\?|$)/)}function o(e){return e.match(/\.[a-zA-Z]+(?=\?|$)/)}Lyte.Mixin.register=function(e,t){var o;if(Lyte.registeredMixins[e]=t,o=r[e])for(var n in o)Lyte.$.requiredMixins[n](t,o[n],n)},Lyte.Mixin.get=function(e){return Lyte.registeredMixins[e]},Lyte.Service.register=function(e,t){if(Lyte.registeredServices.hasOwnProperty(e))Lyte.warn("Service -"+e+" is already registered");else{if(!Lyte._keywords.is(e)){var r=t;Lyte.registeredServices[e]=r;var o=Lyte.requiredServices[e];return o&&o.size&&o.forEach((function(o){var n=r;o.isGlobal&&(n=Lyte.__gS[o.key]=Lyte.__gS[o.key]||new t(o.data)),o.cB(n,o.key,o.name,e)})),r}Lyte.warn("Service name-"+e+" should not be a keyword used in Lyte")}},Lyte.Service.getInjected=function(e){if(Lyte.__gS.hasOwnProperty(e))return Lyte.__gS[e]},Lyte.$.requiredServices=function(e,t,r,o,n,i,a){var s=Lyte.requiredServices[t]||(Lyte.requiredServices[t]=new Map),l=Lyte.$.genMapId(s);return s.set(l,{key:e,cB:r,type:o,name:n,serviceName:t,isGlobal:i,data:a}),t+"-"+l},Lyte.$.lazyRegisterService=function(e,t){var r=t.scope,o=t.name,n=r[t.type][o];n&&(n[t.key]=e)},Lyte.$.injectServices={},Object.defineProperty(Lyte,"__gS",{value:{}}),Lyte.injectServices=function(e){var t={};Array.isArray(e)||(e=[e]),e.forEach((function(e){if(e&&"object"==(void 0===e?"undefined":_typeof(e))){var r=e.as,o=e.service,n=e.data;Lyte._keywords.is(r)?Lyte.warn("Service cannot be used in any keywords of Lyte."):Lyte.toBeInjectedServices.hasOwnProperty(r)?Lyte.warn("A service has already been injected in the key named, ",r):(Lyte.toBeInjectedServices[r]=o,t[r]={service:o,data:n},Lyte.registeredServices[o]&&(Lyte.__gS[r]=new Lyte.registeredServices[o](n)))}else"string"==typeof e?Lyte.toBeInjectedServices.hasOwnProperty(e)?Lyte.warn("A service has already been injected in the key named, ",e):(Lyte.toBeInjectedServices[e]=e,t[e]={service:e},Lyte.registeredServices[e]&&(Lyte.__gS[e]=new Lyte.registeredServices[e])):Lyte.warn("Invalid data passed to injectServices",e)}));var r=Lyte.$.injectServices;for(var o in r)for(var n in t)r[o](n,t[n].service,o,Lyte.__gS[n],void 0,t[n].data)},Lyte.$.genMapId=function(e){for(var t=Math.floor(1e10*Math.random()+1);e.get(t);)t=Math.floor(1e10*Math.random()+1);return t.toString()},Lyte.$.toRemoveFromRequiredServices=function(e){var t=e.split("-"),r=t[t.length-1],o=r.length,n=e.substr(0,e.length-(o+1)),i=Lyte.requiredServices[n];i&&i.delete(r)},Lyte.toBeUsedServices=function(e){var t={},r=e.services;return r&&r.forEach((function(r){if("string"==typeof r)t[r]=r;else if(r&&"object"==(void 0===r?"undefined":_typeof(r))){var o=r.as,n=r.service;Lyte._keywords.is(o,e.type)?Lyte.warn("Service cannot be used in any keywords of Lyte."):t[o]=n}})),t},Lyte.extendService=function(e){var t,r=Lyte.toBeUsedServices(e);for(var o in r)if(t=r[o],e.isGlobal&&Lyte.__gS.hasOwnProperty(o)||!e.isGlobal&&Lyte.registeredServices.hasOwnProperty(t)){var n=e.ins;e.isGlobal?Lyte.__gS[o]:new Lyte.registeredServices[t],Array.isArray(n)||(n=[e.ins]),n.forEach((function(r){r[o]=e.isGlobal?Lyte.__gS[o]:new Lyte.registeredServices[t]}))}else Lyte.$.requiredServices(o,t,e.callback,e.type,e.name,e.isGlobal,e.data)},Lyte.$.requiredMixins=function(e,t,o){var n=r[e]?r[e]:r[e]={};n[o]?n[o].push(t):n[o]=[t]},Lyte.Mixin.exists=function(e){return!!Lyte.registeredMixins[e]},Lyte.log=function(e,t,r){Lyte.debug&&(r?console.log("%c"+e,"color:"+r):console.log(e))},Lyte.time=function(e){var t;Lyte.performance&&(-1!=(t=Lyte.$.consoleTime.indexOf(e))?(Lyte.$.consoleTime.splice(t,1),console.timeEnd(e)):(Lyte.$.consoleTime.push(e),console.time(e)))},Lyte.isRecord=function(e){return!!(e&&e.$&&e.$.hasOwnProperty("isModified"))},Lyte.isComponent=function(e){return!!(e&&e.$node&&e.__data)},Lyte.$.reqFiles={},Lyte.injectResources=function(e,t,r,n){var i=[],a=[];return t=t||function(){},r=r||function(){},new Promise((function(l,d){!function e(r,n){if(r){Array.isArray(r)||(r=[r]),r.length||n();var i=-r.length;r.forEach((function(r){"string"==typeof r?function(e,r,n){Lyte.$.reqFiles[e]?Lyte.$.reqFiles[e].push(n):(Lyte.$.reqFiles[e]=[n],r&&"error"!=r.event.type?(-1!=Lyte.removeFromCache.arr.indexOf(e)&&Lyte.removeFromCache.arr.splice(Lyte.removeFromCache.arr.indexOf(e),1),s.call(r.tag,e,r.event,!0),n()):function(e,r){var n,i=t.internal||{},a=o(e);i.file=e,null!=a?((n=document.createElement("link")).setAttribute("href",e),i.tag=n,".css"==a?n.setAttribute("as","style"):n.setAttribute("as","script"),n.setAttribute("rel","preload"),n.onerror=n.onload=function(e){r.call(this,e),this.onerror=this.onload=void 0},Lyte.triggerEvent("onBeforeInject",i),Lyte.$.assetsDiv.appendChild(n)):Lyte.error("Type of file is not specified in injectResources.")}(e,(function(r){Lyte.injectResources.respObj[e]=this,Lyte.$.reqFiles[e].forEach((function(e){e()})),s.call(this,e,r),t.call(this,r)})))}(r,Lyte.injectResources.availableTags[r],(function(){a()})):Array.isArray(r)?new Promise((function(t){e(r,t)})).then((function(){a()})):(i--,new Promise((function(t){e(r.parent,t)})).then((function(){a()})),new Promise((function(t){e(r.child,t)})).then((function(){a()})))}))}else n();function a(){0==++i&&n()}function s(e,t,r){delete Lyte.$.reqFiles[e],r||(Lyte.injectResources.availableTags[e]&&(Lyte.injectResources.availableTags[e].tag.remove(),delete Lyte.injectResources.respObj[e]),Lyte.injectResources.availableTags[e]={tag:this,event:t,type:t.type})}}(e,function(){n&&n.defer?(n.defer({injectJS:s,files:e,errorFiles:a}),l()):s(e,(function(){r(i,a),a.length?d(i,a):l(i,a)}))}.bind(this))}));function s(e,t,r){if(r=r||[],e){Array.isArray(e)||(e=[e]),e.length||t(i,a);var n=-e.length;e.forEach((function(e){if("string"==typeof e){var t=o(e);!t||".js"!=t&&".css"!=t||-1!=r.indexOf(e)?l():(r.push(e),function(e,t){var r=Lyte.injectResources.respObj[e];if(Lyte.injectResources.availableTags[e]&&"preload"!=Lyte.injectResources.availableTags[e].tag.getAttribute("rel")){var n=Lyte.injectResources.availableTags[e];"error"==n.type?a.push(n.event):i.push(n.event),t()}else{var s,l=o(e);".js"==l?((s=document.createElement("script")).setAttribute("type","text/javascript"),s.setAttribute("src",e)):".css"==l&&((s=document.createElement("link")).setAttribute("type","text/css"),s.setAttribute("rel","stylesheet"),s.setAttribute("href",e)),r.getAttributeNames().forEach((function(e){-1==["href","as","rel"].indexOf(e)&&s.setAttribute(e,r.getAttribute(e))})),delete Lyte.injectResources.respObj[e],s.onerror=s.onload=function(r){"error"==r.type?a.push(r):i.push(r),Lyte.injectResources.availableTags[e].tag.remove(),Lyte.injectResources.availableTags[e]={tag:s,event:r,type:"error"==r.type?"error":"load"},t(),s.onerror=s.onload=void 0},Lyte.$.assetsDiv.appendChild(s)}}(e,(function(){l()})))}else Array.isArray(e)?s(e,(function(){l()})):(n--,s(e.parent,(function(){s(e.child,(function(){l()})),l()})))}))}else t(i,a);function l(){0==++n&&t(i,a)}}},Lyte.injectResources.availableTags=[],Lyte.injectResources.respObj=[],Lyte.$.replaceOldInjectResource=function(){Lyte.injectResources=function(e,t,r){var n=[],i=[];return t=t||function(){},r=r||function(){},new Promise((function(r){!function e(r,a){if(r){Array.isArray(r)||(r=[r]),r.length||a();var s=-r.length;r.forEach((function(r){"string"==typeof r?function(e,r,a){Lyte.$.reqFiles[e]?Lyte.$.reqFiles[e].push(a):(Lyte.$.reqFiles[e]=[a],r&&"error"!=r.event.type?(-1!=Lyte.removeFromCache.arr.indexOf(e)&&Lyte.removeFromCache.arr.splice(Lyte.removeFromCache.arr.indexOf(e),1),d.call(r.tag,r.event,!0),a()):function(e,r){var a=o(e);if(tag=document.createElement({".js":"script",".css":"link"}[a]),a){".css"==a?(tag.setAttribute("href",e),tag.setAttribute("type","text/css"),tag.setAttribute("rel","stylesheet")):tag.setAttribute("src",e),tag.onerror=tag.onload=function(e){"error"==e.type?i.push(e):n.push(e),r&&r.call(this,e)};var s=t.internal||{};s.file=e,s.tag=tag,Lyte.triggerEvent("onBeforeInject",s),Lyte.$.assetsDiv.appendChild(tag)}else Lyte.error("Type of file is not specified in injectResources.")}(e,(function(r){Lyte.$.reqFiles[e].forEach((function(e){e()})),d.call(this,r),t.call(this,r)})))}(r,Lyte.injectResources.availableTags[r],(function(){l()})):Array.isArray(r)?new Promise((function(t){e(r,t)})).then((function(){l()})):new Promise((function(t){e(r.parent,t)})).then((function(){new Promise((function(t){e(r.child,t)})).then((function(){l()}))}))}))}else a();function l(){0==++s&&a()}function d(e,t){var r=this.getAttribute("src")||this.getAttribute("href");delete Lyte.$.reqFiles[r],t||(Lyte.injectResources.availableTags[r]&&Lyte.injectResources.availableTags[r].tag.remove(),this.onerror=this.onload=void 0,Lyte.injectResources.availableTags[r]={tag:this,event:{type:e.type}})}}(e,r)})).then((function(){r(n,i)}))},Lyte.injectResources.availableTags=[],Lyte.injectResources.respObj=[]},Lyte.removeFromCache=function(e){Lyte.removeFromCache.assign(e),Lyte.removeFromCache.arr.length&&(Lyte.removeFromCache.arr.forEach((function(e){Lyte.injectResources.availableTags[e]&&(Lyte.injectResources.availableTags[e].tag.remove(),delete Lyte.injectResources.availableTags[e],delete Lyte.injectResources.respObj[e])})),Lyte.removeFromCache.arr=[])},Lyte.removeFromCache.arr=[],Lyte.removeFromCache.assign=function(e){e="*"==e?Object.keys(Lyte.injectResources.availableTags):Array.isArray(e)?e:[e],Lyte.removeFromCache.arr=Lyte.removeFromCache.arr.concat(e)},Lyte.$.prefetchSupport=!1;try{if(!Lyte.browser.ie){var n=document.createElement("link");Lyte.$.prefetchSupport=n.relList.supports("prefetch")&&n.relList.supports("preload")}}catch(e){}function i(){Lyte.assetsDivContainer.appendChild(Lyte.$.assetsDiv)}Lyte.$.prefetchSupport||(console.log("Prefetch is not supported. Falling back to old implementation"),Lyte.$.replaceOldInjectResource()),Lyte.checkProperty=function(e,t,r,o,n,i,a,s,l){switch(e){case"type":if(Lyte.Transform.hasOwnProperty(o)&&null!=t){var d=Lyte.Transform[o],c=!0;if(Array.isArray(t)){if("array"!=Lyte.Transform[o].extends)return{code:"ERR03",message:Lyte.errorCodes.ERR03,expected:o};d.hasOwnProperty("items")&&(c=Lyte.checkProperty("items",t,r,d.items))}else if("object"===(void 0===t?"undefined":_typeof(t))&&"object"==Lyte.Transform[o].extends&&d.hasOwnProperty("properties"))c=Lyte.checkProperty("properties",t,r,d.properties);else if(Lyte.Transform[o].extends!=(void 0===t?"undefined":_typeof(t)))return{code:"ERR03",message:Lyte.errorCodes.ERR03,expected:o};if(!0!==c)return c}else if(null!=t)if(Array.isArray(t)){if("array"!=o)return{code:"ERR03",message:Lyte.errorCodes.ERR03,expected:o}}else if(o!=(void 0===t?"undefined":_typeof(t)))return{code:"ERR03",message:Lyte.errorCodes.ERR03,expected:o};break;case"mandatory":var p=o;if("object"==(void 0===o?"undefined":_typeof(o))&&l&&1==o.skipValidationOnInit&&(p=!1),p&&(null==t||null==t||""===t))return{code:"ERR02",message:Lyte.errorCodes.ERR02};break;case"maximum":if("number"==typeof t&&t>o)return{code:"ERR04",message:Lyte.errorCodes.ERR04,expected:o};break;case"minimum":if("number"==typeof t&&t<o)return{code:"ERR05",message:Lyte.errorCodes.ERR05,expected:o};break;case"maxLength":case"maxItems":if(t&&t.length>o)return{code:"ERR06",message:Lyte.errorCodes.ERR06,expected:o};break;case"minLength":case"minItems":if(t&&t.length<o)return{code:"ERR07",message:Lyte.errorCodes.ERR07,expected:o};break;case"pattern":if("string"==typeof t&&!new RegExp(o).test(t))return{code:"ERR08",message:Lyte.errorCodes.ERR08,expected:o};break;case"uniqueItems":if(Array.isArray(t)&&o)for(var u=[],f=0;f<t.length;f++){var h=t[f];if(-1!=u.indexOf(h))return{code:"ERR09",message:Lyte.errorCodes.ERR09};u.push(h)}break;case"constant":if(Array.isArray(t)){if(!(_=t.length==o.length&&t.every((function(e,t){return e===o[t]}))))return{code:"ERR10",message:Lyte.errorCodes.ERR10,expected:o}}else if("object"==(void 0===t?"undefined":_typeof(t))){if(!(_=store.adapter.$.compareObjects(t,o)))return{code:"ERR10",message:Lyte.errorCodes.ERR10,expected:o}}else if(t&&t!=o)return{code:"ERR10",message:Lyte.errorCodes.ERR10,expected:o};break;case"items":if(Array.isArray(t))for(f=0;f<t.length;f++){o.any&&Array.isArray(o)||(o=[o]);for(var y=o.length,v=(c=!0,0);v<y;v++)for(var e in d=o[v])if(!0!==(_=Lyte.checkProperty(e,t[f],f,d[e],d))){!0===c&&(_.path=_.path?f+"."+_.path:_.path,c=_);break}if(!0!==c)return c}break;case"properties":if("object"==(void 0===t?"undefined":_typeof(t))&&!Array.isArray(t))for(var r in t)if(o.hasOwnProperty(r)){var m=o[r];for(m.any&&Array.isArray(m)||(m=[m]),y=m.length,c=!0,f=0;f<y;f++)for(var e in d=m[f])if(1!=(_=Lyte.checkProperty(e,t[r],r,d[e],d))){!0===c&&(_.path=_.path?r+"."+_.path:r.toString(),c=_);break}if(!0!==c)return c}else if(n.exact)return{code:"ERR29",message:Lyte.errorCodes.ERR29,property:r};break;case"validation":var _;if(1!=(_=Lyte.customValidator[o].apply(i,[r,t,s])))return _;break;case"instanceof":if(!("object"!==(void 0===t?"undefined":_typeof(t))||Array.isArray(t)||t instanceof o))return{code:"ERR30",message:Lyte.errorCodes.ERR30,property:r,instanceof:o}}return!0},Lyte.checkNestedProp=function(e,t,r,o,n,i,a,s){var l;if(0!=t.length){if("array"==r.type)r.items&&!isNaN(t[0])&&"object"==_typeof(r.items)&&(t=t.slice(1),Lyte.checkNestedProp(e,t,r.items,o,n,i,a,s));else if("object"==r.type&&r.properties&&r.properties.hasOwnProperty(t[0])){var d=t[0];t=t.slice(1),Lyte.checkNestedProp(e,t,r.properties[d],o,n,i,a,s)}}else if(r.properties||r.items){var c={__data:{}};r.properties?c.__data[i]=r.properties[i]:c.__data[i]=r;var p=Lyte.validate(n,i,a,c);if(p&&"object"==(void 0===p?"undefined":_typeof(p))&&p.code)p.value=a,p.path=o.path,o.Error&&o.Error[o.key]?o.Error[o.key].code&&o.Error[o.key].nested?o.Error[o.key].nested:o.Error[o.key].nested={}:o.Error[o.key]={code:p.code,message:p.message,nested:{}},l=o.Error[o.key].nested,o.path.split(".").forEach((function(e){l=l&&!l[e]?l[e]={}:l[e]})),o.index?l[o.index]=p:l[i]=p,n.$&&n.$.error?n.$.error=l:n.$={error:l},Object.defineProperty(n,"$",{enumerable:!1,writable:!1});else if(!p&&n.$&&(n.$.error[i]||o.index&&n.$.error[o.index])){l=o.Error[o.key].nested||void 0;var u=o.index||i;delete n.$.error[u];var f=!0,h=o.path.split(".");o.index&&h.push(o.index),h.forEach((function(e){l[e]&&l[e].code&&(f=!1),l=l[e]})),1==f&&o.Error[o.key]&&delete o.Error[o.key]}s.value=p}},Lyte.types=["string","object","number","boolean","array"],Lyte.attr=function(e,t){var r={};if(r.type=e,null==t&&(t={}),-1==this.types.indexOf(e)&&!Lyte.Transform.hasOwnProperty(e))throw new Error("Not a valid field type - "+e);return Object.assign(r,t),r},Lyte.defineRelation=function(e,t,r){var o={type:"relation",relType:t,relatedTo:e};return r&&(o.opts=r),o},Lyte.belongsTo=function(e,t){return this.defineRelation(e,"belongsTo",t)},Lyte.hasMany=function(e,t){return this.defineRelation(e,"hasMany",t)},Lyte.Transform={},Lyte.customValidator={},Lyte.registerDataType=function(e,t){this.Transform.hasOwnProperty(e)?Lyte.error("Custom Field Type - "+e+" -  already exists."):null!=t.extends&&-1!=Lyte.types.indexOf(t.extends)?this.Transform[e]=t:Lyte.error("Not a valid field type - "+t.extends)},Lyte.registerValidator=function(e,t){this.customValidator.hasOwnProperty(e)?Lyte.error("Custom Validator with name - "+e+" - already exists"):this.customValidator[e]=t},Lyte.patterns={email:/^([A-Za-z0-9._%\-'+/]+@[A-Za-z0-9.-]+\.[a-zA-Z]{2,22})$/,url:/(^(ht|f)tp(s?):\/\/[0-9a-zA-Z][-.\w]*(:[0-9])*(\/?)([a-zA-Z0-9\-.?,:'/\\+=&amp;%$#_[\]@!()*;~]*)?$)/,ampm:/^(AM|PM|am|pm)$/,hour:/^(0?[0-9]|1[0-9]|2[0-4])$/,minute:/^(0?[0-9]|[1-5][0-9]|60)$/,boolean:/^(true|false|TRUE|FALSE)$/,alphaNumeric:/([a-zA-Z0-9])+/,alphabetsOnly:/([a-zA-Z])+/,numeric:/([0-9])+/,phoneNo:/^[0-9a-zA-Z+.()\-;\s]+$/},Lyte.validate=function(e,t,r,o,n){var i=o.__data[t],a=!1,s=i?i.type:void 0,l=i;if(l){l.any&&Array.isArray(l)||(l=[l]);for(var d=l.length,c=!0,p=0;p<d;p++){var u=l[p];for(var f in u)!0!==(a=Lyte.checkProperty(f,r,t,u[f],u,e,s,void 0,n))&&!0===c&&(c=a)}if(!0!==c)return c}return!1},Lyte.registerPattern=function(e,t){this.patterns[e]=t},Lyte.errorCodes={ERR01:"Primary key cannot be modified",ERR02:"Mandatory field cannot be empty",ERR03:"Type of value does not match the specified data type",ERR04:"Value is greater than the maximum value allowed",ERR05:"Value is less than the minimum value allowed",ERR06:"Length of string/array is greater than the maximum limit allowed",ERR07:"Length of string/array is less than the minimum limit allowed",ERR08:"String does not match the specified pattern",ERR09:"Values in array are not unique",ERR10:"Value is not equal to the specified constant",ERR11:"Model of related field is not defined",ERR12:"Model of backward relation is not defined",ERR13:"Record not found",ERR14:"Model does not match the related field model",ERR15:"Error in creating a record as a relation",ERR16:"Record with primary key already exists",ERR17:"Value cannot be changed because record has been deleted",ERR18:"Action not defined",ERR19:"Model not defined",ERR20:"Key not specified",ERR21:"'belongsTo' relationship expects a single object/id",ERR22:"Type not specified for polymorphic relation",ERR23:"Primary Key value not present",ERR24:"Error while relating record",ERR25:"Backward relation not present",ERR26:"Primary key value cannot be undefined or null",ERR27:"Observer can observe only string data type value, '{0}' value cannot be observed in the function named '{1}' in the component '{2}'",ERR28:"Unloaded record cannot be saved",ERR29:"Property not defined in the object",ERR30:"Error in variables declaration for Query",ERR31:"Query not registered for the Model",ERR32:"Property not defined in the object",ERR33:"Property's value is not an instanceof the mentioned class"},Lyte.registeredGlobalEvents=Lyte.__lyteRegisteredEvents={},Lyte.triggerEvent=function(){var e=Array.prototype.slice.call(arguments,1),t=arguments[0],r=!1,o=this.__lyteRegisteredEvents[t];if(o)for(var n=0;n<o.listeners.length;n++){var i=o.listeners[n];if(i&&!1===i.apply(this,e)){r=!0;break}}else o=this.__lyteRegisteredEvents[t]={listeners:[]};var a=new CustomEvent(t,{detail:e});r||document.dispatchEvent(a)},Lyte.addEventListener=function(e,t){if("function"==typeof t){var r=this.__lyteRegisteredEvents[e];return r||(r=this.__lyteRegisteredEvents[e]={listeners:[]}),e+"-"+(r.listeners.push(t)-1)}Lyte.error("Second parameter to Lyte.Component.addGlobalEventListener() must be a function")},Lyte.removeEventListener=function(e){if(e){var t=e.split("-"),r=this.__lyteRegisteredEvents[t[0]];r&&r.listeners[t[1]]?r.listeners[t[1]]=null:Lyte.error("No such listener registered")}else Lyte.error("listener unique id not specified")},Lyte.extendEventListeners=function(e){e&&"object"==(void 0===e?"undefined":_typeof(e))&&!e.hasOwnProperty("__lyteRegisteredEvents")&&Object.defineProperties(e,{__lyteRegisteredEvents:{value:{}},addEventListener:{value:Lyte.addEventListener},removeEventListener:{value:Lyte.removeEventListener},triggerEvent:{value:Lyte.triggerEvent}})},Lyte.deepCopyObject=function(e){for(var t,r,o,n,i,a,s=[{source:e,target:Array.isArray(e)?[]:Object.create(Object.getPrototypeOf(e))}],l=[e],d=s[0].target,c=[d];t=s.shift();){for(r=Object.keys(t.source),o=0;o<r.length;o++)(n=Object.getOwnPropertyDescriptor(t.source,r[o]))&&(n.value&&"object"==_typeof(n.value)?(i=n.value,n.value=Array.isArray(i)?[]:i instanceof Set?new Set:Object.create(Object.getPrototypeOf(i)),-1==(a=l.indexOf(i))?(l.push(i),c.push(n.value),Object.defineProperty(t.target,r[o],n),s.push({source:i,target:n.value})):(n.value=c[a],Object.defineProperty(t.target,r[o],n))):Object.defineProperty(t.target,r[o],n));Lyte.isRecord(t.source)&&(Object.defineProperty(t.target,"$",{value:{}}),t.target.$.isNew=t.source.$.isNew,t.target.$.isModified=t.source.$.isModified,t.target.$.isDeleted=t.source.$.isDeleted,t.target.$.pK=t.source.$.pK,t.target.$._attributes=t.source.$._attributes,t.target.$.isCloned=!0,t.target.$.model={_name:t.source.$.model._name},t.source.$.hasOwnProperty("deepNest")&&(t.target.$.deepNest=t.source.$.deepNest),t.source.$.hasOwnProperty("partialType")&&(t.target.$.partialType=t.source.$.partialType)),Array.isArray(t.source)&&t.source.partial&&Object.defineProperty(t.target,"partial",{value:t.source.partial})}return d},Lyte.nestScpId=1,Lyte.nestScp={},Lyte.__nestRef__={},Lyte.__nestScp__=new Map,Lyte.establishObjectBinding=function(e,t,r,o,n,i){var a,s,l,d=e.__component__&&e.__component__.component.__data?e.__component__.component.__data[t]:void 0;if(r){if(e&&!e.$&&e._scp?Array.from(e._scp.keys()).forEach((function(e){var t=Lyte.nestScp[e];a=store.modelFor(t.model)})):a=e.$.model,!(s=a?a.fieldList[t]:void 0))return;d=s}if(o&&e._scp&&e._scp.size&&Array.from(e._scp.keys()).forEach((function(r){var o=e._scp.get(r).paths;for(var n in o){var a=n?n.split("."):[];a.push(t),Lyte.bindObj(e,t,r,a,new Map,void 0,d,i)}})),(!r||s.watch||s.properties||s.items||i)&&e[t]){var c;e&&e.__component__?(e.__component__.__scpObj||Object.defineProperty(e.__component__,"__scpObj",{value:{}}),e.__component__,c=e.__component__.__scpObj):Lyte.isRecord(e)&&(e.$.__scpObj||Object.defineProperty(e.$,"__scpObj",{value:{}}),c=e.$.__scpObj);var p=c;if(c){var u=!1,f=!1;if(r)if(e[t]&&!Lyte.__nestScp__.has(e[t]))l={model:a._name,attr:t,pK:e.$.pK},u=!0;else{var h=Lyte.__nestScp__.get(e[t]),y=Lyte.__nestRef__[h]=Lyte.__nestRef__[h]||new Map,v=Lyte.$.genMapId(y);y.set(v,!0),Lyte.setRecBindMap(Lyte.nestScp[h],{model:a._name,attr:t,pK:e.$.pK}),p[t]=h+"_"+v}else e[t]&&!Lyte.__nestScp__.has(e[t])?(l={data:e[t],dtype:e.__component__.component.__data[t],key:t,Error:e.__component__.component.data.errors},f=!0):(h=Lyte.__nestScp__.get(e[t]),y=Lyte.__nestRef__[h]=Lyte.__nestRef__[h]||new Map,v=Lyte.$.genMapId(y),y.set(v,!0),p[t]=h+"_"+v);if(l){var m=Lyte.nestScpId++;y=Lyte.__nestRef__[m]=Lyte.__nestRef__[m]||new Map,v=Lyte.$.genMapId(y),y.set(v,!0),Lyte.__nestScp__.set(e[t],m),u&&(Lyte.nestScp[m]={},Lyte.setRecBindMap(Lyte.nestScp[m],l)),f&&(Lyte.nestScp[m]=l),Lyte.nestScp[m]._data=e[t],p[t]=p[t]||m+"_"+v,Lyte.bindObj(e,t,m,[],new Map,void 0,d,i)}}}},Lyte.removeNestScp2Bind=function(e,t){if((e=e.model).has(t.model)){var r=e.get(t.model);if(r.has(t.pK)){var o=r.get(t.pK);o.has(t.attr)&&o.delete(t.attr),o.size||r.delete(t.pK)}r.size||e.delete(t.model)}},Lyte.setRecBindMap=function(e,t){var r=e.model=e.model||new Map,o=t.model,n=t.pK,i=t.attr;o&&!r.has(o)&&r.set(o,new Map),r=r.get(o),n&&!r.has(n)&&r.set(n,new Map),r=r.get(n),i&&!r.has(i)&&r.set(i,!0)},Lyte.bindObj=function(e,t,r,o,n,i,a,s){n=n||new Map;var l,d=null!=t?e[t]:e,c=!1;if(o.length||Lyte.__nestScp__.get(e)!==r||delete Lyte.nestScp[r].cyclic,o.length>1&&d&&Lyte.nestScp[r]&&Lyte.nestScp[r].hasOwnProperty("data")&&Lyte.nestScp[r].data===d)return n.get(d)&&(c=!0),void(Lyte.checkAndAddBind(d,r,o,c)&&Lyte.estObjScp(d,r,o,c));if(a&&(a.hasOwnProperty("items")||a.hasOwnProperty("properties")?l=a.items||a.properties:null==s&&1==a.watch&&(s=a.watch)),l=s?void 0:l,Array.isArray(d))n.get(d)?c=!0:(n.set(d,!0),d.forEach((function(e,t){o.push(t),(1==s||a&&a.hasOwnProperty("items")&&"object"==_typeof(a.items))&&Lyte.bindObj(d,t,r,o,n,void 0,l,s),o.pop()}))),Lyte.checkAndAddBind(d,r,o,c)&&Lyte.estObjScp(d,r,o,c);else if(d&&"object"==(void 0===d?"undefined":_typeof(d))){if(c=!1,n.get(d))c=!0;else for(var p in n.set(d,!0),d)o.push(p),(s||l&&l.hasOwnProperty(p))&&Lyte.bindObj(d,p,r,o,n,void 0,l?l[p]:void 0,s),o.pop();Lyte.checkAndAddBind(d,r,o,c)&&Lyte.estObjScp(d,r,o,c)}},Lyte.checkAndAddBind=function(e,t,r,o){return!e._scp||!e._scp.size||(!(e._scp.size&&e._scp.has(t)&&e._scp.get(t).paths.hasOwnProperty(r.join(".")))||(o&&(Lyte.nestScp[t].cyclic=!0),!1))},Lyte.estObjScp=function(e,t,r,o){e._scp||Object.defineProperty(e,"_scp",{value:new Map,enumerable:!1,configurable:!0});var n=e._scp;n.has(t)||n.set(t,{});var i=n.get(t);r=r?r.join("."):r,(i.paths=i.paths||{})[r]=!0;var a=Lyte.nestScp[t];a.cyclic||1!=o||(a.cyclic=!0)},Lyte.cmpObjs=function(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(var r in e){if(!t.hasOwnProperty(r))return!1;if(0==Lyte.cmpData(e[r],t[r]))return!1}return!0},Lyte.cmpData=function(e,t){if(Array.isArray(e)){if(!Array.isArray(t)||e.length!==t.length)return!1;if(e===t)return!0;for(var r=e.length,o=0;o<r;o++)if(0==Lyte.cmpData(e[o],t[o]))return!1}else{if(e&&t&&"object"==(void 0===e?"undefined":_typeof(e))&&"object"==(void 0===t?"undefined":_typeof(t)))return e===t||Lyte.cmpObjs(e,t);if(e!==t)return!1}return!0},Lyte.nestScpRmPath=function(e,t){if(e&&e.paths)for(var r in e=e.paths)r.startsWith(t+".")&&delete e[r]},Lyte.nestScpRemove=function(e,t,r){var o=e._scp;if(o&&o.size){if(r){Lyte.nestScpRmPath(o.get(t),r);var n=o.get(t),i=n?n.paths:void 0;i&&!Object.keys(i).length&&o.delete(t)}else o.delete(t);o.size||delete e._scp}},Lyte.rmNestScp=function(e,t,r,o,n){if(Array.isArray(e))r.get(e)||(r.set(e,!0),e.forEach((function(e,o){Lyte.rmNestScp(e,t,r,void 0,n)}))),Lyte.nestScpRemove(e,t,n);else if(e&&"object"==(void 0===e?"undefined":_typeof(e))){if(!r.get(e))for(var i in r.set(e,!0),e)Lyte.rmNestScp(e[i],t,r,void 0,n);Lyte.nestScpRemove(e,t,n)}},Lyte.removeNestScp=function(e,t,r,o,n,i,a,s){i=i||new Map,t=Number.parseInt(t);var l=Lyte.nestScp[t],d=Lyte.__nestRef__[t];s&&l.model&&Lyte.removeNestScp2Bind(l,s),n?(d&&d.has(r)&&d.delete(r),(!d||d&&!d.size)&&(delete Lyte.__nestRef__[t],Lyte.__nestScp__.has(e)&&Lyte.__nestScp__.delete(e),Lyte.rmNestScp(e,t,i,!0,o),a||delete Lyte.nestScp[t])):Lyte.rmNestScp(e,t,i,!0,o)},Lyte.resolvePromises=function(e){return"string"==typeof e||e instanceof Promise?e:Array.isArray(e)?function(e){var t=[],r=!1;return e.every((function(e,t){return!(e instanceof Promise||e&&!Array.isArray(e)&&"object"==(void 0===e?"undefined":_typeof(e))&&"function"==typeof e.then)||(r=!0,!1)})),r?new Promise((function(r,o){Promise.all(e).then((function(o){e.forEach((function(e,r){t[r]=o[r]})),r(t)}),(function(e){o(e),Lyte.error("Error on resolve promises",e)}))})):Promise.resolve(e)}(e):"object"==(void 0===e?"undefined":_typeof(e))?function(e){var t=[],r=[],o=Object.keys(e);if(o.forEach((function(o){var n=e[o];(n instanceof Promise||n&&!Array.isArray(n)&&"object"==(void 0===n?"undefined":_typeof(n))&&"function"==typeof n.then)&&(t.push(o),r.push(n))})),r.length){var n={};return new Promise((function(i,a){Promise.all(r).then((function(r){o.forEach((function(o){-1!=t.indexOf(o)?n[o]=r[t.indexOf(o)]:n[o]=e[o]})),i(n)}),(function(e){a(e),Lyte.error("Error on resolve promises",e)}))}))}return Promise.resolve(e)}(e):void 0},"complete"===document.readyState||"interactive"===document.readyState?i():document.addEventListener("DOMContentLoaded",(function(e){i()}),!0);var a=XMLHttpRequest.prototype.send;function s(e,t,r,o){var n=Lyte.__nodeXHRMap=Lyte.__nodeXHRMap||new Map,i=n.get(t);i||n.set(t,new Map),i=n.get(t);var a=t.lyteState=t.lyteState||[],s=o||r;-1==a.indexOf(s)&&a.push(s),t.setAttribute("lyte-state","");var d=i.get(e);if(d||(i.set(e,[]),d=i.get(e)),o)return d.push({state:o}),{target:t,event:e};d.push({isXHR:!0,xhr:r}),r.addEventListener("readystatechange",(function o(n){4==r.readyState&&(l(r,e,t),r.removeEventListener("readystatechange",o))}))}function l(e,t,r){var o=Lyte.__nodeXHRMap,n=o.get(r);if(n){var i=n.get(t);if(i&&i){var a=i,s=-1;if(a.every((function(t,r){return!(t&&t.isXHR&&t.xhr==e||"string"==typeof e&&t.state==e)||(s=r,!1)})),-1!=s){a.splice(s,1);var l=r.lyteState.indexOf(e);if(r.lyteState.splice(l,1),!a.length){n.delete(t);var d=r&&Array.isArray(r.lyteState)?r.lyteState.indexOf(e):-1;-1!=d&&r.lyteState.splice(d,1),r&&r.lyteState&&0==r.lyteState.length&&(r.lyteState=null,r.removeAttribute("lyte-state"))}n.size||o.delete(r)}}}}XMLHttpRequest.prototype.send=function(){var e,t=window.event,r=t?t.target:void 0;if(Lyte.getConfig("stateHandling"))if(t)e=t.type,/^(click|dblclick)$/.test(e)&&r&&r.getAttribute&&"false"!=r.getAttribute("lyte-state-handling")&&s(e,r,this);else{var o=Lyte&&Lyte.Router?Lyte.Router.getRouteInstance():void 0;if(o){var n=o.transition?o.transition.ev:void 0;n&&n.target&&n.target.getAttribute&&"false"!=n.target.getAttribute("lyte-state-handling")&&((Lyte.__transXHRMap=Lyte.__transXHRMap||new Map).set(o.transition,{currentAction:n,XHR:this}),s(n.type,n.target,this))}}a.apply(this,arguments)},Lyte.addEventListener("transitionStart",(function(e){var t=e.nextTrans;t&&e.prevTrans&&(window.event&&/^(click|dblclick)$/.test(window.event.type)?(t.ev=window.event,e.prevTrans.ev&&delete e.prevTrans.ev):409!=e.prevTrans.state&&308!=e.prevTrans.state||!e.prevTrans.ev||(t.ev=e.prevTrans.ev,delete e.prevTrans.ev))})),Lyte.addEventListener("afterRouteTransition",(function(e){if(e&&e.trans){var t=Lyte.__transXHRMap,r=!1;if(409==e.trans.state||308==e.trans.state){var o=window.event,n=e.trans.ev;if(!o||o&&n&&o!=n&&o.target==n.target&&o.type==n.type?e.trans.nested=!0:r=!0,t){var i=t.get(e.trans);i&&(l(i.XHR,i.currentAction.type,i.currentAction.target),t.delete(e.trans))}}else 200==e.trans.state&&(t&&t.delete(e.trans),r=!0);r&&e.trans.ev&&delete e.trans.ev}})),Lyte.addEventListener("beforeRouteTransition",(function(e){e&&e.prevTrans&&e.prevTrans.nested&&(e.trans.ev=e.prevTrans.ev,delete e.prevTrans.ev,e.trans.fromPrevTrans=!0)})),Lyte.setState=function(e){e||console.error("Please provide a state name");var t=window.event;if(/^(click|dblclick)$/.test(t.type)){var r=t.target;if(1==Lyte.getConfig("stateHandling")&&r&&r.getAttribute&&"false"!=r.getAttribute("lyte-state-handling")&&!r.getAttribute("lyte-state")){var o=Lyte.__stateMap=Lyte.__stateMap||new Map;if(o.get(e))console.error("There is already a open state by the name",e);else{var n=s(t.type,r,void 0,e);o.set(e,n)}}}},Lyte.removeState=function(e){e||console.error("Please provide a state name");var t=Lyte.__stateMap;if(t){var r=t.get(e);r&&(t.delete(e),l(e,r.event,r.target))}},Lyte.setConfig=function(e,t){(Lyte.__config=Lyte.__config||{})[e]=t},Lyte.getConfig=function(e){var t=Lyte.__config;if(t)return t[e]}}(),window.intervalTimerForPatch=setInterval((function(){try{window.store&&(store.$.validateJSON=function(e,t,r,o,n){var i=o?o.toValidate:void 0,a=i&&Object.keys(i).length?i:e.fieldList,s=!!e.extend;for(var l in t)if(!r||-1!=r.indexOf(l)){var d=a[l];if(d){if("relation"==d.type&&t[l]){var c=o&&o.toPartialAdd?o.toPartialAdd[l]:void 0;if(1!=(v=this.handleRelation(l,e,d,t,c,n)))return new error1(l,{code:v,data:t,message:Lyte.errorCodes[v]});"hasMany"!=d.relType||t[l].add||(store.$.defArrUtls(t[l]),store.$.defPolyUtls(t[l]),store.$.defUtls(t[l],store.model[d.relatedTo],t,l))}else if(d.type){var p=d;void 0===t[l]&&p.default&&(t[l]=store.$.getDefaultVal(t,p.default));var u=store.$.getDsrzEmpData(d,e._name),f=!u&&t[l];t.hasOwnProperty(l)&&(f||u)&&Lyte.Transform.hasOwnProperty(p.type)&&Lyte.Transform[p.type].hasOwnProperty("deserialize")&&(t[l]=Lyte.Transform[p.type].deserialize(t[l],l,e._name,store.$.getpKVal(t,e))),"boolean"==d.type&&!0!==(v=Lyte.checkProperty("type",t[l],l,d.type,t,void 0,Lyte.isRecord(t)?t.$.model._name:void 0))&&Lyte.error("Boolean Validation failed for property-"+l+" of model-"+e._name)}}else if(s){var h=store.modelFor(e.extend),y=h.fieldList[l];if(y&&"relation"==y.type){var v;if(c=o&&o.toPartialAdd?o.toPartialAdd[l]:void 0,1!=(v=this.handleRelation(l,h,y,t,c)))return new error1(l,{code:v,data:t,message:Lyte.errorCodes[v]});"hasMany"!=y.relType||t[l].add||(store.$.defArrUtls(t[l]),store.$.defPolyUtls(t[l]),store.$.defUtls(t[l],h,t,l))}}}return t},clearInterval(window.intervalTimerForPatch))}catch(e){}}),10),function(e){Lyte.Router=new function(t){var r,o,n,i,a,s,l,d,c,p,u,f="function",h="route",y="pending",v="completed",m="aborted",_="parseRouteMapping",g="constructRunLoop",b="RouteTransition",L="getDependencies",A="getResources",$="beforeModel",E="model",T="afterModel",R="redirect",O="renderTemplate",w="afterRender",S="beforeExit",C="didDestroy",P="willTransition",k="didTransition",N="onError",x="beforeLoad",j="onBeforeLoad",D="beforeRouteTransition",I="afterRouteTransition",B="resources",M="dependencies",F="lt-prop",K="start-from",H=F+"-"+h,q=F+"-fragment",U=F+"-dp",z=F+"-qp",V=F+"-td",G=F+"-trans",W="refresh-"+h,J=F+"-"+W,Y="link-to",Q="LINK-TO",X="stateChange",Z=O+" hook should return either component or HTML. Rendering of HTML directly into the DOM within the "+O+" hook is deprecated.",ee="MediumOrchid",te=Lyte.time,re=Lyte.log,oe=JSON.parse,ne=this,ie=document,ae=ie.location,se={routeHash:{},urlCache:{},stickyRoutes:{},allLinks:{},activeLinkTags:[]},le=!0,de=!1,ce=ge()?ge().index:0,pe=!1,ue=function(){},fe={},he={getResources:B,getDependencies:M};function ye(e,t,r,o,n){t&&("object"!=(void 0===t?"undefined":_typeof(t))||Array.isArray(t)?Ze.call(this,{stopTrans:!0,err:Error(ft(203)).stack,instance:r,hook:o,index:n}):e.setData(t))}function ve(e,t){var r=(t=t||n).routes[e];return{queryParams:r.__ltp.queryParams,dynamicParam:r.__ltp.dynamicParam}}function me(e){return!e.aborted&&!e.paused}function _e(t){var r=t.replace?"replaceState":"pushState",o=se.history?ct(ke(t.url,!0)):"#"+(se.slashAfterHash?ct(t.url):"/"==t.url[0]&&t.url.length>1?t.url.substring(1,t.url.length):t.url);t.title=t.title||ie.title;var n=[t.state,t.title];o&&n.push(o),e.history[r].apply(history,n)}function ge(){return history.state&&history.state.meta}function be(){return history.state&&history.state.data}function Le(){!se.deferInit&&ne.init&&ne.init()}function Ae(e){var t;return ge()&&(t=ge().url)||(t=se.history?Ce():Pe((e&&e.newURL||ae.hash).replace(/.*#/,""))),t}function $e(e,t){if(2!=e.button&&!e.defaultPrevented){var r=t||e.currentTarget;if("A"!==r.children[0].tagName||!(1==e.ctrlKey||1==e.metaKey||2==e.which||r.children[0].hasAttribute("target")&&"_self"!==r.children[0].getAttribute("target"))){e.preventDefault();var o=Object.assign({},r.matched);o.route=Array.isArray(o.route)?o.route.join("."):o.route;var n,i=r.ltProp.replace||r.hasAttribute("lt-prop-replace"),a=ne[i&&"false"!=i?"replaceWith":"transitionTo"](r.matched),s={};if(n=r.getAttribute(G))try{s=oe(n)}catch(e){ht(498,G,t.outerHTML)}var l=r.getAttribute(V);if(l=l||s.data){if("string"==typeof l)try{l=oe(l)}catch(e){ht(498,V,t.outerHTML)}s.data=l}for(var d in s)a[d]=s[d]}}}function Ee(e,t){if(e.length)for(var r,o=0;r=e[o];o++)if(r!=t[o])return!1;return!0}function Te(e){return{route:e.route.join("."),fragment:e.fragment,dynamicParams:e.dynamicParams.filter(Oe),queryParams:e.queryParams}}function Re(e){return e.split(".").filter((function(e){return""!=e}))}function Oe(e){return null!=e}function we(e){te(_);var t=se.routes?se.routes:se.routes={},r={},o=[],n=[];return d={route:function(e,i,a){if("object"==(void 0===i?"undefined":_typeof(i))){if(i.path){if(lt(i.path,"?")){var s=i.path.split("?");i.defQP=at(s[1]),i.path=s[0]||"/"}}else i.path=ct(e);i.queryParams&&(i.defQP=i.queryParams)}else(void 0===i?"undefined":_typeof(i))==f&&(a=i),i={path:ct(e)};if(r=Fe(o,se.routeHash)[i.path]={__lp:{}},"/"==i.path)o.push("/");else{var l=i.path;(wt(l)||St(l))&&pt(l).every((function(e,t,o){if(wt(e)||St(e)){var n;if(wt(e))n=e.replace(":","");else{n=e.replace("*",""),i.wildcard=r.__lp.wildcard=!0,i.sufix=r.__lp.sufix=[];for(var a,s=t+1;a=o[s];s++)r.__lp.sufix.push(a)}return i.dkey=r.__lp.dkey=n,i.dIndex=r.__lp.dIndex=t,!1}return!0})),o.push(l)}var d=Fe(n,t)||t;n.push(e),r.__lp.route=Array.from(n),d[e]?Object.assign(d[e].__lp,i):d[e]={__lp:i},a&&a.call(this,{}),n.pop(),o.pop()}},e.call(d,{}),te(_),t}function Se(e){if(!ne.init){var t,o=e.matched;e.currRoute=t=o.route.join("."),o.refreshRoute&&i.info.route,r={replace:o.replace||!(!o.refreshRoute||!ne.checkIfSameRoute(Te(e.matched),Te(i.matched)))||o.replace,title:n?n.title:ie.title,fromHistory:!1};var s=function(e){var t=Ne(e.matched);return t&&(e.path=r.url=t,je(t,It(e))),t}(e);return s&&a?(re("Transitioning to "+t+" "+s,h),a._trans):(re("Transition failed"),{})}ht(405)}function Ce(){if(se.history){var e=Pe(ae.pathname+ae.search+(ae.hash||""));return ct(e=ke(e))}return ct(Pe(ae.hash.replace("#","")))}function Pe(e){return e||(e="/"),e}function ke(e,t){var r;if((r=se.baseURL)&&e){if(r=ct(r),0==e.indexOf(r)&&!t)return e.replace(r,"");if(t&&0!=e.indexOf(r))return r+e}return e}function Ne(e){if(e&&e.route){var t;Array.isArray(e.route)?t=e.route.join("."):e.route=Re(t=e.route),e.queryParams=e.queryParams||{},e.dynamicParams=e.dynamicParams||[],e.refreshModel=!1;for(var r,o,i=!!n,a=e.dynamicParams.length!=e.route.length,s=0,l=this.tagName==Q,d=se.routes,c=r="",p={},u=0,f=e.route.length;u<f;u++){if(o=e.route[u],i&&n.matched.route[u]!=o&&(i=!1),!(d=Fe(o,d))&&!d.__lp&&d.__lp.path)return ht(422,e.route,u),!1;var h=d.__lp.def;h||l||ht(422,e.route,u);var y,v=d.__lp.path;if(h&&h.__lp){if(h.queryParams){y=d.__lp.defQP;var m=h.__lp.qpdef;for(var _ in m)e.queryParams.hasOwnProperty(_)||(i&&m[_].sticky?e.queryParams[_]=n.routes[u].__ltp.queryParams[_]:y&&y.hasOwnProperty(_)&&(p[_]=e.queryParams[_]=y[_])),"pathProcessor"!=Ne.caller.name&&m[_].cipher&&se.cipher.encryptor&&(e.queryParams[_]=se.cipher.encryptor(e.queryParams[_])),l||e.refreshModel||!m[_].refreshModel||(e.refreshModel=!0)}}else if(y=d.__lp.defQP)for(var _ in y)e.queryParams&&!e.queryParams.hasOwnProperty(_)&&(e.queryParams[_]=y[_]);if(d.__lp.dkey){var g=pt(v),b=pt(v),L=a?s:u;if(!e.dynamicParams||!e.dynamicParams[L])return ht(499,o,l?this:void 0),!1;g[d.__lp.dIndex]=encodeURI(e.dynamicParams[L]),b[d.__lp.dIndex]=ct("<<dp>>"),c+=ct(b.join("/")),r+=ct(g.join("/")),s++}else c+=ct(v),r+=ct(v)}return se.stickyRoutes[t]||(se.urlCache[t]={url:ut(c),defQP:p}),xe(r,e)}}function xe(e,t){if(e="/"==e[e.length-1]&&1!=e.length?e.slice(0,-1):e,t.queryParams){var r=!0;for(var o in t.queryParams)null!=t.queryParams[o]&&(r?(e+="?",r=!1):e+="&",e+=o+"="+encodeURIComponent(t.queryParams[o]))}return se.history&&t.fragment&&(e=e+"#"+t.fragment),ut(e)}function je(e,t,o){te(b),e&&se.baseURL&&-1==ie.location.pathname.indexOf(se.baseURL)?ht(400):(t=t||(!le&&ge()&&ge().matched&&ge().url==Ce()?kt(ge().matched):yt(e)))&&t.matched.route.length&&(clearTimeout(u),t.prevTrans=t.prevTrans||Lyte.Router.__lp.prevTrans,t.path=t.path||e,t.transComp=t.transComp||De(t.prevTrans,t.matched,t.R),function(e){var t,o;(a=new He(e)).url=e.path,a.runLoop={},a._trans=(o=new Ot(t=a),t.state=o.state=201,o),Lyte.extendEventListeners(a._trans),a.routes=function(e){for(var t,r,o=e.matched,n=[],i=e.prevTrans,s=!0,l=0;r=o.route[l];l++){if(!(t=ne.__lp.getDefinition(a.matched._routes[l])))return!1;i&&s&&i.matched&&i.matched.route[l]==r?n.push(new xt(n,t,l,e,i.routes[l])):(n[l]=new xt(n,t,l,e),s=!1)}return i=void 0,n}(e),l?((r=l).url=e.path,a._trans.data=be()||{},r.replace=!0,l=void 0):a._trans.data&&ne.history.replaceState(a._trans.data)}(p=t),Lyte.triggerEvent("transitionStart",{prevTrans:i&&i._trans,nextTrans:a._trans}),u=setTimeout((function(){var e;p=void 0,n&&102==n.state&&a&&ne.checkIfSameRoute(a.info,n.info)&&!n.aborted&&JSON.stringify(n._data)==JSON.stringify(a._trans.data)?1==n.iPause&&n.resume():(n&&102==n.state&&n.abort({state:409}),(n=a)._data=n._trans.data?Lyte.deepCopyObject(n._trans.data):void 0,t.previous=!0,n.transComp=t.transComp,n.runLoop=Me(c=t),n._trans.data&&(r.data=n._trans.data),r.state=n.stateObj={meta:{matched:(e={replace:r.replace,data:r.data,url:n.url,matched:n.matched,fromHistory:r.fromHistory}).matched,url:e.url,index:e.fromHistory?ge()?ge().index:ce:e.replace&&ge()?ge().index:ce+=1},data:e.data},function(e){ne.history||function(){function e(){return this}function t(e,t,r,o){o||ge().index++,_e({state:{meta:ge(),data:e},title:t,url:r})}ne.history=new e,Object.defineProperty(e.prototype,"state",{get:function(){return be()},set:function(e){return de?de=!1:Lyte.warn("setting on data will not be pushed to history. If needed, use `LR.history.replaceState`."),e}}),e.prototype.replaceState=function(){t.apply(Array.from(arguments).push(!0))},e.prototype.pushState=function(){t.apply(Array.from(arguments))}}(),ne.history.index=e.state.meta.index,ne.history.fromHistory=!!e.fromHistory&&(i?i.stateObj.meta.index<n.stateObj.meta.index?"forward":"back":"reload"),de=!0,ne.history.state=be()||{},ne.history.initial=le,ne.history}(r),n.run())}),0))}function De(e,t,r){var o,n,i=!0,a=!0,s=[],l=[],d=[],c=t.route.join("."),p="";if(e){for(var u,f=e.matched,h=t.refreshRoute&&c==e.info.route?t.refreshRoute:t.startFrom,y=0,v=t.route.length;y<v;y++)p=p+(p?".":"")+(u=t.route[y]),!a||u!=f.route[y]||h&&p==h?(a=!1,null==o&&e.routes[y]&&e.routes[y].__ltp.rendered&&e.routes[y].outlet&&(o=y),d.push(u)):(n=r?r[y]:ne.__lp.getDefinition(u.slice(0,y)),i&&Ie(n,y,f,t)?(l.push(u),e.routes[y].__ltp.rendered?s.push(u):d.push(u)):(i=!1,d.push(u)));if(f.route.length>t.route.length){var m=t.route.length;null==o&&e.routes[m].__ltp.rendered&&(o=m)}}else d=d.concat(t.route);return{rendered:s,unRendered:d,common:l,templateToRemove:o}}function Ie(e,t,r,o){var n=!0,i=Fe(e.__lp.objPath,se.routes);return!e.queryParams&&!i.__lp.dkey||(!i.__lp.dkey||r.dynamicParams[t]==o.dynamicParams[t])&&(e.queryParams&&o.refreshModel&&e.queryParams.every((function(t){return!n||!e.__lp.qpdef[t].refreshModel||!o.queryParams&&!r.queryParams||o.queryParams[t]==r.queryParams[t]||(n=!1)})),n)}fe[L]=fe[A]=function(e,t){var r=this.routes[t],o=e==L?"loadDependencies":"loadResources",i=this.R[t][e];if(r.__lp[he[e]+"Loaded"]=!0,i&&me(this)){var s=Ye.call(this,i,this.routes[t],e,t,ve(t));if(s&&s instanceof Promise)return s;r.__lp[he[e]]=s,r.__lp[he[e]+"Loaded"]=!s||!(s.length||"object"==(void 0===s?"undefined":_typeof(s))),s&&(e==L&&console.warn("Requesting files in getDependencies will stall execution of route till download completes. Please validate files before requesting."),r.__lp[o]=function(){r.__lp[o]=y},function(e){var t=function(){};t.internal={};var r=e.r,o=e.reqType,i=e.index,s=r.__lp,l=t.internal.hook=n.prom.hook;t.internal.route=s.objPath,qe(o+" before inject",this.transId,s.objPath),Lyte.injectResources(s[o],t,function(e,t){if(!se.execRouteRequirementsOnDemand&&(!n.aborted||s.objPath==this.routes[i].__lp.objPath&&n.transComp.redirected&&i<=n.transComp.common.length-1||p&&p.transComp.redirected&&i<=p.transComp.common.length-1)){n.aborted&&(n=ne.__lp.trans.aborted?a:!ne.__lp.trans.aborted,s=n.routes[i].__lp);var d=l==L?"loadDependencies":"loadResources",c=l==L?"errorDependencies":"errorResources";n.pending[o].has(i)?((s=n.routes[i].__lp)[o+"Loaded"]=!0,delete s[d],n.pending[o].delete(i),t.length?(qe(o+" inject completed","failure",n.transId),n.paused||n.pause({iPause:!0}),fe[N].call(n,l,i,r.__lp[c]=t,424)):(qe(o+" inject completed","success",n.transId,s.objPath),n.pending.forceFetch.has(i)?(n.pending.forceFetch.delete(i),rt.call(n,n.runLoop.forceFetch,n.fRunningProm.resolve,n.runLoop.forceFetch[i][0])):nt.call(n,n.runLoop,"current",n.runningProm.resolve))):s[d]=function(){if(t.length)return qe(o+" inject completed","failure",n.transId,this.objPath),n.routes[i].__lp[o+"Loaded"]=!0,delete n.routes[i].__lp[d],n.paused||n.pause({iPause:!0}),fe[N].call(n,l,i,r.__lp[c]=t,424),!1;n.routes[i].__lp[o+"Loaded"]=!0,delete n.routes[i].__lp[d]}}}.bind(n),{defer:function(e){var t=e.injectJS,a=e.files,d=l==L?"loadDependencies":"loadResources",c=l==L?"errorDependencies":"errorResources",p=function(e){n.routes[i].__lp[o+"Loaded"]=!0,e.length?(qe(o+" inject completed","failure",n.transId,s.objPath),n.paused||n.pause({iPause:!0}),fe[N].call(n,l,i,r.__lp[c]=e,424)):(qe(o+" inject completed","success",n.transId,s.objPath),n.pending[o].has(i)&&(n.pending[o].delete(i),n.pending.forceFetch.has(i)?(n.pending.forceFetch.delete(i),rt.call(n,n.runLoop.forceFetch,n.fRunningProm.resolve,n.runLoop.forceFetch[i][0])):nt.call(n,n.runLoop,"current",n.runningProm.resolve)))};"pending"==s[d]?(!n.aborted||n.transComp.redirected&&i<=n.transComp.common.length-1)&&t(a,(function(e,t){qe(o+" after inject",n.transId,this.objPath),delete n.routes[i].__lp[d],p(t)})):s[d]=function(){t(a,(function(e,t){qe(o+" after inject",n.transId,this.objPath),delete n.routes[i].__lp[d],p(t)}))}}.bind(n)})}.call(this,{reqType:he[e],r:r,index:t}))}return Je()},fe[$]=fe[E]=fe[T]=function(e,t){var r=this.routes[t],o=this.R[t][e],n=[this.R[t][e],r,ve(t)];if(e==T&&n.splice(2,0,r.currentModel),o){var i=function(t){r.$[e]=t,e==E&&(r.currentModel=t),delete o.then};o.then={success:i,failure:i}}return Je.apply(this,n)},fe[R]=function(e,t){var r=this.routes[t],o=[this.R[t][e],r,ve(t)];return o.splice(2,0,r.currentModel),Je.apply(this,o)},fe[N]=function(e,t,r,o,i){tt.call(n,n.prom),n._trans.triggerEvent(N,{error:r,hook:e});for(var a=this.routes[t];t>=0&&!this.aborted&&this.paused;t--){var s=this.routes[t];if(re(N+" of "+s.routeName,h,ee),0==Qe.call(this,N,t,[r,this._trans,ve(t),e]))break}Xe(r,e,a.routeName,o,i)},fe[P]=function(e,t){return 0==Qe.call(i,e,t,[n._trans])&&it(n.runLoop.previous,e),Je()},fe[D]=function(){if(me(this)){var e;(e=i&&i._trans)&&(delete e.abort,delete e.pause);var t={prevTrans:e,trans:n._trans,history:ne.history};ne[D](t.prevTrans,t.trans,t.history),n._trans.triggerEvent(D,t),Lyte.triggerEvent(D,t)}return Je()},fe[I]=function(e){ne[I](e),n._trans.triggerEvent(I,{trans:e}),Lyte.triggerEvent(I,{trans:e})},fe[x]=function(e,t){return Ye.call(this,this.R[t][e],this.routes[t],e,t,ve(t)),Je()},fe[j]=function(){return new Promise((function(e,t){for(var r=n.matched.route.length,o=1;o<=r&&me(n);o++){var i=r-o;if(n.R[i].actions&&n.R[i].actions.onBeforeLoad&&console.log(j+" action is depricated. Use beforeLoad callback"),0==Qe.call(n,j,i,[ve(i)])||o==r){e();break}}}))},fe[w]=fe[k]=function(e,t){return new Promise(function(r,o){var i=setTimeout(function(){if(e==w){var i=this.routes[t];i.__ltp.rendered=!0,Je.call(this,this.R[t][e],i,i.currentModel,ve(t),i.component).then((function(e){n.routes[t+1]||n._trans.triggerEvent(w),r(e)}),(function(e){o(e)}))}else fe.removeTemplate.call(this),0==Qe.call(this,e,t,[ve(t),n._trans])&&(it(n.runLoop.current,e),t=0),r(),0==t&&dt({state:200})}.bind(this,e,t),0);this.fns.push(i)}.bind(this))},fe[S]=function(e,t){var r=i.routes[t],o=i.R[t][e];return Je.call(this,o,r,r.currentModel,ve(t,i))},fe[O]=function(e,t){var r=this.routes[t],o=this.R[t];if(o[e]){fe.removeTemplate.call(this);var n=Ye.call(this,o[e],r,e,t,r.currentModel,ve(t));if(me(this))if(n&&(r.outletName=n.outlet)){var i,a=r.currentModel;if(r.outlet=i=function e(t,r){var o;if(r){if(!(o=r.outlet?r.outlet.querySelector(t):void 0))return e(t,r.parent)}else(o=ie.querySelector(t))||ht(428,t);return o}(n.outlet,r.parent)){var s={outlet:n.outlet,route:r};if(n.component)if(r.component&&!n.reRender&&r.component.tagName.toLocaleLowerCase()==n.component&&r.outlet==i&&i.contains(r.component))ye.call(this,r.component,a,r,e,t);else{ze(s);var l=ie.createElement(n.component);l._route=r.__lp.objPath,ye.call(this,l,a,r,e,t),i.innerHTML="",i.appendChild(r.component=l)}else if(n.html){r.component=void 0,ze(s),i.innerHTML=n.html;var d=i.getElementsByTagName("script");d.length&&function(e){for(var t,r=0;t=e[r];r++){for(var o,n=t.parentNode,i=ie.createElement("script"),a=0;o=t.attributes[a];a++)i.setAttribute(o.name,o.value);i.innerHTML=t.innerHTML,n.appendChild(i),n.removeChild(t)}}(Array.from(d))}}}else Lyte.warn(Z)}else me(this)&&this.runLoop.templateToRemove&&this.R.length==t+1&&fe.removeTemplate.call(this);return Je()},fe.removeTemplate=function(){var e=this.runLoop.templateToRemove;this.cleared||(i&&e&&function(e){for(var t,r=0,o=e.length;r<o;r++)for(var i,a=(t=e[r]).routes.length-1;a>=t.index;a--)(i=t.routes[a]).outlet&&(ze({outlet:i.outletName,route:i}),i.outlet.innerHTML="",n.routes[a]&&n.routes[a].__lp.objPath==i.__lp.objPath||Ve.call(this,i,a,t))}(e),this.cleared=!0,s!=this&&(s=this),delete this.runLoop.templateToRemove,Lyte.removeFromCache())},this.configureDefaults=function(e){e=e||{},se.history="html5"==e.history,se.baseURL=e.baseURL,se.slashAfterHash=null==e.slashAfterHash||e.slashAfterHash,se.deferInit=e.deferInit||!1,se.preserveUrlOnBrowserNavigation=e.preserveUrlOnBrowserNavigation,se.linkActiveClass=e.hasOwnProperty("linkActiveClass")?e.linkActiveClass:"",se.cipher=e.cipher,se.queryParamOptions={sticky:!e.queryParamOptions||!e.queryParamOptions.hasOwnProperty("sticky")||e.queryParamOptions.sticky},Lyte.$.prefetchSupport&&0!=e.execRouteRequirementsOnDemand?se.execRouteRequirementsOnDemand=!0:(Lyte.$.replaceOldInjectResource&&Lyte.$.replaceOldInjectResource(),se.execRouteRequirementsOnDemand=!1),this.__lp.config=se},this.__lp={version:"3.2.7",pendingReg:[],getDefinition:function(e,t){return"*"==e?se.routes:(t=Fe(e,t=t||se.routes))&&t.__lp&&t.__lp.def||void 0}},this.configureRoutes=function(e){this.__lp.config||this.configureDefaults(),we.call(this,e);for(var t=0,r=this.__lp.pendingReg.length;t<r;t++)Tt.apply({},this.__lp.pendingReg[t]);this.__lp.pendingReg=[],Lyte.domContentLoaded(Le),this.__lp.routesConfigured=!0},this.init=function(t){var r;return delete this.init,this.popstate=function(e){var t,r;if(se.preserveUrlOnBrowserNavigation){if(pe)return void(pe=!1);ge()&&i&&i.stateObj.meta.index!=ge().index&&(pe=!0,r=Ae(e),t=i.stateObj.meta.index-ge().index,history.go(t))}r=r||Ae(e),l={fromHistory:!0,url:r,goValue:t},e&&history.state&&(l.data=history.state),je(r)},e.addEventListener("popstate",this.popstate),se.history?this.popstate():je((l={fromHistory:!0,url:Ce()}).url),(r=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,HTMLElement),_createClass(t,[{key:"attributeChangedCallback",value:function(e,t,r){if(this.matched&&this.hasAttribute("lyte-rendered")){var o=this.getElementsByTagName("A")[0];o&&(e===F?(this.handleLtProp(),this.hasAttribute("lt-prop-custom")||this.setCustomAttributes(o,!0),this.constructHref(o)):/^(lt-prop-route|lt-prop-fragment|lt-prop-dp|lt-prop-qp)$/.test(e)?(this.getMatchedObject(),this.constructHref(o,e,t,r)):this.hasAttribute("lt-prop-custom")||o.setAttribute(e.substring(8),r))}}},{key:"connectedCallback",value:function(){if(this.ltProp=this.ltProp||{},this.handleLtProp(),this.hasAttribute("lyte-rendered"))this.matched||this.getMatchedObject();else{var e;if(this.hasAttribute("lt-prop-custom")||this.ltProp.custom)this.getMatchedObject(),(e=this.getElementsByTagName("A")[0])&&this.constructHref(e);else{for(e=ie.createElement("a");this.childNodes[0];)e.appendChild(this.childNodes[0]);this.setCustomAttributes(e),this.getMatchedObject(),this.constructHref(e),this.appendChild(e)}Lyte.Component?this._linkToEventId=Lyte.Component.addLyteEventListener(this,"click",(function(e){$e(e,this)}),this):this.addEventListener("click",$e),this.setAttribute("lyte-rendered","")}}},{key:"modifyLinkToTagsInRoute",value:function(e){var t=Array.isArray(this.matched.route)?this.matched.route.join("."):this.matched.route,r=se.allLinks[t];if(e){if(r){var o=r.indexOf(this);-1!=o&&r.splice(o,1)}}else r?r.push(this):se.allLinks[t]=[this];if(se.stickyRoutes[t]){var n=se.routes,i=void 0;if(e){if(!this.matched)return;i=e}else i=this.matched.route;if(!i)return;for(var a=0,s=(i=Array.isArray(i)?i:Re(i)).length;a<s;a++){if(!(n=Fe(i[a],n))||!n.__lp)return ht(422,i,a),!1;var l=n.__lp.def.__lp;if(e){var d=l.stickyLinks.indexOf(this);-1!==d&&l.stickyLinks.splice(d,1)}else l.qpdef&&l.stickyLinks.push(this)}}}},{key:"disconnectedCallback",value:function(){var e=this.modifyLinkToTagsInRoute.bind(this);Lyte.Component.shouldIgnoreDisconnect()||(this.matched&&this.matched.route&&e(this.matched.route),this._linkToEventId&&Lyte.Component.removeLyteEventListener(this,this._linkToEventId))}},{key:"handleLtProp",value:function(){var e=this.getAttribute(F);if(e)try{this.ltProp=oe(e)}catch(e){Lyte.warn("Error while parsing ltProp in link-to")}}},{key:"setCustomAttributes",value:function(e,t){for(var r in this.ltProp)/^(id|class|style|target)$/.test(r)&&e.setAttribute(r,this.ltProp[r]);if(!t)for(var o,n,i=0;o=this.attributes[i];i++)(n=o.nodeName)!==F&&/^(lt-prop-id|lt-prop-rel|lt-prop-class|lt-prop-style|lt-prop-target|lt-prop-tabindex|lt-prop-aria-label|lt-prop-aria-attributes)$/.test(n)&&e.setAttribute(n.substring(8),o.nodeValue)}},{key:"constructHref",value:function(e,t,r){var o,n=this.modifyLinkToTagsInRoute.bind(this);(o=ne.getURL.call(this,this.matched))&&(e.setAttribute("href",o),t===H?(n(r),n()):n())}}],[{key:"observedAttributes",get:function(){return[H,U,q,z,F,"lt-prop-class","lt-prop-data-tabindex","lt-prop-data-tabindex","lt-prop-tabindex","lt-prop-aria-label","lt-prop-aria-attributes","lt-prop-id","lt-prop-rel","lt-prop-title","lt-prop-style","lt-prop-target"]}}]),t}()).prototype.getMatchedObject=function(){var e=this.matched||{},t=this.getAttribute.bind(this),r=t(U)||this.ltProp.dp||[],o=t(z)||this.ltProp.qp||{};if(!(r instanceof Array))try{r=oe(r)}catch(e){return void ht(498,"dynamicParams",this.outerHTML)}if(!(o instanceof Object))try{if(o=oe(o),Array.isArray(o))return void ht(498,"queryParams",this.outerHTML)}catch(e){return void ht(498,"queryParams",this.outerHTML)}return e.route=t(H)||this.ltProp.route,e.fragment=t(q)||this.ltProp.fragment,e.dynamicParams=r||[],e.queryParams=o||{},e.refreshRoute=null!=t(J)?t(J):this.ltProp[W],e.refreshRoute=""==e.refreshRoute||"true"==e.refreshRoute?e.route:e.refreshRoute,e.startFrom=t("lt-prop-start-from")||this.ltProp[K],this.matched=e},customElements.define(Y,r),this},this.beforeScroll=this[D]=this[I]=ue,this.checkIfSameRoute=function(e,t){return!(e.route!=t.route||e.fragment!=t.fragment||e.dynamicParams.length!==t.dynamicParams.length||!Ct(e.queryParams,t.queryParams))&&Ee(e.dynamicParams,t.dynamicParams)},this.addRoutes=function(e,t){var r=setInterval((function(){if(Lyte.Router.__lp.routesConfigured){clearInterval(r),Lyte.warn("addRoutes function will be deprecated from next version");var o=Fe(t?t.split("."):[],se.routes);if(!o)return void console.error(t+" is not specified in router map.");Object.assign(o,we.call(d,e))}}),0)},this.replaceWith=function(){var e=kt.call(this,Pt.apply(this,arguments));if(e)return e.matched.replace=!0,Se(e)},this.transitionTo=function(){var e;if(e=kt.call(this,Pt.apply(this,arguments)))return Se(e)},this.getURL=function(e){if(e){e.route?e.queryParams||(e.queryParams={}):e=Pt.apply(this,arguments);var t,r,o,n=this.tagName==Q,i=se.urlCache;if(!se.queryParamOptions.sticky&&(o=i[Array.isArray(e.route)?e.route.join("."):e.route])){if(t=o.url,r=e.dynamicParams&&e.dynamicParams.length)for(var a=0;a<r;a++)t=t.replace("<<dp>>",e.dynamicParams[a]);else-1!=t.indexOf("<<dp>>")&&ht(499,e.route,n?this:void 0);for(var s in o.defQP)!e.queryParams[s]&&o.defQP[s]&&(e.queryParams[s]=o.defQP[s]);t=xe(t,e)}else t=n?Ne.apply(this,arguments):Ne.call(this,e);if(t)return se.history?ke(t,!0):"#"+t}},this.getRoute=function(e){var t=yt(ke(e),!0);return t&&(t.dynamicParams=t.dynamicParams.filter(Oe),t.route=t.route.join(".")),t};var Be=[$,E,T,R,O,w];function Me(e){te(g);var t=e.transComp,r=[],o={},l=[],d=[],c=[],p=[],u=[];if(e.previous){var h=[{hook:D}];if(i){for(var v=i.matched.route.length-1;i.matched.route[v];v--){var m=n.matched._routes[v];m&&m.join(".")==i.matched._routes[v].join(".")||c.push({hook:S,index:v}),p.push({hook:P,index:v})}return te(g),{previous:p.concat(h).concat(c),current:c}}return te(g),{previous:h}}return t.rendered&&t.rendered.length&&t.rendered.forEach((function(e,t){n.routes[t].__ltp.rendered=!0,r.push({hook:R,index:t}),u.push({hook:k,index:n.matched.route.length-t-1})})),t.unRendered&&t.unRendered.length&&(l.push({hook:x,index:t.rendered.length}),t.unRendered.forEach((function(e,i){var s=t.rendered.length+i;(!t.redirected||t.redirected&&t.redirected.index!=s)&&(d=d.concat([{hook:L,index:s},{hook:A,index:s}]));var l=n.routes[s];(_typeof(l.forceFetch)==f?Ye.call(this,l.forceFetch,l,"forceFetch",s,ve(s)):l.forceFetch)?(o[s]=[{hook:$,index:s},{hook:E,index:s},{hook:T,index:s}],a.routes[s].__ltp.fetchStatus=y,[R,O,w].forEach((function(e){r.push({hook:e,index:s}),e==O&&t.unRendered[i+1]&&r.push({hook:x,index:i+1})}))):Be.forEach((function(e){t.redirected&&t.redirected.index==s&&e!=R?-1==[$,E,T].indexOf(e)&&r.push({hook:e,index:s}):r.push({hook:e,index:s})})),u.push({hook:k,index:n.matched.route.length-s-1})}))),(r={previous:[],current:[{hook:j}].concat(l).concat(d.concat(r).concat(u)),forceFetch:o}).templateToRemove=i&&i.runLoop.templateToRemove?i.runLoop.templateToRemove:[],null!=t.templateToRemove&&r.templateToRemove.push({index:t.templateToRemove,routes:s.routes}),te(g),r}function Fe(e,t){if(t)return e?(Array.isArray(e)||"string"!=typeof e||(e=Re(e)),e.every((function(e){return t&&t[e]?(t=t[e],!0):t=!1})),t):t}var Ke=0;function He(e){this.transId=Ke+=1,this.matched=e.matched,this.target=e.matched.target,this.fns=[],this.pending={dependencies:new Set,resources:new Set,forceFetch:new Set},this.info={route:e.matched.target,queryParams:e.matched.queryParams,dynamicParams:e.matched.dynamicParams.filter(Oe)},e.matched.fragment&&(this.info.fragment=e.matched.fragment),this.R=e.R,this.running=this.aborted=this.paused=!1,this.abort=function(e){var t;r&&r.goValue&&(pe=!1),this.abort=ue,(t=this).runningProm&&t.runningProm.reject(m),t.fRunningProm&&t.fRunningProm.reject(m),this.aborted=!0,e||(e={state:308}),this.running&&re("Transition aborted.",h),e.iAbort||delete this.runLoop.templateToRemove,dt(e)}.bind(this),this.pause=function(e){return re("Transition paused.",h),e&&e.iPause?this.iPause=!0:(this.iPause=!1,this.state=this._trans.state=307,this._trans.triggerEvent(X,this.state)),this.paused=n.prom||!0,this.resume=this._trans.resume=function(e){if((e=e||this).prom==e.eProm){if(delete e._trans.resume,delete e.resume,re("Transition resumed.",h),e.paused){var t,r=e.prom;if(1!=e.paused&&(t=e.paused.state),e.runLoop[t])if("forceFetch"==t){var o=e.runLoop.forceFetch[r.index];o[0]&&r.hook==o[0].hook&&o.splice(0,1)}else e.runLoop[t][0]&&e.runLoop[t][0].hook==e.paused.hook&&e.runLoop[t][0].index==e.paused.index&&it(e.runLoop[t],e.paused.hook,e.paused.index);e.iPause=e.paused=!1,e.state=e._trans.state=102,this._trans.triggerEvent(X,e.state),this.forceFetchRunning?e.runLoop.forceFetch[r.index][0]?e.run(e.runLoop.forceFetch[r.index][0]):(e.routes[r.index].__ltp.fetchStatus=v,null!=e.pending.waitingForFF&&e.pending.waitingForFF==r.index&&(delete e.pending.waitingForFF,e.run())):(t&&"forceFetch"==t&&!e.runLoop.forceFetch[r.index][0]&&(e.routes[r.index].__ltp.fetchStatus=v),e.run())}}else e.pendingResume||(e.pendingResume=e.resume,delete e._trans.resume,delete e.resume)}.bind(this),this._trans}.bind(this)}function qe(){Lyte.debug&&console.log.apply(this,Array.from(arguments))}var Ue=function(e,t){var r=1==e.__lp[t+"Loaded"],o=t==M?"loadDependencies":"loadResources";return!e.__lp[o]||"function"!=typeof e.__lp[o]||r?r:0!=e.__lp[o]()&&1==e.__lp[t+"Loaded"]};function ze(e,t){Lyte.triggerEvent("beforeTemplateDestroy",e)}function Ve(e,t,r){re(C+" of "+e.routeName,h,ee),Ye.call(this,e.didDestroy,e,C,t,e.currentModel,ve(t,r))}var Ge=[L,A,$,E,T];function We(e){return lt(Ge,e)}function Je(e,t){if(e){var r,o=arguments,i=n,a=n.prom,s=a.hook,l=a.index,d=We(s),c=this;return new Promise((function(p,u){try{var f=e.apply(t,Array.from(o).slice(2));d&&f&&(f=Lyte.resolvePromises(f)),r=Promise.resolve(f)}catch(e){return void Ze.call(c,{hook:s,index:l,stopTrans:d,err:e,instance:t,promise:{resolve:p,reject:u}})}r.then((function(r){"previous"!=a.state&&n._trans!=t.transition?u("old transition's promise rejected"):(p(r),e.then&&e.then.success.apply(this,arguments))}),(function(r){i.prom=a,u(r),e.then&&e.then.failure.apply(this,arguments),Ze.call(c,{hook:s,index:l,stopTrans:d,err:r,instance:t,PR:!0})}))}))}return Promise.resolve()}function Ye(e,t,r,o){if(e){var n=We(r);try{return e.apply(t,Array.from(arguments).slice(4))}catch(e){return void Ze.call(this,{hook:r,index:o,stopTrans:n,err:e,instance:t})}}}function Qe(e,t,r){var o,n=this.routes[t];if(n.actions&&(o=n.actions[e]))try{if(0==o.apply(n,r))return!1}catch(t){return Xe(t,e,n.routeName),!1}}function Xe(e,t,r,o,n){if("string"==typeof e||"object"==(void 0===e?"undefined":_typeof(e))&&e.stack&&!e.$){e.stack||(e=Error(e)),e.$=!0;var i=ft(o||420,t,r);e.stack=e.stack.replace(e.message,e.message=e.message+"\n\t"+i),ht(e)}else ht(o,t,r,e,n&&n.PR)}function Ze(e){var t=e.instance,r=e.stopTrans,o=e.err,i=e.hook,a=e.index;r?(n.pause(),fe[N].call(this,i,a,o,420,e)):(Xe(o,i,t.routeName),e.promise&&e.promise.resolve())}function et(e,t,r,o,n){o=o||ue,n=n||function(e){e!=m&&ht(e)},new Promise(function(o,n){"nestedForcedPromises"==t?(this.fRunningProm={resolve:o,reject:n},e.call(this,this.runLoop.forceFetch,o)):(this.runningProm={resolve:o,reject:n},e.call(this,this.runLoop,r,o))}.bind(this)).then(o,n)}function tt(e){if(n.eProm=e,this.pendingResume){var t=this.pendingResume;delete this.pendingResume,t()}}function rt(e,t,r){if(me(this)&&e){if(!r){for(var o in e){var i=e[o][0];i&&(i.running||rt.call(this,e,t,i))}return}this.R[r.index];var a=this.routes[r.index];if(r.state="forceFetch",n.prom=r,r.hook==$&&!Ue(a,M))return this.pending.dependencies.add(r.index),void this.pending.forceFetch.add(r.index);ot(r),e[r.index][0].running=!0,e[r.index].splice(0,1),fe[r.hook].call(this,r.hook,r.index).then(function(o){tt.call(n,n.prom),r.hook==T?(a.__ltp.fetchStatus=v,null!=this.pending.waitingForFF&&this.pending.waitingForFF==r.index&&(delete this.pending.waitingForFF,nt.call(this,this.runLoop,"current",this.runningProm.resolve))):r.hook==E?e[r.index][0]&&e[r.index][0].hook==T&&rt.call(this,e,t,e[r.index][0]):e[r.index][0]&&e[r.index][0].hook==E&&rt.call(this,e,t,e[r.index][0])}.bind(this),(function(){}))}else this.forceFetchRunning=!1}function ot(e){if(Lyte.debug){var t=e.hook,r=e.index;if(-1!=[D,j].indexOf(e.hook))return void re(t,h,ee);var o="previous"==e.state?i.R[r]:n.R[r];re(t+" of route "+o.routeName,h,ee)}}function nt(e,t,r){if(me(this)){var o=e[t];if(o&&o.length){var i,a=o[0],s=this.R[a.index],l=this.routes[a.index];if(a.hook==$&&(i=Ue(l,M)),a.hook==$&&!i)return void this.pending.dependencies.add(a.index);if(a.hook==O&&!Ue(l,B))return void this.pending.resources.add(a.index);if(a.hook==R&&s.forceFetch&&l.__ltp.fetchStatus==y)return this.forceFetchRunning||(this.forceFetchRunning=!0,et.call(this,rt,"nestedForcedPromises")),void(this.pending.waitingForFF=a.index);a.state=t,n.prom=a,ot(a),te(a.hook+a.index),fe[a.hook].call(this,a.hook,a.index).then(function(o){tt.call(n,n.prom),te(a.hook+a.index),this.runningProm.resolve==r&&(it(e[t],a.hook,a.index),nt.call(this,e,t,r))}.bind(this))}else r&&r()}else this.paused&&this.runningProm&&this.runningProm.reject(m)}function it(e,t,r){for(var o,n=0;o=e[n];n++)if(o.hook==t)if(null!=r){if(r==o.index){e.splice(n,1);break}}else e.splice(n,1),n--}function at(e){if(e){for(var t,r={},o=lt(e,"?")?e.split("?")[1]:e,n=0,i=(o=lt(o,"&")?o.split(/&/g):[o]).length;n<i;n++)r[(t=o[n].split("="))[0]]=t[1]?decodeURIComponent(t[1]):t[1];return r}}function st(e,t){for(var r=0,o=e.length;r<o;r++)t.shift()}function lt(e,t){return-1!=e.indexOf(t)}function dt(e){if(n.running){n==a&&(a=void 0),o&&(clearInterval(undefined),_e(o),o=void 0),gt(n.info);for(var t=0,r=n.fns.length;t<r;t++)clearTimeout(n.fns[t]);var l;n.pendingResume=void 0,n.running=!1,n.state=n._trans.state=e.state,n._trans.triggerEvent(X,n.state),le||200==n.state?(ne.__lp.prevTrans=i=n,te(b),re("Transition completed.",h),se.history&&n.info.fragment&&(l=ie.getElementById(n._trans.info.fragment))&&l.scrollIntoView&&0!=ne.beforeScroll(n._trans)&&l.scrollIntoView(),fe[I](n._trans)):e.iAbort||s==n?(ne.__lp.prevTrans=i=n,n.state&&201!=n.state&&fe[I](n._trans)):(n.state&&201!=n.state&&fe[I](n._trans),ne.__lp.trans=n=i),le&&(le=!1)}else i&&(ne.__lp.trans=n=i)}function ct(e){return"/"==e[0]?e:"/"+e}function pt(e){return e.match(/[^/?]+/g)||[]}function ut(e){return(e=e.replace(/\/\//g,"/")).replace(/\/\?/g,"?")}function ft(){var e,t=arguments;switch(t[0]){case 400:e=t[1]?"url '"+t[1]+"' is not defined in router.":"Base path of url is not specified.";break;case 405:e="Method not allowed before router initialization.";break;case 422:e="There is no route definition for the route "+t[1].splice(0,t[2]+1).join(".")+".";break;case 424:e="File not loaded in "+t[1]+" of route "+t[2]+".\n"+t[3][0].target.outerHTML;break;case 498:e="Invalid argument "+t[1]+(t[2]?" provided in "+t[2]:".");break;case 499:e=t[1]?"Dynamic params for the route "+t[1]+" is not provided"+(t[2]&&t[2].outerHTML?" in "+t[2].outerHTML:"."):"Transition tried without arguments.";break;case 420:e=(t[3]?"Promise rejected":"Error")+" in "+t[1]+" of route "+t[2]+".";break;case 428:e="There is no outlet named "+t[1]+".";break;case 203:e="Data provided for component is not valid."}return"LR "+t[0]+": "+e}function ht(){Lyte.error(arguments[0].stack?arguments[0]:ft.apply(this,arguments),arguments[3])}function yt(e,t){if(e){var r,o=[];if(se.history){var n=e.split("#");(r=n[1])&&(e=n[0])}var i=e.split("?");if("/"==(e=decodeURI(i[0]))){if(!Fe(["/"],se.routeHash))return void ht(400,e);o.push([e])}else{var a,s=i[1],l=pt(e),d=0,c=[0],p=[];p.dynamicParams=[],function e(t){for(var r in t)if(!a){var n,i=t[r];if("__lp"!=r){var s=pt(r);if(s&&!1!==(n=vt(s,l,d,i,p)))if(c.push(n),d=c[c.length-1],l.length==d){var u=Array.from(p.concat(r));if(i["/"]&&(u=u.concat("/")),o.push(u),!i.__lp.wildcard&&!i.__lp.dkey)return void(/[:*]/.test(u.join(""))||(a=u));c.pop(),d=c[c.length-1]}else{var f=Object.keys(i);if(p.push(r),l[d])if(i.__lp.wildcard&&!i.__lp.sufix.length&&1==f.length){var h=Array.from(p);i["/"]&&(h=h.concat("/")),o.push(h)}else f.length>1&&e(i);p.pop(),c.pop(),d=c[c.length-1]}}}}(se.routeHash)}if(a)return _t(t,a,e,s,r);if(1==o.length)return _t(t,o[0],e,s,r);if(o.length)return _t(t,function e(t,r,o){o=o||0;for(var n,i=i||function(e){for(var t=[],r=0,o=0,n=e.length;o<n;o++){var i=e[o];r=i.length>r?i.length:r}for(o=0;i=e[o];o++)for(var a=0;a<r;a++)t[a]=t[a]||[],t[a][o]=i[a];return t}(t),a=Math.max.apply(Math,_toConsumableArray(i[o]));n=mt(i[o],a);){o+=1;for(var s=[],l=[],d=0,c=n.length;d<c;d++)s.push(r[d]),l.push(t[d]);var p=[],u=[];for(d=0,c=l.length;d<c;d++)null!=l[d][o]&&(p.push(s[d]),u.push(l[d]));return p.length?1==p.length?p[0]:e(u,p,o):s[0]}return r[i[o].indexOf(a)]}(function(e){for(var t=[],r=0,o=e.length;r<o;r++){var n=Array.from(e[r]),i=0,a=[];"/"==n[0]&&n.shift(),"/"==n[n.length-1]&&n.pop();var s=-1;n.every((function(e,t){var r=!0;return pt(e).every((function(e,o){return e==l[++s]?(i++,n.length==t+1&&a.push(i),!0):-1!=e.indexOf(":")?(a.push(i),i=0,!0):(-1!=e.indexOf("*")&&(r=!1),a.push(i),!1)})),r})),t.push(a)}return t}(o),o),e,s,r);ht(400,e)}else ht(400,"")}function vt(e,t,r,o,n){var i;if(!o.__lp.wildcard&&!o.__lp.dkey&&(i=Fe(n,se.routeHash).__lp)&&i.wildcard&&!(r+=t.slice(r).indexOf(e[0])))return!1;for(var a,s=0;a=e[s];s++,r++)if(a!=t[r]&&!wt(a))if(St(a))o.__lp.sufix.length&&(r=t.indexOf(o.__lp.sufix[0])-1);else{if("/"!=e[r])return!1;r--}return r}function mt(e,t,r,o){for(var n=[],i=0,a=e.length;i<a;i++)e[i]==t&&n.push(i);return 1!=n.length&&n}function _t(t,r,o,n,i){var a,s,l,d={route:Fe(r,se.routeHash).__lp.route,queryParams:n?at(n):{}};if(se.history&&(d.fragment=i),d.dynamicParams=function(e,t){for(var r,o,n=se.routes,i=[],a=pt(e.split("?")[0]),s=0,l=t.route.length;s<l;s++){var d=(n=Fe([t.route[s]],n)).__lp;if(d.wildcard)if(d.sufix.length){var c=a.slice(0,a.indexOf(d.sufix[0]));o=decodeURI(c.join("/")),st(c.concat(d.sufix),a)}else o=decodeURI(a.join("/"));else d.dkey?(r=a[d.dIndex],st(pt(d.path),a),o=decodeURI(r)):(st(pt(d.path),a),o=void 0);i.push(o)}return i}(o,d),t)return d;d.dpProcessed=!0;var c=kt(d);return 0!=c&&(s=Lyte.deepCopyObject(c.matched),l=Lyte.deepCopyObject(c.matched),c.matched.hasOwnProperty("refreshModel")||Ne(c.matched),a=Ne(l),Ct(l.queryParams,s.queryParams)||(_e({replace:!0,state:e.history.state,url:a,fromHistory:!0}),c.path=a)),c}function gt(e){se.linkActiveClass&&se.allLinks[e.route]&&se.allLinks[e.route].forEach((function(t){var r=t.getAttribute(U);if(Ee(e.dynamicParams,r?JSON.parse(r):[])){t.classList.add(se.linkActiveClass),se.activeLinkTags.push(t);var o=t.getElementsByTagName("A")[0];o&&o.setAttribute("href",ne.getURL(t.getMatchedObject()))}}))}function bt(e,t,r,o){e&&e.mixins&&(Array.isArray(e.mixins)||(e.mixins=[e.mixins]),e.mixins.forEach((function(e){if(Lyte.registeredMixins[e])if(e=Lyte.registeredMixins[e],o){var s=ne.getRouteInstance(r,i),l=ne.getRouteInstance(r,n),d=a&&ne.getRouteInstance(r,a);s||l?function(e,t,r,o,n){for(var i in e)"actions"==i?(t.actions||(o.actions=r.actions=t.actions={}),r.actions=o.actions=Object.assign(t.actions,e.actions),n&&(n.actions=r.actions)):(r[i]=o[i]=t[i]=e[i],n&&(n[i]=r[i]))}(e,t,s=s||{},l=l||{},d):Et(e,t)}else Et(e,t);else o||Lyte.$.requiredMixins(e,r,"router")})))}function Lt(e,t,r,o,n,i){if(e&&e.services){var a=[],s=[];e.services.forEach((function(e){"string"==typeof e?a.push(e):e&&"object"==(void 0===e?"undefined":_typeof(e))&&(n||!e.scope||e.scope&&"static"==e.scope?a.push(e):s.push(e))}))}a&&a.length&&function(e,t,r,o,n,i){var a=At(r,t);Lyte.extendService({services:e||[],type:"route",ins:o||a,isGlobal:n,data:i,callback:function(e,o,i,a){var s={};s.as=o,s.service=a,Lyte.extendService({services:[s],type:"route",isGlobal:n,ins:r?At(r,t):$t()})}})}(a,t,r,o,n,i),s&&s.length&&At(r,t).forEach((function(e){e&&e.__lp&&(e.__lp.toBeUsed=s)}))}function At(e,t){var r,o=[t];return[i,a,n].forEach((function(t){t&&(r=ne.getRouteInstance(e,t))&&o.push(r)})),o}function $t(e,t){var r=!e;for(var o in t=t||[],e=e||se.routes)"__lp"==o?e.__lp.def&&t.push(e.__lp.def):$t(e[o],t);if(r)return i&&i!=n&&(t=t.concat(i.routes)),n&&(t=t.concat(n.routes)),t}function Et(e,t){for(var r in e)"actions"==r?t.actions=Object.assign(t.actions||{},e.actions):t[r]="queryParams"==r?Lyte.deepCopyObject(e[r]):e[r]}function Tt(e,t,r){if(bt(r,t,e),t.__lp={options:r,objPath:e.replace(/\//g,"."),stickyLinks:[],linkTags:[]},Lt(r,t,e),Lyte.toBeInjectedServices){var o=Lyte.toBeInjectedServices,n=[];for(var i in o)n.push({as:i,service:o[i]});Lt({services:n},t,e,void 0,!0)}var a=se.queryParamOptions.sticky;t.queryParams&&(t.__lp.qpdef={},t.queryParams.forEach((function(r,o){if("string"==typeof r)t.__lp.qpdef[r]={sticky:a,refreshModel:!0},null==se.stickyRoutes[e]&&a&&(se.stickyRoutes[e]=a);else if("object"==(void 0===r?"undefined":_typeof(r))){for(var n in r)t.__lp.qpdef[n]={cipher:r[n].cipher,sticky:r[n].hasOwnProperty("sticky")?r[n].sticky:a,refreshModel:!r[n].hasOwnProperty("refreshModel")||r[n].refreshModel},!se.stickyRoutes[e]&&t.__lp.qpdef[n].sticky&&(se.stickyRoutes[e]=!0);t.queryParams[o]=n}}))),e=Re(e),t.routeName=e[e.length-1],function(e,t){for(var r,o=se.routes,n=e.length,i=n-1,a=0;a<n;a++){if(r=e[a],i===a){var s=o[r];s&&s.__lp?s.__lp.def=t:s?s.__lp={def:t}:o[r]={__lp:{def:t}}}else o[r]||(o[r]={});o=o[r]}}(e,t)}He.prototype.run=function(e){e?rt.call(this,this.runLoop.forceFetch,this.fRunningProm.resolve,e):(function(){et.call(this,nt,"nestedPromises","previous",function(){if(c&&!n.running&&!n.aborted){if(n.state=n._trans.state=102,n._trans.triggerEvent(X,n.state),r)if(se.preserveUrlOnBrowserNavigation){r.fromHistory&&r.goValue&&(pe=!0,history.go(-r.goValue)),r.state.data=n._trans.data||r.state.data,o=Lyte.deepCopyObject(r),n.stateObj=r.state;var e=setInterval((function(){o?pe||(clearInterval(e),_e(o),o=void 0):clearInterval(e)}),0)}else r.state.data=n._trans.data||r.state.data,_e(r),n.stateObj=r.state;ne.__lp.trans=n,c.previous=!1,n.runLoop=Me(c),function(e,t){se.linkActiveClass&&se.activeLinkTags.forEach((function(e){e.classList.remove(se.linkActiveClass)})),se.activeLinkTags=[];var r,o,i=e.matched;try{for(var a=function(e){e.getAttribute("lt-prop-route")==i.target&&-1==activeLinkTags.indexOf(e)&&activeLinkTags.push(e)},s=function(e){o.__ltp.queryParams[e]=r.__lp.qpdef[e].cipher&&se.cipher.decryptor?se.cipher.decryptor(i.queryParams[e]):i.queryParams[e]},l=0,d=n.R.length;l<d;l++)r=n.R[l],o=n.routes[l],r.queryParams&&r.queryParams.forEach(s),o.__ltp.dynamicParam=i.dynamicParams[l],l+1==d&&r.__lp.linkTags.forEach(a);gt(t)}catch(e){ht(e)}}(c,n.info),c=r=void 0,n.running=!0}et.call(this,nt,"nestedPromises","current")}.bind(this))}.call(this),ie.title=this.title=this.routes[this.routes.length-1].title||ie.title)},Lyte.$.requiredMixins.router=function(e,t){t.forEach((function(t){var r=ne.__lp.getDefinition(t);e&&r&&bt(r.__lp.options,r,t,!0)}))},Lyte.$.injectServices.router=function(e,t,r,o,n,i){var a={};a.as=e,a.service=t,Lt({services:[a]},void 0,void 0,$t(),!0,i)},this.registerRoute=function(){se.routes?Tt.apply({},arguments):this.__lp.pendingReg.push(arguments)};var Rt=["runLoop","running","paused","R","routes",m,"prom","run",y,"matched","fns"];function Ot(e){for(var t in e)-1==Rt.indexOf(t)&&("info"==t?this.info=Lyte.deepCopyObject(e[t]):this[t]=e[t])}function wt(e){return lt(e,":")}function St(e){return lt(e,"*")}function Ct(e,t){var r=Object.keys(e),o=Object.keys(t);if(r.length!=o.length)return!1;for(var n in e)if(e[n]!=t[n])return!1;return!0}function Pt(e){var t;return"object"==(void 0===e?"undefined":_typeof(e))?t=e:(t={queryParams:{},dynamicParams:[]},Array.from(arguments).forEach((function(e,r){Array.isArray(e)?ht(498,JSON.stringify(e)):0==r?t.route=e:e&&"object"==(void 0===e?"undefined":_typeof(e))?t.queryParams=Lyte.deepCopyObject(e):t.dynamicParams.push(e)}))),t}function kt(e){if(e.route){var t,r=se.routes,o=[],n=function(e,n){if(!(r=Fe(e,r)))throw Error(ft(400,i.target));if(!(t=r.__lp.def))throw Error(ft(422,i.route,n));o.push(t)};if(e._routes)i=e;else{var i={route:Array.isArray(e.route)?e.route:Re(e.route),queryParams:e.queryParams||{},dynamicParams:[],fragment:e.fragment,target:"",refreshRoute:e.refreshRoute,startFrom:e.startFrom,_routes:[]};if(e.dynamicParams)if(e.dpProcessed)i.dynamicParams=Array.from(e.dynamicParams);else var a=Array.from(e.dynamicParams)}try{i.route.forEach(e._routes?n:function(e,t){i.target=i.target?i.target+"."+e:e,i._routes.push(Re(i.target)),n(e,t),a&&i.dynamicParams.push(r.__lp.dkey?a.shift():void 0)}),a&&a.length&&Lyte.error("Extra dynamic params found. Provide exact numbers dynamic params required for the transition "+JSON.stringify(a))}catch(e){return ht(e),!1}return{matched:i,R:o}}this.tagName==Q?ht(498,H,this.outerHTML):ht(499)}this.getRouteInstance=function(e,t){var r;if(ne&&!ne.init&&(r=t||ne.__lp&&ne.__lp.trans||n)&&r.routes){var o=r.routes.length;if(e){if("*"==e)return r.routes;var i=e.split(".").length-1,a=r.routes[i];return a&&a.__lp.objPath==e?a:void 0}return r.routes[o-1]}};var Nt=[L,A,$,E,T,R,O,w,S],xt=function(e,t,o,i,s){var l=this,d=s||t;for(var c in d)!s&&lt(Nt,c)||("__lp"==c?this.__lp=Lyte.deepCopyObject(d.__lp):this[c]=d[c]);function p(e){var t=Ne(e),o={matched:e,R:n.R};return r={data:n.data,url:t,fromHistory:!1},je(t,It(o)),a._trans}i.transComp&&!i.transComp.rendered[o]&&i.transComp.redirected&&i.transComp.redirected.index<o&&(delete this.__lp.loadDependencies,delete this.__lp.loadResources,this.$={},delete this.currentModel),this.__ltp={queryParams:{}},this.__lp&&this.__lp.toBeUsed&&this.__lp.toBeUsed.length&&(l=this,Lyte.extendService({services:this.__lp.toBeUsed||[],type:"route",ins:this,callback:function(e,t,r,o){var n={};n.key=t,n.service=o,Lyte.extendService({services:[n],type:"route",ins:l})}})),this.transition=a._trans,this.parent=e[o-1],s||(this.$={},this.init&&this.init(),this.throwEvent=void 0!==Lyte.Component&&Lyte.Component.throwEvent),this.replaceWith=ne.replaceWith,this.transitionTo=ne.transitionTo,this.removeFromCache=function(e){Lyte.removeFromCache.assign(e)},this.refresh=function(e){var t=Re(this.__lp.objPath).length-1,o=Array.from(n.matched.route),i={matched:n.matched,R:n.R,transComp:{unRendered:o.splice(t),rendered:o}};if(n.abort({state:308,iAbort:!0}),r={replace:!0,data:n.data,fromHistory:!1,url:n.url},je(n.url,i),e&&e.refreshTemplate)for(var s,l=t;s=a.routes[l];l++)delete s.component;return a._trans},this.setTitle=function(e){ie.title=this.title=e},this.getQueryParams=function(){return this.__ltp.queryParams||{}},this.getDynamicParam=function(){return this.__ltp.dynamicParam},Object.defineProperty(l,"$lg",{value:Lyte.__gl}),this.getRouteInstance=function(e){return ne.getRouteInstance(e)},this.setDynamicParam=function(e){if(e&&this.__ltp.dynamicParam&&this.__ltp.dynamicParam!=e){var t=Array.from(n.matched.dynamicParams);return t.splice(this.__lp.objPath.split(".").length-1,1,e),p(jt(n.matched,{dynamicParams:t}))}return n._trans},this.setQueryParams=function(e,t,r){var o,i={};"object"==(void 0===e?"undefined":_typeof(e))?(i=e,r=t):i[e]=t,"object"==(void 0===r?"undefined":_typeof(r))&&(o=r.refresh),o=r;var a=jt(n.matched,{queryParams:Object.assign({},n.matched.queryParams,i)});return Ct(n.matched.queryParams,a.queryParams)?n._trans:(a.refreshModel=null==a.refreshModel?o:a.refreshModel,p(a))}};function jt(e,t){var r=Object.assign({},e);return r.route=t.route||Array.from(e.route),r.dynamicParams=t.dynamicParams||Array.from(e.dynamicParams),r.queryParams=t.queryParams||Object.assign(e.queryParams),r}var Dt=[L,A,$,E,T,R,O,w];function It(e){if(n)if(n.running){var t=e.matched;if(102==n.state&&n.prom&&n.prom.hook==R){var r=De(n,t,e.R),o=Dt.indexOf(n.prom.hook)<=5?n.prom.index:n.prom.index+1,i=De(s,t,e.R);r.common.length<i.common.length?(r.rendered.length<i.rendered.length&&(e.prevTrans=s,n.runLoop.templateToRemove.length&&n.runLoop.templateToRemove.pop()),r=i,n.prom.index<=i.common.length-1&&(r.redirected=n.prom)):r.common.length-1>=o&&n.prom.index<=r.common.length-1&&(e.prevTrans=n,r.redirected=n.prom)}var a={route:t.target,queryParams:t.queryParams,dynamicParams:t.dynamicParams.filter(Oe)};ne.checkIfSameRoute(n.info,a)&&!n.aborted?n.pause({iPause:!0}):n.abort({state:409,iAbort:!0}),e.transComp=r}else n&&!n.aborted&&n.abort({state:409,iAbort:!0});return e}return this}}(window),function(e){var t=Lyte;t.Security={_ourSanitizerInstance_:{},_userSanitizerInstance_:{},_eM:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;","=":"&#x3D;"},_eR:/[&<>"'`=]/g,_eF:function(e){return this._eM[e]},escape:function(e){return"string"!=typeof e&&(e=""+e),e.replace(this._eR,this._eF.bind(this))}};var r={GLOBAL_TAGS:[],GLOBAL_ATTRIBUTES:[],FORBID_TAGS:[],FORBID_ATTR:[]};t.Security._ourSanitizerInstance_=ZSEC.HTMLPurifier(r),t.Security._ourSanitizerInstance_._GLOBAL_TAGS=r.GLOBAL_TAGS,t.Security._ourSanitizerInstance_._GLOBAL_ATTRIBUTES=r.GLOBAL_ATTRIBUTES,r.GLOBAL_ATTRIBUTES.push("yield-name","lt-prop-route","lt-prop-dp","lt-prop-fragment","lt-prop-qp","lt-prop","lt-prop-class","lt-prop-id","lt-prop-rel","lt-prop-title","lt-prop-style","lt-prop-target","lt-prop-td","lt-prop-custom","lt-prop-target","lt-prop-id","lt-prop-class","lt-prop-style","lt-prop-rel","lt-prop-title"),r.GLOBAL_TAGS.push("link-to"),t.Security._ourSanitizerInstance_._FORBID_TAGS=r.FORBID_TAGS,t.Security._ourSanitizerInstance_._FORBID_ATTR=r.FORBID_ATTR,t.Security.createSanitizer=function(e){e.GLOBAL_ATTRIBUTES||(e.GLOBAL_ATTRIBUTES=[]),e.FORBID_TAGS||(e.FORBID_TAGS=[]),e.FORBID_ATTR||(e.FORBID_ATTR=[]),e.GLOBAL_TAGS||(e.GLOBAL_TAGS=[]),e.GLOBAL_ATTRIBUTES.push("yield-name","lt-prop-route","lt-prop-dp","lt-prop-fragment","lt-prop-qp","lt-prop","lt-prop-class","lt-prop-id","lt-prop-rel","lt-prop-title","lt-prop-style","lt-prop-target","lt-prop-td","lt-prop-custom","lt-prop-target","lt-prop-id","lt-prop-class","lt-prop-style","lt-prop-rel","lt-prop-title"),e.GLOBAL_TAGS.push("link-to");for(var r=Array.from(e.GLOBAL_TAGS),o=[],n=0;n<r.length;n++){S._registeredComponents[r[n]]?o=S._registeredComponents[r[n]].observedAttributes:Lyte.registeredCustomComponent[r[n]]&&(o=Lyte.registeredCustomComponent[r[n]].observedAttributes);for(var i=0;i<o.length;i++)-1==e.GLOBAL_ATTRIBUTES.indexOf(o[i])&&e.GLOBAL_ATTRIBUTES.push(o[i])}return t.Security._userSanitizerInstance_=ZSEC.HTMLPurifier(e),t.Security._userSanitizerInstance_._GLOBAL_TAGS=e.GLOBAL_TAGS,t.Security._userSanitizerInstance_._GLOBAL_ATTRIBUTES=e.GLOBAL_ATTRIBUTES,t.Security._userSanitizerInstance_._FORBID_TAGS=e.FORBID_TAGS,t.Security._userSanitizerInstance_._FORBID_ATTR=e.FORBID_ATTR,t.Security._userSanitizerInstance_};var o=["focus","focusin","focusout","resize","scroll","click","dblclick","mousedown","mouseup","mousemove","mouseover","mouseout","change","select","submit","keydown","keypress","keyup","contextmenu"],n="delete";function a(){Object.defineProperty.apply(Object,arguments)}function s(e,t){e[t]||a(e,t,{value:new Set,enumerable:!1,writable:!0,configurable:!0})}function l(e,t){e.add(t)}function d(e,t){e[t]||a(e,t,{value:[],enumerable:!1,writable:!0,configurable:!0})}function c(){return document.createDocumentFragment()}function p(e){return document.createElement(e)}function u(e,t,r){e.insertBefore(t,r)}function f(e,t,r){e[t][n](r),e[t].size||delete e[t]}t.registerErrorCodes({LC001:"Error while parsing custom prop handler attribute {0}. Check if the value provided is a valid JSON",LC002:"{0} Component is not compiled. Please compile using Lyte CLI",LC003:"Helper named {0} is not defined",LC004:"Action named {0} doesn't exists",LC005:"Lyte.objectUtils doesn't support {0} function",LC006:"Lyte.arrayUtils doesn't support {0} function",LC007:"Component name not specified in Lyte.Component.render",LC008:"Specified outlet {0} doesn't exists - Lyte.Component.render",LC009:"Method named {0} doesn't exists in {1} component",LC010:"Parent Node / reference Node not provided for insertBefore method"});var h=navigator.userAgent;if(h.match(/rv:11/)&&(t._ie=!0,e.action=function(){}),h.match("Edge")){var y=p("div");y.innerHTML="<template><div>c</div></template>",y.querySelector("template").childNodes.length?t._ie=!0:t._ed=!0,y.remove()}var v=function(e){function t(){_classCallCheck(this,t);var e=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.attributes.t||(C.frSpecial=!0),e}return _inherits(t,HTMLElement),t}();if(t._ie||t._ed){var m=c();m.appendChild(document.createTextNode("  dummy ")),m.childNodes[0].replaceWith(document.createTextNode("changed")),"changed"!==m.childNodes[0].textContent&&(t._rwpf=!0),t._ms=!0}t.Component={},Lyte.Compile={};var _=t.Component;function g(){}t.arrayUtils=function(){return C.aF.apply(C,arguments)},t.objectUtils=function(){return C.oF.apply(C,arguments)},_.register=function(){C.registerComponent.apply(C,arguments)},_.registerHelper=function(){C.registerHelper.apply(C,arguments)},_.set=function(){C.set.apply(C,arguments)},_.registeredHelpers={},_.registeredComponents={},_.registerCustomPropHandler=function(e){C.String.dasherize(e),e=C.String.toCamelCase(e),-1===C.customPropHandlers.indexOf(e)&&(C.customPropHandlers.push(e),E.prototype[e]=function(){var t=arguments.length,r=arguments[0],o=arguments[2],n=this.component.data;if(!r){var i={};for(var a in n)if(a.startsWith(e)){var s=a.substring(e.length);i[s=C.String.lowerCaseFirstLetter(s)]=n[a]}return i}if("string"==typeof r){if(!(t>1))return n[e+C.String.upperCaseFirstLetter(r)];this.set(e+C.String.upperCaseFirstLetter(r),arguments[1],o)}else if("object"===(void 0===r?"undefined":_typeof(r)))for(var l in r){var d=e+C.String.upperCaseFirstLetter(l);this.set(d,r[l],arguments[1])}},C.customPropRegex=new RegExp("^("+C.customPropHandlers.join("|")+")"))},_.unregisterComponent=function(e){if(_.registeredComponents[e]){var r=C._registeredComponents[e];if(r.activeInstances>0)t.warn("There are active instances of the component "+e+" and hence cannot be unregistered");else{r._properties={},r.component=r._mixins=r._actions=r._template=r._dynamicNodes=null,r._callBacks={},r._observers=[],r._data=void 0,r._methods={},r.prototype.get=g,r.prototype.set=g,Object.defineProperty(r.prototype,"setData",{configurable:!0,writable:!0,value:function(e,t){if(this._initProperties=this._initProperties||{},"string"==typeof e)this._initProperties[e]=t;else if("object"===(void 0===e?"undefined":_typeof(e)))for(var r in e)this._initProperties[r]=e[r]}}),Object.defineProperty(r.prototype,"setMethods",{configurable:!0,writable:!0,value:function(e,t){if(this._initMethods=this._initMethods||{},"string"==typeof e)this._initMethods[e]=t;else if("object"===(void 0===e?"undefined":_typeof(e)))for(var r in e)this._initMethods[r]=e[r]}}),delete _.registeredComponents[e];var o=document.querySelector("template[tag-name="+e+"]");o&&o.remove();var n=r._helperTemplate;n&&n.remove(),r._depthTemp&&r._depthTemp.remove()}}else t.warn("Component "+e+" not yet registered")},Lyte.createCustomElement=function(e,t){var r=t.constructor;delete t.constructor;var o=t.connectedCallback;delete t.connectedCallback;var n=t.attributeChangedCallback;delete t.attributeChangedCallback;var i=t.disconnectedCallback;delete t.disconnectedCallback,this.defProperty=function(e,t,r){var o={};r.get&&(o.get=r.get),r.set&&(o.set=r.set),Object.defineProperty(e,t,o)};var a=function(t){function a(){_classCallCheck(this,a);var t=_possibleConstructorReturn(this,(a.__proto__||Object.getPrototypeOf(a)).call(this));return t.isNewComp(e)?t.executeCallbacks(r,arguments):t.__lyteIgnore=!0,t}return _inherits(a,HTMLElement),_createClass(a,[{key:"connectedCallback",value:function(){this.__lyteIgnore||this.hasAttribute("lyte-rendered-ce")||(this.executeCallbacks(o,arguments),this.setAttribute("lyte-rendered-ce",""))}},{key:"attributeChangedCallback",value:function(){this.__lyteIgnore||this.executeCallbacks(n,arguments)}},{key:"disconnectedCallback",value:function(){S.ignoreDisconnect||this.__lyteIgnore||this.executeCallbacks(i,arguments)}},{key:"executeCallbacks",value:function(e,t){e&&e.apply(this,Array.from(t))}},{key:"isNewComp",value:function(e){return!this.hasAttribute("lyte-rendered-ce")}}]),a}(),s=t.static;if(s){for(var l in s)"object"===_typeof(s[l])?this.defProperty(a,l,s[l]):Object.defineProperty(a,l,{value:s[l]});delete t.static}for(var l in t)"object"===_typeof(t[l])?this.defProperty(a.prototype,l,t[l]):Object.defineProperty(a.prototype,l,{writable:!0,value:t[l]});t.static=s,t.constructor=r,t.connectedCallback=o,t.attributeChangedCallback=n,t.disconnectedCallback=i,"complete"===document.readyState||"interactive"===document.readyState?customElements.define(e,a):S.toBeRegistered.push({name:e,def:a}),Lyte.registeredCustomComponent[e]=a};var b="undefined"!=typeof HTMLElement?HTMLElement:Element;function L(){t._ie||document.body.appendChild(C.lyteComponentsDiv),document.body.appendChild(C.hDiv);for(var r=o,n=0;n<r.length;n++){var i=r[n];document.body.addEventListener(i,A,!0)}var a=C.toBeRegistered;if(a.length){for(var s=0;s<a.length;s++)customElements.define(a[s].name,a[s].def);C.toBeRegistered=[]}if(/iPad|iPhone|iPod/.test(h)&&!e.MSStream){var l=p("style");l.innerHTML="* { cursor : pointer}",document.head.appendChild(l)}}t.appendTemplateDiv=function(){document.body.appendChild(C.tDiv),document.body.appendChild(C.h1Div)},document.addEventListener("change",(function(e){var t=e.target||e.srcElement;if(t._attributeDetails){var r="value";"checkbox"!==t.type&&"radio"!==t.type||(r="checked");var o=[],n=t._attributeDetails[r];if(n&&n.isLbind){var i=t;if(!t._callee){for(;i&&!C.isCustomElement(i)&&"LYTE-YIELD"!==i.tagName;){if("BODY"===i.tagName){i=null;break}i=i.parentNode}i&&"LYTE-YIELD"===i.tagName?t._callee=i._registerYield._callee:t._callee=i}var a=t._callee;t&&C.adCx(t,o);var s=C.getNew(a.component.data,n.dynamicValue);s.context&&(C.set(s.context,s.lastKey,t[r]),t&&C.rmCx(t,o))}}}));var A=function(r){var o,n=r.type,i=r.target;if(/^(click|dblclick)$/.test(n)&&i.getAttribute&&null!=i.getAttribute("lyte-state"))r.preventDefault();else{r.currentTarget!==document.body&&(i=r.currentTarget),e.event||(o=!0,e.event=r);for(var a=!1;i&&i.getAttribute&&(!i.getAttribute(n)||i.hasAttribute("disabled"))&&"BODY"!=i.tagName&&(!C.hasLyteEvents(i,n)||!(a=C.handleLyteEvents(i,r)));)i=i.parentNode;if(!a&&i){var s=i;if(!i._callee){for(;s&&!C.isCustomElement(s)&&"LYTE-YIELD"!==s.tagName;){if("BODY"===s.tagName){s=null;break}s=s.parentNode}s&&"LYTE-YIELD"===s.tagName?i._callee=s._registerYield._callee:i._callee=s===i?void 0:s}if(i._evBoundEvents&&i._evBoundEvents[n]){i._callee?i._callee.constructor._actions:i.constructor._actions;var l=i._evBoundEvents[n],d=t.deepCopyObject(l);C.skipArgProcessing(d,r,i),C.throwAction.call(i,i,n,d,void 0,void 0,i,r,void 0,!0)}else if(i.getAttribute&&i.getAttribute(n)&&i._boundEvents&&i._boundEvents[n]){i._callee.constructor._actions,i.getAttribute(n).split(" => ")[1];var c=i._boundEvents[n],p=t.deepCopyObject(c);C.skipArgProcessing(p,r,i),C.throwAction.call(i._callee,i._callee,n,p,void 0,void 0,i,r)}if("LABEL"===i.tagName){var u=i.querySelector("input");if(u&&u.getAttribute(n)){i._callee.constructor._actions,u.getAttribute(n).split(" => ")[1];var f=i._boundEvents[n],h=t.deepCopyObject(f);C.skipArgProcessing(h,r,i),C.throwAction.call(i._callee,i._callee,n,h,void 0,void 0,u,r)}}o&&(e.event=void 0)}}},$=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,HTMLElement),_createClass(t,[{key:"connectedCallback",value:function(){var e;this._callee=this._callee||C.getCallee(this.parentNode,this),!this._registerYield&&this._callee&&(this._callee._fR&&this._callee._fR._yieldCallee?this._registerYield={_callee:this._callee._fR._yieldCallee.component.$node}:this._callee._yields&&(e=this.attributes["yield-name"])&&(e=e.nodeValue)&&this._callee._yields[e]&&(this._registerYield={_callee:this._callee._yields[e]._callee}))}},{key:"disconnectedCallback",value:function(){if(!C.ignoreDisconnect&&!this._deleted&&(this._deleted=!0,this._properties)){var e=[];C.adCx(this,e),C.removeSelectedBindingDeep(this._properties,this.component.data,!0);var t=this._registerYield;if(t){var r=[];for(var o in C.adCx(t,r),this._dynamicProperty)if(this._dynamicProperty[o].isActualNode)this._dynamicProperty[o].isActualNode._helperNodes.delete(this);else{var n=t._callee.getProperty(o)._helperNodes;n&&n.delete(this)}this._dynamicProperty={};for(var i=0;i<this._helpers.length;i++)t._callee.removeHelpers(this._helpers[i]);this._helpers=[],C.rmCx(t,r),C.rmCx(this,e)}}}},{key:"getProperty",value:function(e){var t=e.match(/([^[\].]+|\[\])/g),r=this;r._properties[t[0]]||(r._properties[t[0]]={}),a(r=r._properties[t[0]],"_path",{enumerable:!1,value:t[0]});for(var o=1;o<t.length;o++)(t[o].startsWith("'")||t[o].startsWith('"'))&&(t[o]=t[o].substring(1,t[o].length-1)),r[t[o]]||(r[t[o]]={},a(r[t[o]],"_path",{enumerable:!1,value:r._path+"."+t[o]})),r=r[t[o]];return r}}]),t}();customElements.define("lyte-yield",$);var E=function(e){function r(){_classCallCheck(this,r);var e=_possibleConstructorReturn(this,(r.__proto__||Object.getPrototypeOf(r)).call(this));if(e.hasAttribute("lyte-rendered")||e._ccCalled)return e.__lyteIgnore=!0,_possibleConstructorReturn(e);if(!_.registeredComponents[e.localName]){e.__lyteIgnore=!0;var t=C._registeredComponents[e.localName];return t._pendingComponents=t._pendingComponents||[],t._pendingComponents.push(e),_possibleConstructorReturn(e)}return e.actualConstructor(),e}return _inherits(r,b),_createClass(r,[{key:"actualConstructor",value:function(){this.constructor.activeInstances++;var e,t=this.attributes._lyteprop,r=(e=t=t?t.nodeValue:void 0)?C.fRP[e]:void 0,o=this.component=r?r.component:new this.constructor.component;this._properties={},o.methods={},o._config=this.constructor._config;var n=void 0;if(!r){n=o.data={};var i=this.constructor._data?this.constructor._data.apply(o):{};for(var s in a(n,"__component__",{value:this,configurable:!0,writable:!0,enumerable:!1}),n.errors={},o.__data=i,i){var l=i[s];n[s]=l.default,/^(object|array)$/.test(l.type)&&(l.watch||l.hasOwnProperty("items")||l.hasOwnProperty("properties"))&&Lyte.establishObjectBinding(n,s,!1,void 0,void 0,!!l.watch||void 0)}if(this.constructor._serviceToBeUsed)for(var d in this.constructor._serviceToBeUsed){var c=this.constructor._serviceToBeUsed[d];if(Lyte.registeredServices.hasOwnProperty(c))this.component[d]=new Lyte.registeredServices[c];else{this.__toRemoveLazy=this.__toRemoveLazy||{};var p=this,u=Lyte.$.requiredServices(d,c,(function(e,t,r,o){p.component[t]=new e,p.__toRemoveLazy[o].forEach((function(e){Lyte.$.toRemoveFromRequiredServices(e)})),delete p.__toRemoveLazy[o]}));this.__toRemoveLazy[c]=this.__toRemoveLazy[c]||[],this.__toRemoveLazy[c].push(u)}}}for(var f in this.constructor._methods)o.methods[f]=this.constructor._methods[f];if(o.$node)for(var h in o.$node)"localName"!=h&&(this[h]=o.$node[h]);o.$node=this;var y=void 0;if(o._config&&(y=1==o._config.clientLifeCycleHooks||"object"==_typeof(o._config.clientLifeCycleHooks)&&o._config.clientLifeCycleHooks.includes("constructor")),r)this._fR=r,delete C.fRP[e];else for(var h in this.callback("constructor"),this._actions=this._actions?this._actions:{},this._callee=this._callee||this.getCallee(this.parentNode),!y&&this.hasAttribute("server-rendered")||this.callback("constructor"),n)C.handleValidation(n,h,n[h],o,!0)&&(n[h]=void 0)}},{key:"getMethods",value:function(e){return this.component.getMethods(e)}},{key:"hasAction",value:function(e){return this.component.hasAction(e)}},{key:"setActions",value:function(e,t){return this.component.setActions(e,t)}},{key:"setMethods",value:function(e,t){return this.component.setMethods(e,t)}},{key:"getCallee",value:function(e){return C.getCallee(e,this)}},{key:"afterConnected",value:function(){var e=this.constructor;if(this.getAttribute("_lyteprop"))return"";for(var t=e._observedAttributes,r=0;r<t.length;r++){var o=t[r];a(this.getProperty(o),"__fromComponent",{value:!0,enumerable:!1})}this.getProperty("errors");var n=Lyte.__gl,i=this.component,s=i.data;if(s.$lg=n,this._initProperties){var l=this._initProperties;for(var d in l){var c,p=i.__data[d];c=!p||p.type===C.getDataType(l[d])||void 0===l[d]&&"boolean"!==p.type?l[d]:C.typeCast(l[d],i.__data[d].type),C.handleValidation(s,d,c,i,!0)||(s[d]=c,p&&/^(object|array)$/.test(p.type)&&(p.watch||p.hasOwnProperty("items")||p.hasOwnProperty("properties"))&&Lyte.establishObjectBinding(s,d,void 0,void 0,void 0,!!p.watch||void 0))}this._initProperties=void 0}if(this._initMethods){var u=this._initMethods;for(var f in u)i.methods[f]=u[f];this._initMethods=void 0}var h=void 0;i._config&&null!=i._config.clientLifeCycleHooks&&(h=1==i._config.clientLifeCycleHooks||"object"==_typeof(i._config.clientLifeCycleHooks)&&i._config.clientLifeCycleHooks.includes("init")),!h&&this.hasAttribute("server-rendered")||(this.callback("init"),this.onCallBack("init")),this.registerYields(),s.lyteUnbound&&(C.unbound=!0);var y="";return s.lyteFastRender?(y=this.renderFast(e._dynamicNodes,e._sta,i),requestAnimationFrame((function(){requestAnimationFrame((function(){C.callCC()}))}))):y=this.renderNodes(e._template,e._dynamicNodes,void 0,void 0,void 0,void 0,this.constructor._tC),y}},{key:"renderComponent",value:function(e,t){var r=e.componentName,o=e.staticAttrs,n=S._registeredComponents[r];if(!n)return"";var i=new n.component;t.component=i,i.data={};var a=n._data?n._data.apply(i):{};for(var s in a)i.data[s]=a[s].default;i.data.errors={},i.__data=a;var l=S._registeredComponents[r]._observedAttributes;for(var d in t.data=t.data||{},o)-1!==l.indexOf(d)&&(t.data[d]=o[d]);var c=t.data;if(c)for(var p in c){var u;u=!i.__data[p]||i.__data[p].type===C.getDataType(c[p])||void 0===c[p]&&"boolean"!==i.__data[p].type?c[p]:C.typeCast(c[p],i.__data[p].type),C.handleValidation(i.data,p,u,i)||(i.data[p]=u)}for(var d in i.methods={},n._methods)i.methods[d]=n._methods[d];i.$node={querySelector:g,localName:r},i.init&&i.init.apply(i);var f=void 0;if(n._callBacks&&(f=n._callBacks.init))for(var h=0;h<f.length;h++)f[h].value.apply(i);return t.unbound=!0,delete i.$node.querySelector,this.renderFast(S._registeredComponents[r]._dynamicNodes,S._registeredComponents[r]._sta,i,t)}},{key:"renderFast",value:function(e,r,o,n){var i,a,s=this;o&&(a=this.component,this.component=o);for(var l=this.component.data,d="",c=r,p=r.cc,u=0;u<p.length;u++)if(null!=p[u]){var f=p[u],h=e[f];if(h.dynamicValue){var y=C.getDD(l,h.newDynamicValue);y=null==y||null==y?"":y,d+=Lyte.Security.escape(y)}else if(h.helperInfo){C.ffr=!0;var v=this.processHelper({name:h.helperInfo.name,args:this.processArgs(this,h,[],void 0,void 0,!0)},void 0);C.ffr=!1,v=null==v||null==v?"":v,d+="unescape"===h.helperInfo.name?v:Lyte.Security.escape(v)}else if(h.type)switch(h.type){case"for":var m,g=e[f-1].attr.items;g.dynamicValue?m=C.getDD(l,g.newDynamicValue):g.helperInfo&&(m=this.processHelper({name:g.helperInfo.name,args:this.processArgs(this,g,[],void 0,void 0,!0)},void 0));var b=h._args.item||"item",L=h._args.index||"index",A="";if(m&&m.length){for(var $=l[b],E=l[L],T=0;T<m.length;T++){var R=m[T];l[b]=R,l[L]=T,A+=this.renderFast(h.dynamicNodes,h._sta,void 0,n)}l[b]=$,l[L]=E}d+=A;break;case"forIn":var O,w=e[f-1].attr.object;w.dynamicValue?O=C.getDD(l,w.newDynamicValue):w.helperInfo&&(O=this.processHelper({name:w.helperInfo.name,args:this.processArgs(this,w,[],void 0,void 0,!0)},void 0));var S=h._args.value||"value",P=h._args.key||"key",k="",N=void 0;if(O&&(N=Object.keys(O))){for(var x=l[S],j=l[P],D=0;D<N.length;D++){var I=N[D];l[S]=O[I],l[P]=I,k+=this.renderFast(h.dynamicNodes,h._sta,void 0,n)}l[b]=x,l[L]=j}d+=k;break;case"if":case"switch":var B,M,F=e[f-1].attr.value;if(F.dynamicValue?B=C.getDD(l,F.newDynamicValue):F.helperInfo&&(B=this.processHelper({name:F.helperInfo.name,args:this.processArgs(this,F,[],void 0,void 0,!0)},void 0)),B)M="if"===h.type?"true":B.toString();else if("if"===h.type)M="false";else switch(B){case void 0:M="undefined";break;case null:M="null";break;case!1:M="false";break;case"":M='""'}var K=h.cases[M];if(K)for(;K&&(d+=this.renderFast(K.dynamicNodes,K._sta,void 0,n),K.additional);)K=K.additional.next?h.cases[K.additional.next]:h.default;else(K=h.default)&&K._sta&&(d+=this.renderFast(K.dynamicNodes,K._sta,void 0,n));break;case"attr":for(var H=void 0,q=void 0,U=e.length,z=f+1;z<U;z++){var V=e[z];if("registerYield"!==V.type&&"componentDynamic"!==V.type&&"insertYield"!==V.type&&"component"!==V.type)break;if(("componentDynamic"===e[z].type||"insertYield"===e[z].type||"component"===e[z].type)&&e[z].position.toString()==e[f].position.toString()){if("componentDynamic"!=e[z].type){H=e[z];break}if(_.registeredComponents[e[z].componentName]){H=e[z];break}}}var G=void 0;H&&(G="component"!==H.type,i=C.fRC++,q=C.fRP[i]={data:{}}),H&&"component"===H.type||(d=d.substring(0,d.length-11));var W=h.attr,J={};for(var Y in W)if(W[Y].dynamicValue){var Q=W[Y].newDynamicValue?C.getDD(l,W[Y].newDynamicValue):this.get(W[Y].dynamicValue);q?(q.data[W[Y].camelCase]=Q,"string"==typeof Q&&G&&(d=d+(Q=this.formatValue(Y,Q))+" ")):d=d+(Q=this.formatValue(Y,Q))+" "}else if(W[Y].helperInfo)if("action"===W[Y].helperInfo.name){var X=W[Y].helperInfo.args[0],Z=void 0;X.startsWith('"')||X.startsWith("'")?Z=X.substring(1,X.length-1):(t.warn("Deprecation warning. Action name "+X+" must be in quotes"),Z=X);var ee=this.processArgs(this,W[Y],[],"__lyteEvent__","__lyteNode__");J[W[Y].globalEvent||-1!==W[Y].name.indexOf("-")?W[Y].name:W[Y].name.substr(2)]={name:Z,args:W[Y].helperInfo.args,actArgs:ee,globalEvent:!!W[Y].globalEvent,skipArgProcessing:!0}}else if("method"===W[Y].helperInfo.name){var te;n?n.methods:this.component.methods,q&&function(){var e=q.methods=q.methods||{},t=n?n.component:s.component,r=s.processArgs(s,W[Y],[],"__lyteEvent__","__lyteNode__");te=function(){this.$node;var e=r.slice(1),o=r[0],n=Array.from(arguments),i=e.concat(n);return t.methods[o].apply(t,i)},e[W[Y].camelCase]=te}()}else{var re=this.processHelper({name:W[Y].helperInfo.name,args:this.processArgs(this,W[Y],[],void 0,void 0,!0)},void 0);q?(q.data[W[Y].camelCase]=re,"string"==typeof re&&G&&(d=d+(re=this.formatValue(Y,re))+" ")):d=d+(re=this.formatValue(Y,re))+" "}if(Object.keys(J).length){var oe=C.fRC++;d=d+"lyteaction="+oe+" ",C.fRP[oe]=J,J.componentName=this.component.$node.localName||"undefined"}q&&"component"!==H.type&&"insertYield"!==H.type&&(d=d+"_lyteprop="+i+" "),h.attrHandling||(c[u+1]=c[u+1].substr(1),h.attrHandling=!0);break;case"insertYield":var ne=void 0!==i?C.fRP[i]:void 0;ne&&delete C.fRP[i],i=void 0;var ie=void 0,ae=h.yieldName||ne.data.yieldName;ne&&delete ne.data.yieldName;var se=void 0;if(n&&n.yields)ie=n.yields[ae],se=n._yieldCallee;else{if(!(ie=this._yields[ae]))break;se=ie._callee}if(ie){var le=void 0,de=void 0;se instanceof HTMLElement?le=se:(le=this,de=this.component,this.component=se.component);var ce={},pe=[];if(ie._cx&&C.adCx(ie,pe),ne)for(var Y in ne.data)ce[Y]=le.component.data[Y],le.component.data[Y]=ne.data[Y];var ue=le.component;for(var fe in a&&a.$node==se&&(ue=a),d+=le.renderFast(ie.dynamicNodes||ie._dynamicNodes,ie._sta,ue,se),ce)le.component.data[fe]=ce[fe];ie._cx&&C.rmCx(ie,pe),de&&(le.component=de)}break;case"component":if(void 0!==i){var he=C.fRP[i],ye=he.data.componentName;ye&&(_.registeredComponents[ye]?(d=d+"<"+ye+" _lyteprop="+i+">",i=void 0,d=(d+=this.renderComponent({componentName:ye},he,l))+"</"+ye+">"):d+="component not registered")}break;case"componentDynamic":var ve=void 0!==i?C.fRP[i]:{};i=void 0,d+=this.renderComponent(h,ve,l);break;case"registerYield":var me=void 0;void 0!==i?me=C.fRP[i]:(i=C.fRC++,me=C.fRP[i]={}),me.yields=me.yields||{},me.yields[h._args["yield-name"]]=h,me._yieldCallee||(me._yieldCallee=n||{component:this.component})}else d+=c[u]}else d+=c[u];return o&&(this.component=a),d}},{key:"formatValue",value:function(e,t){var r=void 0===t?"undefined":_typeof(t);""===t&&(r="undefined");var o=void 0,n="src"==e||"href"==e;switch(r){case"boolean":return t?e:"";case"object":return o=void 0!==Record&&t instanceof Record?JSON.stringify(t.$.toJSON()):JSON.stringify(t),e+'="'+(n?o:Lyte.Security.escape(o))+'"';case"undefined":return e;default:return e+'="'+(n?t:Lyte.Security.escape(t))+'"'}}},{key:"renderNodes",value:function(e,r,o,n,i,s,l){n=n||{};var d=void 0,c=this.constructor,f=!1;t._ms||!e?(f=!0,d=C.getContentForIE(l,c)):e.hasAttribute("depth")?(f=!0,d=C.getContentForIE(e,c)):d=e.content.cloneNode(!0,"lyte");for(var h=[],y=[],v=void 0,m=new Map,_=0;_<r.length;_++){var g=r[_],b=g.type,L=d;if(L=I(L,g.position),r._cache||(r._cache={}),"componentDynamic"===b)n.node?L._cx=n:o&&(L._cx=o._cx);else if("text"===b)this.bindNode(L,void 0,o,n,r[_],y,i,void 0,r._cache,b,void 0,m);else if("attr"===b){if(L._attributeDetails=g.attr,"LYTE-YIELD"===L.nodeName){L._callee=this,L.component={},L.component.data={},a(L.component.data,"__component__",{value:L,configurable:!0,writable:!0,enumerable:!1}),L._properties={};for(var A=0;A<L.attributes.length;A++){var $=L.attributes[A];"is"!==$.nodeName&&"yield-name"!==$.nodeName&&(L._properties[C.String.toCamelCase($.nodeName)]={})}}var E=[];for(var T in g.attr){var R=g.attr[T];R._depthTemp=g._depthTemp;var O=T;if(R&&(R.dynamicValue||R.helperInfo)){n.node?L._cx=n:o&&(L._cx=o._cx);var w=void 0,S=void 0;if(R.helperInfo&&"action"===R.helperInfo.name){L._boundEvents=L._boundEvents||{},S=(w=R.helperInfo.args[0]).startsWith('"')||w.startsWith("'")?w.substring(1,w.length-1):w;var P=R.globalEvent||-1!==O.indexOf("-")?O:O.substr(2);L._boundEvents[P]={name:S,args:R.helperInfo.args},Math.floor(1e3*Math.random())}if(!R.globalEvent){L.hasAttribute(O)||L.setAttribute(O,"{{dummy}}");var k=this.bindNode(L.attributes.getNamedItem(O),E,o,n,R,void 0,i,void 0,r._cache,b,_);k!==L.attributes.getNamedItem(O)&&(L._removedAttributes=L._removedAttributes||{},L._removedAttributes[O]=k)}}}g.attr&&Object.keys(g.attr).length&&(L._callee=this);for(var N=0;N<E.length;N++)L.removeAttribute(E[N])}else if(/^(for|forIn|component)$/.test(b)){n.node?L._cx=n:o&&(L._cx=o._cx),L._dynamicNodes=g.dynamicNodes,t._ms&&(L._tC=g.templateContent),g.actualTemplate&&(L._tC=g.actualTemplate);var x=void 0;switch(b){case"for":L._ht=g._ht,x=this.updateForHelper(L,{type:"default"},n.node?n:void 0,i,g._sta);break;case"forIn":L._ht=g._ht,x=this.updateForInHelper(L,{type:"default"},n.node?n:void 0,i);break;case"component":x=this.updateDynamicComponent(L,!1,n.node?n:void 0,i,_,o)}x&&h.push(x)}else if(/^(if|switch)$/.test(b)){L._cases=g.cases,L._default=g.default,L._ht=g._ht,n.node?L._cx=n:o&&(L._cx=o._cx),g.actualTemplate&&(L._tC=g.actualTemplate,L._origTemplate||(t._ie?L._origTemplate=p("template"):L._origTemplate=g._depthTemp.cloneNode(!0),L.hasAttribute("value")&&L._origTemplate.setAttribute("value",L.getAttribute("value"))));var j=this.updateSwitchHelper(b,L,n.node?n:void 0,void 0,i,void 0,m);if(j){if(h.push(j),j.toAppendMain.querySelector("template[is=break]")){L._isStopped="break",d=Lyte.Compile.getTrimmedContent(d,g.position,void 0),v=g.position;break}if(j.toAppendMain.querySelector("template[is=continue]")){L._isStopped="continue",d=Lyte.Compile.getTrimmedContent(d,g.position,void 0);break}}}else"registerYield"===b?(n.node?L._cx=n:o&&(L._cx=o._cx),L._dynamicNodes=g.dynamicNodes,L._sta=g._sta,L._ht=g._ht,t._ms&&(L._tC=g.templateContent),L._callee=this):"insertYield"===b&&(n.node?L._cx=n:o&&(L._cx=o._cx),L.component=L.component||{data:{}},L._properties=L._properties||{},L.component=L.component||{data:{}},L._properties=L._properties||{},this.updateYield(L,!1,n.node?n:void 0))}r._cache=void 0;for(var D=0;D<y.length;D++){var B=y[D].dynamicPositions,M=B.initialNode,F=B.dynamicNodeValue,K=F.childNodes.length;K||(F.appendChild(document.createTextNode("")),K=1);var H=F.childNodes[0];if(t._rwpf&&"#document-fragment"===M.parentNode.nodeName){for(;F.childNodes.length;)u(M.parentNode,F.childNodes[0],M);M.remove()}else M.replaceWith.apply(M,F.childNodes);y[D].dynamicPositions={startingNode:H,length:K}}return m.size&&m.forEach((function(e,t){e.pN.insertBefore(t,e.cN),e.cN.nextSibling?e.pN.insertBefore(document.createElement("textend"),e.cN.nextSibling):e.pN.appendChild(document.createElement("textend"))})),v&&((s=s||{}).stop=!0),o?n.type?(o._helpers[n.itemIndex]=h,f&&(d=c.createDocFragment1(d)),d):(o._helpers=o._helpers||[],o._helpers.push.apply(o._helpers,h),f&&(d=c.createDocFragment1(d)),d):(this.executeBlockHelpers(h),f&&(d=c.createDocFragment1(d)),d)}},{key:"executeBlockHelpers",value:function(e,t){for(var r=0;r<e.length;r++){var o=e[r].lastNode,n=o.parentNode;o._placeHolder&&(n=(o=o._placeHolder).parentNode),u(n,e[r].toAppendMain,o),e[r]=e[r].lastNode}}},{key:"updateBlockHelpers",value:function(e,t){for(var r=0;r<e.length;r++)switch(e[r].getAttribute("is")){case"for":this.updateForHelper(e[r],{type:"default"},t);break;case"if":this.updateSwitchHelper("if",e[r],t);break;case"forIn":this.updateForInHelper(e[r],{type:"default"},t);break;case"switch":this.updateSwitchHelper("switch",e[r],t);break;case"component":this.updateDynamicComponent(e[r],!1,t);break;case"insertYield":break;case"yield":case"registerYield":t&&(e[r]._cx=t);break;default:"LYTE-YIELD"===e[r].tagName&&this.updateYield(e[r],!1,t)}}},{key:"attributeChangedCallback",value:function(e,r,o){var n=this.constructor;if(!(n._observedMethodAttributes&&n._observedMethodAttributes[e]||this.__lyteIgnore)){var i=C.String.toCamelCase(e),a=C.customPropHandlers.indexOf(i);if(-1===a){if(r!==o){var s=this.attributes.getNamedItem(e);if(s){if(s.__lyteIgnore)return void(this.attributes.getNamedItem(e).__lyteIgnore=!1)}else if(this["__"+e])return void(this["__"+e]=!1);var l=this.component,d=l.__data[i];if(d&&d.type){var c=d.type;if("string"!==c){var p={attr:e,tagName:this.tagName};if(o=C.typeCast(o,c,p),p.isError)return void t.warn("data type of the value provided for attribute "+e+" of "+this.tagName+" is not valid")}}var u=l.data;u[i]!==o?this.set(i,null===o?void 0:o):C.clearError(u,i)}}else{var f=C.customPropHandlers[a],h=o;if(h)try{for(var y in h=JSON.parse(h)){var v=f+C.String.upperCaseFirstLetter(y);this.set(v,h[y])}}catch(r){t.error("LC001",e)}}}}},{key:"removeHelpersSpecificIndex",value:function(e,t){if(e._helpers[t])for(var r=0;r<e._helpers[t].length;r++)this.removeHelpers(e._helpers[t][r]);if(e._forContent[t]){for(var o=0;o<e._forContent[t].length;o++)e._forContent[t][o].remove();var i=this;Object.keys(e._items[t]._dynamicProperty).forEach((function(t){if(e._dynProps[t]--,!e._dynProps[t]){var r=i.getProperty(t);r._helperNodes&&r._helperNodes[n](e)}})),e._items[t]={_dynamicProperty:{},itemProperty:{},indexProperty:{}}}}},{key:"removeHelpers",value:function(e,t,r){r||(e.remove(),delete("component"===e.getAttribute("is")?this.__dc:this.__h)[e.__lyteId]);var o="delete",n=[];if(C.adCx(e,n),e._forContent)if("for"===e.getAttribute("is")){if(e._helpers)for(var i=0;i<e._helpers.length;i++){for(var a=0;a<e._helpers[i].length;a++)this.removeHelpers(e._helpers[i][a]);e._helpers[i]=[]}for(var s=0;s<e._forContent.length;s++)for(var l=0;l<e._forContent[s].length;l++)e._forContent[s][l].remove();var d=e.getAttribute("item");if(e._items.length){for(var c=e._items[0].itemProperty,p=0;p<e._items.length;p++){var u=e._items[p]._dynamicProperty;for(var f in u){var h=this.getProperty(f);h._helperNodes&&h._helperNodes[o](e)}}if(c)for(var y=0;y<e._items.length;y++)this.removeBindings(_defineProperty({},d,e._items[y].itemProperty),_defineProperty({},d,e._attributes.items[y]))}if(!t&&e._actualBinding){e._attributes.items&&e._attributes.items._bindings&&e._actualBinding._createdBinding&&e._attributes.items._bindings[o](e._actualBinding),e._actualBinding._forHelpers&&e._actualBinding._forHelpers[o](e);var v=e._removedAttributes.items._multipleProperty;e._removedAttributes&&e._removedAttributes.items&&!e._removedAttributes.items.helperValue&&v&&v[0].actProp._forHelpers&&v[0].actProp._forHelpers[o](e)}e._items=[]}else{if(e._helpers)for(var m=Object.keys(e._helpers),_=0;_<m.length;_++){for(var g=0;g<e._helpers[m[_]].length;g++)this.removeHelpers(e._helpers[m[_]][g]);e._helpers[m[_]]=[]}for(var b in e._forContent)for(var L=0;L<e._forContent[b].length;L++)e._forContent[b][L].remove();var A=e._items,$=e.getAttribute("key");for(var E in A){var T=A[E],R=T.itemProperty,O=T._dynamicProperty;for(var w in O){var S=this.getProperty(w);S._helperNodes&&S._helperNodes[o](e)}R&&this.removeBindings(_defineProperty({},$,e._items[E].itemProperty),_defineProperty({},$,e._attributes.object[E]))}t||(e._actualBinding&&(e._attributes.object&&e._attributes.object._bindings&&e._actualBinding._createdBinding&&e._attributes.object._bindings[o](e._actualBinding),e._actualBinding._forHelpers&&e._actualBinding._forHelpers[o](e)),v=e._removedAttributes.object._multipleProperty,e._removedAttributes.object&&!e._removedAttributes.object.helperValue&&v&&v[0].actProp._forHelpers&&v[0].actProp._forHelpers[o](e),e._propBindingObject&&e._attributes.object&&e._attributes.object._bindings&&e._attributes.object._bindings[o](e._propBindingObject)),e._items={}}else if(e._caseContent||e._yieldContent){if(e._helpers){for(var P=0;P<e._helpers.length;P++)this.removeHelpers(e._helpers[P]);e._helpers=[]}if(e._caseContent){for(var k=0;k<e._caseContent.length;k++)e._caseContent[k].remove();for(var N in e._dynamicProperty)if(e._dynamicProperty[N].isActualNode)e._dynamicProperty[N].isActualNode._helperNodes[o](e);else{var x=this.getProperty(N)._helperNodes;x&&x[o](e)}e._dynamicProperty={}}else{for(var j=0;j<e._yieldContent.length;j++)e._yieldContent[j].remove();e._dynamicProperty={}}var D=C.pendingViewPortElements;if(e._inPve&&D.length){var I=D.indexOf(C.getFakeTemplate(e));-1!=I&&D.splice(I,1)}}else if(e._renderedComponent)for(var B in e._renderedComponent)e._renderedComponent[B]&&(e._renderedComponent[B].remove(),e._renderedComponent[B]=null);C.rmCx(e,n)}},{key:"updateYield",value:function(e,r,o){var n=this.constructor;e._callee||(e._callee=this);var i=e._callee._yields[e.getAttribute("yield-name")];if(i){e._registerYield=i;var a=i._callee||e._callee._callee;if(a){i._callee||(i._callee=a),e._dynamicProperty=e._dynamicProperty||{};var s={},l=[];C.adCx(i,l),Object.keys(e._properties).forEach((function(t){s[t]={},s[t].value=a.component.data[t],s[t].property=a._properties[t],a._properties[t]=e._properties[t],a.component.data[t]=e.component.data[t]})),t._ms||!i._ht||i._htA||(i._htA=!0,i.content.append(i._ht.content.cloneNode(!0)));var d=a.renderNodes(i,i._dynamicNodes||[],e,{node:e},!0,void 0,i._tC);e.component.data.lyteUnbound||C.establishBindings(e._properties,e.component.data),a.executeBlockHelpers(e._helpers),Object.keys(e._properties).forEach((function(e){a.component.data[e]=s[e].value,a._properties[e]=s[e].property})),C.rmCx(i,l),e.appendChild(d)}else{if(t._ms){var c=p("div");c.innerHTML=i.outerHTML,t._ie&&(c.firstChild.innerHTML=i.innerHTML);var u=c.childNodes[0];n.splitTextNodes(u),u=n.createDocFragment1(u),e.appendChild(u)}else e.appendChild(i.content.cloneNode(!0,"lyte"));e._helpers=[]}}}},{key:"updateDynamicComponent",value:function(e,t,r,o,n,i){var a=void 0;e._callee=this;var s=e.hasAttribute("lyte-keep-alive");if(!e._renderedComponent){e._renderedComponent={};var l=C.createLyteId(this);this.__dc[l]=e,e.__lyteId=l}e._cx=r||e._cx,e._dynamicProperty=e._dynamicProperty||{};var d=e.getAttribute("component-name")||(e._attributes?e._attributes["component-name"]:void 0);if(d){var c=void 0,f=!1;if(t){if(s&&(C.ignoreDisconnect=!0),e._renderedComponent[e._currentComponent]){var h=e._renderedComponent[e._currentComponent];s?C.hDiv.content.appendChild(h):h.remove()}C.ignoreDisconnect=!1,s||(e._dynamicProperty={}),e._renderedComponent[d]&&s?c=e._renderedComponent[d]:(c=p(d),f=!0)}else c=p(d),f=!0;if(!s&&e._currentComponent&&(e._renderedComponent[e._currentComponent]=null),f){for(var y=0;y<e.attributes.length;y++)"is"!==e.attributes[y].name&&"component-name"!==e.attributes[y].name&&"lyte-keep-alive"!==e.attributes[y].name&&c.setAttribute(e.attributes[y].name,e.attributes[y].value);if(e._attributes)for(var v in e._attributes)"component-name"!==v&&c.setData(C.String.toCamelCase(v),e._attributes[v]);var m=this.renderNodes(e,e._dynamicNodes,e,void 0,o,void 0,e._tC);c.appendChild(m)}return f&&(c._toRegEvnts=e._toRegEvnts),t?(C.ignoreDisconnect=!0,u(e.parentNode,c,e),C.ignoreDisconnect=!1):a={toAppendMain:c,lastNode:e},e._renderedComponent[d]=c,e._currentComponent=d,c._callee=this,c._actions=e._actions,c.setMethods(e._initMethods),c._attributeDetails=e._attributeDetails,c._boundEvents=e._boundEvents,c._cx=e._cx,a}}},{key:"updateForHelper",value:function(e,r,o,n,i){if("TEMPLATE"!==e.tagName){if(Object.keys(e).forEach((function(t){"innerHTML"!==t&&"innerText"!==t&&(e._origTemplate[t]=e[t])})),t._ie){var a=p("div");a.innerHTML=e._tC,e._origTemplate.innerHTML=a.children[0].innerHTML,this.constructor.splitTextNodes(e._origTemplate),e.hasAttribute("depth")&&e._origTemplate.setAttribute("depth",e.getAttribute("depth"))}var s=e._origTemplate._placeHolder=document.createTextNode("");e._origTemplate.setAttribute("item",e.getAttribute("item")),e._origTemplate.setAttribute("index",e.getAttribute("index")),e.hasAttribute("unbound")&&e._origTemplate.setAttribute("unbound","true"),C.replaceWithPf(e,e._origTemplate._placeHolder),(e=C.replaceWithOrigTemplate(e)).setAttribute("is","for"),C.apdNode(e,this),s._helper=e}else if(!e._placeHolder){var l;l=document.createTextNode(""),C.replaceWithPf(e,l),e._placeHolder=l,l._helper=e,C.apdNode(e,this)}if(e._sta=e._sta||i,e._callee=this,e._attributes=e._attributes||{},"update"===r.type&&e._currentItems===e._attributes.items)return{};e._cx=o||e._cx;var d=e.getAttribute("index");d||(e.setAttribute("index","index"),d="index");var f=e.getAttribute("item");f||(e.setAttribute("item","item"),f="item");var h=this.component.data[f],y=this.component.data[d],v=this._properties[f],m=this._properties[d];this._properties[f]=this._properties[d]={};var _=e._attributes.items,g=(e.content,e._dynamicNodes),b=e;e._items||(e._items=[]),e._dynProps=e._dynProps||{};var L=void 0,A=void 0,$=r.firstIndex,E=r.secondIndex,T=r.thirdIndex,R=$+E,O=!0,w=0;if(r)switch(r.type){case"remove":L=$,w=$;for(var S=$,P=E;P>0;P--,S++)this.removeHelpersSpecificIndex(e,S);for(var k=$+E;k<e._items.length;k++)e._items[k]._cx.itemIndex=e._items[k]._cx.itemIndex-E;e._items.splice($,E),e._helpers.splice($,E),e._forContent.splice($,E);break;case"insert":A=$,L=E,w=$+E,e._forContent[$]&&(b=e._forContent[$][0]);for(var N=[],x=[],j=[],D=E,I=$;D>0;D--,I++)N.push([]),x.push({}),j.push([]);e._helpers.splice.apply(e._helpers,[$,0].concat(N)),e._items.splice.apply(e._items,[$,0].concat(x));for(var B=$+E;B<e._items.length;B++)e._items[B]._cx.itemIndex=e._items[B]._cx.itemIndex+E;e._forContent.splice.apply(e._forContent,[$,0].concat(j));break;case"replace":A=$,L=E,w=$+E,this.removeHelpersSpecificIndex(e,$),c(),e._forContent[$+1]&&(b=e._forContent[$+1][0]);for(var M=[],F=[],K=[],H=E,q=$;H>0;H--,q++)M.push([]),K.push([]),F.push({});e._helpers.splice.apply(e._helpers,[$,1].concat(M)),e._items.splice.apply(e._items,[$,1].concat(F));for(var U=$+E;U<e._items.length;U++)e._items[U]._cx.itemIndex=e._items[U]._cx.itemIndex+E-1;e._forContent.splice.apply(e._forContent,[$,1].concat(K)),1==r.secondIndex&&(O=!1);break;case"splice":A=$,L=E,w=$+E;for(var z=T,V=0;z>0;z--,V++)this.removeHelpersSpecificIndex(e,$+V);c(),e._forContent[$+T]&&(b=e._forContent[$+T][0]);for(var G=[],W=[],J=[],Y=E,Q=$;Y>0;Y--,Q++)G.push([]),J.push([]),W.push({});e._helpers.splice.apply(e._helpers,[$,T].concat(G)),e._items.splice.apply(e._items,[$,T].concat(W));for(var X=$+E;X<e._items.length;X++)e._items[X]._cx.itemIndex=e._items[X]._cx.itemIndex+E-T;e._forContent.splice.apply(e._forContent,[$,T].concat(J)),r.secondIndex==r.thirdIndex&&(O=!1);break;case"update":e.getAttribute("item");for(var Z=0;Z<e._items.length;Z++)this.removeHelpersSpecificIndex(e,Z);e._items=[];case"default":e._forContent=[],e._helpers=[],A=0,L=_?_.length:0,w=_?_.length:0;break;default:t.error("Error in updateForHelper")}b||(b=e),b!=e&&e._helpers.length>0&&(r.type,1)&&(b=C.findLastNodeL(b,R,e));var ee=void 0,te=!1,re=C.unbound;if((e.hasAttribute("unbound")||e._attributes&&e._attributes.unbound&&"false"!==e._attributes.unbound)&&(te=!0,C.unbound=!0),!e._fRender&&("lyteFastRender"==e.getAttribute("unbound")||e._attributes&&"lyteFastRender"==e._attributes.unbound)&&(e._fRender=!0),e._currentItems=_,!t._ms&&L-A>0&&e._ht&&!e._htA&&(e.content.append(e._ht.content.cloneNode(!0)),e._htA=!0),"remove"!==r.type){for(var oe="",ne=[],ie=c(),ae=A,se=L;se>0;ae++,se--){e._helpers[ae]=[],e._items[ae]={_dynamicProperty:{},itemProperty:{},indexProperty:{}},this.component.data[f]=_[ae],this.component.data[d]=ae;var le={};le[f]={},le[f]._data=_[ae],le[f]._dyn=[f],le[d]={},le[d]._data=ae,le[d]._dyn=[d],this._properties[f]={},this._properties[d]={};var de={itemValue:f,itemIndex:ae,type:"for",node:e,indexValue:d};e._items[ae]._cx=de;var ce={},pe=void 0;e._fRender?oe+=this.renderFast(g,e._sta,this.component):(g._cache=le,pe=this.renderNodes(e.hasAttribute("depth")?e._depthTemp:e,g,e,de,n,ce,e._tC));for(var ue=Object.keys(e._items[ae]._dynamicProperty),fe=0;fe<ue.length;fe++){var he=ue[fe];e._dynProps[he]?e._dynProps[he]++:e._dynProps[he]=1}if(e._items[ae].itemProperty=this.getProperty(f),e._items[ae].indexProperty=this.getProperty(d),C.unbound||C.establishBindings(_defineProperty({},f,e._items[ae].itemProperty),_defineProperty({},f,e._attributes.items[ae])),e._fRender?ne.push(e._forContent[ae]=[]):e._forContent[ae]=Array.from(pe.childNodes),this.executeBlockHelpers(e._helpers[ae],e),e._fRender||ie.appendChild(pe),ce.stop)break}if(e._fRender){var ye,ve=document.createElement("template");if(ve.innerHTML=oe,ie.appendChild(ve.content),C.processAction(ie),t._ie){ye=[];for(var me=ie.childNodes,_e=0;_e<me.length;_e++)1==me[_e].nodeType&&ye.push(me[_e])}else ye=ie.children;for(_e=0;_e<ne.length;_e++)ne[_e].push(ye[_e]);requestAnimationFrame((function(){requestAnimationFrame((function(){C.callCC()}))}))}C.unbound=re,"default"===r.type?ee={toAppendMain:ie,lastNode:b}:b._placeHolder?u(b._placeHolder.parentNode,ie,b._placeHolder):u(b.parentNode,ie,b),!te&&e._removedAttributes&&e._removedAttributes.items&&!e._removedAttributes.items.helperValue&&e._removedAttributes.items._multipleProperty&&C.establishBindings({items:e._removedAttributes.items._multipleProperty[0].actProp},{items:_})}if(C.unbound=re,O)for(var ge=w;ge<e._items.length;ge++)e._items[ge].indexProperty&&C.affectChanges(e._items[ge].indexProperty);return this.component.data[f]=h,this.component.data[d]=y,this._properties[f]=v,this._properties[d]=m,e._currentItems=_,ee}},{key:"updateForInHelper",value:function(e,r,o,n){if("TEMPLATE"!==e.tagName){if(Object.keys(e).forEach((function(t){"innerHTML"!==t&&"innerText"!==t&&(e._origTemplate[t]=e[t])})),t._ie){var i=p("div");i.innerHTML=e._tC,e._origTemplate.innerHTML=i.children[0].innerHTML,this.constructor.splitTextNodes(e._origTemplate),e.hasAttribute("depth")&&e._origTemplate.setAttribute("depth",e.getAttribute("depth"))}var a=e._origTemplate._placeHolder=document.createTextNode("");e._origTemplate.setAttribute("key",e.getAttribute("key")),e._origTemplate.setAttribute("value",e.getAttribute("value")),e.hasAttribute("unbound")&&e._origTemplate.setAttribute("unbound","true"),C.replaceWithPf(e,e._origTemplate._placeHolder),(e=C.replaceWithOrigTemplate(e)).setAttribute("is","forIn"),C.apdNode(e,this),a._helper=e}else if(!e._placeHolder){var d;d=document.createTextNode(""),C.replaceWithPf(e,d),e._placeHolder=d,C.apdNode(e,this),d._helper=e}var f=this;if(e._callee=this,e._attributes=e._attributes||{},"update"===r.type&&e._currentObject===e._attributes.object)return{};o=o||e._cx,e._cx=o;var h=e.getAttribute("key");h||(h="key",e.setAttribute("key","key"));var y=e.getAttribute("value");y||(y="value",e.setAttribute("value","value"));var v=f.component.data[h],m=f.component.data[y],_=f._properties[h],g=f._properties[y];f._properties[h]=f._properties[y]={};var b=e._attributes.object,L=(e.content,e._dynamicNodes),A=e,$=[];if(e._items||(e._items={}),e._dynProps=e._dynProps||{},r)switch(r.type){case"delete":this.removeHelpersSpecificIndex(e,r.property);var E=e._keysArray.indexOf(r.property);E>-1&&e._keysArray.splice(E,1),e._helpers&&delete e._helpers[r.property],delete e._propBindingObject[r.property];break;case"add":$=[r.property],e._keysArray.push(r.property);break;case"update":e._keysArray.forEach((function(t,r,o){this.removeHelpersSpecificIndex(e,t)}),this),e._keysArray=$=b?Object.keys(b):[],e._helpers={},e._items={},e._propBindingObject={};break;case"default":e._forContent={},e._helpers={},e._keysArray=$=b?Object.keys(b):[];break;default:t.error("Error in updateForHelper")}var T=void 0;if(!b){var R=c();"default"!==r.type?u(A.parentNode,R,A):T={toAppendMain:R,lastNode:A}}var O=C.unbound;if((e.hasAttribute("unbound")||e._attributes&&e._attributes.unbound)&&(C.unbound=!0),e._currentObject=b,!t._ms&&$.length&&e._ht&&!e._htA&&(e.content.append(e._ht.content.cloneNode(!0)),e._htA=!0),b&&"remove"!==r.type){var w=c();e._propBindingObject=e._propBindingObject||{},$.forEach((function(t,r,o){e._helpers[t]=[],e._items[t]={_dynamicProperty:{},itemProperty:{}},f.component.data[h]=t,f.component.data[y]=b[t],f._properties[h]={},f._properties[y]={};var i={};i[h]={},i[h]._data=t,i[h]._dyn=[h],i[y]={},i[y]._data=b[t],i[y]._dyn=[y];var a={itemIndex:t,itemValue:y,keyValue:h,type:"forIn",node:e};e._items[t]._cx=a,L._cache=i;var s=this.renderNodes(e.hasAttribute("depth")?e._depthTemp:e,L,e,a,n,void 0,e._tC);Object.keys(e._items[t]._dynamicProperty).forEach((function(t){e._dynProps[t]?e._dynProps[t]++:e._dynProps[t]=1})),e._items[t].itemProperty=this.getProperty(y),e._propBindingObject[t]=e._items[t].itemProperty,e._forContent[t]=Array.from(s.childNodes),this.executeBlockHelpers(e._helpers[t],e),w.appendChild(s)}),this),C.unbound||(s(e._attributes.object,"_bindings"),l(e._attributes.object._bindings,e._propBindingObject),C.establishBindings(e._propBindingObject,e._attributes.object)),C.unbound=O,"default"!==r.type?A._placeHolder?u(A._placeHolder.parentNode,w,A._placeHolder):u(A.parentNode,w,A):T={toAppendMain:w,lastNode:A}}return C.unbound=O,f.component.data[h]=v,f.component.data[y]=m,f._properties[h]=_,f._properties[y]=g,e._currentObject=b,T}},{key:"updateSwitchHelper",value:function(e,r,o,n,i,a,s){if(t._ms||!r._ht||r._htA||(r.content.append(r._ht.content.cloneNode(!0)),r._htA=!0),"TEMPLATE"!==r.tagName){if(Object.keys(r).forEach((function(e){"innerHTML"!==e&&"innerText"!==e&&(r._origTemplate[e]=r[e])})),t._ie){var l=p("div");l.innerHTML=r._tC,r._origTemplate.innerHTML=l.children[0].innerHTML,this.constructor.splitTextNodes(r._origTemplate),r.hasAttribute("depth")&&r._origTemplate.setAttribute("depth",r.getAttribute("depth"))}var d=r._origTemplate._placeHolder=document.createTextNode("");C.replaceWithPf(r,r._origTemplate._placeHolder),(r=C.replaceWithOrigTemplate(r)).setAttribute("is",e),C.apdNode(r,this),d._helper=r}else if(!r._placeHolder){var f;f=document.createTextNode(""),C.replaceWithPf(r,f),r._placeHolder=f,f._helper=r,C.apdNode(r,this)}var h=r;r._callee||(r._callee=this),o=o||r._cx,r._cx=o,r._dynamicProperty=r._dynamicProperty?r._dynamicProperty:{};var y=void 0,v=void 0;if(""===r.getAttribute("value")||r.getAttribute("value")?v=r.getAttribute("value"):r._attributes&&(v=r._attributes.value),r._currentCase&&v===r._currentCase){var m;"false"==v&&(r._attributeDetails&&r._attributeDetails.value&&(m=r._attributeDetails.value.helperInfo?JSON.stringify(r._attributeDetails.value.helperInfo):r._attributeDetails.value.dynamicValue),console.error("If Helper - value provided is string false. Kindly change as this provision will be removed from upcoming build ",m))}else{if(v)y="if"===e?"true":v.toString();else if("if"===e)y="false";else switch(v){case void 0:y="undefined";break;case null:y="null";break;case!1:y="false";break;case"":y='""';break;case 0:y="0"}if(y!==r._currentCase){r._currentCase=y;var _=r._depthTemp||r,g=r._cases[y],b=void 0;if(!g&&(g=r._default,b=t._ms?g.templateContent:_.content.querySelector("[default]"),t._ms||!g._ht||b._htA||(b._htA=!0,b.content.append(g._ht.content.cloneNode(!0))),r._isDefault=!0,!b)){r._caseContent&&r._caseContent.length&&this.removeHelpers(r,void 0,!0),r._caseContent=[];var L=document.createTextNode("");if(r._caseContent.push(L),r._currentCaseName=y,r._helpers=r._helpers||[],n)return void(h._placeHolder?u(h._placeHolder.parentNode,L,h._placeHolder):u(h.parentNode,L,r));var A=c();return A.append(L),{lastNode:h,toAppendMain:A}}r._caseContent&&r._caseContent.length&&this.removeHelpers(r,void 0,!0);var $=g,E=y,T=void 0;T=b||(t._ms?{}:_.content.querySelector("[case='"+C.cssEscape(E)+"']"));for(var R=[];$;){t._ms||!$._ht||T._htA||(T._htA=!0,T.content.append($._ht.content.cloneNode(!0)));var O=$.dynamicNodes,w=this.renderNodes(T,O,r,void 0,i,void 0,$.templateContent);if(R.push(w),!$.additional)break;$.additional.next?(T=t._ms?{}:r.content.querySelector("[case='"+C.cssEscape($.additional.next)+"']"),$=r._cases[$.additional.next]):(T=t._ms?{}:r.content.querySelector("[default]"),$=r._default)}r._caseContent=[];for(var S=c(),P=0;P<R.length;P++)11==R[P].nodeType?r._caseContent=r._caseContent.concat(Array.from(R[P].childNodes)):r._caseContent.push(R[P]),S.append(R[P]);if(this.executeBlockHelpers(r._helpers,r),n){var k=void 0;return S.querySelector("template[is=break]")?k="break":S.querySelector("template[is=continue]")&&(k="continue"),r._placeHolder?u(r._placeHolder.parentNode,S,r._placeHolder):u(r.parentNode,S,r),k}return{toAppendMain:S,lastNode:r}}}}},{key:"dummy",value:function(e,t){this.constructor._properties[boundValue].observer}},{key:"callObservers",value:function(e,t){var r=this.constructor._properties[e],o=r?r.observer:void 0;if(o)for(var n=0;n<o.length;n++)-1!==t.indexOf(".")&&o[n].path!==t||this["_"+o[n].functionName].apply(this)}},{key:"bindNode",value:function(e,r,o,n,i,a,c,u,f,h,y,v){var m=n.itemValue,_=n.itemIndex,g=n.type,b=n.indexValue,L=i.dynamicValue,A=i.helperInfo,$=void 0,E=e.ownerElement,T=[];2===e.nodeType&&(e={nodeName:e.nodeName,ownerElement:e.ownerElement,nodeType:2,nodeValue:e.nodeValue,_attributeDetails:e._attributeDetails}),A&&A.name,e._callee=this;var R=!1;if(A&&Object.keys(A).length){R=!0,e.nodeName,$=e.helperValue=A;var O=[];if("action"===A.name){var w=A.args[0];A.args[0]=w.startsWith("'")?w.replace(/'/g,""):w,w=A.args.slice(0,1)[0];var S=A.args.slice(1,A.args.length),P=!1,k=e.nodeName;return-1!=k.indexOf("-")&&(P=!0),O=[E,k,P,{name:w,args:S}],void this.processHelper({name:A.name,args:O},e)}O="method"===A.name?A.args:this.processArgs(this,{helperInfo:A},T,void 0,e,void 0,f),$=this.processHelper({name:A.name,args:O},e),"unescape"===A.name&&(e={dynamicPositions:{initialNode:e,dynamicNodeValue:$},_callee:e._callee,helperValue:e.helperValue},$=void 0,a.push(e))}else{A={},e.syntaxValue=L;var N=[];$=C.get(this.component.data,L,N,f),T.push(N)}if(2==e.nodeType){var x=e.ownerElement.tagName;("INPUT"==x||"TEXTAREA"==x||"DIV"==x&&e.ownerElement.hasAttribute("contenteditable"))&&(e.ownerElement._rA=e.ownerElement._rA||[],e.ownerElement._rA.push(e)),E._origTemplate?e.ownerElement=E._origTemplate:(E.hasAttribute("lyte-for")||E.hasAttribute("lyte-if")||E.hasAttribute("lyte-switch")||E.hasAttribute("lyte-forin"))&&"TEMPLATE"!==E.tagName&&(t._ie?(e.ownerElement=p("template"),e.ownerElement.setAttribute("is",i._depthTemp)):e.ownerElement=i._depthTemp.cloneNode(!0),E._origTemplate=e.ownerElement)}var j=void 0;if("unbound"!==A.name&&!C.unbound){var D=void 0;o&&(D=g?o._items[_]._dynamicProperty:o._dynamicProperty);for(var I=0;I<T.length;I++){for(var B=T[I],M=0;M<B.length;M++){var F=this.getProperty(B[M]);if(o){var K,H=B[M].search(/\W/);(K=-1!==H?B[M].substring(0,H):B[M])===m||K===b||n.node&&n.node._properties&&n.node._properties[K]?(e._cx=n,d(F,"_dynamicNodes"),F._dynamicNodes.push(e),K!==b&&(j=F)):(s(F,"_helperNodes"),F._helperNodes.add(o),D[B[M]]?D[B[M]].push(e):(D[B[M]]=[]).push(e))}else d(F,"_dynamicNodes"),F._dynamicNodes.push(e);if(E&&(E.hasAttribute("lyte-for")||E.hasAttribute("lyte-if")||E.hasAttribute("lyte-switch")||E.hasAttribute("lyte-forin"))||E&&"TEMPLATE"===E.tagName&&/^(for|forIn)$/.test(E.getAttribute("is"))&&!R){var q=E.getAttribute("is");("for"===q&&"items"===e.nodeName||"forIn"===q&&"object"===e.nodeName)&&(F._forHelpers||s(F,"_forHelpers"),e.ownerElement._actualBinding=F,F._forHelpers.add(e.ownerElement))}c&&C.establishSelectedBinding(F,this.component.data,this)}B.length>1&&(e._multipleProperty=e._multipleProperty||[],e._multipleProperty.push({dynamicProp:j?void 0:D,actProp:this.getProperty(B[0]),helperNode:o,dynamicValues:B,index:I}))}}if($="boolean"===!(void 0===$||_typeof($))&&"number"===!(void 0===$||_typeof($))?$||"":$,2===e.nodeType){var U=e._parentNode?e._parentNode:e.ownerElement;U.tagName&&U.getAttribute("is");var z=C.isCustomElement(U,!0);z&&(U.set?U.set(C.String.toCamelCase(e.nodeName),$):(U._initProperties=U._initProperties||{},U._initProperties[C.String.toCamelCase(e.nodeName)]=$));var V=$;if(z&&"string"!=typeof $&&!u)U._attributes=U._attributes||{},U._attributes[e.nodeName]=$,"TEMPLATE"===U.nodeName&&R&&("for"===U.getAttribute("is")&&"items"===e.nodeName||"forIn"===U.getAttribute("is")&&"object"===e.nodeName&&!C.unbound)&&(e.ownerElement._actualBinding={_forHelpers:(new Set).add(U),_createdBinding:!0},$&&(s($,"_bindings"),l($._bindings,e.ownerElement._actualBinding))),r.push(e.nodeName);else if("boolean"==typeof $)U._attributes=e.ownerElement._attributes||{},U._attributes[e.nodeName]=$,$?U.setAttribute(e.nodeName,""):r.push(e.nodeName);else{var G;if($&&"object"===(void 0===$?"undefined":_typeof($)))if(void 0!==Record&&$ instanceof Record)G=JSON.stringify($.$.toJSON());else try{G=JSON.stringify($)}catch(t){Lyte.error("Data passed for property '"+e.nodeName+"' of '"+e.ownerElement.nodeName.toLocaleLowerCase()+"' cannot be serialized. The component '"+e.ownerElement.nodeName.toLocaleLowerCase()+"' might not be registered before its use.")}else G=null==$||null==$?"":$;if($=G,C.isControlHelper(e.ownerElement))U._attributes=e.ownerElement._attributes||{},U._attributes[e.nodeName]=$,r.push(e.nodeName);else{var W=void 0===$?"":$;e.ownerElement.setAttribute(e.nodeName,W)}}"LYTE-YIELD"===U.tagName&&(U.component.data[C.String.toCamelCase(e.nodeName)]=V),/^(INPUT|TEXTAREA|SELECT)$/.test(U.nodeName)&&("value"===e.nodeName?U.value=void 0===$?"":$:"checked"===e.nodeName&&(U.checked=$)),$||-1===C.booleanAttrList.indexOf(e.nodeName)||r.push(e.nodeName)}else e.nodeValue=void 0===$?"":$;return e}},{key:"debounce",value:function(e,t){var r;return function(){var o=this,n=arguments;r&&clearTimeout(r),r=setTimeout((function(){e.apply(o,n),r=null}),t||100)}}},{key:"getProperty",value:function(e){var t=e.match(/([^[\].]+|\[\])/g),r=this;r._properties[t[0]]||(r._properties[t[0]]={}),a(r=r._properties[t[0]],"_path",{enumerable:!1,value:t[0]});for(var o=1;o<t.length;o++)(t[o].startsWith("'")||t[o].startsWith('"'))&&(t[o]=t[o].substring(1,t[o].length-1)),r[t[o]]||(r[t[o]]={},a(r[t[o]],"_path",{enumerable:!1,value:r._path+"."+t[o]})),r=r[t[o]];return r}},{key:"updateNode",value:function(e,t){var r=this.component,o=[],n=void 0;if(e._multipleProperty)for(var i=0;i<e._multipleProperty.length;i++)if(e._multipleProperty[i]&&e._multipleProperty[i].dynamicValues.lastIndexOf(t)>0){o[i]=!1;var a=void 0;if((n=e._multipleProperty[i]).dynamicProp){if(o[i]=n,a=n.dynamicProp[n.actProp._path]){var c=a.indexOf(e);a.splice(c,1)}var p=n.helperNode;if(0===a.length)if("if"===p.getAttribute("is"))n.actProp._helperNodes.delete(p),delete n.dynamicProp[n.actProp._path];else if(delete n.dynamicProp[n.actProp._path],p._items){for(var u=!0,f=0;f<p._items.length;f++)if(p._items[f]._dynamicProperty&&p._items[f]._dynamicProperty[n.actProp._path]){u=!1;break}u&&n.actProp._helperNodes.delete(p)}}if(!o[i]&&(o[i]="dynamicNodes",a=n.actProp._dynamicNodes)){var h=a.indexOf(e);a.splice(h,1),a.length||delete n.actProp._dynamicNodes}}if(e.syntaxValue||e.helperValue){var y=void 0,v=void 0;if(e._cx||2===e.nodeType&&e.ownerElement._cx){y=e._cx||e.ownerElement._cx;var m=[];C.changeContext(y.node,m,y)}else"LYTE-YIELD"===e.tagName&&e._callee._cx&&(v=!0,y=e._callee._cx,m=[],C.changeContext(y.node,m,y,!0));var _=void 0,g=[],b=!1;if(e.helperValue){b=!0;var L=_=e.helperValue;if(_=this.processHelper({name:L.name,args:this.processArgs(this,{helperInfo:L},g,void 0,e)},e),"unescape"===L.name){for(var A=e.dynamicPositions,$=A.startingNode,E=A.length;E>1;){var T=$.nextSibling;$.remove(),$=T,E--}var R=_.childNodes.length;R||(_.appendChild(document.createTextNode("")),R=1);var O=_.childNodes[0];$.replaceWith.apply($,_.childNodes);var w={startingNode:O,length:R};e.dynamicPositions=w,_=void 0}}else{var S=e.syntaxValue,P=void 0;-1===S.indexOf(".")&&-1===S.indexOf("[")||(P=S,S=S.substring(0,S.indexOf(".")));var k=P?C.get(r.data,P,g):r.data[S];_="boolean"===!(void 0===k||_typeof(k))&&"number"===!(void 0===k||_typeof(k))?k||"":k}if(g[0]instanceof Array||(g=[g]),o)for(i=0;i<o.length;i++)if(o[i]){var N=e._multipleProperty[i],x=e._multipleProperty[i].index,j=this.getProperty(g[x][0]),D=this.getProperty(g[x][0].substring(0,g[x][0].indexOf("."))),I=this.getData(g[x][0].substring(0,g[x][0].indexOf(".")));if("dynamicNodes"===o[i])d(j,"_dynamicNodes"),j._dynamicNodes.push(e);else{s(j,"_helperNodes"),j._helperNodes.add(N.helperNode);var B=N.dynamicProp;B[j._path]?B[j._path].push(e):(B[j._path]=[]).push(e)}if(e.ownerElement&&(e.ownerElement.hasAttribute("lyte-for")||e.ownerElement.hasAttribute("lyte-if")||e.ownerElement.hasAttribute("lyte-switch")||e.ownerElement.hasAttribute("lyte-forin"))||e.ownerElement&&"TEMPLATE"===e.ownerElement.tagName&&/^(for|forIn)$/.test(e.ownerElement.getAttribute("is"))&&!b){var M=e.ownerElement.getAttribute("is");("for"===M&&"items"===e.nodeName||"forIn"===M&&"object"===e.nodeName)&&(N.actProp._forHelpers.has(e.ownerElement)&&N.actProp._forHelpers.delete(e.ownerElement),j._forHelpers||s(j,"_forHelpers"),e.ownerElement._actualBinding=j,j._forHelpers.add(e.ownerElement))}null!=I&&C.establishBindings(D,I),e._multipleProperty[i].actProp=j,e._multipleProperty[i].dynamicValues=g[x]}if(2===e.nodeType){var F=[],K=e._parentNode?e._parentNode:e.ownerElement;if("TEMPLATE"===K.tagName&&"component"===K.getAttribute("is")&&"component-name"!==e.nodeName)if(K.hasAttribute("lyte-keep-alive"))for(var H in K._renderedComponent)F.push(K._renderedComponent[H]);else{var q=K._currentComponent;q&&K._renderedComponent[q]&&F.push(K._renderedComponent[q])}F.push(K);for(var U=0;U<F.length;U++){var z=F[U];if(z.set?z.set(C.String.toCamelCase(e.nodeName),_,void 0,!0):(z._initProperties=z._initProperties||{},z._initProperties[C.String.toCamelCase(e.nodeName)]=_),"LYTE-YIELD"===z.tagName&&z.component.data&&e.nodeName&&z.component.data[e.nodeName]!==_&&C.set(z.component.data,C.String.toCamelCase(e.nodeName),_,void 0,void 0,z),z._attributes=z._attributes||{},C.isCustomElement(z,!0)&&"string"!=typeof _){if("TEMPLATE"===e.ownerElement.nodeName){if(e.helperValue){if("for"===e.ownerElement.getAttribute("is")&&"items"===e.nodeName||"forIn"===e.ownerElement.getAttribute("is")&&"object"===e.nodeName){var V=e.ownerElement._attributes[e.nodeName],G=_;C.removeSelectedBindingDeep(e.ownerElement._actualBinding,V),G&&(s(G,"_bindings"),l(G._bindings,e.ownerElement._actualBinding),C.establishBindings(e.ownerElement._actualBinding,G)),"object"===e.nodeName&&C.removeSelectedBindingDeep(e.ownerElement._propBindingObject,V)}}else if("for"===e.ownerElement.getAttribute("is")&&"items"===e.nodeName||"forIn"===e.ownerElement.getAttribute("is")&&"object"===e.nodeName){var W=e.ownerElement._attributes[e.nodeName];"object"===e.nodeName&&C.removeSelectedBindingDeep(e.ownerElement._propBindingObject,W)}z["__"+e.nodeName]=!0,z.removeAttribute(e.nodeName)}}else if("boolean"==typeof _)z._attributes=z._attributes||{},z._attributes[e.nodeName]=_,_?z.setAttribute(e.nodeName,""):z.removeAttribute(e.nodeName);else{var J;if(_&&"object"===(void 0===_?"undefined":_typeof(_)))if(void 0!==Record&&_ instanceof Record)J=JSON.stringify(_.$.toJSON());else try{J=JSON.stringify(_)}catch(t){Lyte.error("Data passed for property '"+e.nodeName+"' of '"+e.ownerElement.nodeName.toLocaleLowerCase()+"' cannot be serialized. The component '"+e.ownerElement.nodeName.toLocaleLowerCase()+"' might not be registered before its use.")}else J=null==_||null==_?"":_;var Y=void 0===(_=J)?"":_,Q=e.ownerElement;Q.hasAttribute(e.nodeName)?"INPUT"==Q.tagName&&"value"==e.nodeName&&Q.validity.badInput||Q.setAttribute(e.nodeName,Y):e.nodeValue=Y}if(z._attributes[e.nodeName]=_,/^(INPUT|TEXTAREA|SELECT)$/.test(z.nodeName))if("value"===e.nodeName){var X=void 0===_?"":_;z.value!==X&&(z.value=X)}else"checked"===e.nodeName&&(z.checked=_);_||-1===C.booleanAttrList.indexOf(e.nodeName)||z.removeAttribute(e.nodeName);var Z=z._isStopped,ee=void 0;switch(z.getAttribute("is")){case"for":this.updateForHelper(z,{type:"update"});break;case"if":ee=this.updateSwitchHelper("if",z,void 0,!0,!0);break;case"forIn":this.updateForInHelper(z,{type:"update"});break;case"switch":this.updateSwitchHelper("switch",z,void 0,!0,!0);break;case"component":"component-name"===e.nodeName&&this.updateDynamicComponent(z,"update")}var te=void 0;Z&&Z!==ee?te=ee?"break"===ee?"MS":"SM":"break"===Z?"SM":"SS":"break"===ee?te="MS":"continue"===ee&&(te="SS"),te&&this.handleBreak(z._cx,te)}}else e.nodeValue=void 0===_?"":_;y&&C.removeContext(y.node,m,y,v)}}},{key:"handleBreak",value:function(e,t){if(e){for(var r=e.node,o=e.itemIndex,n=(r.getAttribute("item"),e.node._forContent),i="M"===t[0]?n.length:o+1,a=o;a<i;a++){for(var s=n[a],l=0;l<s.length;l++)s[l].remove(),(s[l]._forContent||s[l]._caseContent)&&this.removeHelpers(s[l]);n[a]=[],C.removeSelectedBindingDeep(r._items[a].itemProperty,r._attributes.items[a]),r._helpers[a]=[],r._items[a]={_dynamicProperty:{},itemProperty:{},indexProperty:{}}}var d=r._attributes.items.length;"M"===t[1]?this.updateForHelper(r,{firstIndex:o,secondIndex:d-o,type:"replace"},void 0,{}):this.updateForHelper(r,{firstIndex:o,secondIndex:1,type:"replace"},void 0,{})}}},{key:"createCustomEvent",value:function(e,t,r){var o=new CustomEvent(e);t._actions[e]=o,t._actions[e].processAction=r}},{key:"isEmptyString",value:function(e){return!("string"==typeof e)||""===e}},{key:"processArgs",value:function(e,t,r,o,n,i,a){var s=t.newHelperInfo&&i?t.newHelperInfo.args:t.helperInfo.args;r=r||[],s=Array.isArray(s)?Array.from(s):s;for(var l=0;l<s.length;l++)if(s[l]&&s[l].type)this.internalHelpers(e,s,l,r,o,n,i,a);else if(this.isEmptyString(s[l]))i&&s[l]instanceof Array&&(s[l]=C.getDD(e.component.data,s[l]));else if(s[l].startsWith("'")&&s[l].endsWith("'"))s[l]=s[l].substr(1,s[l].length-2);else{s[l]=s[l].trim();var d=[];"event"===s[l]&&o?s[l]=o:"this"===s[l]&&n?s[l]=2===n.nodeType?n.ownerElement:n:s[l]=C.get(e.component.data,s[l],d,a),r.push(d)}return s}},{key:"internalHelpers",value:function(e,t,r,o,n,i,a,s){var l=t[r].value,d=this.processHelper({name:l.name,args:this.processArgs(e,{helperInfo:l},o,n,i,a,s)});t[r]=d}},{key:"processHelper",value:function(e,r){var o=[],n=e.name;if(_.registeredHelpers[n]){switch(e.name){case"method":o.push(this,r);break;case"lbind":o.push(this,r.ownerElement);break;case"lyteViewPort":if(!r||!r.ownerElement)return!1;o.push(r.ownerElement),e.args.length||o.push(!1)}return _.registeredHelpers[e.name].apply(this,o.concat(e.args))}t.error("LC003",e.name)}},{key:"getActionProperty",value:function(e){var t=this._properties;return t?t[e].value:void 0}},{key:"hasInternalBindings",value:function(e){return e.match(/[(]{1}[^)]+[)]{1}/)}},{key:"getArgValues",value:function(e,t){for(var r=[],o=0;o<e.length;o++)r.push(t[e[o]].value);return r}},{key:"createEventListeners",value:function(e,t,r){if(e._callee||e===this||(e._callee=this),-1==o.indexOf(t)){var n=t.substr(2);e.getAttribute(n),_.registeredComponents[e.localName]&&!e.component||"TEMPLATE"===e.tagName&&"component"===e.getAttribute("is")?(e._toRegEvnts=e._toRegEvnts||{},e._toRegEvnts[t.substr(2)]={listener:A,attrVal:this.tagName.toLowerCase()+" => "+r.name}):(e.setAttribute(n,this.tagName.toLowerCase()+" => "+r.name),e.addEventListener(t.substr(2),A)),e.hasAttribute(t)&&(e[t]=void 0),e.removeAttribute(t)}}},{key:"registerParentYield",value:function(e){var r=this._callee._yields[e],o=void 0;r&&(t._ie?((o=document.createElement("div")).innerHTML=r.outerHTML,o=o.childNodes[0],this.constructor.splitTextNodes(o)):o=r.cloneNode(!0),Object.keys(r).forEach((function(e){o[e]=r[e]})),this._yields[e]=o)}},{key:"registerYields",value:function(){this._yields={};for(var e=this.querySelectorAll("template[is=registerYield],template[is=yield]"),t=[],r=0;r<e.length;r++){for(;e[r].hasChildNodes();)e[r].content.appendChild(e[r].childNodes[0]);e[r].hasAttribute("from-parent")&&this._callee?this._callee._yields?this.registerParentYield(e[r].getAttribute("yield-name")):t.push(e[r]):this._yields[e[r].getAttribute("yield-name")]=e[r]}if(t.length&&this._callee){var o=this;this.lazyYield=function(){if(o._callee){for(var e=0;e<t.length;e++){var r=t[e];o.registerParentYield(r.getAttribute("yield-name"))}o._callee.removeEventListener("onReady",o.lazyYield),delete o.lazyYield}},this._callee.addEventListener("onReady",this.lazyYield)}}},{key:"connectedCallback",value:function(){if(!this.hasAttribute("lyte-rendered")&&_.registeredComponents[this.localName]&&!this._ccCalled){var e=this._fR;if(e||(this._callee=this._callee||this.getCallee(this.parentNode)),this.__h={},this.__counter=0,this.__dc={},e){var t=e.methods;t&&this.setMethods(t),C.ccDelay.push(this),this._ccCalled=!0}else this.actualConnectedCallback();(this._initProperties&&this._initProperties.hasOwnProperty("lyteViewPort")?this._initProperties.lyteViewPort:this.component.data.lyteViewPort)&&(C.isViewPortPending||(requestAnimationFrame((function(){requestAnimationFrame((function(){C.executePendingViewPort()}))})),C.isViewPortPending=!0),C.pendingViewPortElements.push(this))}}},{key:"actualConnectedCallback",value:function(){var e=this.component.data,r=this._fR;r&&(this._callee=this._callee||this.getCallee(this.parentNode));var o=this.constructor._templateAttributes;if(o&&o.attr)for(var n in o.attr){var i=o.attr[n];if(!this.hasAttribute(i.name)&&!e.hasOwnProperty(i.name)||i.globalEvent){if(i.helperInfo&&"action"===i.helperInfo.name){this._evBoundEvents=this._evBoundEvents||{};var a,d=i.helperInfo.args[0];a=d.startsWith('"')||d.startsWith("'")?d.substring(1,d.length-1):d;var c=i.globalEvent||-1!==i.name.indexOf("-")?i.name:i.name.substr(2);this._evBoundEvents[c]={name:a,args:i.helperInfo.args,from:"component"};var p=this.getAttribute(i.name),u=this.constructor._template.getAttribute(i.name);this.setAttribute(i.name,u+(p?" ; "+p:""))}i.globalEvent||(i.from="component",i.staticValue?this.setAttribute(o.attr[n].name,i.staticValue):(this.setAttribute(o.attr[n].name,"{{dummy}}"),this.bindNode(this.attributes.getNamedItem(o.attr[n].name),[],void 0,{},o.attr[n],void 0,void 0,!0)))}}for(var f in this._toRegEvnts)this.addEventListener(f,this._toRegEvnts[f].listener),this.hasAttribute(f)?this.setAttribute(f,this.getAttribute(f)+" ; "+this._toRegEvnts[f].attrVal):this.setAttribute(f,this._toRegEvnts[f].attrVal);this._toRegEvnts={};var h=C.unbound,y=this.afterConnected();if(C.unbound||r||(Lyte.establishObserverBindings.call(this,this.constructor._observers),s(e,"_bindings"),l(e._bindings,this._properties),C.establishBindings(this._properties,e)),C.unbound=h,"string"==typeof y){if(y)if(C.frSpecial){var v=document.createElement("template");v.innerHTML=y,this.innerHTML="",this.appendChild(v.content)}else this.innerHTML=y;C.processAction(this)}else{if(this.component.data.lyteViewPort)if(t._ie){for(var m=0;m<y.childNodes.length;m++)if(y.childNodes[m].tagName){this._dummyViewPortF=y.childNodes[m];break}for(m=y.childNodes.length-1;m>=0;m--)if(y.childNodes[m].tagName){this._dummyViewPortL=y.childNodes[m];break}}else this._dummyViewPortF=y.children[0],this._dummyViewPortL=y.children[y.children.length-1];this.appendChild(y)}var _=this.component.__data,g=this.attributes;this.__lyteIgnore=!0;for(var b=g.length-1;b>-1;b--){var L=S.String.toCamelCase(g[b].nodeName);_[L]&&_[L].hideAttr&&this.removeAttribute(g[b].nodeName)}if(this.__lyteIgnore=!1,this._callee&&this._callee.serverCall&&(this.serverCall=!0),this.serverCall&&!this.hasAttribute("server-rendered")){this.setAttribute("server-rendered","");var A=S.sendtoclient.call(this,this,!0,this.component.__data);this.setAttribute("component-data",JSON.stringify(A))}this.hasAttribute("server-rendered")||this.setAttribute("lyte-rendered",""),r||Lyte._ignoreOnReady||this.dispatchEvent(new CustomEvent("onReady"));var $=void 0;this.component._config&&null!=this.component._config.clientLifeCycleHooks&&($=1==this.component._config.clientLifeCycleHooks||"object"==_typeof(this.component._config.clientLifeCycleHooks)&&this.component._config.clientLifeCycleHooks.includes("didConnect"));var E=this.component._ssr?this.component._ssr.overrides:void 0;(!this.hasAttribute("server-rendered")||this.serverCall||$)&&(E&&E.didConnect&&this.serverCall?E.didConnect.apply(this):this.callback("didConnect"),this.onCallBack("didConnect")),null==this.serverCall&&this.callback("didRender"),r&&this.removeAttribute("_lyteprop")}},{key:"onCallBack",value:function(e){var r=this.constructor._callBacks[e];if(r)for(var o=0;o<r.length;o++)try{r[o].value.call(this.component)}catch(e){t.error(e)}}},{key:"callback",value:function(e){var r,o=this.component[e];if(o){arguments.length>1&&(r=Array.from(arguments)).splice(0,1);try{o.apply(this.component,r||[])}catch(e){t.error(e)}}}},{key:"establishObserverBindings",value:function(){for(var e=this.constructor._observers,t=0;t<e.length;t++)for(var r=e[t].properties,o=0;o<r.length;o++){var n=void 0,i=!1;-1!==r[o].indexOf(".[]")?(i=!0,n=this.getProperty(r[o].substring(0,r[o].indexOf(".[]")))):n=this.getProperty(r[o]),s(n,"_observers"),n._observers.add({callee:this,observer:e[t],isArrayObserver:i})}}},{key:"removeBindings",value:function(e,t){for(var r in e){var o=t[r];o&&o._bindings&&o._bindings.delete(e[r]),"object"===_typeof(e[r])&&o&&this.removeBindings(e[r],o)}}},{key:"actualDisconnected",value:function(){var e=this;if(e.component){for(a in e._cx=null,e._callee=null,e.component.$node=null,e.component.__data=null,e.component.data.__component__=null,e.component.data=null,e.component=null,e.__dc=e.__dc||{},e.__h=e.__h||{},e.__dc){var t=e.__dc[a];if(t.hasAttribute("lyte-keep-alive"))for(var r=Object.keys(t._renderedComponent),o=0;o<r.length;o++){var n=r[o];n!==t._currentComponent&&t._renderedComponent[n].remove()}}for(a in e.__h)e.__h[a].remove();e.__h={},e.__dc={};var i=e._yields;for(var a in i)i[a]._callee=null;e=null}}},{key:"disconnectedCallback",value:function(){if(!C.ignoreDisconnect&&this.component){var e=C.pendingViewPortElements;if(this.component.data.lyteViewPort){var t=e.indexOf(this);-1!=t&&e.splice(t,1)}if(e.length)for(var r=0;r<e.length;r++){var o=C.getActViewPortTemplate(e[r]);o&&"TEMPLATE"==o.tagName&&"if"==o.getAttribute("is")&&o._callee==this&&(e.splice(r,1),r--)}if(this._destroyed=!0,this.__toRemoveLazy){for(var n in this.__toRemoveLazy)this.__toRemoveLazy[n].forEach((function(e){Lyte.$.toRemoveFromRequiredServices(e)}));delete this.__toRemoveLazy}this.component._bindings=null;var i=this.__scpObj;if(i)for(var a in i){var s=this.component.data[a],l=i[a].split("_");s&&Lyte.removeNestScp(this.component.data[a],l[0],l[1],void 0,this)}this._fR||C.removeSelectedBindingDeep(this._properties,this.component.data,!0);var d=this.__h;for(a in d)d[a]._actualBinding&&this.removeHelpers(d[a]);for(var c in d={},this._properties)this._properties[c]={};this.callback("didDestroy"),this.onCallBack("didDestroy"),C.dcc||(C.dcc=[],requestAnimationFrame((function(){requestAnimationFrame((function(){try{for(var e,t=0;e=C.dcc[t];t++)e.actualDisconnected()}catch(e){}C.dcc=void 0}))}))),C.dcc.push(this),this.lazyYield&&this.removeEventListener("onReady",this.registerParentYield),this.constructor.activeInstances--}}}],[{key:"updateValue",value:function(e,t,r){for(var o=t.split("."),n=e,a=0;a<o.length-1;a++)n=n[o[a]];n[o[i]]=r}},{key:"createDocFragment1",value:function(e){if(e.content)return e.content;for(var t=e.childNodes,r=c(),o=t.length,n=0;n<o;n++)r.appendChild(t[0]);return r}},{key:"_registerComponent",value:function(e,r){var o,n=C.lyteComponentsDiv,i=t.$.assetsDiv,a=this._template;if(this._template&&"string"==typeof this._template){this._template.replace(/\\'/g,"'");var s=p("div");for(s.innerHTML=this._template;s.firstChild;)"STYLE"===s.firstChild.nodeName?(i.querySelector("style[from-component='"+e+"']")&&i.querySelector("style[from-component='"+e+"']").remove(),s.firstChild.setAttribute("from-component",e),i.appendChild(s.firstChild)):n.appendChild(s.firstChild)}else document.querySelector("template[tag-name='"+e+"']")&&n.appendChild(document.querySelector("template[tag-name='"+e+"']"));if(this._template=n.querySelector("template[tag-name='"+e+"']"),this._helperTemplate=document.createElement("template"),this._helperTemplate.setAttribute("_lyteht",e),C.h1Div.content.appendChild(this._helperTemplate),this._template){if(C.needDummyComponentsDiv)if(t._ie){var l=t.Compile.getTemplateFromString(a);C.dummyLyteComponentsDiv.appendChild(l)}else o=this._template.cloneNode(!0);this._template&&this._template.content;var d,c=-1!==this._observedAttributes.indexOf("lyteUnbound"),u=t._ie?this._template:this._template.content;if(c&&(t._ie?((d=document.createElement("div")).innerHTML=this._template.outerHTML,d=d.childNodes[0]):d=this._template.cloneNode(!0)),this.splitTextNodes(u),c&&this.splitTextNodes(d),!this._dynamicNodes)if(t.Compile.getDynamicNodes){var f=t.Compile.getDynamicNodes(e,void 0,t._ie?u:void 0);if(f.errors)return console.error("Error in the component",f.componentName,f.errors),!1;this._dynamicNodes=f.dynamicNodes}else t.error("LC002",e);if(this._dynamicNodes){D(u,this._dynamicNodes,e,this,d?t._ie?d:d.content:void 0),t._ed?this._tC=this._template.outerHTML:t._ie&&(this._tC=u.outerHTML),this._templateAttributes=this._templateAttributes||{type:"attr",attr:{},position:[]};var h=[this._templateAttributes];if(D(this._template,h,e,this),this._templateAttributes=h[0],this._templateAttributes&&this._templateAttributes.attr){var y=this._template.attributes;try{for(var v=0;v<y.length;v++){var m=y[v].name;this._templateAttributes.attr[m]||"tag-name"===m||"use-strict"===m||(this._templateAttributes.attr[m]={name:m,staticValue:y[v].value},this._template.removeAttribute(m),o&&o.removeAttribute(m),v--)}}catch(e){t.error("Error with templateAttributes. ")}}}o&&C.dummyLyteComponentsDiv.appendChild(o),this._sta=d?C.processStatic(d):void 0}}},{key:"splitTextNodes",value:function(e){if(e&&e.childNodes&&e.childNodes.length)for(var r=e.childNodes.length-1;r>=0;r--)this.splitTextNodes(e.childNodes[r]);if("TEMPLATE"!==e.tagName||t._ie||this.splitTextNodes(e.content),e.nodeType===e.TEXT_NODE){var o=e.nodeValue;if(o){var n=o.match(/{{[^}]*?(?:(?:('|")[^\1]*?\1)[^}]*?)*}}/g);if(!n)return;for(var i=[],a=0;a<n.length;a++){var s=o.indexOf(n[a]),l=s+n[a].length;s&&i.push(document.createTextNode(o.substring(0,s))),i.push(document.createTextNode(o.substring(s,l))),o=o.substring(l)}if((o.trim()||!e.nextSibling||3!==e.nextSibling.nodeType||e.nextSibling.nodeValue.trim())&&i.push(document.createTextNode(o)),t._rwpf&&"#document-fragment"===e.parentNode.nodeName){for(var d=0;d<i.length;d++)u(e.parentNode,i[d],e);e.remove()}else e.replaceWith.apply(e,i)}}}},{key:"observedAttributes",get:function(){for(var e=[],t=0;t<this._observedAttributes.length;t++)e[t]=C.String.dasherize(this._observedAttributes[t]);return C.customPropHandlers.forEach((function(t,r){e.push(C.String.dasherize(t))})),e}}]),r}(),T=function(){return{type:"callBack",value:"observer"===this.type?this.value:this,properties:arguments,observes:"observer"===this.type?this:void 0}},R=function(){return{type:"observer",value:this,properties:arguments,on:Function.prototype.on}},O=function(){return{type:"computed",value:this,properties:arguments}},w=Function.prototype;w.on?w.lyteOn=T:w.on=T,w.observes?w.lyteObserves=R:w.observes=R,w.computed?w.lyteComputed=O:w.computed=O;var S={fRP:{},fRC:0,customPropRegex:"",customPropHandlers:[],_registeredComponents:{},_reRegisteredComponents:[],toBeRegistered:[],updateCustomCrmComponent:function(e,t){for(var r in e)if(e[r]&&"observer"===e[r].type)e[r].fnName=r,t._observers.push(e[r]);else if(e[r]&&"callBack"===e[r].type){for(var o=e[r].properties,n=0;n<o.length;n++)t._callBacks[o[n]]||(t._callBacks[o[n]]=[]),e[r].fnName=r,t._callBacks[o[n]].push(e[r]);e[r].observes&&(e[r].observes.fnName=r,t._observers.push(e[r].observes))}else t.component.prototype[r]=e[r];return e},dataFromMixin:function(e,t,r,o){for(var n=e.length,i=0;i<n;i++)for(var a in e[i])"actions"===a?Object.assign(t,e[i][a]):"methods"===a?Object.assign(r,e[i][a]):o[a]=e[i][a];return{actionsFromMixin:t,methodsFromMixin:r,newDefinition:o}},throwEvent:function(e){var t=this.$node?this.$node:this,r=t._actions?t._actions[e]:void 0,o=[];if(arguments.length>1)for(var n=1;n<arguments.length;n++)o.push(arguments[n]);C.throwAction.call(t,t._callee,e,void 0,!0,o,t),this.$node&&t.dispatchEvent(r||new CustomEvent(e,{detail:o}))},throwAction:function(e,r,o,n,i,a,s,l,d){var c=void 0;if(this._route&&n)c=(e=t.Router.getRouteInstance(this._route)).actions||(e.actions={});else if(this.routeName){var p=this.parent;p&&(c=p.component?(e=p.component).constructor._actions:(e=p).actions||(e.actions={}))}else e&&(c=e.constructor._actions);if(e){var u=i||[];if(o=o||(this._actions&&this._actions[r]?this._actions[r].processAction:void 0)){var f=[];a&&C.adCx(a,f);var h;if(h=o.skipArgProcessing?o.args:this.processArgs(e,{helperInfo:o},void 0,s,a),u.splice.apply(u,[0,0].concat(h)),a&&C.rmCx(a,f),c[o.name])if(n)c[o.name].apply(this._callee.component,u),l=!0;else{var y=a.parentNode,v=c[o.name].apply(this.component,u);if(s.currentTarget===document.body||d||(v=!1),l=!0,!1!==v&&!s.cancelBubble)if(o.from&&a.getAttribute(s.type)&&a._boundEvents&&a._boundEvents[s.type]){a._callee.constructor._actions;var m=a._boundEvents[s.type],_=t.deepCopyObject(m);C.skipArgProcessing(_,s,a),C.throwAction.call(a._callee,a._callee,s.type,_,void 0,void 0,a,s,l)}else{if(C.hasLyteEvents(a,r)&&(v=!C.handleLyteEvents(a,s)),!1===v)return;if(C.isCustomElement(a)&&(e=y),y){for(var g=void 0;y&&(!y.getAttribute(r)||y.hasAttribute("disabled"))&&"BODY"!=y.tagName&&(!C.hasLyteEvents(y,r)||!(g=C.handleLyteEvents(y,s)));)y=y.parentNode;if(g||!y||"BODY"===y.tagName)return;if(y._callee||(y._callee=y.getCallee?y.getCallee(y):C.getCallee(y)),y&&s.type===r&&!s.cancelBubble)if(y._evBoundEvents&&y._evBoundEvents[r]){var b=y._evBoundEvents[r],L=t.deepCopyObject(b);C.skipArgProcessing(L,s,y),C.throwAction.call(y,y,r,L,void 0,void 0,y,s,l)}else if(y&&y._boundEvents&&y._boundEvents[r]){var A=y._boundEvents[r],$=t.deepCopyObject(A);C.skipArgProcessing($,s,y),C.throwAction.call(y._callee,y._callee,r,$,void 0,void 0,y,s,l)}}}}else t.error("LC004",o.name)}else if(n){var E=c[r]||c[C.String.toCamelCase(r)]||c[C.String.dasherize(r)];if(E){var T=C.isCustomElement(e)?e.component:e;l=!0,!1!==E.apply(T,u)&&C.throwAction.call(e,e._callee,r,o,n,i,void 0,void 0,l)}else C.throwAction.call(e,e._callee,r,o,n,i,void 0,void 0,l)}}else l||t.warn("Nothing handled the action "+r+".")},isControlHelper:function(e){return"TEMPLATE"===e.tagName&&e.getAttribute("is")&&"component"!==e.getAttribute("is")||e.hasAttribute("lyte-for")||e.hasAttribute("lyte-if")||e.hasAttribute("lyte-switch")||e.hasAttribute("lyte-forin")},isCustomElement:function(e,t){return e.hasAttribute&&(("TEMPLATE"===e.tagName||e.attributes["lyte-for"]||e.attributes["lyte-if"]||e.attributes["lyte-switch"]||e.attributes["lyte-forin"])&&t||e.nodeName&&-1!==e.nodeName.indexOf("-")&&(_.registeredComponents[e.localName]||"LYTE-YIELD"===e.tagName))},componentSet:function(e,t,r,o,n){o||this.get(e)!==t?C.set(this.data,e,t,r,void 0,n):C.clearError(this.data,e)},componentGet:function(e){return e?C.get(this.data,e):this.data},nodeGet:function(e){return e?this.component.get(e):this.component.data},nodeSet:function(e,t,r,o){this.component.set(e,t,r,void 0,o)},registerComponent:function(r,o,n){if(-1!=C._reRegisteredComponents.indexOf(r)||!_.registeredComponents[r]){var i=void 0,a=void 0;C._registeredComponents[r]?(i=C._registeredComponents[r],a=!0):((i=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,E),t}())._properties={},i.activeInstances=0,i._depthTemp=document.createElement("template"),i.prototype.throwAction=this.throwAction,i.compName=r),Object.defineProperty(i.prototype,"setData",{configurable:!0,writable:!0,value:function(e,t,r){return this.component.setData(e,t,r)}}),Object.defineProperty(i.prototype,"getData",{configurable:!0,writable:!0,value:function(e){return this.component.getData(e)}}),Object.defineProperty(i.prototype,"setMethods",{configurable:!0,writable:!0,value:function(e,t){return this.component.setMethods(e,t)}}),i.prototype.get=this.nodeGet,i.prototype.set=this.nodeSet,i._bindsIds=[],n=n||{};var s={},l={};for(var d in n)"services"==d&&(l[d]={},n.services.forEach((function(e){if("string"==typeof e)l[d][e]=e;else if(e&&"object"===(void 0===e?"undefined":_typeof(e))){var t=e.as,r=e.service;Lyte._keywords.is(t,"component")?Lyte.warn("Service cannot be used in any keywords of Lyte."):e.scope&&"static"!=e.scope?"instance"==e.scope&&(t=e.as,r=e.service,s[d]=s[d]||{},s[d][t]=r):l[d][t]=r}}))),"mixins"==d&&(l[d]=[],n.mixins.forEach((function(e){Lyte.Mixin.exists(e)?l[d].push(Lyte.registeredMixins[e]):Lyte.$.requiredMixins(e,r,"component")}))),"ssr"==d&&(i._ssr=n[d]),"config"==d&&(i._config=n[d]);i.component=$;var c=$.prototype;c.$lg=Lyte.__gl,c.set=this.componentSet,c.get=this.componentGet,e.requireValidateInComponent&&(c.validate=function(){var e=this.data;for(var t in e)C.handleValidation(e,t,e[t],this)}),c.throwEvent=this.throwEvent,c.executeMethod=C.executeMethod,c.getData=C.componentGetData,c.setData=C.componentSetData,c.getMethods=C.componentGetMethods,c.setMethods=C.componentSetMethods,c.hasAction=C.componentHasAction,c.setActions=C.componentsetActions,i._mixins=n.mixins,i._serviceToBeUsed=s?s.services:void 0;var p={},u=Lyte.toBeInjectedServices;if(u)for(var f in u)Lyte.$.injectServices.component(f,u[f],void 0,Lyte.__gS[f],i);for(var h in l)if("mixins"==h){var y={},v={};C.dataFromMixin(l.mixins,p,y,v),o=Object.assign(v,o),p=Object.assign(p,{})}else if("services"==h){var m=l[h];for(var g in m)Lyte.registeredServices.hasOwnProperty(m[g])?o[g]=new Lyte.registeredServices[m[g]]:Lyte.$.requiredServices(g,m[g],(function(e,t){C._registeredComponents[r].component.prototype[t]=new e}))}i._actions=Object.assign({},p,o.actions),i._template=o._template,delete o._template,i._dynamicNodes=o._dynamicNodes,delete o._dynamicNodes,i._templateAttributes=o._templateAttributes,delete o._templateAttributes,i._callBacks={},i._observers=[];var b=o.data?o.data:void 0,L=Object.assign({},y,o.methods);i._observedAttributes=o._observedAttributes||[],i._observedMethodAttributes=o._observedMethodAttributes||{},delete o._observedAttributes,delete o._observedMethodAttributes,delete o.data,delete o.methods,o=C.updateCustomCrmComponent(o,i),i._data=b,i._methods=L,i._registerComponent(r,i),_.registeredComponents[r]=!0,C._registeredComponents[r]||("complete"===document.readyState||"interactive"===document.readyState?customElements.define(r,i):C.toBeRegistered.push({name:r,def:i}));var A=i._depthTemp;return!C._ie&&A&&A.content.childNodes.length?(A.setAttribute("data-id","depthTemp_"+r),C.lyteComponentsDiv.appendChild(A)):delete i._depthTemp,C._registeredComponents[r]=i,a&&((i._pendingComponents||[]).forEach((function(e){delete e.__lyteIgnore,e.actualConstructor(),Array.from(e.attributes).forEach((function(t){-1!=e.constructor.observedAttributes.indexOf(t.name)&&e.attributeChangedCallback(t.name,null,t.value)})),e.connectedCallback()})),i._pendingComponents=[]),i}function $(){}t.warn("Component "+r+" already registered")},registerHelper:function(e,t){_.registeredHelpers[e]=t},registerMixin:function(e,r){t.Mixin.register.call(t,e,r)},typeCast:function(e,t,r){if(null===e)return e;try{switch(t){case"string":return"object"===(void 0===e?"undefined":_typeof(e))?JSON.stringify(e):e.toString();case"number":if(""==e)return;var o=+e;if(isNaN(o))throw"TypeCast exception";return o;case"array":case"object":return JSON.parse(e);case"boolean":return!(!e&&""!==e||"false"===e);default:return e}}catch(t){return r&&(r.isError=!0),e}},sendtoclient:function(e,t,r){var o=t?e.component.data:e,n={},i=r;for(var a in o)if(t){var s=e.component.__data[a];if("bindIds"==a&&(n[a]={value:o[a]}),s&&/^(object|array)$/.test(s.type)&&e._attributeDetails&&e._attributeDetails.hasOwnProperty(S.String.dasherize(a)))n[a]={fP:!0};else if(o[a]instanceof Date)n[a]={value:o[a],type:"Date"};else if(i[a])n[a]={value:o[a],type:i[a].type};else{var l=_typeof(o[a]);null==o[a]&&(l=void 0),n[a]={value:o[a],type:l}}}else"Date"==o[a].type?n[a]=new Date(o[a].value):o[a].fP||(n[a]=o[a].value);return n},getDataType:function(e){var t=void 0===e?"undefined":_typeof(e);return"object"===t&&Array.isArray(e)?"array":t},handleValidation:function(e,r,o,n,i){var a=t.validate(e,r,o,n,i);return a?(C.set(n.data.errors,r,a),n.$node.callback&&n.$node.callback("onError",r,a)):C.clearError(e,r),a},clearError:function(e,r){e.errors&&e.errors[r]&&t.objectUtils(e.errors,"delete",r)},createLyteId:function(e){return e.__counter++,"__lyteId"+e.__counter},apdNode:function(e,t){C.tDiv.content.appendChild(e);var r=this.createLyteId(t);t.__h[r]=e,e.__lyteId=r},update:function(e,t,r,o,n,i,d,c,p,u){var f=e.__component__,h=!0,y=void 0,v=void 0;if(!i){if(i=e[t],f&&"LYTE-YIELD"!==f.tagName){if((v=f.component.__data[t])&&(y=v.type)&&(h=!v.hideAttr,y===C.getDataType(r)||void 0===r&&"boolean"!==y||(r=C.typeCast(r,y))),r===i)return void C.clearError(e,t);if((!o||"object"==(void 0===o?"undefined":_typeof(o))&&1!=o.skipValidation)&&C.handleValidation(e,t,r,f.component))return}e.hasOwnProperty(t)||Array.isArray(e)?e[t]=r:C.oF(e,"add",t,r,!0)}var m,_,g=!!f,b=C.String.dasherize(t),L=!1;if(e._scp&&(Lyte.cmpData(i,r)||(L=!0),i&&(Array.isArray(i)||"object"==(void 0===i?"undefined":_typeof(i)))&&Array.from(e._scp.keys()).forEach((function(e){var t=Lyte.nestScp[e],r=t.cyclic;Lyte.removeNestScp(i,e),r&&Lyte.bindObj(t._data,void 0,e,[],new Map)}))),(Lyte.isRecord(e)&&e.$.__scpObj||e.hasOwnProperty("__component__")&&e.__component__.__scpObj)&&(Lyte.isRecord(e)?(m=e.$.__scpObj,_=e):(m=e.__component__.__scpObj,_=e.__component__),m.hasOwnProperty(t))){var A=m[t].split("_");Lyte.removeNestScp(i,A[0],A[1],void 0,_,void 0,Lyte.isRecord(r)||Array.isArray(r)&&r.model&&r.add?r:void 0),delete m[t]}if((n&&Lyte.isRecord(e)||e&&e.hasOwnProperty("_scp")&&e._scp.size||v&&/^(object|array)$/.test(v.type)&&v&&/^(object|array)$/.test(v.type)&&(v.watch||v.hasOwnProperty("items")||v.hasOwnProperty("properties")))&&Lyte.establishObjectBinding(e,t,n,!0,u,v&&v.watch?v.watch:void 0),f&&c&&("string"==typeof r&&f.getAttribute(b)!==r||f.hasAttribute(b))&&(!C.customPropRegex.exec(t)||f.hasAttribute(b))&&h)if(r&&"object"===(void 0===r?"undefined":_typeof(r))){var $=void 0;try{$=JSON.stringify(r),f.attributes.getNamedItem(b).__lyteIgnore=!0,f.setAttribute(b,$)}catch(e){}}else{var E=C.typeCast(r,"string");if(f.getAttribute(b)!==E){var T=f.attributes.getNamedItem(b);T&&(T.__lyteIgnore=!0),E=E||"",f.setAttribute(b,E)}}if(r&&"string"!=typeof r&&"boolean"!=typeof r&&"number"!=typeof r){if(i&&"object"===(void 0===i?"undefined":_typeof(i))&&i._bindings){if(r._bindings||a(r,"_bindings",{enumerable:!1,writable:!0,value:new Set,configurable:!0}),f&&f.component.data===e&&-1===t.indexOf(".")){var R=f.getProperty(t);if(this.removeSelectedBindingDeep(R,i),l(r._bindings,R),this.establishBindings(R,r),R._forHelpers)for(var O=R._forHelpers.toArrayLyte(),w=0;w<O.length;w++){var S=O[w];S._propBindingObject&&this.removeSelectedBindingDeep(S._propBindingObject,i)}this.affectChanges(R,void 0,i,d,e[t])}else if(e._bindings)for(var P=e._bindings.toArrayLyte(),k=0;k<P.length;k++){var N=P[k][t];if(N){if(this.removeSelectedBindingDeep(N,i),l(r._bindings,N),this.establishBindings(N,r),N._forHelpers)for(var x=N._forHelpers.toArrayLyte(),j=0;j<x.length;j++){var D=x[j];D._propBindingObject&&this.removeSelectedBindingDeep(D._propBindingObject,i)}this.affectChanges(N,void 0,i,d,e[t])}}}else if(e._bindings){s(r,"_bindings");for(var I=e._bindings.toArrayLyte(),B=0;B<I.length;B++){var M=I[B];M[t]&&(l(r._bindings,M[t]),this.establishBindings(M[t],r),this.affectChanges(M[t],void 0,i,d,e[t]))}}v=v||(f&&"LYTE-YIELD"!==f.tagName?f.component.__data[t]:void 0),n&&Lyte.isRecord(e)||e&&e.hasOwnProperty("_scp")&&e._scp.size||v&&/^(object|array)$/.test(v.type)&&(v.watch||v.hasOwnProperty("items")||v.hasOwnProperty("properties"))}else{if(i&&"object"===(void 0===i?"undefined":_typeof(i))&&i._bindings&&e._bindings)for(var F=e._bindings.toArrayLyte(),K=0;K<F.length;K++){var H=F[K];if(H[t]&&(this.removeSelectedBindingDeep(H[t],i),H[t]._forHelpers))for(var q=H[t]._forHelpers.toArrayLyte(),U=0;U<q.length;U++){var z=q[U];z._propBindingObject&&this.removeSelectedBindingDeep(z._propBindingObject,i)}}if(e._bindings)for(var V=e._bindings.toArrayLyte(),G=0;G<V.length;G++){var W=V[G];W[t]&&this.affectChanges(W[t],void 0,i,d,e[t])}}if(L&&e._scp&&this.callDeepObservers(e,{type:"deepChange",oldValue:i,newValue:r},t),g&&!p&&f._attributeDetails&&f._callee){var J=f._attributeDetails[C.String.dasherize(t)],Y=void 0;if(J&&J.isLbind&&(Y=J.dynamicValue),Y){var Q=void 0;f._cx&&(Q=[],C.changeContext(f._cx.node,Q,f._cx));var X=C.getNew(f._callee.component.data,Y);if(!X.context)return;var Z=!1;X.context===f._callee.component.data?f._callee._properties[X.lastKey]&&f._callee._properties[X.lastKey].__fromComponent&&(Z=!0):Z=!0,Z&&C.set(X.context,X.lastKey,r,o),Q&&C.removeContext(f._cx.node,Q,f._cx)}}},getContentForIE:function(e,r,o,n){if("string"==typeof e){o=!0;var i=p("div");i.innerHTML=e,e=i.childNodes[0],r.splitTextNodes(e)}if(e.getAttribute&&e.getAttribute("depth")){Lyte._ms&&n&&(n._content=i);var a=parseInt(e.getAttribute("depth"));e=t._ie?e:o?e.content:e.content.cloneNode(!0);for(var s=0;s<a;s++)e=e.childNodes[0]}return e},replaceWithPf:function(e,r){t._rwpf?(u(e.parentNode,r,e),e.remove()):e.replaceWith(r)},getCallee:function(e,t){for(;e&&!C.isCustomElement(e)&&"LYTE-YIELD"!==e.tagName;){if("BODY"===e.tagName){e=null;break}e=e.parentNode}return e&&"LYTE-YIELD"===e.tagName?e._registerYield?e._registerYield._callee:void 0:t===e?void 0:e},set:function(e,r,o,n,i,a){var s,l=-1,d={};Lyte.isRecord(e)&&i&&(s=e),"object"===(void 0===r?"undefined":_typeof(r))&&r||(l=(r+="").lastIndexOf("."));var c=r;if(-1!==l){var p=r.substring(0,l);r=r.substring(l+1),e=C.get(e,p)}if("string"!=typeof r||e[r]!==o){if(e._setterScope)var u=e._setterScope;var f=[];if(e._scp&&e._scp.size&&(Array.from(e._scp.keys()).forEach((function(t){var r=e._scp.get(t);obj=r.paths;var o,n,i,a=Lyte.nestScp[t],s={},l=Object.keys(obj);if(l.length>1?i="*":1==l.length&&(i=l[0]),s.path=i,s.id=t,l.length>1&&(s.paths=l),s.attr=void 0,s.data=a.data,s.dtype=a.dtype||void 0,s.key=a.key||void 0,s.Error=a.Error||void 0,a.model)for(var d=a.model,c=Array.from(a.model.keys()),p=0;p<c.length;p++){var u=c[p],h=d.get(u);if(h)for(var y=Array.from(h.keys()),v=y.length,m=0;m<v;m++){var _=y[m],g=h.get(_),b=Array.from(g.keys()),L=b.length;for(k=0;k<L;k++){var A=b[k],$=Object.assign({},s),E=store.peekRecord(u,_);E&&((n=(o=E.$.model).fieldList[A])&&(n.properties||n.items||1==n.watch)&&($.data=Lyte.deepCopyObject(E[A]),$.rec=E,$.isRec=!0,$.attr=A,$.dtype=o.fieldList[A],$.Error=E.$.error),f.push($))}}}else f.push(s)})),f.forEach((function(t){if((!n||"object"==(void 0===n?"undefined":_typeof(n))&&1!=n.skipValidation)&&(t.dtype||t.rec)){var i=t.id,a=t.path.split("."),s=t.dtype;Lyte.checkNestedProp(i,a,s,t,e,r,o,d),e.$&&0==Object.values(e.$.error).length&&delete e.$}})),d.value&&d.value.code))return;c=c===r?c:void 0;var h={};if("object"===(void 0===r?"undefined":_typeof(r)))if(!t.isRecord(e)||i||e.$.isCloned)for(var y in r)C.set(e,y,r[y],o,i,a);else{for(var v in r){var m=r[v],_=e.$.model.fieldList[v];!(_=_?_.type:void 0)||void 0===m&&"boolean"!==_||_===C.getDataType(m)||(r[v]=C.typeCast(m,_))}var g=store.$.setData(e.$,r,void 0,n,void 0,void 0,h);if(g.$.isError)return g}else if(!t.isRecord(e)||i||e.$.isCloned)C.update(e,r,o,n,i,void 0,u,c,a,s);else{e[r];var b=e.$.model.fieldList[r];!(b=b?b.type:void 0)||void 0===o&&"boolean"!==b||b===C.getDataType(o)||(o=C.typeCast(o,b));var L=store.$.setData(e.$,r,o,n,void 0,void 0,h);if(L.$.isError)return L}f&&f.length&&f.forEach((function(e){e.isRec&&store.$.deepValueChange(e.rec,e.attr,e.rec[e.attr],e)}))}else e.__component__?C.clearError(e,r):t.isRecord(e)&&!e.$.isCloned&&(store.$.clrRecErr(e.$,r),e.$.emit&&e.$.emit("set",[e,r]),e.$.model&&e.$.model.emit&&e.$.model.emit("set",[e.$.model._name,e,r]),store.emit&&store.emit("set",[e.$.model._name,e,r]))},adCx:function(e,t){var r="LYTE-YIELD"===e.tagName;!e._cx||r&&"LYTE-YIELD"===e._cx.node.tagName?r&&e._callee._cx&&C.changeContext(e._callee._cx.node,t,e._callee._cx,!0):C.changeContext(e._cx.node,t,e._cx,r)},rmCx:function(e,t){var r="LYTE-YIELD"===e.tagName;!e._cx||r&&"LYTE-YIELD"===e._cx.node.tagName?r&&e._callee._cx&&C.removeContext(e._callee._cx.node,t,e._callee._cx,!0):C.removeContext(e._cx.node,t,e._cx,r)},changeContext:function(e,t,r,o){if(r){var n="LYTE-YIELD"===e.tagName;if(!e._cx||n&&"LYTE-YIELD"===e._cx.node.tagName?("LYTE-YIELD"===e.tagName||o)&&e._callee&&e._callee._cx&&C.changeContext(e._callee._cx.node,t,e._callee._cx):C.changeContext(e._cx.node,t,e._cx,"LYTE-YIELD"===e.tagName||o),n){var i=e._registerYield._callee;i&&i._cx&&C.changeContext(i._cx.node,t,i._cx)}var a=void 0,s=void 0;if(r.type){if("for"===r.type){if(a=e.getAttribute("index"),s=e.getAttribute("item"),0===e._items.length)return}else if(a=e.getAttribute("key"),s=e.getAttribute("value"),0===Object.keys(e._items).length)return;var l=e._callee,d=l.component.data[s],c=l.component.data[a],p=l._properties[s],u=l._properties[a],f="for"===r.type?e._currentItems:e._currentObject;l.component.data[s]=f[r.itemIndex],l.component.data[a]=r.itemIndex,l._properties[s]=e._items[r.itemIndex].itemProperty,l._properties[a]=e._items[r.itemIndex].indexProperty;var h={initialItemValue:d,initialIndexValue:c,initialItemProp:p,initialIndexProp:u};t.push(h)}else{var y={},v=e._registerYield._callee;Object.keys(r.node._properties).forEach((function(e){y[e]={},y[e].value=v.component.data[e],y[e].property=v._properties[e],v._properties[e]=r.node._properties[e],v.component.data[e]=r.node.component.data[e]})),t.push(y)}}},removeContext:function(e,t,r,o){if(r){var n="LYTE-YIELD"===e.tagName;if(!e._cx||n&&"LYTE-YIELD"===e._cx.node.tagName?("LYTE-YIELD"===e.tagName||o)&&e._callee&&e._callee._cx&&C.removeContext(e._callee._cx.node,t,e._callee._cx):C.removeContext(e._cx.node,t,e._cx,"LYTE-YIELD"===e.tagName||o),n){var i=e._registerYield._callee;i&&i._cx&&C.removeContext(i._cx.node,t,i._cx)}var a=void 0,s=void 0;if(r.type){if("for"===r.type){if(a=e.getAttribute("index"),s=e.getAttribute("item"),0===e._items.length)return}else if(a=e.getAttribute("key"),s=e.getAttribute("value"),0===Object.keys(e._items).length)return;var l=e._callee,d=(e._attributes.items,t.shift());l.component.data[s]=d.initialItemValue,l.component.data[a]=d.initialIndexValue,l._properties[s]=d.initialItemProp,l._properties[a]=d.initialIndexProp}else{var c=e._registerYield._callee,p=t.shift();Object.keys(r.node._properties).forEach((function(e){c.component.data[e]=p[e].value,c._properties[e]=p[e].property}))}}},sortCommands:function(e,t){var r={},o=e.slice();r.origianlArray=e;for(var n=[],i=0;i<t.length;i++){var a=o.indexOf(t[i]);-1===a?(n.push({type:"Add",element:t[i],toIndex:i}),o.splice(i,0,t[i])):a!==i&&(n.push({type:"Move",element:t[i],fromIndex:a,toIndex:i}),o.splice(a,1),o.splice(i,0,t[i]))}for(var s=o.length-1;s>=t.length;s--)n.push({type:"Remove",element:o[s]}),o.splice(s,1);return r.commands=n,r.changedArray=t,r},oF:function(){var e=arguments[0],r=arguments[1],o=arguments[2],n=arguments[3],i=arguments[4],a=arguments[5];if("add"!==r||i){var s={};if(s.type=r,s.property=o,/^(add|delete)$/.test(r)){var l=e._bindings;if("delete"===r?C.set(e,o,void 0,void 0,a):e[o]=n,l)for(var d=l.toArrayLyte(),c=0;c<d.length;c++){var p=d[c]._forHelpers;if(p)for(var u=p.toArrayLyte(),f=0;f<u.length;f++){var h=u[f];if("forIn"==h.getAttribute("is")){h.getAttribute("key");var y=[];"add"===r&&C.adCx(h,y),h._callee.updateForInHelper(h,s),"add"===r&&C.rmCx(h,y)}}}"delete"===r&&delete e[o]}else t.error("LC005",r)}else C.set(e,o,n,void 0,a)},aF:function(){var e=arguments[0],r=e.length,o=!0,n=arguments[1],i={};if(!/^(replaceAt|removeAt|shift)$/.test(n)||e.length){var a=void 0;if("sort"==n){var l=arguments[0],d=arguments[2],c=arguments[3]||[],p=l.slice();if(c.forEach((function(e){p.push(e)})),"function"==typeof arguments[2])p.sort(d);else{var u=arguments[2],f=u.sortBy,h=u.sortOrder;p.sort((function(e,t){return(e=f?e[f]:e)>(t=f?t[f]:t)?h?1:-1:e<t?h?-1:1:0}))}a=this.sortCommands(l,p).commands}var y=arguments[2],v=void 0,m=[];if(!(e._scp&&/^(replaceAt|splice|removeAt|remove|insertAt)$/.test(n)&&(e._scp.forEach((function(e,t){var r,o={},n=Lyte.nestScp[t],i=e.paths,a=Object.keys(i);if(a.length>1?r="*":1==a.length&&(r=a[0]),o.path=r,o.id=t,a.length>1&&(o.paths=a),o.attr=void 0,o.data=n.data,o.reInit=Lyte.isRecord(n.data)||Array.isArray(n.data)&&n.data.model&&n.data.add,o.dtype=n.dtype||void 0,o.key=n.key||void 0,o.Error=n.Error||void 0,o.index=y,n.model)for(var s=n.model,l=Array.from(n.model.keys()),d=0;d<l.length;d++){var c=l[d],p=s.get(c);if(p)for(var u=Array.from(p.keys()),f=u.length,h=0;h<f;h++){var v=u[h],_=p.get(v),g=Array.from(_.keys()),b=g.length;for(k=0;k<b;k++){var L=g[k],A=Object.assign({},o),$=store.peekRecord(c,v);$&&(model=$.$.model,field=model.fieldList[L],field&&(field.properties||field.items||1==field.watch)&&(A.data=Lyte.deepCopyObject($[L]),A.rec=$,A.isRec=!0,A.attr=L,A.dtype=model.fieldList[L],A.Error=$.$.error,A.key=L),m.push(A))}}}else o.reInit=Lyte.isRecord(n.data)||Array.isArray(n.data)&&n.data.model&&n.data.add,m.push(o)})),m.forEach((function(t){if(t.dtype||t.rec){var r=t.id,o=t.path.split("."),n=t.dtype;Lyte.checkNestedProp(r,o,n,t,e,o,y,i),e.$&&0==Object.values(e.$.error).length&&delete e.$}})),i.value&&i.value.code)))switch(n){case"replaceAt":var _=parseInt(arguments[2]);if(_>e.length)return t.warn("index provided for replaceAt is greater than array length"),[];var g=arguments[3];Array.isArray(g)||(g=[g]);var b=e.splice.apply(e,[_,1].concat(g)),L={firstIndex:_,secondIndex:g.length,type:"replace"};if(1==L.secondIndex&&(o=!1),e._bindings)for(var A=e._bindings.toArrayLyte(),$=0;$<A.length;$++){var E=A[$];if(E._forHelpers)for(var T=E._forHelpers.toArrayLyte(),R=0;R<T.length;R++){var O=T[R];if("for"==O.getAttribute("is")){for(var w=_+b.length,S=O.getAttribute("item"),P=_,N=0;P<w;P++,N++)C.removeSelectedBindingDeep(_defineProperty({},S,O._items[P].itemProperty),_defineProperty({},S,b[N]));var x=[];C.adCx(O,x),O._callee.updateForHelper(O,L),C.rmCx(O,x)}}for(var j in E){var D=parseInt(j),I=1==L.secondIndex?D==L.firstIndex:D>=L.firstIndex;if(!isNaN(D)&&I){var B=D-L.firstIndex,M=void 0;if(M=B<1?b[B]:e[L.firstIndex-1+L.secondIndex+B],this.removeSelectedBindingDeep(E[j],M),E[j]._forHelpers)for(var F=E[j]._forHelpers.toArrayLyte(),K=0;K<F.length;K++){var H=F[K];H._propBindingObject&&this.removeSelectedBindingDeep(H._propBindingObject,M)}if(e[D]&&"object"===_typeof(e[D])&&(s(e[D],"_bindings"),this.establishBindings({dummy:E[j]},{dummy:e[D]})),this.affectChanges(E[j],void 0,M,void 0,e[D]),1==L.secondIndex)break}}}return v={type:"array",insertedItems:g,removedItems:b,index:_},C.bindWatchObj(m,e,g,b,_),C.callArrayObservers(e,v,o,r),b[0];case"splice":var q=parseInt(arguments[2]);if(q>e.length)return t.warn("index provided is greater than array length"),[];var U=arguments.length>3?arguments[3]:e.length-q,z=arguments.length>4?arguments[4]:[];Array.isArray(z)||(z=[z]);var V=e.splice.apply(e,[q,U].concat(z)),G={firstIndex:q,secondIndex:z.length,thirdIndex:U,type:"splice"};if(G.secondIndex==G.thirdIndex&&(o=!1),e._bindings)for(var W=e._bindings.toArrayLyte(),J=0;J<W.length;J++){var Y=W[J];if(Y._forHelpers)for(var Q=Y._forHelpers.toArrayLyte(),X=0;X<Q.length;X++){var Z=Q[X];if("for"==Z.getAttribute("is")){for(var ee=q+V.length,te=Z.getAttribute("item"),re=q,oe=0;re<ee;re++,oe++)C.removeSelectedBindingDeep(_defineProperty({},te,Z._items[re].itemProperty),_defineProperty({},te,V[oe]));var ne=[];C.adCx(Z,ne),Z._callee.updateForHelper(Z,G),C.rmCx(Z,ne)}}for(var ie in Y){var ae=parseInt(ie),se=G.secondIndex==G.thirdIndex?ie>=G.firstIndex&&ie<G.firstIndex+G.secondIndex:ae>=G.firstIndex;if(!isNaN(ae)&&se){var le=ae-G.firstIndex,de=void 0;if(de=le<G.thirdIndex?V[le]:e[G.firstIndex-G.thirdIndex+G.secondIndex+le],this.removeSelectedBindingDeep(Y[ie],de),Y[ie]._forHelpers){var ce=Y[ie]._forHelpers.toArrayLyte();for(K=0;K<ce.length;K++){var pe=ce[K];pe._propBindingObject&&this.removeSelectedBindingDeep(pe._propBindingObject,de)}}e[ae]&&"object"===_typeof(e[ae])&&(s(e[ae],"_bindings"),this.establishBindings({dummy:Y[ie]},{dummy:e[ae]})),this.affectChanges(Y[ie],void 0,de,void 0,e[ae])}}}return v={type:"array",index:q,insertedItems:z,removedItems:V},C.bindWatchObj(m,e,z,V,q),C.callArrayObservers(e,v,o,r),V;case"push":var ue=arguments[2];Array.isArray(ue)||(ue=[ue]),C.aF(e,"insertAt",e.length,ue);break;case"pop":return C.aF(e,"remove",e.length-1)[0];case"shift":case"shiftObject":return C.aF(e,"remove",0)[0];case"removeAt":case"remove":var fe=parseInt(arguments[2]);if(fe>e.length)return t.warn("index provided for removeAt is greater than array length"),[];var he=arguments[3]?parseInt(arguments[3]):1,ye={firstIndex:fe,secondIndex:he,type:"remove"},ve=e.splice(fe,he);if(e._bindings)for(var me=e._bindings.toArrayLyte(),_e=0;_e<me.length;_e++){var ge=me[_e];if(ge._forHelpers)for(var be=ge._forHelpers.toArrayLyte(),Le=0;Le<be.length;Le++){var Ae=be[Le];if("for"==Ae.getAttribute("is")){for(var $e=fe+ve.length,Ee=Ae.getAttribute("item"),Te=fe,Re=0;Te<$e;Te++,Re++)C.removeSelectedBindingDeep(_defineProperty({},Ee,Ae._items[Te].itemProperty),_defineProperty({},Ee,ve[Re]));var Oe=[];C.adCx(Ae,Oe),Ae._callee.updateForHelper(Ae,ye),C.rmCx(Ae,Oe)}}for(var we in ge){var Se=parseInt(we);if(!isNaN(Se)&&Se>=ye.firstIndex){var Ce=Se-ye.firstIndex,Pe=void 0;if(Pe=Ce<ye.secondIndex?ve[Ce]:e[ye.firstIndex-ye.secondIndex+Ce],this.removeSelectedBindingDeep(ge[we],Pe),ge[we]._forHelpers){var ke=ge[we]._forHelpers.toArrayLyte();for(K=0;K<ke.length;K++){var Ne=ke[K];Ne._propBindingObject&&this.removeSelectedBindingDeep(Ne._propBindingObject,Pe)}}e[Se]&&"object"===_typeof(e[Se])&&(s(e[Se],"_bindings"),this.establishBindings({dummy:ge[we]},{dummy:e[Se]})),this.affectChanges(ge[we],void 0,Pe,void 0,e[Se])}}}return v={type:"array",removedItems:ve,index:fe},C.bindWatchObj(m,e,void 0,ve,fe),C.callArrayObservers(e,v,o,r),ve;case"removeObject":y=[y];case"removeObjects":Array.isArray(y)||(y=[y]),y==e&&(y=Array.from(y));for(var xe=0;xe<y.length;xe++){var je=e.indexOf(y[xe]);-1!==je&&C.aF(e,"removeAt",je)}break;case"unshift":case"unshiftObject":case"unshiftObjects":var De=arguments[2];Array.isArray(De)||(De=[De]),C.aF(e,"insertAt",0,De);break;case"insertAt":var Ie=parseInt(arguments[2]),Be=arguments[3],Me=Be.length;Array.isArray(Be)||(Be=[Be]);for(var Fe=Ie;Fe>e.length;Fe--)Be.unshift(void 0),Ie--;var Ke={firstIndex:Ie,secondIndex:Be.length,type:"insert"};if(e.splice.apply(e,[Ie,0].concat(Be)),e._bindings)for(var He=e._bindings.toArrayLyte(),qe=0;qe<He.length;qe++){var Ue=He[qe];if(Ue._forHelpers)for(var ze=Ue._forHelpers.toArrayLyte(),Ve=0;Ve<ze.length;Ve++){var Ge=ze[Ve];if("for"==Ge.getAttribute("is")){var We=[];C.adCx(Ge,We),Ge._callee.updateForHelper(Ge,Ke),C.rmCx(Ge,We)}}for(var Je in Ue){var Ye=parseInt(Je);if(!isNaN(Ye)&&Ye>=Ke.firstIndex){if(this.removeSelectedBindingDeep(Ue[Je],e[Ye+Ke.secondIndex]),Ue[Je]._forHelpers){var Qe=Ue[Je]._forHelpers.toArrayLyte();for(K=0;K<Qe.length;K++){var Xe=Qe[K];Xe._propBindingObject&&this.removeSelectedBindingDeep(Xe._propBindingObject,oldObject)}}e[Ye]&&"object"===_typeof(e[Ye])&&(s(e[Ye],"_bindings"),this.establishBindings({dummy:Ue[Je]},{dummy:e[Ye]})),this.affectChanges(Ue[Je],void 0,e[Ye+Ke.secondIndex],void 0,e[Ye])}}}var Ze=parseInt(arguments[2]);v={type:"array",insertedItems:Array.isArray(arguments[3])?arguments[0].slice(Ze,Ze+Me):[arguments[3]],index:Ze},C.bindWatchObj(m,e,Be,void 0,Ze),C.callArrayObservers(e,v,o,r);break;case"concat":C.aF(e,"insertAt",e.length,arguments[2]);break;case"sort":var et=[];if(a.forEach((function(t){switch(t.type){case"Remove":e.splice(t.toIndex,1),et.push({firstIndex:t.toIndex,secondIndex:1,type:"remove"});break;case"Move":e.splice(t.fromIndex,1),e.splice(t.toIndex,0,t.element),et.push({firstIndex:t.fromIndex,secondIndex:1,type:"remove"}),et.push({firstIndex:t.toIndex,secondIndex:1,thirdIndex:0,type:"splice"});break;case"Add":e.splice(t.toIndex,0,t.element),et.push({firstIndex:t.toIndex,secondIndex:1,thirdIndex:0,type:"splice"})}})),e._bindings)for(var tt=e._bindings.toArrayLyte(),rt=0;rt<tt.length;rt++){var ot=tt[rt];if(ot._forHelpers)for(var nt=ot._forHelpers.toArrayLyte(),it=0;it<nt.length;it++){var at=nt[it];if("for"==at.getAttribute("is")){var st=[];C.adCx(at,st);for(var lt=0;lt<et.length;lt++){var dt=et[lt];at._callee.updateForHelper(at,dt)}C.rmCx(at,st)}}}if(Array.isArray(arguments[3])&&arguments[3].length){v={type:"array",insertedItems:arguments[3]};var ct=[];arguments[3].forEach((function(t){ct.push(e.indexOf(t))})),v.indices=ct,C.callArrayObservers(e,v,o,r)}break;default:return void t.error("LC006",n)}}else t.warn(n+" operation cannot be performed on empty array")},callDeepObservers:function(e,t,r,o){var n=this;Array.from(e._scp.keys()).forEach((function(i){var a,s=e._scp.get(i).paths,l=Object.keys(s);1==l.length?a=l[0]:l.length>1&&(a=l);var d,c=Lyte.nestScp[i];if(c.model)for(var p=c.model,u=Array.from(c.model.keys()),f=0;f<u.length;f++){var h=u[f],y=p.get(h);if(y)for(var v=Array.from(y.keys()),m=v.length,_=0;_<m;_++){var g=v[_],b=y.get(g),L=Array.from(b.keys()),A=L.length;for(k=0;k<A;k++){var $=L[k],E=store.peekRecord(h,g);n.deepObsBind(E,!0,$,t,l,a,e,r,o)}}}else d=c.data,n.deepObsBind(d,!1,void 0,t,l,a,e,r,o)}))},deepObsBind:function(t,r,o,n,i,a,s,l,d){var c=n.type;if(t._bindings)for(var p=Object.assign({},n),u=t._bindings.toArrayLyte(),f=0;f<u.length;f++){var h=u[f],y=void 0;if(r?h.hasOwnProperty(o)&&h[o].hasOwnProperty("*")&&(y=h[o]["*"]):h.hasOwnProperty("*")&&(y=h["*"]),y){var v=y._observers?y._observers.toArrayLyte():[];if(l)if(i.length>1){for(var m=i.length,_=[],g=0;g<m;g++)_.push(i[g]?i[g]+"."+l:l);a=_}else 1==i.length&&(a=a?a.concat("."+l):l);for(var b=0;b<v.length;b++){var L=v[b];p.path=a,p.type="deepChange",p.data=t;var A=y._path.split(".");if(A.pop(),p.item=A.join("."),L.callee&&L.callee.component)L.observer.value.call(L.callee.component,p);else{var $=s._setterScope?s._setterScope:e;if(Array.isArray($))for(var E=$.length,T=0;T<E;T++){var R=$[T];L.observer.value.call(R,p)}else L.observer.value.call($,p)}}}!d&&"array"==c&&h.length&&this.affectChanges(h.length,void 0,initialArrLength,void 0,array.length,d)}},callArrayObservers:function(t,r,o,n){if(t._scp&&t._scp.size&&this.callDeepObservers(t,Object.assign({},r),void 0,!0),t._bindings)for(var i=t._bindings.toArrayLyte(),a=0;a<i.length;a++){var s=i[a],l=i[a]._path;if(s._observers)for(var d=s._observers.toArrayLyte(),c=0;c<d.length;c++){var p=d[c];if(p.isArrayObserver)if(r&&(r.item=l),p.callee&&p.callee.component)p.observer.value.call(p.callee.component,r);else{var u=t._setterScope?t._setterScope:e;if(Array.isArray(u))for(var f=u.length,h=0;h<f;h++){var y=u[h];p.observer.value.call(y,r)}else p.observer.value.call(u,r)}}s.length&&this.affectChanges(s.length,void 0,n,void 0,t.length,o)}},bindWatchObj:function(e,t,r,o,n){e&&e.length&&e.forEach((function(e){if(e.isRec&&store.$.deepValueChange(e.rec,e.attr,t,e),o&&o.forEach((function(t){Lyte.removeNestScp(t,e.id,void 0,void 0,void 0,void 0,e.reInit?e.data:void 0)})),r&&r.forEach((function(t,r){if(t&&(Array.isArray(t)||"object"==(void 0===t?"undefined":_typeof(t)))){var o=e.path.split(",");o.push(n+r),Lyte.bindObj(t,void 0,e.id,o&&o.length?o:[],void 0,void 0,void 0,!0)}})),void 0!==n){var i=Lyte.nestScp[e.id];if(i.cyclic)Lyte.removeNestScp(i._data,e.id),Lyte.bindObj(i._data,void 0,e.id,[],void 0,void 0,void 0,!0);else{var a=r?r.length:0,s=n+a,l=t.slice(s);l.forEach((function(t){Lyte.removeNestScp(t,e.id)})),l.forEach((function(t,r){if(t&&(Array.isArray(t)||"object"==(void 0===t?"undefined":_typeof(t)))){var o=e.path.split(",");o.push(s+r),Lyte.bindObj(t,void 0,e.id,o&&o.length?o:[],void 0,void 0,void 0,!0)}}))}}}))},establishUpdateBindings:function(e,t,r){for(var o=e.toArrayLyte(),n=0;n<o.length;n++){var i=o[n];i[t]&&(s(r,"_bindings"),l(r._bindings,i[t]),this.establishBindings(i[t],r))}},establishSelectedBinding:function(e,t,r){if(e)for(var o=e._path.split("."),n=r.getProperty(o[0]),i=t[o[0]],a=0;a<o.length&&i&&"object"===(void 0===i?"undefined":_typeof(i));a++)s(i,"_bindings"),l(i._bindings,n),n=n[o[a+1]],i=i[o[a+1]]},establishBindings:function(e,t){if(e._helperNodes)for(var r=e._path,o=e._helperNodes.toArrayLyte(),n=0;n<o.length;n++){var i=o[n]._dynamicProperty?o[n]._dynamicProperty[r]:void 0;if(i)for(var a=0;a<i.length;a++){var d=i[a].ownerElement;if(d&&"TEMPLATE"===d.tagName&&"for"===d.getAttribute("is")&&d._items){d.getAttribute("item");for(var c=0;c<d._items.length;c++){var p=t[c],u=d.getAttribute("item");p&&"object"===_typeof(d._items[c])&&this.establishBindings(d._items[c].itemProperty,_defineProperty({},u,p))}}}}for(var f in e){var h=t[f];h&&"string"!=typeof h&&"number"!=typeof h&&"boolean"!=typeof h?(h._bindings||s(h,"_bindings"),l(h._bindings,e[f]),"object"===_typeof(e[f])&&this.establishBindings(e[f],h)):(t._bindings||s(t,"_bindings"),l(t._bindings,e))}},removeSelectedBindingDeep:function(e,t,r){if(t||r){for(var o in t&&t._bindings&&f(t,"_bindings",e),e){var n=void 0;t&&(n=t[o]),n&&n._bindings&&f(n,"_bindings",e[o]),"object"===_typeof(e[o])&&this.removeSelectedBindingDeep(e[o],n,r)}if(r){var i=e._dynamicNodes,a=e._helperNodes;i&&i.length&&e._dynamicNodes.splice(0,i.length),a&&a.size&&a.clear()}if(e&&e._forHelpers)for(var s=e._forHelpers.toArrayLyte(),l=0;l<s.length;l++){var d=s[l];if("for"===d.getAttribute("is")){d.getAttribute("item");for(var c=d._attributes.items,p=d._items,u=0;u<p.length;u++)this.removeSelectedBindingDeep(p[u].itemProperty,c[u],r)}else d._propBindingObject&&t&&t._bindings&&(f(t,"_bindings",d._propBindingObject),this.removeSelectedBindingDeep(d._propBindingObject,t,r))}}},removeAllBindings:function(e,t){for(var r in e)t[r]&&t[r]._bindings&&f(t[r],"_bindings",e[r]),t[r]&&"string"!=typeof t[r]&&C.removeAllBindings(e[r],t[r])},affectChanges:function(t,r,o,n,i,a){if(t._dynamicNodes)for(var s=0;s<t._dynamicNodes.length;s++)t._dynamicNodes[s]._callee.updateNode(t._dynamicNodes[s],t._path);var l=t._path;if(t._helperNodes)for(var d=[],c=t._helperNodes.toArrayLyte(),p=0;p<c.length;p++)if(t._helperNodes.has(c[p]))if("for"===c[p].getAttribute("is")&&c[p]._items){var u=[];C.adCx(c[p],u);for(var f=c[p].getAttribute("index"),h=c[p].getAttribute("item"),y=c[p]._callee,v=y.component.data[h],m=y.component.data[f],_=y._properties[h],g=y._properties[f],b=c[p]._attributes.items,L=0;L<c[p]._items.length;L++)if(y.component.data[h]=b[L],y.component.data[f]=L,y._properties[h]=c[p]._items[L].itemProperty,c[p]._items[L]._dynamicProperty[l]){d=c[p]._items[L]._dynamicProperty[l];for(var A=0;A<d.length;A++)d[A]._callee.updateNode(d[A],l)}y.component.data[h]=v,y.component.data[f]=m,y._properties[h]=_,y._properties[f]=g,C.rmCx(c[p],u)}else if("forIn"===c[p].getAttribute("is")&&c[p]._items){var $=[];C.adCx(c[p],$);var E=c[p].getAttribute("key"),T=c[p].getAttribute("value"),R=c[p]._callee,O=R.component.data[T],w=R.component.data[E],S=R._properties[T],P=R._properties[E],k=c[p]._attributes.object;for(var N in c[p]._items)if(R.component.data[T]=k[N],R.component.data[E]=N,R._properties[T]=c[p]._items[N].itemProperty,c[p]._items[N]._dynamicProperty[l]){d=c[p]._items[N]._dynamicProperty[l];for(var x=0;x<d.length;x++)d[x]._callee.updateNode(d[x],l)}R.component.data[T]=O,R.component.data[E]=w,R._properties[T]=S,R._properties[E]=P,C.rmCx(c[p],$)}else{var j=[];if((d=c[p]._dynamicProperty[t._path]||[]).length){C.adCx(c[p],j);for(var D=0;D<d.length;D++)d[D]._callee.updateNode(d[D],t._path);C.rmCx(c[p],j)}}if(t._observers){var I=t._observers.toArrayLyte();if(0!=a&&(null!=o||null!=i))for(var B=0;B<I.length;B++){var M=I[B],F={type:"change",oldValue:o,newValue:i,item:t._path};if(M.callee&&M.callee.component)M.observer.value.call(M.callee.component,F);else{var K=n||e;if(Array.isArray(K))for(var H=K.length,q=0;q<H;q++){var U=K[q];M.observer.value.call(U,F)}else M.observer.value.call(K,F)}}}if(Array.isArray(t))for(var z=0;z<t.length;z++)for(var V in t[z])this.affectChanges(t[z][V],!0,o?o[z]?o[z][V]:o[z]:o,n,i?i[z]?i[z][V]:i[z]:i);else for(var G in t){var W=o?o[G]:o,J=i?i[G]:i;"*"==G&&t[G].hasOwnProperty("_observers")&&(W=o,J=i),this.affectChanges(t[G],!0,W,n,J)}},skipArgProcessing:function(e,t,r){if(e.skipArgProcessing){var o=e.args=e.actArgs;o.shift();var n=o.indexOf("__lyteEvent__"),i=o.indexOf("__lyteNode__");-1!==n&&(o[n]=t),-1!==i&&(o[i]=r)}else e.args.shift()},getDV:function(e){for(var t,r,o=[],n=o,i=[],a="",s=[],l=[],d=[],c=0;c<e.length;c++)if("."!==e[c])if("["!==e[c]){if(('"'===e[c]||"'"===e[c])&&e[c++]===t){for(;"s"===e[c]&&"]"!=e[c];)c++;s.pop(),r=!0}"]"!==e[c]?a=a.concat(e[c]):(l.pop(),a.length&&(!0===r||isNaN(parseInt(a))?n.push(a):d.length&&(n=d.pop(),i.length&&Array.isArray(n[n.length-1])&&!n[n.length-1].length&&n.pop(),n.push(a),!l.length&&i.length&&i.shift())),!l.length&&i.length?(o.push(i.shift()),n=o):d.length&&!i.length&&(n=d.pop()),a="",r="")}else{for(l.push(c),a.length&&n.push(a);"s"===e[c+1];)c++;'"'===e[c+1]||"'"===e[c+1]?(s.push(e[c+1]),t=e[c+1],c++):i.length?(n.push([]),d.push(n),n=n[n.length-1]):(i.push([]),d.push(n),n=i[i.length-1]),a=""}else a.length&&n.push(a),a="";return a.length&&o.push(a),(s.length||l.length)&&console.log("check the syntax",s,l),o},ccDelay:[],callCC:function(){this.ccDelay.forEach((function(e){e.component&&e.actualConnectedCallback()})),this.ccDelay=[]},getDD:function(e,t){var r=e;return t.forEach((function(t,o){if(Array.isArray(t)){if(null==e)return;var n=C.getDD(r,t);if(null==n)return;e=e[n]}else{if(null==e)return;e=e[t]}})),e},processStatic:function(e){for(var t=e.innerHTML.split("__**"),r=[],o=0;o<t.length;o++)t[o].startsWith("--Lyte")?r.push(parseInt(t[o].substring(6))):r.push(void 0);return t.cc=r,t},findLastNodeL:function(e,t,r){var o,n=0;switch(null!=t&&(n=t),r.getAttribute("is")){case"for":r._helpers[n]&&(o=r._helpers[n][0]),e||r._forContent[0]&&(e=r._forContent[0][0]);break;case"forIn":r._helpers[r._keysArray[0]]&&(o=r._helpers[r._keysArray[0]][0]),e||r._forContent[r._keysArray[0]]&&(e=r._forContent[r._keysArray[0]][0]);break;case"if":case"switch":o=r._helpers[n],e||(e=r._caseContent[0]);break;case"component":return e._renderedComponent[e._currentComponent]||e}return e||(e=r._placeHolder),o&&e==o._placeHolder&&(e=this.findLastNodeL(void 0,void 0,o)),e},processAction:function(e){Array.from(e.querySelectorAll("[lyteaction]")).forEach((function(e){var r=e.attributes.lyteaction.value;e._boundEvents=C.fRP[r],delete C.fRP[r];var o=e._boundEvents._cx,n=e._boundEvents;delete n._cx;var i=n.componentName;for(var a in delete n.componentName,e._boundEvents)if(-1!==a.indexOf("-")){e._actions=e._actions||{},e._actions[a]=new CustomEvent(a),e._actions[a].processAction=e._boundEvents[a],e._boundEvents[a].actArgs.shift();var s=e._boundEvents[a].actArgs.indexOf("__lyteNode__");-1!==s&&(e._boundEvents[a].actArgs[s]=e),e._boundEvents[a].args=e._boundEvents[a].actArgs,delete e._boundEvents[a]}else{var l=t.deepCopyObject(e._boundEvents[a].args),d=l.splice(0,1)[0],c=B(d=d.startsWith("'")?d.replace(/'/g,""):d,l);e.setAttribute(a.startsWith("on")?a.substr(2):a,i+" => "+c),e._boundEvents[a].globalEvent||e.addEventListener(a,A)}e._boundEvents._cx=o,e.removeAttribute("lyteaction")}))},getCtxVal:function(e,t){return null!=e?e[t]:void 0},get:function(e,t,r,o){if(r||(r=[]),o&&o.hasOwnProperty(t))return nodeValue=o[t]._data,o[t]._dyn&&o[t]._dyn.forEach((function(e){r.push(e)})),nodeValue;try{var n=t.match(/([^[\]]+|\[\])/g),i=e;r.push(n[0]);for(var a=n[0].split("."),s=0;s<a.length;s++)e=C.getCtxVal(e,a[s]);for(var l=1;l<n.length;l++){var d=n[l];if(d.startsWith(".")){for(var c=d.substring(1).split("."),p=0;p<c.length;p++)e=C.getCtxVal(e,c[p]);r[0]=r[0]+d}else if(d.startsWith("'")||d.startsWith('"')||!isNaN(d))isNaN(d)?(r[0]=r[0]+"."+d.substring(1,d.length-1),e=C.getCtxVal(e,d.substring(1,d.length-1))):(r[0]=r[0]+"."+d,e=C.getCtxVal(e,d));else{r.length;var u=C.get(i,d,r);r[0]=r[0]+"."+u,e=C.getCtxVal(e,u)}}return o&&(o[t]={},o[t]._data=e,o[t]._dyn=r),e}catch(e){return}},getNew:function(e,t){try{var r=t.match(/([^[\]]+|\[\])/g),o=e,n=r[0].split(".");if(r.length<2){if(n.length<2)return{context:o,lastKey:n[0]};for(var i=0;i<n.length-1;i++)e=e[n[i]];return{context:e,lastKey:n[i]}}for(var a=0;a<n.length;a++)e=e[n[a]];for(var s=1;s<r.length-1;s++){var l=r[s];if(l.startsWith("."))for(var d=l.substring(1).split("."),c=0;c<d.length;c++)e=e[d[c]];else e=l.startsWith("'")||l.startsWith('"')||!isNaN(l)?e[l.substring(1,l.length-1)]:e[this.get(o,l)]}var p=r[s];if(p.startsWith(".")){for(var u=p.substring(1).split("."),f=0;f<u.length-1;f++)e=e[u[f]];p=u[f]}else p=p.startsWith("'")||p.startsWith('"')||!isNaN(p)?p.substring(1,p.length-1):this.get(o,p);return{context:e,lastKey:p}}catch(e){return}},componentGetData:function(e){return e?this.get(e):this.data},componentSetData:function(e,t,r){if("string"==typeof e)this.set(e,t,r);else if("object"===(void 0===e?"undefined":_typeof(e)))for(var o in e)this.set(o,e[o],t)},componentGetMethods:function(e){return e?this.methods[e]:this.methods},componentHasAction:function(e){return!(!e||!this.$node._actions[e])},componentsetActions:function(e,t){var r=this.$node.constructor._actions;if("string"==typeof e)r[e]=t;else if("object"===(void 0===e?"undefined":_typeof(e)))for(var o in e)r[o]=e[o]},componentSetMethods:function(e,t){if("string"==typeof e)this.methods[e]=t;else if("object"===(void 0===e?"undefined":_typeof(e)))for(var r in e)this.methods[r]=e[r]},render:function(e,r,o,n){var i;if(e){if("string"==typeof e)i=p(e);else{if(!e.compName)return void t.error("LC007");i=p(e.compName)}if(r&&i.setData(r),o){var a=void 0;(a="string"==typeof o?document.querySelector(o):o)?(n&&n.dataType&&(i.component.__data=n.dataType),a.appendChild(i),i._callee=i.getCallee?i.getCallee(a):void 0):t.error("LC008",o)}return i}t.error("LC007")},String:{cache_c:{},cache_d:{},upperCaseFirstLetter:function(e){return e.charAt(0).toUpperCase()+e.slice(1)},lowerCaseFirstLetter:function(e){return e.charAt(0).toLowerCase()+e.slice(1)},toCamelCase:function(e){return this.cache_c[e]||(this.cache_c[e]=e.replace(/(-\w)/g,(function(e){return e[1].toUpperCase()}))),this.cache_c[e]},dasherize:function(e){return this.cache_d[e]||(this.cache_d[e]=e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()),this.cache_d[e]}},appendChild:function(e,t){C.ignoreDisconnect=!0,e.appendChild(t),C.ignoreDisconnect=!1},replaceWith:function(){var e=Array.from(arguments),t=e.shift();C.ignoreDisconnect=!0;for(var r,o=t.parentNode,n=0;r=e[n];n++)o.insertBefore(r,t);t.remove(),C.ignoreDisconnect=!1},insertBefore:function(e,r,o){if(C.ignoreDisconnect=!0,!o){if(!e)return t.error("LC010"),void(C.ignoreDisconnect=!1);o=e.parentNode}u(o,r,e||null),C.ignoreDisconnect=!1},insertAfter:function(){var e=Array.from(arguments),t=e.shift();C.ignoreDisconnect=!0,t.after.apply(t,e),C.ignoreDisconnect=!1},executeMethod:function(){var e=Array.prototype.slice.call(arguments,1),r=C.String.toCamelCase(arguments[0]);if(this.methods[r])return this.methods[r].apply(this,e);t.error("LC009",r,this.$node.tagName)},getProperData:function(e){var r=e.dataType,o=e.attr,n=e.newValue,i=e.tagName;switch(r){case"boolean":n=!(!n||"false"===n);break;case"object":try{(n=JSON.parse(n))instanceof Object||t.warn("data type of the value provided for attribute "+o+" of "+i+" is not valid")}catch(e){return void t.warn("attribute "+o+" is not a valid JSON string.")}break;case"array":try{(n=JSON.parse(n))instanceof Array||t.warn("data type of the value provided for attribute "+o+" of "+i+" is not valid")}catch(e){return void t.warn("attribute "+o+" is not a valid JSON string.")}break;case"number":var a=+n;if(n!==a+"")return void t.warn("data type of the value provided for attribute "+o+" of "+i+" is not valid");n=a}return e.newValue=n,!0},cssEscape:function(e){return e?e.replace(/['"]/g,"\\$&"):e}};t.typeCast=S.typeCast,t.getDataType=S.getDataType,t.Component._get=S.get,_.chromeBugFix=function(){var e=h.match(/Chrom(e|ium)\/([0-9]+)\./);(e=e?parseInt(e[2],10):0)>62&&(this.chI=[],document.addEventListener("focus",(function(e){var t=e.target;"INPUT"!==t.tagName&&"TEXTAREA"!==t.tagName&&"DIV"!==t.tagName||-1==Lyte.Component.chI.indexOf(t)&&Lyte.Component.chI.push(t)}),!0),this.chromeBugFix=function(){var e=Lyte.Component.chI,t=e.length,r=["_callee","_attributeDetails","_attributes","_removedAttributes","_yields","_rA","_cx"],o=[],n=[];document.querySelectorAll("[lyte-keep-alive]").forEach((function(e,t){for(var r in e._renderedComponent)n.push.apply(n,Array.from(e._renderedComponent[r].querySelectorAll("input")))}));for(var i,a=t-1;i=e[a];a--)document.compareDocumentPosition(i)%2&&-1==n.indexOf(i)&&(e.splice(a,1),i.remove(),o.push(i),i._rA=i._rA||[],i._rA.forEach((function(e){e.ownerElement=void 0})),r.forEach((function(e){i[e]=void 0})),Array.from(i.attributes).forEach((function(e){i.removeAttribute(e.nodeName)})))},Lyte.addEventListener("afterRouteTransition",(function(){Lyte.Component.chromeBugFix()})),Lyte.Router||setInterval((function(){Lyte.Component.chromeBugFix(),S.String.cache_c={},S.String.cache_d={}}),3e5))};var C=S;function P(e,t){for(var r=document.createElementNS("http://www.w3.org/2000/svg","svg"),o=0;o<e.childNodes.length;o++)r.appendChild(e.childNodes[o].cloneNode(!0));var n=document.createElement("template");for(n.setAttribute("is",t),o=0;o<r.childNodes.length;o++)n.content.appendChild(r.childNodes[o]),o--;return n}function N(e,t){var r=document.createElement("template");return r.setAttribute("is",t),r.innerHTML=e.innerHTML,r}function x(e,t){t.splitTextNodes(e),t._depthTemp.content.appendChild(e)}function j(e,t,r,o){var n=!0;"TEMPLATE"==e.tagName&&(t._ht=e.innerHTML,n=!1),t._ht&&(n&&(e.innerHTML=t._ht,o.splitTextNodes(e)),r&&r.innerHTML!==t._ht&&(r.innerHTML=t._ht,o.splitTextNodes(r)))}function D(e,r,o,n,i){for(var a=function(a){var s=r[a],g=s.type,b=s.position,L=I(e,b),A=void 0;switch(i&&(A=I(i,b)),g){case"text":var $=Lyte.Compile.getMustache(L.nodeValue),E=void 0;$&&(E=Lyte.Compile.getHelper($));var T=$;E?(s.helperInfo=E,A&&(s.newHelperInfo=Lyte.Compile.getHelper($,!0),C.replaceWithPf(A,document.createTextNode("__**--Lyte"+a+"__**")))):T&&(s.dynamicValue=T,s.newDynamicValue=C.getDV(T),A&&C.replaceWithPf(A,document.createTextNode("__**--Lyte"+a+"__**")));break;case"insertYield":if(A){A.appendChild(document.createTextNode("__**--Lyte"+a+"__**"));var R=A.attributes["yield-name"];s.yieldName=R?R.nodeValue:void 0}break;case"componentDynamic":if(A){for(A.appendChild(document.createTextNode("__**--Lyte"+a+"__**")),s.componentName=A.localName,l=Array.from(A.attributes),s.staticAttrs={},y=0;y<l.length;y++)s.staticAttrs[C.String.toCamelCase(l[y].nodeName)]=l[y].nodeValue;delete s.staticAttrs._lyteprop}break;case"attr":for(var O=[],w=[],k=L,M=s.attr=s.attr||{},F=0;F<k.attributes.length;F++)if(-1!==k.attributes[F].nodeValue.indexOf("{{")){var K=k.attributes[F].nodeValue,H=Lyte.Compile.getMustache(K),q=void 0;if(H?q=Lyte.Compile.getHelper(H):/{{.*}}/.test(K)&&!/\\{{.*}}/.test(K)&&(q=Lyte.Compile.splitMixedText(K)),q&&("action"===q.name||"method"===q.name)&&/^(onfocus|onfocusin|onfocusout|onresize|onscroll|onclick|ondblclick|onmousedown|onmouseup|onmousemove|onmouseover|onmouseout|onchange|onselect|onsubmit|onkeydown|onkeypress|onkeyup|oncontextmenu|__focus|__focusin|__focusout|__resize|__scroll|__click|__dblclick|__mousedown|__mouseup|__mousemove|__mouseover|__mouseout|__change|__select|__submit|__keydown|__keypress|__keyup|__contextmenu)$/.test(k.attributes[F].name)){M[k.attributes[F].name.substr(2)]={name:k.attributes[F].name.substr(2),camelCase:C.String.toCamelCase(k.attributes[F].name.substr(2)),helperInfo:q,newHelperInfo:Lyte.Compile.getHelper(H,!0),globalEvent:!0};var U=t.deepCopyObject(q.args),z=U.splice(0,1)[0],V=B(z=z.startsWith("'")?z.replace(/'/g,""):z,U);k.setAttribute(k.attributes[F].name.substr(2),o+" => "+V),A&&A.setAttribute(k.attributes[F].name.substr(2),o+" => "+V),O.push(k.attributes[F].name)}else if(q||H){var G={};k.attributes[F].name.startsWith("lbind:")?(O.push(k.attributes[F].name),w.push({name:k.attributes[F].name.substring(6),value:k.attributes[F].nodeValue}),G.isLbind=!0,G.name=k.attributes[F].name.substring(6),G.camelCase=C.String.toCamelCase(G.name)):(G.name=k.attributes[F].name,G.camelCase=C.String.toCamelCase(G.name)),q?"lbind"===q.name?(G.dynamicValue=q.args[0],G.newDynamicValue=C.getDV(q.args[0]),G.isLbind=!0):(G.helperInfo=q,G.newHelperInfo=Lyte.Compile.getHelper(H,!0)):(G.dynamicValue=H,G.newDynamicValue=C.getDV(H)),M[G.name]=G}}if(O.length)for(var W=0;W<O.length;W++)k.removeAttribute(O[W]),A&&A.removeAttribute(O[W]);if(A){for(v in M)A.removeAttribute(v);A.setAttribute("_lyteAttr","__**--Lyte"+a+"__**","")}if(w.length)for(var J=0;J<w.length;J++)k.setAttribute(w[J].name,w[J].value);break;case"for":case"forIn":case"registerYield":j(L,s,A,n);case"component":d=t._ie?L:L.content,A||"registerYield"!=g&&!L.hasAttribute("unbound")||(t._ms?((A=document.createElement("div")).innerHTML=s.actualTemplate?s.actualTemplate:L.outerHTML,A=A.childNodes[0],n.splitTextNodes(A)):A=L.cloneNode(!0));var Y=void 0;if(c=A?t._ie?A:A.content:void 0,s.actualTemplate&&(d=C.getContentForIE(s.actualTemplate,n,void 0,t._ms?s:void 0),A&&(c=C.getContentForIE(s.actualTemplate,n))),D(d,s.dynamicNodes,o,n,c),c){var Q=s.actualTemplate?c:A;s._sta=C.processStatic(Q)}t._ms&&(s.actualTemplate?(s.templateContent=d.outerHTML,s._content&&(s.actualTemplate=s._content.innerHTML,delete s._content)):s.templateContent=L.outerHTML,L.innerHTML=""),s.actualTemplate&&(Y=g,t._ie||x(Y=s.svg?P(d,g):N(d,g),n),(r[a-1]&&r[a-1].position.toString()===r[a].position.toString()?r[a-1]:r[a])._depthTemp=Y),A&&(s._args={},"registerYield"===g?C.replaceWithPf(A,document.createTextNode("__**--Lyte"+a+"__**")):"component"===g?C.replaceWithPf(A,document.createTextNode((A.hasAttribute("_lyteattr")?A.getAttribute("_lyteattr"):"")+"__**--Lyte"+a+"__**")):C.replaceWithPf(A,document.createTextNode("__**--Lyte"+a+"__**")),Array.from(A.attributes).forEach((function(e){s._args[e.nodeName]=e.nodeValue}))),s._ht&&(s._ht=L.cloneNode(!0),n._helperTemplate.content.append(s._ht),L.innerHTML="");break;case"if":case"switch":j(L,s,A,n);var X=void 0;if(c=A?t._ie?A:A.content:void 0,s.actualTemplate&&(L=C.getContentForIE(s.actualTemplate,n,void 0),A)){var Z=C.getContentForIE(s.actualTemplate,n);c=t._ie?Z:Z.content}if(p="default",t._ms){for(u={},h=t._ed?L.content.childNodes:L.childNodes,y=0;y<h.length;y++)"TEMPLATE"===h[y].tagName&&(h[y].getAttribute("case")?u[h[y].getAttribute("case")]=h[y]:h[y].hasAttribute("default")&&(f=h[y]));for(v in s.cases){var ee=void 0;_=C.getContentForIE(u[v],void 0,!0),c&&(ee=C.getContentForIE(c.querySelector("[case='"+S.cssEscape(v)+"']"))),j(_,s.cases[v],ee,n),D(_,s.cases[v].dynamicNodes,o,n,ee?C.getContentForIE(ee):void 0),u[v].remove(),c&&(s.cases[v]._sta=C.processStatic(ee)),s.cases[v].templateContent=u[v].outerHTML}if(s[p].dynamicNodes){var te=void 0;_=C.getContentForIE(f,void 0,!0),c&&(te=c.querySelector("[default]")),j(_,s[p],te,n),D(_,s[p].dynamicNodes,o,n,te?C.getContentForIE(te):void 0),f.remove(),s[p].templateContent=f.outerHTML,c&&(s[p]._sta=C.processStatic(te))}}else{for(var re in m=L.content||L,s.cases){var oe=void 0;c&&(oe=C.getContentForIE(c.querySelector("[case='"+S.cssEscape(re)+"']"))),j(_=C.getContentForIE(m.querySelector("[case='"+C.cssEscape(re)+"']"),void 0,!0),s.cases[re],oe,n),D("TEMPLATE"===_.tagName?_.content:_,s.cases[re].dynamicNodes,o,n,oe),c&&(s.cases[re]._sta=C.processStatic(oe)),s.cases[re]._ht&&(s.cases[re]._ht=_.cloneNode(!0),n._helperTemplate.content.append(s.cases[re]._ht),_.innerHTML="")}if(s[p].dynamicNodes){var ne=void 0;c&&(ne=C.getContentForIE(c.querySelector("[default]"))),j(_=C.getContentForIE(m.querySelector("[default]"),void 0,!0),s[p],ne,n),D("TEMPLATE"===_.tagName?_.content:_,s[p].dynamicNodes,o,n,ne),c&&(s[p]._sta=C.processStatic(ne)),s[p]._ht&&(s[p]._ht=_.cloneNode(!0),n._helperTemplate.content.append(s[p]._ht),_.innerHTML="")}}s.actualTemplate&&(X=g,t._ie||x(X=s.svg?P(L.content,g):N(L,g),n),r[a-1]&&r[a-1].position.toString()===r[a].position.toString()?r[a-1]._depthTemp=X:r[a]._depthTemp=X),A&&C.replaceWithPf(A,document.createTextNode("__**--Lyte"+a+"__**")),s._ht&&(s._ht=L.cloneNode(!0),n._helperTemplate.content.append(s._ht),L.innerHTML="")}},s=0;s<r.length;s++){var l,d,c,p,u,f,h,y,v,m,_;a(s)}}function I(e,r){for(var o=e,n=0;n<r.length;n++)o="TEMPLATE"!=o.tagName||t._ie?o.childNodes[r[n]]:o.content.childNodes[r[n]];return o}function B(e,t){for(var r=0;r<t.length;r++)t[r]&&"object"===_typeof(t[r])&&(t[r]=B(t[r].value.name,t[r].value.args));return e?e+"("+t.toString()+")":t.toString()}customElements.define("lyte-safari-test-component",v),document.createElement("div").innerHTML="<lyte-safari-test-component t></lyte-safari-test-component>",_.render=C.render,_.insertBefore=C.insertBefore,_.insertAfter=C.insertAfter,_.replaceWith=C.replaceWith,_.appendChild=C.appendChild,C.tDiv=p("template"),C.tDiv.setAttribute("id","dummy-templates-div"),C.hDiv=p("template"),C.hDiv.setAttribute("id","keep-alive-div"),C.h1Div=p("template"),C.h1Div.setAttribute("id","lyte-helper-div"),Lyte.Compile.componentsDiv=C.lyteComponentsDiv=p("div"),C.lyteComponentsDiv.setAttribute("id","lyte-components-div"),Set.prototype.toArrayLyte=function(){return"Set"===this.constructor.name?Array.from(this):Array.from(this._values)},"complete"===document.readyState||"interactive"===document.readyState?L():document.addEventListener("DOMContentLoaded",(function(e){L()}),!0),C.registerHelper("unbound",(function(e){return e})),C.registerHelper("action",(function(e,t,r,o){r?(e._actions=e._actions?e._actions:{},e._actions[t]||(this.createCustomEvent(t,e,o),e.removeAttribute(t))):this.createEventListeners(e,t,o)})),C.registerHelper("lbind",(function(e){return this.getData(e)})),C.registerHelper("method",(function(e,r,o){r=arguments[1],o=arguments[2];var n=arguments[0].component,i=r?r.ownerElement:null,a=arguments[1].nodeName;r=null;var s=Array.prototype.slice.call(arguments,2),l=function(){var e=this.$node,r=[];C.adCx(e,r);var i=this.$node.processArgs(this.$node._callee,{helperInfo:{args:s}},[],void 0,this.$node),a=i.splice(0,1)[0];C.rmCx(e,r);var l=Array.from(arguments),d=i.concat(l);if(n.methods[a])return n.methods[a].apply(n,d);t.error("LC009",o,n.$node.tagName)};if(!i)return l;i.set?i.component.methods[C.String.toCamelCase(a)]=l:i.setMethods(C.String.toCamelCase(a),l)})),C.registerHelper("unescape",(function(e,t,r){if(C.ffr)return e;if(Lyte.Security.ignoreSanitizer){var o=document.createElement("div");return o.innerHTML=e,o}if(t&&Object.keys(t)&&Object.keys(t).length>0&&(Object(t.GLOBAL_TAGS).length>0&&-1!=(a=t.GLOBAL_TAGS.indexOf("link-to"))&&t.GLOBAL_TAGS.splice(a,1),t&&t.GLOBAL_ATTRIBUTES&&Object.keys(t.GLOBAL_ATTRIBUTES).length>0))for(var n=["yield-name","lt-prop-route","lt-prop-dp","lt-prop-fragment","lt-prop-qp","lt-prop","lt-prop-class","lt-prop-id","lt-prop-rel","lt-prop-title","lt-prop-style","lt-prop-target","lt-prop-td","lt-prop-custom","lt-prop-target","lt-prop-id","lt-prop-class","lt-prop-style","lt-prop-rel","lt-prop-title"],i=0;i<n.length;i++){var a;-1!=(a=t.GLOBAL_ATTRIBUTES.indexOf(n[i]))&&t.GLOBAL_ATTRIBUTES.splice(a,1)}if(t&&t.GLOBAL_TAGS){null==t.GLOBAL_ATTRIBUTES&&(t.GLOBAL_ATTRIBUTES=[]);for(var s=Array.from(t.GLOBAL_TAGS),l=[],d=0;d<s.length;d++)for(S._registeredComponents[s[d]]?l=S._registeredComponents[s[d]].observedAttributes:Lyte.registeredCustomComponent[s[d]]&&(l=Lyte.registeredCustomComponent[s[d]].observedAttributes?Lyte.registeredCustomComponent[s[d]].observedAttributes:[]),i=0;i<l.length;i++)-1==t.GLOBAL_ATTRIBUTES.indexOf(l[i])&&t.GLOBAL_ATTRIBUTES.push(l[i])}var c=document.createElement("div");if(r&&Object.keys(r).length)if(t&&Object.keys(t).length){Lyte.Security.addGlobalObject(r,t);var p=r.sanitize(e);Lyte.Security.removeGlobalObject(r,t)}else p=r.sanitize(e);else t&&Object.keys(t).length?(Lyte.Security.addGlobalObject(Lyte.Security._ourSanitizerInstance_,t),p=Lyte.Security._ourSanitizerInstance_.sanitize(e),Lyte.Security.removeGlobalObject(Lyte.Security._ourSanitizerInstance_,t)):p=Lyte.Security._ourSanitizerInstance_.sanitize(e);return c.innerHTML=p,c})),C.registerHelper("escape",(function(e,t){return"url"==t?ZSEC.Encoder.encodeForHTMLAttribute(e):"js"==t?ZSEC.Encoder.encodeForJavaScript(e):"css"==t?ZSEC.Encoder.encodeForCSS(e):e})),C.registerHelper("debugger",(function(){})),C.registerHelper("log",(function(){console.log.apply(e,Array.from(arguments))})),C.registerHelper("ifEquals",(function(e,t){return e===t})),C.registerHelper("if",(function(e,t,r){return e?t:r})),C.registerHelper("negate",(function(e){return!e})),C.registerHelper("ifNotEquals",(function(e,t){return e!==t})),C.registerHelper("concat",(function(){for(var e="",t=arguments.length,r=0;r<t;r++)null!=arguments[r]&&(e+=arguments[r]);return e})),a(HTMLElement.prototype,"setData",{enumerable:!1,value:function(e,t){if(this._initProperties=this._initProperties||{},"string"==typeof e)this._initProperties[e]=t;else if("object"===(void 0===e?"undefined":_typeof(e)))for(var r in e)this._initProperties[r]=e[r]}}),a(HTMLElement.prototype,"setMethods",{enumerable:!1,value:function(e,t){if(this._initMethods=this._initMethods||{},"string"==typeof e)this._initMethods[e]=t;else if("object"===(void 0===e?"undefined":_typeof(e)))for(var r in e)this._initMethods[r]=e[r]}}),C.registerHelper("encAttr",(function(e){return ZSEC.Encoder.encodeForHTMLAttribute(encodeURIComponent(e))})),C.registerHelper("expHandlers",(function(e,t,r,o){var n=arguments.length;if("++"==t){if("postfix"==r)return e++;if("prefix"==r)return++e}else if("--"==t){if("postfix"==r)return e--;if("prefix"==r)return--e}else{if("=="==t)return e==r;if("==="==t)return e===r;if("!="==t)return e!=r;if("!=="==t)return e!==r;if("&&"==t)return e&&r;if("||"==t)return e||r;if("+"==t)return n>2?e+r:e;if("-"==t)return n>2?e-r:-e;if("*"==t)return e*r;if("/"==t)return e/r;if("%"==t)return e%r;if("<"==t)return e<r;if(">"==t)return e>r;if("<="==t)return e<=r;if(">="==t)return e>=r;if("|"==t)return e|r;if("&"==t)return e&r;if("!"==t)return!e;if("="==t)return r;if("+="==t)return e+r;if("-="==t)return e-r;if("*="==t)return e*r;if("/="==t)return e/r;if("?:"==t)return e?r:o}})),_.register("lyte-event-listener",{_template:'<template tag-name="lyte-event-listener"></template>',_dynamicNodes:[],_observedAttributes:["eventName"],init:function(){var e=this,r=t.addEventListener(this.get("eventName"),(function(){var t=Array.prototype.slice.call(arguments);t.splice(0,0,"on-fire"),e.throwEvent.apply(e,t)}));this.regId=r},data:function(){return{eventName:t.attr("string")}},didDestroy:function(){t.removeEventListener(this.regId)}}),_.registerCustomPropHandler("ltProp"),_.shouldIgnoreDisconnect=function(){return C.ignoreDisconnect},_.addLyteEventListener=function(e,t,r,o){return e._lyteEvents=e._lyteEvents||{},e._lyteEvents[t]=e._lyteEvents[t]||[],t+"-"+e._lyteEvents[t].push({func:r,fromEventListener:!0,context:o})},_.removeLyteEventListener=function(e,r){if(r){var o=r.split("-"),n=(o[0],parseInt(o[1]));e._lyteEvents&&e._lyteEvents[o[0]]&&!isNaN(n)?e._lyteEvents[o[0]][o[1]-1]={}:t.error("Invalid listenerId / listener is not available")}else t.error("No listenerId provided")},_.throwEvent=C.throwEvent,C.hasLyteEvents=function(e,t){return!(!e._lyteEvents||!e._lyteEvents[t])},C.handleLyteEvents=function(t,r){for(var o,n=t._lyteEvents[r.type],i=0;i<n.length;i++)if(n[i].func&&(!1===n[i].func.call(n[i].context?n[i].context:e,r)||r.cancelBubble)){o=!0;break}return o&&r.stopPropagation(),o},Object.defineProperty(e,"LyteComponent",{get:function(){return t.warn("Usage of LyteComponent is deprecated. Use Lyte.Component instead"),S}}),_.chromeBugFix(),C.booleanAttrList=["async","autocomplete","autofocus","autoplay","border","challenge","checked1","compact","contenteditable","controls","default","defer","disabled","formNoValidate","frameborder","hidden","indeterminate","ismap","loop","multiple","muted","nohref","noresize","noshade","novalidate","nowrap","open","readonly","required","reversed","scoped","scrolling","seamless","selected","sortable","spellcheck","translate"],Lyte.$.requiredMixins.component=function(e,t){var r=[],o={},n={},i={};r.push(e),t.forEach((function(e){var t=e,a=S._registeredComponents[t];r.length&&S.dataFromMixin(r,o,n,i),a._actions=Object.assign(a._actions,o);var s=Object.assign(a._methods,n);delete i.methods,S.updateCustomCrmComponent(i,a),a._methods=s,S._registeredComponents[t]=a}))},Lyte.$.injectServices.component=function(e,t,r,o,n,i){if(n){var a={};a[n.compName]=n}var s=n?a:C._registeredComponents;s&&Object.keys(s).forEach((function(r){var n=s[r];o&&Lyte.__gS[e]?n.component.prototype[e]=o:Lyte.$.requiredServices(e,t,(function(e,t){n.component.prototype[t]=e}),void 0,void 0,!0,i)}))},Lyte.Security.addGlobalObject=function(e,t){for(var r in t)Array.isArray(t[r])&&t[r].forEach((function(t){-1==e["_"+r].indexOf(t)&&e["_"+r].push(t)}))},Lyte.Security.removeGlobalObject=function(e,t){for(var r in t)Array.isArray(t[r])&&t[r].forEach((function(t){var o=e["_"+r].indexOf(t);-1!=o&&e["_"+r].splice(o,1)}))},Lyte.Compile.getTrimmedContent=function(e,t,r){var o=e;if(r){t=[];for(var n=r.parentNode;t.unshift(this.getArrayIndex(n.childNodes,r)),n=n.parentNode,r=r.parentNode,n;);}for(var i=0;i<t.length;i++){for(var a=e.childNodes.length-1;a>t[i];a--)e.childNodes[a].remove();e=e.childNodes[t[i]]}return o},Lyte.Compile.getArrayIndex=function(e,t){for(var r=0;r<e.length;r++)if(e[r]===t)return r},Lyte.Compile.splitMixedText=function(e){for(var t=[],r=0,o={name:"concat",args:[]},n=0;n<e.length;n++){var i=n;if("\\"!==e[n-1]&&"{"===e[n]&&"{"===e[++n])t.push("{{"),o.args.push("'"+e.substr(r,i-r)+"'"),r=n+1;else if("}"===e[n]&&"}"===e[++n]&&t.length){t.pop(r);var a=e.substr(r,i-r),s=this.getHelper(a);s?(a=s,o.args.push({type:"helper",value:a})):o.args.push(a),r=n+1}}return r<e.length&&o.args.push("'"+e.substr(r,e.length-r)+"'"),o},Lyte.Compile.getHelper=function(e,t){var r=/\((?:[^)]*|(?:(?:"(?:[^"\\]|\\.)*?")|(?:'([^'\\]|\\.)*?')|[\w\s!@#$%^&*)([\]+=.,_-]*?)*?)\)$/.exec(e);if(r)return this.getHelperInfo(e,r,t)},Lyte.Compile.getHelperInfo=function(e,t,r){var o={};if(o.name=e.substr(0,t.index).replace(/\s/g,""),t=t?t[0].trim():t,"lyteViewPort"==o.name&&"()"==t)return o.args=[],o;var n=this.getHelperArgs(t.substr(1,t.length-2),r);return!1!==n&&(o.args=n,o)},Lyte.Compile.getHelperArgs=function(e,t){for(var r=[],o=[],n=0,i=0;i<e.length;i++)if(r.length||","!==e.charAt(i))"("===e.charAt(i)?"'"!=r[r.length-1]&&'"'!=r[r.length-1]&&(r.push(e.charAt(i)),e.charAt(i)):")"===e.charAt(i)?"("===r[r.length-1]&&r.pop():"'"===e.charAt(i)&&"\\"!==e.charAt(i-1)?"'"===r[r.length-1]?r.pop():'"'!==r[r.length-1]&&(r.push(e.charAt(i)),e.charAt(i)):'"'===e.charAt(i)&&"\\"!==e.charAt(i-1)&&('"'===r[r.length-1]?r.pop():"'"!==r[r.length-1]&&(r.push(e.charAt(i)),e.charAt(i)));else{var a=e.substr(n,i-n);(a=a.trim())&&a.startsWith('"')&&a.endsWith('"')&&(a="'"+(a=a.slice(1,-1))+"'"),a=this.getHelperArgValue(a,t),o.push(a),n=i+1}if(r.length)return!1;var s=e.substr(n,e.length-n);(s=s.trim())&&s.startsWith('"')&&s.endsWith('"')&&(s="'"+(s=s.slice(1,-1))+"'");try{s=this.getHelperArgValue(s,t)}catch(e){return!1}if(o.push(s),t){var l=[];o.forEach((function(e){"string"==typeof e&&"'"!==e[0]&&"event"!==e&&"this"!==e?l.push(C.getDV(e)):l.push(e)})),o=l}return o},Lyte.Compile.getHelperArgValue=function(e,t){switch(e){case"undefined":return;case"true":return!0;case"false":return!1;case"null":return null;case"":return;default:return e&&e.startsWith("'")&&e.endsWith("'")?e=(e=e.replace(/\\\'/g,"'")).replace(/\\\"/g,'"'):/\([\w\s,')(]*/.test(e)?{type:"helper",value:this.getHelper(e,t)}:isNaN(e)?e:parseInt(e)}},Lyte.Compile.getMustache=function(e){if(e=e&&"string"==typeof e?e.trim():e,/^{{(?=[\s]*[\w-_\(\$)]+)/.test(e)){var t=e.match(/{{[a-zA-Z0-9_.[\]()]*(?![\\])}}/g);if(t&&t.length>1)return;if(!this.syntaxCheck(e)||!/{{[^}]*?(?:(?:('|")[^\1]*?\1)[^}]*?)*}}$/.test(e))return;var r=e.match(/[\w!@#$%^&*)(+=.,_-]+[\s]*[(]{0,1}(?:"([^"]|\\")*?"|'([^']|\\')*?'|[\w\s!@#$%^&*)([\]+=.,_-]*?)*?[)]{0,1}[\s]*(?=}})/g);if(r&&r.length>1)return;return r?r[0].trim():r}},Lyte.Compile.syntaxCheck=function(e){for(var t,r=[],o=0;o<e.length;o++)"'"===e[o]?"'"===t&&"\\"!==e[o-1]?(r.pop(),t=void 0):r.length||(t=e[o],r.push(t)):'"'===e[o]&&('"'===t&&"\\"!==e[o-1]?(r.pop(),t=void 0):r.length||(t=e[o],r.push(t)));return!r.length},S.replaceWithOrigTemplate=function(e){return e._origTemplate._fakeTemp=e,e._origTemplate},S.pendingViewPortElements=[],S.isInViewPort=function(t){var r=t.getBoundingClientRect();return r.top>=0&&r.top<=(e.innerHeight||document.documentElement.clientHeight)||r.bottom>=0&&r.bottom<=(e.innerHeight||document.documentElement.clientHeight)},Lyte.Component.registerHelper("lyteViewPort",(function(e,t){if(C.getActViewPortTemplate(e)._viewPortRendered)return!1;var r=C.pendingViewPortElements;if(!t)return S._pendingAnimationFrame||(requestAnimationFrame((function(){requestAnimationFrame((function(){for(var e=[],t=Array.from(r),o=t.length-1;o>=0;o--){var n=t[o];if(C.isViewPortTemplate(n)&&!n._callee._destroyed){var i=C.getActViewPortTemplate(n);C._isInViewPort(i,i._callee)&&(e.push(r.splice(o,1)[0]),n._inPve=!1,n._viewPortRendered=!0),i._inPve=n._inPve,i._viewPortRendered=n._viewPortRendered}}for(var a=0;a<e.length;a++)C._executeIfTemplates(e[a]);S._pendingAnimationFrame=!1,e.length&&requestAnimationFrame((function(){requestAnimationFrame((function(){C.executePendingViewPort()}))}))}))})),S._pendingAnimationFrame=!0),-1==r.indexOf(C.getFakeTemplate(e))&&(e._inPve=!0,r.push(e)),!0;if(r.length){var o=C.getFakeTemplate(e),n=r.indexOf(o);-1!=n&&(r[n]._inpve=e._inPve=!1,r[n]._viewPortRendered=e._viewPortRendered=!0,r.splice(n,1))}})),S._isInViewPort=function(e,t){var r=e._caseContent[0];if(r&&C.isInViewPort(r))return!0},S._executeIfTemplates=function(e){var t,r,o=C.getActViewPortTemplate(e);if(o._attributes.value=!1,o._cx||2===o.nodeType&&o.ownerElement._cx){r=o._cx||o.ownerElement._cx;var n=[];C.changeContext(r.node,n,r)}else"LYTE-YIELD"===o.tagName&&o._callee._cx&&(t=!0,r=o._callee._cx,n=[],C.changeContext(r.node,n,r,!0));o._callee.updateSwitchHelper("if",o,o._cx,!0,!0),r&&C.removeContext(r.node,n,r,t)},S.isViewPortTemplate=function(e){if(("TEMPLATE"==e.tagName||e._origTemplate)&&"if"==e.getAttribute("is"))return!0},S.getActViewPortTemplate=function(e){return e._origTemplate?e._origTemplate:e},S.getFakeTemplate=function(e){return e._fakeTemp?e._fakeTemp:e},S.executePendingViewPort=function(){var e=C.pendingViewPortElements;if(e.length){for(var t=Array.from(e),r=[],o=t.length-1;o>=0;o--){var n=t[o];if(C.isViewPortTemplate(n)){var i=C.getActViewPortTemplate(n);C._isInViewPort(i,i._callee)&&(r.push(e.splice(o,1)[0]),n._inPve=!1,n._viewPortRendered=!0),i._inPve=n._inPve,i._viewPortRendered=n._viewPortRendered}else(C.isInViewPort(n._dummyViewPortF)||C.isInViewPort(n._dummyViewPortL))&&(n._dummyViewPortF=n._dummyViewPortL=void 0,r.push(e.splice(o,1)[0]))}C.isViewPortPending=!1;for(var a=0;a<r.length;a++){var s=r[a];C.isViewPortTemplate(s)?C._executeIfTemplates(s):s.setData("lyteViewPort",!1)}r.length&&requestAnimationFrame((function(){requestAnimationFrame((function(){C.executePendingViewPort()}))}))}},e.addEventListener("resize",(function(){requestAnimationFrame((function(){requestAnimationFrame((function(){C.executePendingViewPort()}))}))})),document.addEventListener("scroll",(function(){var e=_.viewPortSettings.debounce;e?(C.viewPortScrollDebounce&&clearTimeout(C.viewPortScrollDebounce),C.viewPortScrollDebounce=setTimeout((function(){requestAnimationFrame((function(){requestAnimationFrame((function(){C.executePendingViewPort()}))})),C.viewPortScrollDebound=void 0}),e)):requestAnimationFrame((function(){requestAnimationFrame((function(){C.executePendingViewPort()}))}))}),!0),S.core={},S.core._constructor=E,S.core._registerComponent=E._registerComponent,S.core.registerComponent=C.registerComponent,S.core.executeBlockHelpers=E.prototype.executeBlockHelpers,S.core.updateForHelper=E.prototype.updateForHelper,S.core.updateForInHelper=E.prototype.updateForInHelper,S.core.updateSwitchHelper=E.prototype.updateSwitchHelper,_.viewPortSettings={debounce:0,executePendingViewPortElements:function(){S.executePendingViewPort()}}}(window),Lyte.registerErrorCodes({LD01:"Primary key value might be missing in the response data that is received, {0}",LD02:"{0} - {1} is not registered",LD03:"Cannot set the error {0} for {1}",LD04:"No such record to merge, {0}",LD05:"Model( {0} ) of related property - {1} not found in model - {2}",LD06:"Backward relation not present in model( {0} ), for the property {1} of model( {2} )",LD07:"{0} type not handled in handleArrayOperations",LD08:"{0} {1} will be deprecated from next version {2}",LD09:"deserializeKey cannot be processed for payload with more than two keys. Please use payloadKey callback instead or try modifying the same in normalizeResponse callback",LD10:"Response data not in a format lyte data store expects",LD11:"Deprecation Warning! findRecord response payload will not accept an array. It will be deprecated from the next version",LD12:"Response ( {0} ) is not in a format, lyte data store expects",LD13:"Response processing failed in {0} for model-{1} {2}, since invalid data is received in {1}(modelName) key of the data",LD14:"Cannot register {0} - {1}, as it already exists.",LD15:"Primary key value might be missing in the response data that is received, {0}",LD16:"Record merge failed for the record in model - {0} with primaryKey value - {1}, since either the persisted(saved) primary key value for a newly created record is not received from server or not in the proper structure to merge",LD17:"Record with the primary key value already exists",LD18:"No { 0 } present",LD19:"Deprecation Warning! findAll will not accept response payload values other than an array or any empty value. Current implementation which allows this will be deprecated from the next version",LD20:"Record cannot be saved as a state, when it is not either a new or a modified record or in a error state.",LD21:"No such state ( {0} ) saved for the record.",LD22:"For create / createRecord, response with a primary key value should be received",LD23:"PrimaryKey field {1} in {0} cannot have default value",LD24:"Response couldn't be parsed, {0}",LD25:"Cannot create record for the data - {0}",LD26:"Only one baseKey is allowed for a model",LD27:"Record merge failed, since the data passed is invalid - {0}",LD28:"Record merge failed for the model - {0}, since a valid primary key value is not found in the data to be merged - {1}",LD29:"Unloaded record-{0} of the model-{1} is being saved",LD30:"Variable value in query is mandatory for {0}",LD31:"Datatype defined for {0} is mismatch with the value's datatype",LD32:"Query '{0}' was not registered for the model '{1}"});var $Record=function(){Object.assign(this,{inIDB:!1,isPersisted:!0,isUnloaded:!1,isModified:!1,isNew:!1,isDeleted:!1,isError:!1,events:[],validatedOnCreate:!0,error:{}})},Record=function(e,t,r){var o=store.modelFor(e),n=r?r.delayPersistence:store.$.getFromCB("adapter",e,"delayPersistence");Object.assign(this,t),Object.defineProperties(this,{$:{writable:!0,value:new $Record}}),this.$.record=this;var i=store.$.saveParent;i&&this!==i&&store.$.defProp(this.$,"parent",i);var a=o._fldGrps.default,s=o._fldGrps.watch,l=o._fldGrps.hasMany,d=o._fldGrps.nested_prop;for(var c in a){var p=a[c],u=t[c];void 0!==u&&""!==u||(this[c]=store.$.getDefaultVal(this,p.default))}var f=store.$.getpKVal(this,o);for(var h in Object.defineProperties(this.$,{pK:{value:f,writable:!0},model:{value:o},_attributes:{value:{},writable:!0},_relationships:{value:{},writable:!0},isDirty:{value:function(){var e,t=this.record;return!!t.$.isModified||!!(e=store.$.isDirty(t,this.model.relations)).length&&e}},undoStack:{value:store.$.genUnRedoStack(),writable:!0},redoStack:{value:store.$.genUnRedoStack(),writable:!0},delayPersistence:{value:n}}),s)Lyte.establishObjectBinding(this,h,!0,void 0,void 0,!0);for(var y in d)Lyte.establishObjectBinding(this,y,!0,void 0,void 0,y&&y.watch?y.watch:void 0);for(var v in l){var m=l[v];this.hasOwnProperty(v)?this[v]=Array.isArray(this[v])?Array.from(this[v]):this[v]:store.modelFor(m.relatedTo)&&store.$.getFromCB("serializer",m.relatedTo,"initHasManyRelation")&&(this[v]=[])}var _=o._properties;Object.keys(_).length&&(this._bindings||store.$.defProp(this,"_bindings",new Set,!1,!0),this._bindings.add(_),store.$.establishObserverBindings(this,_))};Object.defineProperties($Record.prototype,{get:{value:function(e){return this.record[e]}},set:{value:function(e,t,r){return this.isDeleted?store.$.setRecErr(this,this.model._pK,"ERR17"):store.$.setData(this,e,t,r),this.record}},getDirtyAttributes:{value:function(){var e=[],t=this._attributes;if(Object.keys(t).length)for(var r in t)e.push(r);return e}},rollBackAttributes:{value:function(e,t){Array.isArray(e)||(e=[e]);for(var r=this.record,o=[],n=this.model,i=this._attributes,a=0;a<e.length;a++){var s=e[a];if(i.hasOwnProperty(s)){var l=n.fieldList[s],d=i[s];"relation"==l.type?(store.$.rllBckRecArr(d,r,n,l),(r.$.dN&&r.$.dN.hasOwnProperty(s)?r.$.dN[s]:new Map).forEach((function(e,t){store.$.deleteDeepNest(r,s,t)}))):store.$.cmpSet(r,s,d,void 0,!0),o.push(s),delete i[s],store.$.clrRecErr(this,s)}}if(Object.keys(this._attributes).length||(this.hasOwnProperty("dN")&&(!this.dN||Object.keys(this.dN).length)||r.$.isNew||store.$.removeParentNesting(r,"modified"),store.$.cmpSet(this,"isModified",!1),store.$.changePersist(r,!0),this.isNew||store.$.deleteFromArray(n.dirty,this.get(n._pK))),o.length>0){var c=[r,o];this.emit("change",c),n.emit("change",c),this.undoStack=store.$.genUnRedoStack(),this.redoStack=store.$.genUnRedoStack()}}},rollBack:{value:function(e,t){var r=this.model,o=(r._pK,new Map);t=!1!==t&&r._fldGrps.inherit&&Object.keys(r._fldGrps.inherit).length,e?(this.rollBackState(e,t),store.$.removeOnSave(this.model._name,this.record.$.pK)):(t&&store.$.rBinherit(this,o,""),store.$.rollBackRecord(this))}},deleteRecord:{value:function(e){var t=this.model,r=this.record;e=void 0!==e?e:r.$.delayPersistence?r.$.delayPersistence.delete:void 0,store.$.removeFromStore(t,r.$.pK,void 0,void 0,e)}},destroyRecord:{value:function(e,t,r,o){return this.deleteRecord(r),this.save(e,t,"destroyRecord",void 0,o)}},addEventListener:{value:function(e,t){return store.$.eventListeners.add(this,e,t)}},removeEventListener:{value:function(e){store.$.eventListeners.remove(this,e)}},emit:{value:function(e,t){store.$.eventListeners.emit(this,e,t)}},triggerAction:{value:function(e,t,r,o,n){var i=this.model,a=i.actions;return(a?a[e]:void 0)?store.adapter.$.handleAction(e,i,this.record,t,r,o,n):Promise.reject({code:"ERR18",message:Lyte.errorCodes.ERR18,data:e})}},save:{value:function(e,t,r,o,n){var i,a=this.model,s=this.record,l=this.isDirty(),d=r&&r.validateOnSave,c=r&&r.skipValidation,p=a.fieldList;if(!0!==this.isUnloaded)if(this.isDeleted){if(!this.isNew)return store.adapter.$.del(a._name,s,!0,o,e,t,n)}else{if(this.isNew)return c||s.$.validatedOnCreate&&!d||(i=store.$.validateRecord(this.record,p)),!c&&(0==i||this&&this.error&&Object.keys(this.error).length>0)?Promise.reject(this.error):store.adapter.$.create(a._name,s,!0,e,t,n);if(this.isModified||l&&l.length){if(!c&&r&&d&&(i=store.$.validateRecord(this.record,p)),!c&&(0==i||s&&s.$&&s.$.isError))return Promise.reject(s.$.error);var u=store.$.updateJSON(this.record,a,l);return store.adapter.$.put(a._name,u,s,!0,e,t,n)}}else if(Lyte.warn("LD29","object"==_typeof(s.$.pK)?JSON.stringify(s.$.pK):s.$.pK,a._name),store.$.getFromCB("adapter",a._name,"rejectUnloadRecordSave"))return Promise.reject({code:"ERR28",message:Lyte.errorCodes.ERR28,data:s});return Promise.resolve()}},getInitialValues:{value:function(e){var t=!1;e?(Array.isArray(e)||(e=[e]),t=!0):e=this.getDirtyAttributes();for(var r={},o=this.record,n=this._attributes,i=0;i<e.length;i++)if(null!=o[e]&&o[e[i]].add){r[e[i]]=o[e[i]].slice(0);for(var a=n[e[i]],s=o[e[i]].model._pK,l=a.length-1;l>=0;l--)if("added"==a[l]._type)for(var d=0;d<a[l].records.length;d++){var c=store.$.getIndex(r[e[i]],s,a[l].records[d].$.pK);-1!=c&&r[e[i]].splice(c,1)}else if("removed"==a[l]._type)for(d=a[l].records.length-1;d>=0;d--)r[e[i]].splice(a[l]._indices[d],0,a[l].records[d]);else"changed"==a[l]._type&&(r[e[i]]=Array.isArray(a[l].records)?Array.from(a[l].records):a[l].records)}else r[e[i]]=n[e[i]];return t?r[e[0]]:r}},toJSON:{value:function(e){var t=!0;return"object"==(void 0===e?"undefined":_typeof(e))&&0==e.inherit&&(t=e.inherit),Object.assign({},store.$.toJSON(this.model._name,this.record,e||!0,void 0,void 0,t))}},undo:{value:function(e,t){var r=this.undoStack._order_.length;for(t=t||(r?r-1:r);r-- >t;)store.$.unredoOp(1,this,e)}},getCurrentState:{value:function(){return this.undoStack._order_.length}},redo:{value:function(e){store.$.unredoOp(2,this,e)}},validate:{value:function(e){var t={},r=this.model.fieldList;Array.isArray(e)&&e.forEach((function(e,o){r[e]&&(t[e]=r[e])})),0==Object.keys(t).length&&(t=r);var o=this.record;store.$.validateRecord(o,t)}},saveState:{value:function(e){if(this.isNew||this.isModified){for(var t,r=this._savedState=this._savedState||{},o=e;!o;)t=Math.floor(1e5*Math.random()+1),o=r.hasOwnProperty(t)?o:t;var n=this.toJSON("state");store.$.defProp(n,"$",{},!1,!0),this.model._arrPk.forEach((function(e){delete n[e]}));var i=this.undoStack,a=this.redoStack,s=this._attributes;if(i&&Object.keys(i).length){var l=i._order_;i=n.$.undoStack=store.$.deepCopyStack(i),store.$.defProp(i,"_order_",Lyte.deepCopyObject(l),!1,!0)}return a&&Object.keys(a).length&&(l=a._order_,a=n.$.redoStack=store.$.deepCopyStack(a),store.$.defProp(a,"_order_",Lyte.deepCopyObject(l),!1,!0)),s&&Object.keys(s).length&&(n.$._attributes=store.$.deepCopyAttrs(this.model,s)),this._savedState[o]=n,o}Lyte.warn("LD20")}},clearState:{value:function(e){e?delete this._savedState[e]:this._savedState={}}},rollBackState:{value:function(e,t){var r=this._savedState,o=r?r[e]:void 0;o?(this.dN&&(this.dN={}),store.$.setData(this,o,void 0,void 0,{},!0,t),store.$.updateDn(this.record),this.undoStack=o.$.undoStack||store.$.genUnRedoStack(),this.redoStack=o.$.redoStack||store.$.genUnRedoStack(),this._attributes=o.$._attributes||{},store.$.checkAttrs(this.record),delete this._savedState[e]):Lyte.warn("LD21",e)}},hasSavedState:{value:function(e){return!(!this._savedState||!this._savedState.hasOwnProperty(e))}},persist:{value:function(e){var t,r,o=this.model._name,n=this.record,i={obj:new Map};if(this.isNew)t="create",store.$.toJSON(o,n,void 0,t,i);else if(r=this.isDirty()){var a=store.$.updateJSON(n,this.model,r);store.$.toJSON(o,a,void 0,void 0,i)}var s=i.obj.get(this.pK);store.adapter.$.mergeResponse(n,this.model,void 0,this.pK,s,!0),store.adapter.$.updateIDB(o,t||(n.$.isDeleted?"deleteRecord":n.$.isModified||r?"updateRecord":void 0),n)}}});var Model=function(e,t){Object.assign(this,{_name:e,fieldList:{id:{type:"string",primaryKey:!0,defined:!1}},relations:{},_properties:{},_fldGrps:{default:{},hasMany:{},watch:{},inherit:{},nested_prop:{},inverse:{}},data:[],dirty:[],_deleted:new Map,events:{}}),store.$.defProp(this.data,"_recMap",new Map);var r=[];for(var o in t)store.$.registerField(this,o,t[o],r);this._pK||(this._pK="id"),this.isComp=!1;var n=this._pK.split(",");n.length>1&&(this.isComp=!0),this._arrPk=n,"undefined"!=typeof Lyte&&Lyte.establishObserverBindings(r,!0,this._properties,this),store.$.defArrUtls(this.data),store.$.defUtls(this.data,this),store.$.defProp(this,"extends",store.$.extendModel)};Model.prototype.addEventListener=function(e,t){return store.$.eventListeners.add(this,e,t)},Model.prototype.removeEventListener=function(e){store.$.eventListeners.remove(this,e)},Model.prototype.emit=function(e,t){store.$.eventListeners.emit(this,e,t)},Model.prototype.on=function(e,t){return this.addEventListener(e,t)},Model.prototype.setGql=function(e,t,r){store.$.setQuery(this,t,e,r)};var store={model:{},$:{idbOpen:!0,request:{},toRelate:{},idbQueue:[],idbQ:{},idbQ2:{},nestScp:{},nestScpId:1,changePersist:function(e,t){if(!e.$.isUnloaded||e.$.isPeristed!==t)switch(t){case!0:e.$.isNew||e.$.isModified||e.$.isDeleted||store.$.cmpSet(e.$,"isPersisted",!0);break;case!1:(e.$.isNew||e.$.isModified||e.$.isDeleted||e.$.dN&&Object.keys(e.$.dN)&&Object.keys(e.$.dN).length)&&store.$.cmpSet(e.$,"isPersisted",!1)}},getFromCB:function(e,t,r){for(var o=store[e],n=o?o[t]:void 0,i=n?n[r]:void 0;void 0===i;)if(n&&n.$super)i=(n=n.$super)?n[r]:void 0;else{if(n||(n=o.application),!n||!n.hasOwnProperty(r)){if("adapter"==e){switch(r){case"host":i=window.location.origin?window.location.origin:window.location.protocol+"//"+window.location.host;break;case"namespace":i="";break;case"actionNamespace":i="action";break;case"batchNamespace":i="batch";break;default:i=void 0}break}break}if(i=n[r],!n&&!i)break}return i},newCB:function(e,t,r,o,n){for(var i in t.__extendedBy=[],o)t[i]=o[i];store.$.extendOptions(n,e,r,t,store),store.$.lazyExtend(e,t,r),store.$.defProp(t,"is",e),store.$.defProp(t,"__name",r)},extendOptions:function(e,t,r,o,n){e&&e.mixins&&e.mixins.length&&e.mixins.forEach((function(e){if(Lyte.Mixin.exists(e)){var i=Lyte.registeredMixins[e];for(var a in i)o[a]=i[a]}else Lyte.$.requiredMixins(e,{name:r,scope:n},t)}));var i=e?e.services:[];if(store.$.extendService(i,t,r,o,n),Lyte.toBeInjectedServices){var a=Lyte.toBeInjectedServices,s=[];for(var l in a)s.push({as:l,service:a[l]});store.$.extendService(s,t,r,o,n,!0)}},extendService:function(e,t,r,o,n,i,a){Lyte.extendService({services:e,type:t,name:r,ins:o,isGlobal:i,data:a,callback:function(e,r,o){Lyte.$.lazyRegisterService(i?e:new e,{scope:n,type:t,name:o,key:r})}})},lazyExtend:function(e,t,r){var o=store[e];if(o.__toAddSuper&&o.__toAddSuper.hasOwnProperty(r)){for(var n=o.__toAddSuper[r],i=0;i<n.length;i++){var a,s=o[n[i]];s&&s.is==e&&(s.$super=t,t.__extendedBy.push(n[i]),"application"!=r&&(o.__toAddSuper.application&&(a=o.__toAddSuper.application.indexOf(s.__name))>-1&&o.__toAddSuper.application.splice(a,1),o.application&&(a=o.application.__extendedBy.indexOf(s.__name))>-1&&o.application.__extendedBy.splice(a,1)))}delete o.__toAddSuper[r]}},cbDef:function(e,t){Object.defineProperties(e.prototype,{super:{value:function(){return store.$.super.call(this,arguments)}},extends:{value:function(e){store.$.extendCallback.call(this,store,t,e)}}})},changeRelPkMaps:function(e,t,r,o,n){var i=e.$.model,a=i.relations;for(var s in a)for(var l=a[s],d=l.length,c=0;c<d;c++){var p=l[c],u=p.relKey,f=p.relType;if(e.hasOwnProperty(u)){var h,y=e[u],v=store.model[p.relatedTo];if(v&&(h=store.$.getBackwardRel(i,p,v))&&"hasMany"==h.relType)if(R=h.opts&&h.opts.sort&&h.opts.sort.sortFn&&h.opts.sort.observes,"belongsTo"==f&&Lyte.isRecord(y))switch(o){case"sort":case"srtObsChk":if(y&&Array.isArray(y[h.relKey]))if("sort"==o)R&&-1!=h.opts.sort.observes.indexOf(n)&&store.$.handleArrOp(y[h.relKey],"sort");else if(n!==h.relKey)return!0;break;default:y[h.relKey]&&y[h.relKey]._recMap&&y[h.relKey]._recMap.delete(t)&&y[h.relKey]._recMap.set(r,e)}else if("hasMany"==f&&Array.isArray(y))for(var m=y.length,_=0;_<m;_++){var g=y[_];switch(o){case"sort":case"srtObsChk":if(g&&Array.isArray(g[h.relKey]))if("sort"==o)R&&-1!=h.opts.sort.observes.indexOf(n)&&store.$.handleArrOp(g[h.relKey],"sort");else if(n!==h.relKey)return!0;break;default:Lyte.isRecord(g)&&g[h.relKey]&&g[h.relKey]._recMap&&g[h.relKey]._recMap.delete(t)&&g[h.relKey]._recMap.set(r,e)}}}}var b=e.$._relationships;for(var L in b){var A=b[L],$=store.modelFor(L);for(var u in A)for(var E=A[u],T=$.fieldList[u],R=T.opts&&T.opts.sort&&T.opts.sort.sortFn&&T.opts.sort.observes,O=E.length,w=0;w<O;w++){var S=(g=E[w])[u];if(Array.isArray(S))switch(o){case"sort":case"srtObsChk":if(Array.isArray(S))if("sort"==o)R&&-1!=T.opts.sort.observes.indexOf(n)&&store.$.handleArrOp(S,"sort");else if(n!==T.relKey)return!0;break;default:S._recMap&&S._recMap.delete(t)&&S._recMap.set(r,e)}}}},updateNestScp:function(e,t){if(Lyte.isRecord(e)){var r=e.$.__scpObj||{};for(var o in r)if(i=(i=r[o]).split("_")[0],Lyte.nestScp&&Lyte.nestScp.hasOwnProperty(i)&&Lyte.nestScp[i].model){var n=Lyte.nestScp[i].model.get(e.$.model._name);if(n.has(t)){var i=n.get(t);n.delete(t),n.set(e.$.pK,i)}}}},getDefaultVal:function(e,t){return"function"!=typeof t?t:t.call(e)},deepValueChange:function(e,t,r,o){var n={emit:!1,attr:[],oldRec:{}};store.$.estAttrs(e,t,r,n,o),store.$.checkAttrs(e),store.$.changeCallbck(e,n)},updateDn:function(e){var t=e.$.model.relations;for(var r in t)t[r].forEach((function(t){var r=t.opts,o=t.relKey,n=t.relType;if(r&&r.deepNest&&e.hasOwnProperty(o)){var i=e[o];"belongsTo"==n&&(i.$.isModified||i.$.dN&&Object.keys(i.$.dN).length)?store.$.setDeepNest(e,o,i.$.pK,"updated"):"hasMany"==n&&Array.isArray(i)&&i.forEach((function(t){(t.$.isModified||t.$.dN&&Object.keys(t.$.dN).length)&&store.$.setDeepNest(e,o,t.$.pK,"updated")}))}}))},genUnRedoStack:function(){var e={};return store.$.defProp(e,"_order_",[],!1),e},deepCopyStack:function(e){if(e&&"object"==(void 0===e?"undefined":_typeof(e)))for(var t in e=Object.assign({},e))if(Array.isArray(e[t])){var r=e[t]=Array.from(e[t]);r.forEach((function(e,t){r[t]=Object.assign(e)}))}return e},deepCopyAttrs:function(e,t){var r=e.fieldList;for(var o in t=Object.assign({},t)){var n=t[o];r[o]&&"relation"==r[o].type&&Array.isArray(n)&&(n=t[o]=Array.from(n)).forEach((function(e,t){n[t]=Object.assign({},e),e.hasOwnProperty("records")&&e.records&&(e.records=Array.from(e.records)),e.hasOwnProperty("_indices")&&e._indices&&(e._indices=Array.from(e._indices))}))}return t},addTo_Del:function(e,t,r){var o={index:r,data:t};(e._deleted=e._deleted||new Map).set(t.$.pK,o)},scExtd:function(e,t,r,o){var n="adapter"==e?store.adapter:store.serializer;if(t)return n.hasOwnProperty(t)?(Lyte.warn("LD14",e,t),{error:Lyte.getErrorMessage("LD14",e,t),extends:function(){}}):(n[t]="adapter"==e?new Adapter(r,o,t):new Serializer(r,o,t),n.application&&"application"!=t&&(n[t].$super=n.application,n.application.__extendedBy.push(t)),n.application||"application"==t||(n.__toAddSuper=n.__toAddSuper||{},n.__toAddSuper.hasOwnProperty("application")||(n.__toAddSuper.application=[]),n.__toAddSuper.application.push(t)),n[t])},initCB:function(e,t,r,o){var n=store.$.cbScp(t,r,e),i=o.args,a={};if(n)return a.data=store.$.cB(n,i),a},cB:function(e,t){return e.func.apply(e.scope,t.concat(e.name))},cbScp:function(e,t,r){for(var o=store[r],n=o[e],i=o.application;;){if(n&&n[t]&&"function"==typeof n[t])return{scope:n,func:n[t],name:t};if(!n||!n.$super)return i&&i[t]&&"function"==typeof i[t]?{scope:i,func:i[t],name:t}:void 0;n=n.$super}},comparePk:function(e,t){var r=e.$.pK,o=void 0===r?"undefined":_typeof(r);if("string"==o||"number"==o)return r===t;if("object"==(void 0===r?"undefined":_typeof(r))){var n=Object.keys(r).length,i=0;for(var a in r)r[a]===t[a]&&i++;return n===i}},getpKVal:function(e,t){var r=(t=t||e.$.model)._arrPk;if(1==r.length)return e[r[0]];var o={};return r.forEach((function(t){o[t]=e[t]})),o},unredoOp:function(e,t,r){var o,n;1==e?(o=t.undoStack,n=t.redoStack):(o=t.redoStack,n=t.undoStack);var i=[],a={};if(r?(i=Array.isArray(r)?r:[r]).forEach((function(e){if(o[e].length)for(var t=o._order_.length-1;t>=0;t--){var r=o._order_[t],n=r.indexOf(e);if(n>-1){r.splice(n,1),r.length||o._order_.splice(t,1);break}}})):i=o._order_&&o._order_.length?o._order_.pop():i,i.length){for(var s=0;s<i.length;s++){var l,d=i[s];"update"==(l=o[d].pop())._type?l.hasOwnProperty("val")?store.$.setData(t,d,l.val,void 0,a):l.hasOwnProperty("records")&&store.$.setData(t,d,l.records,void 0,a):1==e&&"propAdd"==l._type?"undefined"!=typeof Lyte?(a[d]={_type:"propDelete",val:t.record[d]},l.hasOwnProperty("val")&&store.$.setData(t,d,l.val,void 0,{}),Lyte.objectUtils?Lyte.objectUtils(t.record,"delete",d):delete t.record[d]):delete t.record[d]:2==e&&"propDelete"==l._type?(a[d]={_type:"propAdd"},store.$.setData(t,d,l.val,void 0,a)):"added"==l._type?t.record.$.get(d).remove(l.records,void 0,a):"removed"==l._type&&(store.$.rllBckRecArr([l],t.record,t.model,t.model.fieldList[d]),l._type="added",a[d]=l)}var c=Object.keys(a);for(s=0;s<c.length;s++)n[d=c[s]]=n[d]||[],n[d].push(a[d]);c.length&&n._order_.push(c)}},unregisterModel:function(e,t){var r=store.modelFor(e);if(r){r.data.length&&store.unloadAll(e,void 0,t);var o=r.extendedBy;if(o&&Object.keys(o).length)for(var n in o)store.unregisterModel(n,t);var i=r.extend;i&&delete store.modelFor(i).extendedBy[e],delete store.model[e]}else Lyte.warn("LD02","Model ",e)},getDsrzEmpData:function(e,t){if(e.hasOwnProperty("deserializeEmptyData"))return e.deserializeEmptyData;var r=store.$.getFromCB("serializer",t,"deserializeEmptyData");return void 0!==r&&r},updateFieldValidation:function(e,t,r,o){var n=e.data,i=e.fieldList;n.forEach((function(n){var a=i[t];if(r){var s=store.$.getDsrzEmpData(a,e._name),l=!s&&n[t];n.hasOwnProperty(t)&&(l||s)&&Lyte.Transform.hasOwnProperty(a.type)&&Lyte.Transform[a.type].hasOwnProperty("deserialize")&&(n[t]=Lyte.Transform[a.type].deserialize(n[t],t,e._name,store.$.getpKVal(n,e)))}if(!o){var d=!!(n.$.error&&n.$.error.hasOwnProperty(t)&&n.$.error[t].hasOwnProperty("value")),c=d?n.$.error[t].value:void 0;store.$.clrRecErr(n.$,t),d?store.$.validateField(n,t,a,void 0,{old:!0,value:c}):store.$.validateField(n,t,a,void 0)}d&&n.$.error&&0===Object.keys(n.$.error)&&n.$.set(t,c)}))},validateRelatedRecord:function(e,t,r){var o=store.model[r.relatedTo].fieldList;if(r&&r.opts&&e&&e.hasOwnProperty(t)&&r.opts&&"record"==r.opts.serialize){if("belongsTo"==r.relType&&Lyte.isRecord(e[t]))return this.validateRecord(e[t],o);if("hasMany"==r.relType&&Array.isArray(e[t])){var n=!0,i=this;return e[t].forEach((function(e,t){Lyte.isRecord(e)&&!1===i.validateRecord(e,o)&&(n=!1)})),n}}},validateRecord:function(e,t){var r,o=!0;for(var n in t)r=this.validateField(e,n,t[n],void 0),!0===o&&!1===r&&(o=!1);return!(!1===o||!0===e.$.isError&&e.$.error&&Object.keys(e.$.error).length)},validateField:function(e,t,r,o,n){var i,a=n&&n.old?n.value:e[t],s=e.$;if("relation"==r.type){if(!1===this.validateRelatedRecord(e,t,r))return!1}else if(r.mandatory&&!e.$.error.hasOwnProperty(t)&&(void 0===a||""===a||Array.isArray(a)&&0===a.length))store.$.setRecErr(s,t,{code:"ERR02",message:Lyte.errorCodes.ERR02,value:a});else if(i=!0,n||e.hasOwnProperty(t)&&!e.$.error.hasOwnProperty(t)){var l=r;l.any&&Array.isArray(l)||(l=[l]);for(var d=l.length,c=!0,p=0;p<d;p++){var u=l[p];for(var f in u){var h=Lyte.checkProperty(f,a,t,u[f],u,e,void 0,Lyte.isRecord(e)?e.$.model._name:void 0);if(!0!==h){!0===c&&("object"==(void 0===h?"undefined":_typeof(h))&&(h.value=a),c=h);break}}}!0!==c&&(store.$.setRecErr(s,t,c),i=!1),n&&i&&store.$.cmpSet(e,t,a,void 0,!0),i&&store.$.clrRecErr(s,t)}},partialData:function(e,t,r,o,n){var i=e[t];if(!i||!Array.isArray(i))return!0;i.partial||store.$.defPar(i);var a=i.partial=i.partial||new Map;a.get(r)||a.set(r,{});var s=!1;switch(a.get(r).type){case"added":"removed"==o&&(a.delete(r),s=!0);break;case"removed":if("added"==o){if(e[t]._recMap)var l=e[t]._recMap.get(r);!l||Lyte.isRecord(l)&&!l.$.isDirty()?(a.delete(r),s=!0):a.get(r).type="modified"}break;case"modified":case"updated":if("added"==o)break;default:var d={type:o};n&&(d.polymorphicType=n),a.set(r,d)}return s&&!a.size?(a.size||store.$.deleteDeepNest(e,t,r),!0):void 0},removeParentNesting:function(e,t){var r=e.$.model,o=e.$.pK,n=r.relations;for(var i in n)n[i].forEach((function(n){var i,a,s,l,d=store.model[n.relatedTo];d&&((i=store.$.getBackwardRel(r,n,d))&&i.opts&&(a=i.opts.deepNest,s="partial"==i.opts.serialize,l=n.relKey?e[n.relKey]:store.$.getRelatedRecord(e,n.relatedTo,n.dummy)),a&&(Array.isArray(l)?l.forEach((function(e){Lyte.isRecord(e)&&store.$.deleteDeepNest(e,i.relKey,o)})):Lyte.isRecord(l)&&store.$.deleteDeepNest(l,i.relKey,o)),s&&(l&&!Array.isArray(l)&&(l=[l]),Array.isArray(l)&&l.forEach((function(e){var r=i.relKey?e[i.relKey]:void 0;if(r&&r.partial&&r.partial.get(o)){var n=r.partial.get(o).type;"modified"==t?/^(modified|updated)$/.test(n)&&r.partial.delete(o):r.partial.delete(o)}}))))}))},deleteDeepNest:function(e,t,r){var o=e.$.dN;o&&(o[t]&&void 0===r?delete o[t]:o[t]&&o[t].get(r)&&(o[t].delete(r),o[t].size||delete o[t]),Object.keys(o).length||(delete e.$.dN,e.$.isModified||e.$.isNew||store.$.removeParentNesting(e),store.$.changePersist(e,!0)))},updateJSON:function(e,t,r){var o={},n=t._arrPk,i=e.$._attributes;for(var a in i)o[a]=e[a];var s=r;1==r&&(s=store.$.isDirty(e,t.relations)||[]);for(var l=0;l<s.length;l++)o[s[l]]=e[s[l]];return n.forEach((function(t){o[t]=e[t]})),o},removeDeepNest:function(e){if(Lyte.isRecord(e)&&e.$.dN&&Object.keys(e.$.dN).length){e.$.dN={};var t=e.$.model.relations;for(var r in t)t[r].forEach((function(t){var r=t.opts;if(r&&(r.deepNest||"partial"==r.serialize)){var o=e[t.relKey];Array.isArray(o)?o.forEach((function(e){Lyte.isRecord(e)&&(store.$.removeDeepNest(e),e.$.isNew||e.$.isModified||e.$.dN&&(!e.$.dN||0!=Object.keys(e.$.dN).length)||store.$.removeParentNesting(e))})):Lyte.isRecord(o)&&(store.$.removeDeepNest(o),o.$.isNew||o.$.isModified||o.$.dN&&(!o.$.dN||0!=Object.keys(o.$.dN).length)||store.$.removeParentNesting(o))}}))}},addDeepNest:function(e,t,r,o,n){n=n||new Map;var i,a=t?store.model[e.$.model.extend]:e.$.model,s=e.$.pK,l=(r=r||"updated",a.relations);for(var d in l)l[d].forEach((function(t){var l,d,c;i=t.relKey?e[t.relKey]:store.$.getRelatedRecord(e,t.relatedTo,t.dummy);var p=store.model[t.relatedTo];if(i&&p){l=store.$.getBackwardRel(a,t,p);var u=!1;if(!n.get(l)){var f=n.set(l,new Map);u=!0}if(f=n.get(l),(u||!f.get(i))&&(f.set(i,!0),l&&l.opts&&(d=l.opts.deepNest,l.opts.serialize,c=!!l.opts.serialize),d&&store.$.makeDirty("dirty",i,r,l,s,n),c&&e&&i&&(!o||!o||o.model!==t.relatedTo||l.relKey!==o.relKey))){var h=i;Array.isArray(h)?h.forEach((function(e){store.$.partialData(e,l.relKey,s,/^(added|removed)$/.test(r)?r:"modified")})):Lyte.isRecord(h)&&store.$.partialData(h,l.relKey,s,/^(added|removed)$/.test(r)?r:"modified")}}}));a.extend&&this.addDeepNest(e,!0)},getRelatedRecord:function(e,t,r){if(e){var o=e.$._relationships;if(o[t]&&o[t][r])return o[t][r]}},makeDirty:function(e,t,r,o,n,i){if("id"!=o.opts.serialize||"updated"!=r){var a=o.relKey;Array.isArray(t)?t.forEach((function(e){store.$.setDeepNest(e,a,n,r,i)})):Lyte.isRecord(t)&&store.$.setDeepNest(t,a,n,r,i)}},setDeepNest:function(e,t,r,o,n){var i=e.$.dN=e.$.dN||{},a=i[t]=i[t]||new Map;a.has(r)||a.set(r,{});var s=a.get(r);switch(s.type){case"added":"removed"==o&&store.$.deleteDeepNest(e,t,r);break;case"removed":"added"==o&&store.$.deleteDeepNest(e,t,r);break;default:s.type=o,store.$.changePersist(e,!1),store.$.addDeepNest(e,void 0,void 0,void 0,n)}},isDirty:function(e,t,r,o){var n=[];for(var i in t)for(var a=t[i],s=0;s<a.length;s++)if((i=a[s]).opts&&i.opts.serialize){var l=i.relKey,d=i.relType,c=e[l],p=store.model[i.relatedTo];if(r&&p&&r==store.$.getBackwardRel(o,i,store.model[i.relatedTo])&&o._name!=i.relatedTo)continue;if("record"==i.opts.serialize){if(store.$.isRelDirty(i,c,i)){n.push(l);continue}}else if("partial"==i.opts.serialize)if("hasMany"==d){if(c&&c.partial&&c.partial.size){n.push(l);continue}}else if(Lyte.isRecord(c)&&c.$.isModified||e&&e.$&&e.$.partial&&e.$.partial.hasOwnProperty(l)){n.push(l);continue}i.opts.deepNest&&e.$.dN&&e.$.dN[l]&&n.push(l)}return n},isRelDirty:function(e,t,r){var o=e.relType,n=store.model[e.relatedTo],i=n.relations;if(!store.$.isEmpty(t))if("hasMany"==o&&Array.isArray(t)&&t.length){for(var a=t.length,s=0;s<a;s++)if(1==t[s].$.isModified)return!0;for(var l=0;l<a;l++){var d=t[l];if(this.isDirty(d,i,r,n).length)return!0}}else if("belongsTo"==o&&Lyte.isRecord(t)){if(1==t.$.isModified)return!0;if(this.isDirty(t,i,r,n).length)return!0}return!1},handleCachedResponse:function(e,t){var r=store.$.cachedBatch=store.$.cachedBatch||{},o=0;return(r[e]||[]).forEach((function(e,r){t.splice(e.ind+o++,0,e.data)})),delete r[e],t},addToCachedBatch:function(e){var t=store.$.currentBatch,r=store.$.cachedBatch=store.$.cachedBatch||{},o=r[t]=r[t]||[],n=(store.$.batch[t]||[]).length;o.push({ind:n,data:e})},establishToRelated:function(e,t){var r=e.$.model,o={};t.forEach((function(t){var n=store.peekRecord(t.model,t.pkVal);if(n){var i=n.$.model;store.$.getRelations(i,t.key,r,o),store.$.establishLink(o.forward,o.backward,n,e,void 0,!0)}}))},checkObjAndAddToArr:function(e,t,r){for(var o=Object.keys(r).length,n=-1,i=e.length,a=0;a<i;a++){var s=e[a],l=0;for(var d in r)s[d]==t[d]&&l++;if(l==o)return n=a,void e.splice(a,1,t)}return-1==n&&e.push(t),n},addToRelate:function(e,t,r,o){var n=r.forward.relatedTo,i=store.$.toRelate[n]=store.$.toRelate[n]||new Map;i.has(o)||i.set(o,[]);var a=i.get(o),s={model:e,pkVal:t.$.pK,key:r.forward.relKey};a.push(s)},addOnSave:function(e,t,r,o,n,i){store.$.onSave=store.$.onSave||{};var a=store.$.onSave[e]=store.$.onSave[e]||{},s=a[t[n]]=a[t[n]]||{},l=t[r]||[];"belongsTo"==o.relType&&(l=Array.isArray(t[r])?t[r]:[t[r]]),l.forEach((function(e){var t=s[o.relKey]=s[o.relKey]||[];store.$.checkAndAddToArray(t,e[i])}))},addToIDBonSave:function(e,t){var r=store.model[e].fieldList,o=store.$.onSave?store.$.onSave[e]:void 0;if(o){var n=store.model[e]._pK,i=t&&n?o[t[n]]:void 0;if(i){for(var a in i){var s=i[a],l=r[a].relatedTo;s.forEach((function(e){var t=store.peekRecord(l,e);if(t){var r=t.$.parent;if(Lyte.isRecord(r)){var o=r.$.model,n=o._name,i=o._pK;store.$.checkAndAddToIDBQ(n,"updateRecord",store.peekRecord(n,r[i]).$.toJSON(!0))}else store.$.checkAndAddToIDBQ(l,"updateRecord",store.peekRecord(l,e).$.toJSON(!0))}}))}store.$.removeOnSave(e,t[n])}}},removeOnSave:function(e,t){var r=store.$.onSave?store.$.onSave[e]:void 0;r&&r[t]&&delete r[t]},checkAndAddToIDBQ:function(e,t,r){var o={model:e,type:t,data:r};(store.$.idbQ2[e]=store.$.idbQ2[e]||[]).push(o)},checkAndRemoveKey:function(e,t,r){for(var o in e){var n=t[o];n&&"relation"==n.type&&(r&&!this.checkPresenceInArray(r,o)?delete e[o]:this.removeNotNeededKeys(n.relatedTo,e[o]))}},removeNotNeededKeys:function(e,t,r){var o=store.model[e],n=o.fieldList,i=r?r.deserializeKeys:void 0;if(o){var a=this;Array.isArray(t)?t.forEach((function(e){a.checkAndRemoveKey(e,n,i)})):this.checkAndRemoveKey(t,n,i)}return t},getIDBObj:function(e,t,r,o,n,i){if(e&&e.hasOwnProperty("idb"))return"function"==typeof e.idb?e.idb.apply(e,[{model:i||e._name,type:r,queryParams:t,key:o,customData:n}]):e.idb},idbQ2Push:function(e,t,r,o,n,i,a){try{var s=store.model[e],l=store.$.getIDBObj(s,r,o,n,a);if(l){var d={model:e,type:o,customData:a};d.queryCache=l.queryCache,s._pK;var c=store.$.idbQ2[e]=store.$.idbQ2[e]||[];switch(o){case"action":return void delete c[o];case"update":case"create":d.data=[],t.forEach((function(e){d.data.push(Lyte.isRecord(e)?e.$.toJSON(void 0,!0):e)}));break;case"updateRecord":case"createRecord":case"delete":d.data=t;break;case"destroyRecord":case"deleteRecord":d.id=t;break;case"findRecord":d.key=n;var p=t[0].$.toJSON("idb");(u={})[e]=p,i&&(u.meta=i),!0===l.queryCache&&(d.queryParams=r),d.data=u;break;case"findAll":var u;p=[],t.forEach((function(e){p.push(e.$.toJSON("idb"))})),(u={})[e]=p,i&&(u.meta=i),!0===l.queryCache&&(d.queryParams=r),d.data=u;break;case"pushPayload":Lyte.isRecord(t)&&(t=t.$.toJSON("idb")),d.data=t}c.push(d)}}catch(e){Lyte.error("Error while adding to IDBQueue ",e)}},isEmpty:function(e){return null==e||""===e||null==e},isEmptyObj:function(e){return null!==e&&"object"==(void 0===e?"undefined":_typeof(e))&&0==Object.keys(e).length},isEmptyArray:function(e){return!(!Array.isArray(e)||0!=e.length)},registerField:function(e,t,r,o){var n=e.fieldList[t]?Object.assign({},e.fieldList[t]):void 0;if("observer"==r.type)o.push(r);else if("callBack"==r.type){r.observes&&o.push(r.observes);for(var i=r.properties,a=0;a<i.length;a++)"didLoad"===i[a]||"init"===i[a]?(e.didLoad||(e.didLoad=[]),e.didLoad.push(r.value)):"add"!==i[a]&&"change"!==i[a]||e.on(i[a],r.value);"didLoad"==t&&(e.didLoad||(e.didLoad=[]),e.didLoad.push(r.value))}else if("didLoad"==t)e.didLoad||(e.didLoad=[]),e.didLoad.push(r);else if(Object.keys(r).length){if(r.primaryKey&&(e.fieldList.id&&0==e.fieldList.id.defined&&delete e.fieldList.id,r.hasOwnProperty("default")&&(Lyte.warn("LD23",e._name,t),delete r.default),null!=e._pK?(e._pK=e._pK+","+t,e.isComposite=!0):e._pK=t,r.baseKey)){if(e.bK)return void Lyte.warn("LD26");e.bK=t}e.fieldList.hasOwnProperty(t),e.fieldList[t]=r,n&&e._fldGrps&&(n.hasOwnProperty("default")&&delete e._fldGrps.default[t],n.hasOwnProperty("watch")&&delete e._fldGrps.watch[t],n.opts&&n.opts.hasOwnProperty("inherit")&&delete e._fldGrps.inherit[t]),r.hasOwnProperty("default")&&(e._fldGrps.default[t]=r),r&&r.opts&&r.opts.hasOwnProperty("inherit")&&(e._fldGrps.inherit[t]=r),r.hasOwnProperty("watch")&&1==r.watch&&/^(array|object)$/.test(r.type)&&(e._fldGrps.watch[t]=r),(r.hasOwnProperty("properties")||r.hasOwnProperty("items"))&&(e._fldGrps.nested_prop[t]=r)}if("relation"===r.type){r.relKey=t;var s=r.relatedTo,l=e.fieldList[t];e.relations[s]||(e.relations[s]=[]);var d={};d.relKey=l.relKey,store.$.checkObjAndAddToArr(e.relations[r.relatedTo],l,d),"hasMany"==r.relType&&(e._fldGrps.hasMany[t]=r),r.hasOwnProperty("opts")&&r.opts.hasOwnProperty("inverse")&&(e._fldGrps.inverse[s]=r)}},setError:function(e,t,r){e.$.hasOwnProperty("error")?Array.isArray(t)?t.forEach((function(t){store.$.cmpSet(e.$.error,t,r)})):store.$.cmpSet(e.$.error,t,r):Lyte.error("LD03",e,t)},unRegCb:function(e,t){var r=store[e][t];if(r){var o=r.__extendedBy;if(o.length){if(store[e].__toAddSuper=store[e].__toAddSuper||{},store[e].__toAddSuper[t]?o.forEach((function(r){store[e].__toAddSuper[t].push(r)})):store[e].__toAddSuper[t]=o.slice(),o.forEach((function(t){store[e][t].$super=void 0})),store[e].application&&"application"!=t){var n=store[e].application;o.forEach((function(t){store[e][t].$super=n,store[e].application.__extendedBy.push(t)}))}store[e].application||(store[e].__toAddSuper.application?o.forEach((function(t){store[e].__toAddSuper.application.push(t)})):store[e].__toAddSuper.application=o.slice())}r.$super&&r.$super.__extendedBy.splice(r.$super.__extendedBy.indexOf(t),1),delete store[e][t]}else Lyte.error("LD02",e,t)},eventListeners:{add:function(e,t,r){return e.events=e.events||{},e.events[t]=e.events[t]||[],e.events[t].push({f:r}),t+"-"+(e.events[t].length-1)},remove:function(e,t){var r;if(t)if(/^(add|remove|change)$/.test(t))r=t,e.events&&e.events[r]&&delete e.events[r];else{var o=t?t.split("-"):void 0;if(o){var n=e.events[o[0]];n&&o[1]&&(n[o[1]]=null)}}else{var i=e.events;for(var a in i)i&&i[a]&&delete i[a]}},emit:function(e,t,r){for(var o=e.events&&e.events[t]?e.events[t]:[],n=0;n<o.length;n++)o[n]&&o[n].f.apply(null,r)}},extendCallback:function(e,t,r){var o,n,i=e[t];if(r&&"string"==typeof r&&((n=i[r])||(i.__toAddSuper=i.__toAddSuper||{},i.__toAddSuper.hasOwnProperty(r)||(i.__toAddSuper[r]=[]),i.__toAddSuper[r].push(this.__name))),n&&n.is==t&&(!this.$super||"application"==this.$super.__name)){if(this.$super=n,n.__extendedBy.push(this.__name),i.application){var a=i.application.__extendedBy.indexOf(this.__name);a>-1&&i.application.__extendedBy.splice(a,1)}if((o=i.__toAddSuper)&&o.application){var s=o.application.indexOf(this.__name);s>-1&&i.__toAddSuper.application.splice(s,1)}}return this},super:function(){var e=this.$super,t=arguments[0][0][arguments[0][0].length-1],r=[],o=arguments[0][0],n=e[t];if("function"==typeof n){for(var i in delete o[o.length-1],o)o.hasOwnProperty(i)&&r.push(o[i]);return n.apply(e,r)}if(n)return n},extendModel:function(e,t){var r=t||this;if(e&&store.model[e]){var o=Object.assign({},store.model[e].fieldList);for(var n in o)"relation"==o[n].type&&delete o[n];var i={},a="id"==r._pK&&0==r.fieldList.id.defined;for(var n in o){var s=o[n];if(a&&s.primaryKey&&s.defined,r.fieldList.hasOwnProperty(n)&&r._fldGrps){var l=r.fieldList[n];l.hasOwnProperty("default")&&delete r._fldGrps.default[n],l.hasOwnProperty("watch")&&delete r._fldGrps.watch[n]}s.hasOwnProperty("default")&&(r._fldGrps.default[n]=s),s.hasOwnProperty("watch")&&1==s.watch&&/^(array|object)$/.test(s.type)&&(r._fldGrps.watch[n]=s),s.primaryKey?i[n]=s:r.fieldList[n]=s}var d=Object.keys(i),c=d.length;if(a&&c){for(var n in delete r.fieldList.id,i)r.fieldList[n]=i[n];1==c?(r._pK=d[0],r._arrPk=Array.from(d)):(r.isComp=!0,r._arrPk=Array.from(d),r._pK=r._arrPk.toString())}var p=r._name;if(store.model[p].extend=e,store.model[e].extendedBy=store.model[e].extendedBy||{},store.model[e].extendedBy[p]=!0,!store.adapter[p]&&store.adapter[e]&&(store.adapter[p]=store.adapter[e]),!store.serializer[p]&&store.serializer[e]&&(store.serializer[p]=store.serializer[e]),store.model[e].actions){var u=r.actions=r.actions||{};for(var n in store.model[e].actions)u.hasOwnProperty(n)||(u[n]=store.model[e].actions[n])}}},demoLishObserverBindings:function(e,t,r){for(key in r||(r=e),t){if(e[key]instanceof Object){if(r&&e[key]._setterScope){var o=e[key]._setterScope.indexOf(r);-1!=o&&e[key]._setterScope.splice(o,1)}Object.keys(t[key]).length&&this.demoLishObserverBindings(e[key],t[key],e)}if(e._setterScope&&e!=r){var n=e._setterScope.indexOf(r);-1!=n&&e._setterScope.splice(n,1)}}},establishObserverBindings:function(e,t,r){for(key in r||(r=e),t)e[key]instanceof Object&&(e[key]._bindings||store.$.defProp(e[key],"_bindings",new Set,!1,!0),r&&!e[key]._setterScope&&store.$.defProp(e[key],"_setterScope",[]),-1==e[key]._setterScope.indexOf(r)&&e[key]._setterScope.push(r),e[key]._bindings.add(t[key]),Object.keys(t[key]).length&&this.establishObserverBindings(e[key],t[key],e)),e._setterScope||(store.$.defProp(e,"_setterScope",[]),e._setterScope.push(e))},setData:function(e,t,r,o,n,i,a){var s,l={emit:!1,attr:[],oldRec:{}},d=e.model,c=!1,p=e.record;if(a&&t){var u=e.model._fldGrps.inherit;for(var f in u)if(e.record[u[f].relKey]&&t[u[f].relKey]){if("belongsTo"==u[f].relType)e.model._arrPk.forEach((function(e){delete t[u[f].relKey][e]})),this.setData(e.record[u[f].relKey].$,t[u[f].relKey],void 0,void 0,void 0,!0,!0);else for(var h=t[u[f].relKey].length-1;h>=0;h--)e.model._arrPk.forEach((function(e){delete t[u[f].relKey][h][e]})),this.setData(e.record[u[f].relKey][h].$,t[u[f].relKey][h],void 0,void 0,void 0,!0,!0);delete t[u[f].relKey]}}if(t&&"object"===(void 0===t?"undefined":_typeof(t)))for(var y in s=[],o=r,t)s.push(y),this.setValue(e,y,t[y],o,l,i),d&&d._properties&&d._properties.hasOwnProperty(y)&&(c=!0);else s=t,this.setValue(e,t,r,o,l,i),d&&d._properties&&d._properties.hasOwnProperty(t)&&(c=!0);return e.emit("set",[e.record,s]),e.model.emit("set",[d._name,e.record,s]),store.emit("set",[d._name,e.record,s]),c&&store.$.establishObserverBindings(p,d._properties),!i&&l.emit&&store.$.changeCallbck(p,l,n),p},changeCallbck:function(e,t,r){var o=[e,t.attr],n=e.$;if(n.emit("change",o),n.model.emit("change",o),store.emit("change",[n.model._name,n.record,t.attr]),r)for(var i in t.oldRec)r[i]=t.oldRec[i];else{for(var a=0;a<t.attr.length;a++)i=t.attr[a],n.undoStack[i]=n.undoStack[i]||[],n.undoStack[i].push(t.oldRec[i]);n.undoStack._order_.push(t.attr)}},setValue:function(e,t,r,o,n,i,a){var s=e.model,l=s._pK,d=e.record;if(t!=s._pK){var c=s.fieldList[t],p=c&&c.opts?1==c.opts.watch:void 0;if(d.hasOwnProperty(t),d[t],!c)return void store.$.cmpSet(d,t,r,void 0,!0);if(!c.mandatory||null!=r&&null!=r&&""!==r){if(c.relType){var u,f,h=c.relType,y={},v=store.modelFor(c.relatedTo),m=v._pK,_=v._pK,g=v.isComp||v.fieldList[m].type,b=v.isComp,L=(m=v._pK,g=b?"object":v.fieldList[m].type,c&&c.opts?c.opts.polymorphic:void 0);if(this.getRelations(s,c.relKey,v,y),d[t]&&"hasMany"==h){if(u=[],d[t].forEach((function(e){u.push(e.$.pK)})),d[t]===r)return;if(Array.isArray(r)&&r.length===d[t].length){for(var A,$=r.length,E=0,T=0;T<$&&(A=r[T],Lyte.isRecord(A)?f=A:A&&(void 0===A?"undefined":_typeof(A))==g&&(f=store.peekRecord(A._type?A._type:c.relatedTo,A)),Lyte.isRecord(f)&&f===d[t][T]);T++)E++;if(E&&E==$)return}store.$.addOnSave(s._name,d,t,c,l,_),Array.from(d[t]).forEach((function(e){store.$.demolishLink(e,_,d,y.forward.relKey,void 0,void 0,void 0,!0),null!==y.backward&&store.$.demolishLink(d,s._pK,e,y.backward.relKey,y.forward)}))}else if(d[t]&&Lyte.isRecord(d[t])&&"belongsTo"==h){if(u=d[t].$.pK,Lyte.isRecord(r)?f=r:r&&(void 0===r?"undefined":_typeof(r))==g&&(f=store.peekRecord(r._type?r._type:c.relatedTo,r)),Lyte.isRecord(f)&&f===d[t])return;store.$.addOnSave(s._name,d,t,c,l,_);var R=d[t];store.$.demolishLink(R,_,d,y.forward.relKey,void 0,void 0,void 0,!0),null!==y.backward&&store.$.demolishLink(d,s._pK,R,y.backward.relKey,y.forward),store.$.cmpSet(d,t,{},o,!0)}if("hasMany"==h&&store.$.isEmpty(r)){var O=d[t]&&d[t].partial?d[t].partial:void 0;store.$.cmpSet(d,t,[],o,!0),O&&store.$.defProp(d[t],"partial",O),store.$.establishObserverBindings(d,d.$.model._properties),store.$.defArrUtls(d[t]),store.$.defPolyUtls(d[t]),store.$.defUtls(d[t],v,d,t)}if(Array.isArray(r)){if("belongsTo"==h)return this.revertToOldVal(d,t,u,y),void store.$.setRecErr(e,t,"ERR21",r)}else r=[r];var w=[];for(T=0;T<r.length;T++)if(!(this.isEmpty(r[T])||"belongsTo"==h&&this.isEmptyObj(r[T])||"hasMany"==h&&this.isEmptyArray(r[T]))){var S=r[T],C=r[T]&&r[T]._type?r[T]._type:c.relatedTo;if(!b&&r[T]&&_typeof(r[T])===g){if(null==(S=store.peekRecord(r[T]._type?r[T]._type:c.relatedTo,r[T])))this.addToRelate(s._name,d,y,r[T]);else if(S.$&&S.$.isError){w.push({code:"ERR15",message:Lyte.errorCodes.ERR15,error:Object.assign({},S)});continue}}else if(r[T]&&"object"==_typeof(r[T])){if(S.$&&S.$.isError){w.push({code:"ERR15",message:Lyte.errorCodes.ERR15,error:Object.assign({},S)});continue}if(!Lyte.isRecord(S)&&(L&&r[T]&&r[T]._type?S=store.peekRecord(r[T]._type,store.$.getpKVal(r[T],store.modelFor(r[T]._type))):b&&(S=store.peekRecord(r[T]._type?r[T]._type:c.relatedTo,r[T]))||(S=this.newRecord(C,r[T],o?o.skipValidation:void 0)),S.$.isError)){w.push({code:"ERR15",data:r[T],message:Lyte.errorCodes.ERR15,error:Object.assign({},S)});continue}}1!=(x=this.establishLink(y.forward,y.backward,d,S,void 0,!!i||void 0))?w.push({code:x,data:r[T],message:Lyte.errorCodes[x]}):store.$.addOnSave(s._name,d,t,c,l,_)}if(w.length&&w.length==r.length)return this.revertToOldVal(d,t,u,y),void("belongsTo"==c.relType?store.$.setRecErr(e,t,w[0]):store.$.setRecErr(e,t,w));if(w.length>1?store.$.setRecErr(e,t,w):store.$.clrRecErr(e,t),!i){var P=d.$._attributes;P.hasOwnProperty(t)||(P[t]=[]),P[t].push({_type:"changed",records:u}),n.emit=!0,n.attr.push(t);var k={};k.records=u,k._type="update",n.oldRec[t]=k;var N=d.$.getInitialValues(t),x=!0;if(N&&Array.isArray(d[t])&&N.length==d[t].length)for(x=!1,T=0;T<N.length;T++)if(!store.$.comparePk(d[t][T],N[T])){x=!0;break}x||delete P[t]}}else if(r!==d[t]){if(!o||o&&!0!==o.skipValidation){(M=c).any&&Array.isArray(M)||(M=[M]);var j=M.length,D=!0;for(T=0;T<j;T++){var I=M[T];for(var B in I)!0!==(K=Lyte.checkProperty(B,r,t,I[B],I,d,void 0,s._name))&&!0===D&&("object"==(void 0===K?"undefined":_typeof(K))&&(K.value=r),D=K)}if(!0!==D)return void store.$.setRecErr(e,t,D)}i?(p&&/^(array|object)$/.test(c.type)&&Lyte.establishObjectBinding(d,t,!0),store.$.cmpSet(d,t,r,o,!0)):store.$.estAttrs(d,t,r,n,a,o)}else if(r===d[t]&&d.$.isError&&d.$.error[t]){var M,F=!0;for((M=c).any&&Array.isArray(M)||(M=[M]),j=M.length,D=!0,T=0;T<j;T++)for(var B in I=M[T]){var K;!0!==(K=Lyte.checkProperty(B,r,t,I[B],I,d,void 0,s._name))&&(D=!1)}!0!==D&&(F=!1),F&&store.$.clrRecErr(e,t)}}else store.$.setRecErr(e,t,{code:"ERR02",message:Lyte.errorCodes.ERR02,value:r});store.$.checkAttrs(d)}else d[t]!==r&&store.$.setRecErr(e,t,"ERR01",r)},estAttrs:function(e,t,r,o,n,i){var a=e.$._attributes,s=e.$.model,l=a[t],d=a.hasOwnProperty(t);d?(n&&Lyte.cmpData(d?l:n.data,e[t])||r&&"object"==(void 0===r?"undefined":_typeof(r))&&!n&&store.adapter.$.compareObjects(l,r)||l==r)&&delete a[t]:a[t]=n?n.data:this.createCopy(e[t]);var c=e.hasOwnProperty(t),p=n?n.data:e[t];if(!n){var u={};s._properties&&s._properties.hasOwnProperty(t)&&(u[t]=s._properties[t],store.$.demoLishObserverBindings(e,u)),store.$.cmpSet(e,t,r,i,!0)}store.$.clrRecErr(e.$,t),e.$.srtObs&&store.$.changeRelPkMaps(e,void 0,void 0,"sort",t);var f={_type:"update"};f.val=p,c||(f._type="propAdd"),o.emit=!0,o.attr.push(t),o.oldRec[t]=f},checkAttrs:function(e){var t=e.$.model;Object.keys(e.$._attributes).length?(store.$.cmpSet(e.$,"isModified",!0),store.$.changePersist(e,!1),store.$.addDeepNest(e),this.checkAndAddToArray(t.dirty,e.$.pK)):(store.$.cmpSet(e.$,"isModified",!1),store.$.changePersist(e,!0),e.$.isNew||e.$.hasOwnProperty("dN")&&(!e.$.dN||Object.keys(e.$.dN).length)||store.$.removeParentNesting(e),e.$.isNew||this.deleteFromArray(t.dirty,e.$.pK))},checkForCorrectRelation:function(e,t){var r=e.relatedTo;return!!(Lyte.isRecord(t)&&(e.opts&&e.opts.polymorphic?t.$.model.extend&&e.relatedTo===t.$.model.extend:e&&t&&r===t.$.model._name))},removeKeys:function(e,t){for(var r in t)if(e.hasOwnProperty(r)){var o=e[r];("belongsTo"===o.type||"hasMany"===o.type&&t[r])&&this.removeNotDefinedKeys(o.relatedTo,t[r],!(!o.opts||!o.opts.polymorphic)||void 0)}else delete t[r]},removeNotDefinedKeys:function(e,t,r){var o=e.fieldList;if(Array.isArray(t))for(var n=0;n<t.length;n++){var i=t[n];this.removeKeys(r&&Lyte.isRecord(i)?i.$.model.fieldList:o,i)}else this.removeKeys(r&&Lyte.isRecord(t)?t.$.model.fieldList:o,t)},add:function(e,t,r,o){var n,i=this.record,a=i.$.model,s=this.key,l=a.fieldList[s],d={};store.$.getRelations(a,l.relKey,store.modelFor(l.relatedTo),d),Array.isArray(e)||(e=[e]);var c=store.modelFor(d.forward.relatedTo),p=c._pK,u=[],f=[],h=c.isComp;i.$._attributes.hasOwnProperty(s)&&i.$._attributes[s].length&&(n=i.$.getInitialValues(s));for(var y=0;y<e.length;y++){var v=e[y];if(h&&"object"==(void 0===v?"undefined":_typeof(v))&&Object.keys(v).length===c._arrPk.length){if(this.polymorphic&&!t){u.push({code:"ERR22",data:e[y],message:Lyte.errorCodes.ERR22});continue}v=store.peekRecord(t||d.forward.relatedTo,v)}if(!h&&c.fieldList[p].type.toLowerCase()==(void 0===v?"undefined":_typeof(v))||h&&"object"==(void 0===v?"undefined":_typeof(v))&&Object.keys(v).length===c._arrPk.length){if(this.polymorphic&&!t){u.push({code:"ERR22",data:e[y],message:Lyte.errorCodes.ERR22});continue}v=store.peekRecord(t||d.forward.relatedTo,v)}else"object"!=(void 0===v?"undefined":_typeof(v))||Lyte.isRecord(v)||(v=store.$.newRecord(v._type?v._type:t||l.relatedTo,v,r?r.skipValidation:void 0));var m=this.polymorphic&&t?t:v&&v._type?v._type:void 0;if(null==v)u.push({code:"ERR13",data:e[y],message:Lyte.errorCodes.ERR13});else if(v.$&&v.$.isError)u.push({code:"ERR15",data:e[y],message:Lyte.errorCodes.ERR15,error:v});else if(Lyte.isRecord(v)&&!store.$.hasDuplicateRelation(v,i[s],p,m,c)){var _=store.$.establishLink(d.forward,d.backward,i,v);1!=_?u.push({code:_,data:e[y],message:Lyte.errorCodes[_]}):f.push(v)}}if(f.length){var g=i.$._attributes;g[s]?store.$.hasRecordsArrayChanged(i,s,n)?g[s].push({_type:"added",records:f}):(delete i.$._attributes[s],Object.keys(i.$._attributes).length||(store.$.cmpSet(i.$,"isModified",!1),store.$.changePersist(i,!0),delete g[s],i.$.isNew||(store.$.deleteFromArray(a.dirty,i.$.pK),(!i.$.dN||i.$.dN&&!Object.keys(i.$.dN).length)&&store.$.removeParentNesting(i)))):(g[s]=[{_type:"added",records:f}],store.$.cmpSet(i.$,"isModified",!0),store.$.changePersist(i,!1),store.$.checkAndAddToArray(a.dirty,i[a._pK])),store.$.emit("change",i,[s]);var b={_type:"added",records:f};o?o[s]=b:(i.$.undoStack[s]=i.$.undoStack[s]||[],i.$.undoStack[s].push(b),i.$.undoStack._order_.push([s]))}return u.length>0?store.$.setRecErr(i.$,s,u):store.$.clrRecErr(i.$,s),i},remove:function(e,t,r){var o,n=this.record,i=n.$.model,a=this.key,s=i.fieldList[a],l={};store.$.getRelations(i,s.relKey,store.modelFor(s.relatedTo),l),Array.isArray(e)||(e=[e]);var d,c=store.modelFor(l.forward.relatedTo),p=c._pK,u=c.isComp,f=[],h=[],y=[];n.$._attributes.hasOwnProperty(a)&&n.$._attributes[a].length&&(o=n.$.getInitialValues(a));for(var v=0;v<e.length;v++){var m,_=e[v];if(!u&&c.fieldList[p].type.toLowerCase()==_typeof(e[v])||u&&"object"==(void 0===_?"undefined":_typeof(_))&&Object.keys(_).length===c._arrPk.length){if(1==this.polymorphic&&!t){f.push({code:"ERR22",data:e[v],message:Lyte.errorCodes.ERR22});continue}d=store.peekRecord(t||l.forward.relatedTo,e[v]),m=t}else Lyte.isRecord(e[v])&&(d=e[v],m=t||(d&&d._type?d._type:void 0));if(d){var g=store.$.getIndex(n[a],p,d.$.get(p),m);store.$.demolishLink(d,p,store.peekRecord(i._name,n.$.pK),l.forward.relKey,void 0,void 0,void 0,!0),null!=l.backward&&store.$.demolishLink(n,i._pK,store.peekRecord(m||l.forward.relatedTo,d.$.pK),l.backward.relKey,l.forward),h.push(d),y.push(g)}}if(h.length){var b=n.$._attributes;b[a]?store.$.hasRecordsArrayChanged(n,a,o)?b[a].push({_type:"removed",records:h,_indices:y}):(delete n.$._attributes[a],Object.keys(n.$._attributes).length||(store.$.cmpSet(n.$,"isModified",!1),store.$.changePersist(n,!0),delete b[a],n.$.isNew||(store.$.deleteFromArray(i.dirty,n.$.pK),(!n.$.dN||n.$.dN&&!Object.keys(n.$.dN).length)&&store.$.removeParentNesting(n)))):(b[a]=[{_type:"removed",records:h,_indices:y}],store.$.cmpSet(n.$,"isModified",!0),store.$.changePersist(n,!1),store.$.checkAndAddToArray(i.dirty,n[i._pK])),store.$.emit("change",n,[a]);var L={_type:"removed",records:h,_indices:y};r?r[a]=L:(n.$.undoStack[a]=n.$.undoStack[a]||[],n.$.undoStack[a].push(L),n.$.undoStack._order_.push([a]))}f.length>0?store.$.setRecErr(n.$,a,f):store.$.clrRecErr(n.$,a)},filter:function(e,t,r){var o=0;for(var n in t)e[n]===t[n]&&o++;if(o===r)return!0},filterBy:function(e){for(var t=Object.keys(e).length,r=[],o=0;o<this.length;o++)store.$.filter(this[o],e,t)&&r.push(this[o]);return r.filterBy||(store.$.defArrUtls(r),store.$.defUtls(r,this.model)),r},idbSerialize:function(e,t,r,o,n,i){var a=t.forward.relatedTo,s=r._pK,l=o._pK;Array.isArray(e)?e.forEach((function(r,d){Lyte.isRecord(r)&&r.$.inIDB||store.$.checkPresenceInArray(store.$.recStack[a],r[l])?e[d]=r[l]:(store.$.removeBackwardRel(r,t,s,n,!0),store.$.removeSelfCircularReference(o._name,r,i))})):e&&Lyte.isRecord(e)&&(Lyte.isRecord(e)&&e.$.inIDB||this.checkPresenceInArray(store.$.recStack[a],e[l])?e[t.relKey]=e[l]:(this.removeBackwardRel(e,t,s,n,!0),this.removeSelfCircularReference(o._name,e,i)))},idSerialize:function(e,t,r,o,n){var i=t.forward.opts?t.forward.opts.polymorphic:void 0,a=t.forward.relKey,s=e[a=t.forward.relKey],l=store.model[t.backward.relatedTo],d=store.model[t.forward.relatedTo],c=store.$.getpKVal(e,l);if(Array.isArray(s))if(i)e[a]=this.polymorphicToJSON(t.forward,s);else{var p=[];if(o)var u=o[a]=o[a]||[];s.forEach((function(e){if(e.$&&e.$.isNew&&1!=r&&"state"!=r)store.$.rSerialize(e,t,d,l._pK,c,r,u,n),p.push(e);else{if(u){var o={},i="related";e.$.isDeleted&&(i="removed"),store.$.defProp(o,"$",{});var a=o.$,s=t.forward.relatedTo;Object.defineProperties(a,{pkVal:{value:e.$.pK},type:{value:i},model:{value:s},record:{value:store.peekRecord(s,e.$.pK)}}),e.$.isDeleted&&(o.$.onlyDetach=!0),u.push(o)}e.$&&!e.$.isDeleted&&p.push(e.$.pK&&"object"==_typeof(e.$.pK)?Object.assign({},e.$.pK):e.$.pK)}})),e[a]=p}else s&&Lyte.isRecord(s)&&(s.$.isNew&&1!=r&&"state"!=r?(o&&(u=o[a]=o[a]||{}),u=store.$.rSerialize(s,t,d,l._pK,c,r,u,n),o[a]=u):i?e[a]=this.polymorphicToJSON(t.forward,s):s.$.isDeleted||(e[a]=s.$.pK&&"object"==_typeof(s.$.pK)?Object.assign({},s.$.pK):s.$.pK))},recordSerialize:function(e,t,r,o,n,i,a,s,l,d){var c=n._pK;if(Array.isArray(r)){if(0==r.length)return delete e[t],0;r=Array.from(r);for(var p=l[t]=l[t]||[],u=0;u<r.length;u++)r[u]&&Lyte.isRecord(r[u])&&(this.rSerialize(r[u],o,i,c,a,s,p,d),r[u].$.isDeleted&&(p[u]&&p[u].$&&(p[u].$.onlyDetach=!0),r.splice(u,1),u--))}else r&&Lyte.isRecord(r)&&(p=l[t]=l[t]||{},p=this.rSerialize(r,o,i,c,a,s,p,d),l[t]=p)},rSerialize:function(e,t,r,o,n,i,a,s){var l=t.forward.relatedTo,d=(store.model[t.backward.relatedTo],t.forward.opts?t.forward.opts.polymorphic:void 0);if(this.removeBackwardRel(e,t,o,n),a){var c,p={},u=e.$.isNew?"added":e.$.isModified?"modified":e.$.isDeleted?"removed":"related";d&&(c=e.$.model._name,e.$.polymorphicType=c,r=store.model[c]),store.$.defProp(p,"$",{});var f=p.$,h=d?c:l;Object.defineProperties(f,{pkVal:{value:e.$.pK},type:{value:u},model:{value:h},record:{value:store.peekRecord(h,e.$.pK)}}),Array.isArray(a)&&a.push(p)}return this.removeSelfCircularReference(r._name,e,i,void 0,p,s),p},partialSerialize:function(e,t,r,o,n,i,a,s,l,d){var c=o.forward,p=n._pK,u=o.forward.relatedTo,f=o.forward.opts?o.forward.opts.polymorphic:void 0;if("hasMany"==c.relType)if(r&&r.partial){var h=r.partial,y=i._pK;if(l&&($=l[t]=l[t]||[],store.$.defProp($,"partial",!0)),h){var v,m,_=[],g=this;h.forEach((function(e,t){if(m=t,/^(added|modified)$/.test((v=e).type)){var n="related",l=store.$.getIndex(r,y,m,void 0,store.model[u]);if(-1!=l){var c,h,b,L=r[l];L&&L.$&&(h=Object.assign({},L.$),L=Object.assign({},L),store.$.defProp(L,"$",h)),c=L,f&&L&&(b=L._type?L._type:L.$.model._name,i=store.model[b]);var A=store.peekRecord(i._name,m);if(g.removeBackwardRel(L,o,p,a),L.$.isNew)n="added";else if(L.$.isModified){n="modified";var E=store.$.isDirty(A,i.relations);c=store.$.updateJSON(L,i,E)}else E=store.$.isDirty(A,i.relations),c=store.$.updateJSON(L,i,E);if($){var T={};store.$.defProp(T,"$",{});var R=T.$,O=f?b:u;Object.defineProperties(R,{pkVal:{value:m},type:{value:n},model:{value:f?b:u},record:{value:store.peekRecord(O,m)}}),$.push(T)}g.removeSelfCircularReference(i._name,c,s,void 0,T,d),Lyte.isRecord(c)?c.$.partialType=v.type:(store.$.defProp(c,"$",{}),store.$.defProp(c.$,"partialType",v.type),c.$.hasOwnProperty("pK")||store.$.defProp(c.$,"pK",m)),f&&(c.$.polymorphicType=b),_.push(c)}}else if("removed"==v.type){var w={};if(m&&"object"==(void 0===m?"undefined":_typeof(m))?Object.assign(w,Object.assign({},m)):w[y]=m,A=store.peekRecord(i._name,m)||store.peekRecord(i._name,m,!0),$){if(T={},store.$.defProp(T,"$",{}),R=T.$,Object.defineProperties(R,{pkVal:{value:m},type:{value:"removed"},model:{value:f&&v.polymorphicType?v.polymorphicType:u},record:{value:A}}),d){var S="rec"+ ++d.size;w[d.refKey]=S,d.set(S,T)}$.push(T)}store.$.defProp(w,"$",{}),w.$.partialType="removed",f&&v.polymorphicType&&(w.$.polymorphicType=v.polymorphicType),w.$.hasOwnProperty("pK")||(w.$.pK=m),_.push(w)}})),_.length?r=e[t]=_:delete e[t]}}else delete e[t];else if("belongsTo"==c.relType&&r&&Lyte.isRecord(r)){var b;f&&r&&(b=r._type?r._type:r.$.model._name,i=store.model[b]),this.removeBackwardRel(r,o,p,a);var L,A=r;if(r.$.isNew?this.removeBackwardRel(r,o,p,a):(L=store.$.isDirty(r,i.relations),A=store.$.updateJSON(r,i,L)),l){var $=l[t]=l[t]||{},E=r.$.isNew?"added":r.$.isModified?"modified":"related";store.$.defProp($,"$",{});var T=$.$,R=f?b:u;Object.defineProperties(T,{pkVal:{value:r.$.pK},type:{value:E},model:{value:R},record:{value:store.peekRecord(R,r.$.pK)}})}f&&(A.$||store.$.defProp(A,"$",{}),A.$.polymorphicType=b),this.removeSelfCircularReference(i._name,A,s,void 0,$,d),r=e[t]=A}},removeSelfCircularReference:function(e,t,r,o,n,i,a){var s=store.model[e],l=s.fieldList,d=(s.extend,store.$.getpKVal(t,s));store.$.recStack[e]=store.$.recStack[e]||[],store.$.checkAndAddToArray(store.$.recStack[e],d);var c,p=store.peekRecord(e,d),u=Lyte.isRecord(p)?p.$.partial:void 0,f=t&&t.$?t.$.polymorphicType:void 0,h=new Map;if(h.set(t,d),i){c="rec"+ ++i.size;var y={};store.$.defProp(y,"$",{pkVal:p.$.pK,model:p.$.model._name}),i.set(c,y)}var v=store.$.getFromCB("serializer",e,"serializeEmptyRelation");for(var m in t){var _,g,b,L,A,$=l[m],E=!1;if(("create"==o||Lyte.isRecord(t)&&t.$.isNew)&&s._pK==m&&1!=r)delete t[m];else if($)if($&&"relation"!=$.type&&!r&&Lyte.Transform[$.type]&&Lyte.Transform[$.type].serialize&&t.hasOwnProperty(m))t[m]=Lyte.Transform[$.type].serialize(t[m],m,p);else{if(u&&u.hasOwnProperty(m)){var T={},R=store.model[$.relatedTo]._pK,O=!1;if(u[m].forEach((function(e,r){if(T[R]=r,store.$.defProp(T,"$",{}),store.$.defProp(T.$,"partialType","removed"),store.$.defProp(T.$,"pK",r),n){var o=n[m]=n[m]||{};store.$.defProp(o,"$",{});var i=o.$;Object.defineProperties(i,{pkVal:{value:r},type:{value:"removed"},model:{value:$.relatedTo},parent:{value:p},record:{value:store.peekRecord($.relatedTo,r)}})}(!0===v||Array.isArray(v)&&v.indexOf($.relKey))&&$.opts&&/^(id|record)$/.test($.opts.serialize)?(t[m]=null,O=!0):"partial"==$.opts.serialize&&(t[m]=T,O=!0)})),O)continue}if(1!=r&&"state"!=r||!t[m]||"object"!=_typeof(t[m])||!$||"relation"==$.type){if(t[m]&&$&&"relation"==$.type){if(g=$.relatedTo,L=$.relType,A=!(!$.opts||!$.opts.inherit),null==(b=store.modelFor(g)))continue;var w=$.relKey,S={};E?this.getRelations(_,$.relKey,b,S):this.getRelations(s,w,b,S);var C=$.opts,P=C?C.serialize:void 0,k=t[w];if("idb"==r)store.$.idbSerialize(k,S,s,b,d,r);else if(a&&A)store.$.toChildJSON(g,L,t[m],m,e,h,e+"_"+d),"belongsTo"==L&&(t[m][store.modelFor(g)._pK]==d&&g==e&&delete t[m],t[m]=Object.assign({},t[m]));else if(r&&!a||a&&!A||"id"==P)store.$.idSerialize(t,S,r,n,i);else if("record"===P){if(0==store.$.recordSerialize(t,m,k,S,s,b,d,r,n,i)&&"hasMany"===L&&(!0===v||Array.isArray(v)&&v.indexOf($.relKey))&&Array.isArray(p[m])&&p[m].partial&&p[m].partial.size){var N=!0;if(p[m].partial.forEach((function(e){"removed"!==e.type&&(N=!1)})),N){t[m]=[];continue}}}else{if("partial"!==P){delete t[w];continue}store.$.partialSerialize(t,m,k,S,s,b,d,r,n,i)}((k=t?t[w]:void 0)&&"hasMany"==L&&Array.isArray(k)&&0==k.length||"belongsTo"==L&&"object"==(void 0===k?"undefined":_typeof(k))&&0==Object.keys(k).length)&&((!0===v||Array.isArray(v)&&v.indexOf($.relKey))&&"hasMany"==L&&$.opts&&/^(id|record)$/.test($.opts.serialize)?t[w]=[]:delete t[w])}}else t[m]=Lyte.deepCopyObject(t[m])}else{if(f&&(_=store.modelFor(f),$=_.fieldList[m],E=!0),1==r){t[m]&&"object"==_typeof(t[m])&&(t[m]=Lyte.deepCopyObject(t[m]));continue}delete t[m]}}if(i){var x=i.refKey;t[x]=c}},removeBackwardRel:function(e,t,r,o,n){if(n)delete e[t.backward.relKey];else if(null!=t.backward){var i=e[t.backward.relKey];if(Array.isArray(i)){for(var a=0;a<i.length;a++)if(this.comparePk(i[a],o))return i.splice(a,1),void(0==i.length&&delete e[t.backward.relKey])}else i&&Lyte.isRecord(i)&&this.comparePk(i,o)&&delete e[t.backward.relKey]}},polymorphicToJSON:function(e,t){var r=e.opts;if(r&&r.polymorphic){if(Array.isArray(t)){var o=[];return t.forEach((function(e){o.push(store.$.polyToJSON(e))})),o}return store.$.polyToJSON(t)}},polyToJSON:function(e){var t=e.$.model;!t.hasOwnProperty("fieldList")&&t._name&&(t=store.model[t._name]);var r=t?t._pK:void 0,o={},n=e.$.pK;return"object"==(void 0===n?"undefined":_typeof(n))?o=Object.assign({},n):o[r]=n,o._type=e._type?e._type:e.$.model._name,o},toChildJSON:function(e,t,r,o,n,i,a){var s=store.modelFor(e),l=s.fieldList,d={};Array.isArray(r)||(r=[r]);for(var c=0;c<r.length;c++){if(!i.get(r[c])){var p=store.$.getpKVal(r[c],s);i.set(r[c],p)}for(var u in s.relations)for(var f=0;f<s.relations[u].length;f++){var h=s.relations[u][f].relKey?s.relations[u][f].relKey:void 0;if(h&&l[h]&&"relation"==l[h].type&&r[c][l[h].relKey])if(r[c][l[h].relKey]&&l[h].opts&&l[h].opts.inherit){if("hasMany"==l[h].relType&&r[c][l[h].relKey])for(var y=0;y<r[c][l[h].relKey].length;y++)p=store.$.getpKVal(r[c][l[h].relKey][y],store.modelFor(l[h].relatedTo)),i.get(r[c][l[h].relKey][y])?Lyte.isRecord(r[c][l[h].relKey][y])&&i.get(r[c][l[h].relKey][y])&&(r[c][l[h].relKey][y]="object"==(void 0===p?"undefined":_typeof(p))?p:_defineProperty({},store.modelFor(l[h].relatedTo)._pK,p)):(i.set(r[c][l[h].relKey][y],p),store.$.toChildJSON(l[h].relatedTo,l[h].relType,r[c][l[h].relKey][y],l[h].relKey,l[h].relatedTo,i,a),"object"==_typeof(r[c][l[h].relKey][y])&&(r[c][l[h].relKey][y]=Object.assign({},r[c][l[h].relKey][y])));else"belongsTo"==l[h].relType&&r[c][l[h].relKey]&&(p=store.$.getpKVal(r[c][l[h].relKey],store.modelFor(l[h].relatedTo)),i.get(r[c][l[h].relKey])?r[c][l[h].relKey]="object"==(void 0===p?"undefined":_typeof(p))?p:_defineProperty({},store.modelFor(l[h].relatedTo)._pK,p):(i.set(r[c][l[h].relKey],p),store.$.toChildJSON(l[h].relatedTo,l[h].relType,r[c][l[h].relKey],l[h].relKey,l[h].relatedTo,i,a),r[c][l[h].relKey]=Object.assign({},r[c][l[h].relKey])));0==Object.keys(r[c][l[h].relKey]).length&&delete r[c][l[h].relKey]}else(Lyte.isRecord(r[c][l[h].relKey])||"hasMany"==l[h].relType&&Lyte.isRecord(r[c][l[h].relKey][0]))&&(this.getRelations(s,l[h].relKey,store.modelFor(l[h].relatedTo),d),store.$.idSerialize(r[c],d,!0))}Lyte.isRecord(r[c])&&(r[c]=Object.assign({},r[c]))}},toJSONObj:function(e,t,r,o,n,i){var a,s,l=e._name,d=(e._pK,e._fldGrps.inherit&&Object.keys(e._fldGrps.inherit).length);if(a=1!=r&&"state"!=r||i&&(!i||d)?Lyte.deepCopyObject(t):Object.assign({},t),Lyte.isRecord(a))s=a.$.pK;else{if(!store.$.getpKVal(a,e))return;if(!store.peekRecord(l,store.$.getpKVal(a,e)))return;s=store.peekRecord(l,store.$.getpKVal(a,e)).$.pK}var c,p=n?n.obj:void 0;return p&&!p.has(s)&&(p.set(s,{}),c=p.get(s)),this.removeSelfCircularReference(l,a,r,o,c,n&&n.ref?n.ref:void 0,i),"idb"==r&&this.removeNotNeededKeys(l,a,e.idb),a},toJSON:function(e,t,r,o,n,i){var a,s=store.model[e];if(store.$.recStack={},Array.isArray(t)){for(var l=[],d=0;d<t.length;d++)a=this.toJSONObj(s,t[d],r,o,n,i),l.push(a);return l}return t&&("object"===(void 0===t?"undefined":_typeof(t))||Lyte.isRecord(t))&&(a=this.toJSONObj(s,t,r,o,n,i)),store.$.recStack={},a},createCopy:function(e){if(Array.isArray(e)){if(e.save){for(var t=[],r=0;r<e.length;r++){var o=Lyte.deepCopyObject(e[r]);t.push(o)}return t}}else if(e&&(Lyte.isRecord(e)||"object"==(void 0===e?"undefined":_typeof(e))))return Lyte.deepCopyObject(e);return e},compareRecords:function(e,t,r,o,n){if(r=n._arrPk,Lyte.isRecord(e)&&Lyte.isRecord(t)&&r.length){if(o&&e._type&&o!==e._type)return!1;for(var i=r.length,a=0;a<i;a++){var s=r[a];if(e[s]&&t[s]&&e[s]!==t[s])return!1}return!0}return!1},hasRecordInArray:function(e,t,r,o,n){if(Lyte.isRecord(t)&&r)for(var i=e.length,a=0;a<i;a++){var s=e[a];if(!o||s._type===o)if(n){if(this.compareRecords(s,t,r,void 0,t.$.model))return!0}else if(o&&s._type&&o===t._type&&s[r]===t[r]||s[r]===t[r])return!0}return!1},hasDuplicateRelation:function(e,t,r,o,n){var i=n.isComp;return Array.isArray(t)?i||t.isPolymorphic||!t._recMap?this.hasRecordInArray(t,e,r,o,i):t._recMap.get(e[r]):!(!t||!Lyte.isRecord(t))&&this.compareRecords(e,t,r,o,n)},checkPresenceInArray:function(e,t){return e&&e.some((function(e){return e===t}))},checkAndAddToArray:function(e,t){if(this.checkPresenceInArray(e,t))return-1;e.push(t)},deleteFromArray:function(e,t){var r=e.indexOf(t);-1!=r&&e.splice(r,1)},genPk:function(e,t,r){var o;e.forEach((function(e){o=r[e].type;var n=t[e]=Math.floor(1e5*Math.random()+1);"string"==o&&(t[e]=n.toString())}))},generateRandomPk:function(e,t,r,o){for(this.genPk(r,t,o);this.isDuplicateRecord(e,t,r.toString());)this.genPk(r,t,o)},pkPresence:function(e,t){var r=!0;return t.forEach((function(t){e.hasOwnProperty(t)&&e[t]||(r=!1)})),r},newRecord:function(e,t,r){var o=store.modelFor(e);if(void 0===o)return Lyte.warn("LD02","Model",e),new error1(void 0,void 0,Lyte.getErrorMessage("LD02","Model",e));if(void 0===t&&(t={}),t&&"object"!==(void 0===t?"undefined":_typeof(t)))return Lyte.warn("LD25",t),new error1(void 0,void 0,Lyte.getErrorMessage("LD25",t));var n=o.fieldList,i={},a=new error1,s=o._arrPk;for(var l in this.pkPresence(t,s)?this.isDuplicateRecord(o,t,s)&&store.$.setError(a,s,{code:"ERR16",message:Lyte.errorCodes.ERR16}):this.generateRandomPk(o,t,s,n),n){"hasMany"==(T=n[l]).relType&&(i[l]=[]);var d=t[l];if("relation"!=T.type&&(void 0!==d&&""!==d||T.hasOwnProperty("default")&&(d=i[l]=store.$.getDefaultVal(i,T.default)),!r)){var c=T;c.any&&Array.isArray(c)||(c=[c]);for(var p=c.length,u=!0,f=0;f<p;f++){var h=c[f];for(var y in h)1!=(E=Lyte.checkProperty(y,d,l,h[y],h,t,i,e))&&!0===u&&("object"==(void 0===E?"undefined":_typeof(E))&&(E.value=d),u=E)}!0!==u&&store.$.setError(a,l,u)}}for(var v in t)i[v]=t[v];i=new Record(e,i),store.$.cmpSet(i.$,"isNew",!0),store.$.changePersist(i,!1);var m=o.relations;for(var _ in m){var g=m[_];for(f=0;f<g.length;f++){var b=g[f],L=b.relKey,A=b.opts?b.opts.polymorphic:void 0;if(i&&i[L]){var $=t[L];i[L]=void 0;var E,T=g[f],R={};if(1!=(E=this.getRelations(o,T.relKey,store.modelFor(T.relatedTo),R))){store.$.setError(a,T.relKey,{code:E,data:g,message:Lyte.errorCodes[E]});continue}var O=store.modelFor(T.relatedTo),w=O._pK,S=O.isComp,C=S?void 0:O.fieldList[O._pK].type;if(Array.isArray($)){if("belongsTo"==g[f].relType){store.$.setError(a,T.relKey,{code:"ERR21",data:$,message:Lyte.errorCodes.ERR21});continue}}else $=[$];a[T.relKey]=[];for(var P=0;P<$.length;P++){var k=void 0,N=T.relatedTo;if($[P]&&Lyte.isRecord($[P]))k=$[P];else if(S&&"object"==_typeof($[P])){var x;if(-1!=(x=store.$.getIndex(O.data,w,store.$.getpKVal($[P],O))))k=O.data[x];else{if(A){if(!$[P]||!$[P].hasOwnProperty("_type")){store.$.setError(a,T.relKey,{code:"ERR22",data:$[P],message:Lyte.errorCodes.ERR22});continue}N=$[P]._type}k=this.newRecord(N,$[P])}}else if($[P]&&_typeof($[P])==C.toLowerCase())k=store.peekRecord(N,$[P]);else if($[P]&&"object"==_typeof($[P])){if(A){if(!$[P]||!$[P].hasOwnProperty("_type")){store.$.setError(a,T.relKey,{code:"ERR22",data:$[P],message:Lyte.errorCodes.ERR22});continue}N=$[P]._type}k=this.newRecord(N,$[P])}k&&k.$&&k.$.isError?store.$.setError(a,T.relKey,{code:"ERR15",data:$[P],message:Lyte.errorCodes.ERR15,error:Object.assign({},k)}):k&&k.$&&!k.$.isError&&1!=(E=this.establishLink(R.forward,R.backward,i,k,void 0,!1))&&store.$.setError(a,T.relKey,{code:E,data:$[P],message:Lyte.errorCodes[E]})}if(0==a[T.relKey].length&&delete a[T.relKey],"hasMany"==g[f].relType){var j=L;null==i[j]&&(i[j]=[]),i[j].add||(A&&store.$.defProp(i[j],"polymorphic",!0),store.$.defArrUtls(i[j]),store.$.defUtls(i[j],store.modelFor(g[f].relatedTo),i,j),store.$.defPolyUtls(i[j]))}}}}if(a&&a.$&&Object.keys(a.$.error).length>0)return a;var D=store.$.toRelate[o._name],I=i.$.pK;if(D&&D.has(I)&&(store.$.establishToRelated(i,D.get(I)),D.delete(I)),o.didLoad){var B=o.didLoad;for(f=0;f<B.length;f++)B[f].apply(i)}return this.handleArrOp(o.data,"push",i),this.checkAndAddToArray(o.dirty,i.$.pK),o.emit("add",[i]),store.emit("add",[o._name,i]),r&&(i.$.validatedOnCreate=!1),i},toInsertData:function(e,t,r){var o=store.model[e],n=this.insertIntoStore(e,t[e],r,!0,void 0);return o&&delete o.rel,n},insertIntoStore:function(e,t,r,o,n,i,a){var s;if(Array.isArray(t)){s=[];for(var l=0;l<t.length;l++)s[l]=this.insertIntoStore(e,t[l],r,o,n),s[l]&&s[l].$&&s[l].$.isError&&(s.$=s.$||store.$.defProp(s,"$",{}),store.$.cmpSet(s.$,"isError",!0))}else if(t&&"object"==(void 0===t?"undefined":_typeof(t))&&Object.keys(t).length){var d=store.modelFor(e);if(t._type&&d.extendedBy&&(d=d.extendedBy[t._type]?store.modelFor(t._type):void 0),Lyte.isRecord(t))return;if(a&&t&&d){var c=d.relations;for(var p in c)c[p].forEach((function(e){var r=e.relKey,o=e.relType;if("hasMany"==o&&t.hasOwnProperty(r)&&Array.isArray(t[r])&&t[r].length){var n=[];t[r].forEach((function(e){Lyte.isRecord(e)?n.push(e.$.pK):n.push(e)})),t[r]=n}else"belongsTo"==o&&t.hasOwnProperty(r)&&Lyte.isRecord(t[r])&&(t[r]=t[r].$.pK)}))}if(this.isDuplicateRecord(d,t,d._pK))(s=this.validateAndMerge(d,t,n))&&s.data?s=s.data:s&&s.type&&Lyte[s.type].apply(Lyte,s.args||[]);else{var u=new Record(d._name,t);d.data.push(u);var f=store.$.toRelate[d._name],h=u.$.pK;r&&(store.$.saveParent=u),s=this.validateAndPush(d,u,n),f&&f.has(h)&&(store.$.establishToRelated(u,f.get(h)),f.delete(h))}r&&(store.$.saveParent=void 0),o&&(store.$.recStack={})}return s},removeFromStore:function(e,t,r,o,n,i){var a=e.data,s=e._name;if(0!=a.length){Array.isArray(t)||(t=[t]);for(var l=e._pK,d=0;d<t.length;d++){var c=this.getIndex(a,l,t[d]);if(-1!=c){var p,u=a[c],f=u.$.pK,h=e.relations;if(u.$.isNew&&(i=n=void 0,r=!0),Object.keys(h).length&&this.toDemolishRelation(e,c,o,i,n),!0!==n&&!1!==i&&(p=this.handleArrOp(a,"removeAt",void 0,c,1),e.emit("remove",[p[0]]),store.emit("remove",[e._name,p[0]]),e._properties&&store.$.demoLishObserverBindings(u,e._properties)),!0===r){store.$.cmpSet(u.$,"isUnloaded",!0);var y=u.$.__scpObj;for(var v in y){var m=y[v].split("_"),_=Lyte.nestScp[m[0]];_&&Lyte.removeNestScp(_._data,m[0],m[1],void 0,u,void 0,void 0,{model:s,pK:u.$.pK,attr:v})}if((b=store.model.cachedQueries)&&(L=b[s])&&L.length)for(var g=L.length-1;g>=0;g--)($=L[g]).hasDeletedRecords&&$.data&&-1!==(E=$.data[s].indexOf(u))&&L.splice(g,1)}if(1!=i){var b,L,A=p?p[0]:u;if(!r&&(store.$.cmpSet(A.$,"isDeleted",!0),store.$.changePersist(A,!0),!0!==n&&!1!==i&&(A.$.isNew||A.$.isModified)&&store.$.deleteFromArray(e.dirty,A.$.pK),A.$.isNew||store.$.addTo_Del(e,A,c),b=store.model.cachedQueries))if((L=b[s])&&L.length)for(g=L.length-1;g>=0;g--){var $,E;($=L[g])&&$.data&&-1!=(E=$.data[s].indexOf(u))&&($.hasDeletedRecords=!0)}Array.isArray(e.dirty)&&-1!=(E=e.dirty.indexOf(f))&&e.dirty.splice(E,1)}}}}},getIndex:function(e,t,r,o,n){return(n?n.isComp:t.split(",").length>1)?this.getCompInd(e,r,o,n):this.getInd(e,t,r,o)},getCompInd:function(e,t,r,o){for(var n=0;e&&n<e.length;n++){var i=e[n];if((!r||e[n]._type===r)&&store.adapter.$.compareObjects(store.$.getpKVal(i,o),t))return n}return-1},getInd:function(e,t,r,o){for(var n=0;e&&n<e.length;n++){var i=e[n];if((!o||i._type===o)&&i[t]==r)return n}return-1},isDuplicateRecord:function(e,t){var r=e.data,o=e._pK,n=e.isComposite;if(r.length){if(!n&&e.data._recMap){var i=t[o];return void 0!==e.data._recMap.get(i?i.toString():i)}return r.some((function(r){if(store.adapter.$.compareObjects(store.$.getpKVal(t,e),store.$.getpKVal(r)))return!0}))}return!1},validateAndPush:function(e,t,r){e.rel||(e.rel={});for(var o=e._arrPk,n=o.length,i=0;i<n;i++){var a=o[i];if(!t.hasOwnProperty(a))return l=e.data.indexOf(t),e.data.splice(l,1),new error1(a,{code:"ERR23",data:t,message:Lyte.errorCodes.ERR23});if(null==t[a]||null==t[a])return l=e.data.indexOf(t),e.data.splice(l,1),new error1(a,{code:"ERR26",data:t,message:Lyte.errorCodes.ERR26})}var s=null==t.$.pK||"object"==_typeof(t.$.pK)?t.$.pK:t.$.pK.toString();e.data._recMap.set(s,t),t=this.validateJSON(e,t,void 0,void 0,r);var l=e.data.indexOf(t);if(e.data.splice(l,1),this.handleArrOp(e.data,"push",t),e.didLoad){var d=e.didLoad;for(i=0;i<d.length;i++)d[i].apply(t)}return e.emit("add",[t]),store.emit("add",[e._name,t]),t},validateAndMerge:function(e,t,r,o){if(e.rel||(e.rel={}),void 0===store.$.getpKVal(t,e))return{type:"error",args:["LD28",e._name,Lyte.isRecord(t)?t:JSON.stringify(t)]};var n=store.peekRecord(e._name,store.$.getpKVal(t,e));if(!n||!Lyte.isRecord(n))return{type:"error",args:["LD04",Lyte.isRecord(t)?t:JSON.stringify(t)]};if(this.mergeData(n,t,r,o),e.didLoad)for(var i=e.didLoad,a=0;a<i.length;a++)i[a].apply(n);return{data:n}},mergeData:function(e,t,r,o){if(e&&t){var n,i=e.$.model,a=!1;for(var s in o&&store.adapter.$.mergeError(i,e,t),t)if(n=i.fieldList[s]){if("relation"!=n.type){var l=store.$.getDsrzEmpData(n,i._name),d=!l&&t[s];t.hasOwnProperty(s)&&(d||l)&&Lyte.Transform.hasOwnProperty(n.type)&&Lyte.Transform[n.type].hasOwnProperty("deserialize")&&(t[s]=Lyte.Transform[n.type].deserialize(t[s],s,i._name,store.$.getpKVal(t,i)));var c={};i._properties&&i._properties.hasOwnProperty(s)&&(c[s]=i._properties[s],store.$.demoLishObserverBindings(e,c)),store.$.cmpSet(e,s,t[s],void 0,!0),i._properties&&i._properties.hasOwnProperty(s)&&(a=!0)}else if(n&&"relation"==n.type){var p={},u={};store.$.getRelations(e.$.model,s,store.modelFor(n.relatedTo),u);var f=store.model[u.forward.relatedTo],h=this.compareRelations(e,t,s,n,r?r[s]:void 0,p,o);this.mergeRecords(p,h,i,f,e,s,t,u,r,o)}}else"$"!=s&&store.$.cmpSet(e,s,t[s],void 0,!0);a&&store.$.establishObserverBindings(e,i._properties)}},mergeRecords:function(e,t,r,o,n,i,a,s,l,d){s||(s={},store.$.getRelations(r,i,o,s));var c=r._pK;if("hasMany"==s.forward.relType&&store.$.isEmptyArray(a[i])&&(store.$.cmpSet(n,i,[],void 0,!0),store.$.establishObserverBindings(n,n.$.model._properties),store.$.defArrUtls(n[i]),store.$.defPolyUtls(n[i]),store.$.defUtls(n[i],o,n,i)),Array.isArray(e.add)&&e.add.forEach((function(e){store.$.createAndRelate(r,o,n,i,e,s,l)})),Array.isArray(e.remove)&&e.remove.forEach((function(e){var t=e.pK,r=e.model;store.$.demolishLink(n,c,store.peekRecord(r,t),s.backward.relKey,s.forward,s.backward,!0),store.$.demolishLink(store.peekRecord(r,t),store.modelFor(r)._pK,n,s.forward.relKey,s.backward,s.forward,!0)})),n&&n.hasOwnProperty(i)&&(store.$.deleteDeepNest(n,i),Array.isArray(n[i])&&n[i].hasOwnProperty("partial"))){var p=[];n[i].partial.forEach((function(e,t){p.push(t),n[i].partial.delete(t)}))}switch(t){case 0:Lyte.isRecord(n[i])&&(store.$.demolishLink(n,c,n[i],s.backward.relKey,s.forward,s.backward,!0),store.$.demolishLink(n[i],o._pK,n,s.forward.relKey,s.backward,s.forward,!0)),store.$.createAndRelate(r,o,n,i,a[i],s,l);break;case 1:break;case 2:this.mergeData(n[i],a[i],void 0,d)}},compareRelations:function(e,t,r,o,n,i,a){var s=store.modelFor(o.relatedTo),l=s._pK;if("belongsTo"==o.relType)return n&&"removed"===n.$.type&&(!t||t&&store.$.comparePk(e,store.$.getpKVal(t,s)))?1:this.compareRecordWithObj(e[r],t[r],l,n,a);var d=!1;if(n&&n.partial&&(d=!0),!d&&(!e.hasOwnProperty(r)||e&&e.hasOwnProperty(r)&&(store.$.isEmpty(e[r])||store.$.isEmptyArray(e[r]))))return i?void(t[r]||[]).forEach((function(e){(i.add=i.add||[]).push(e)})):0;for(var c=t[r]?t[r].length:0,p=[],u=0;u<c;u++){var f=t[r][u];if(!n||!n[u]||"removed"!=n[u].$.type){var h=this.getIndex(e[r],l,"object"==(void 0===f?"undefined":_typeof(f))?store.$.getpKVal(f,s):f);if(-1!=h){p.push(e[r][h].$.pK);var y=this.compareRecordWithObj(e[r][h],f,l,n?n[u]:void 0,a);2==y&&this.mergeData(e[r][h],f,n?n[u]:void 0,a)}else i&&(i.add=i.add||[]).push(f)}}i&&!d&&(e[r]||[]).forEach((function(e){var t=e.$.pK;-1==p.indexOf(t)&&(i.remove=i.remove||[]).push({pK:t,model:e.$.model._name})}))},compareRecordWithObj:function(e,t,r,o,n){if(!e||!Lyte.isRecord(e))return 0;var i=e.$.model,a=(i._pK,i.isComp),s=i.fieldList;if(!a){var l=i.fieldList[r];if((void 0===t?"undefined":_typeof(t))==l.type)return e[r]==t?1:0}if(t&&"object"==(void 0===t?"undefined":_typeof(t))){if(!store.$.comparePk(e,store.$.getpKVal(t,i)))return 0;for(var d in t)if(l=s[d]){if("relation"==l.type){var c={},p=this.compareRelations(e,t,d,l,o?o[d]:void 0,c,n);this.mergeRecords(c,p,i,store.modelFor(l.relatedTo),e,d,t,void 0,o)}else if(e[d]!=t[d])return 2}else if(e[d]!=t[d])return 2;return 1}return 0},validateJSON:function(e,t,r,o,n){var i=o?o.toValidate:void 0,a=i&&Object.keys(i).length?i:e.fieldList,s=!!e.extend;for(var l in t)if(!r||-1!=r.indexOf(l)){var d=a[l];if(d){if("relation"==d.type&&t[l]){var c=o&&o.toPartialAdd?o.toPartialAdd[l]:void 0;if(1!=(v=this.handleRelation(l,e,d,t,c,n)))return new error1(l,{code:v,data:t,message:Lyte.errorCodes[v]});"hasMany"!=d.relType||t[l].add||(store.$.defArrUtls(t[l]),store.$.defPolyUtls(t[l]),store.$.defUtls(t[l],store.model[d.relatedTo],t,l))}else if(d.type){var p=d;void 0===t[l]&&p.default&&(t[l]=store.$.getDefaultVal(t,p.default));var u=store.$.getDsrzEmpData(d,e._name),f=!u&&t[l];t.hasOwnProperty(l)&&(f||u)&&Lyte.Transform.hasOwnProperty(p.type)&&Lyte.Transform[p.type].hasOwnProperty("deserialize")&&(t[l]=Lyte.Transform[p.type].deserialize(t[l],l,e._name,store.$.getpKVal(t,e)))}}else if(s){var h=store.modelFor(e.extend),y=h.fieldList[l];if(y&&"relation"==y.type){var v;if(c=o&&o.toPartialAdd?o.toPartialAdd[l]:void 0,1!=(v=this.handleRelation(l,h,y,t,c)))return new error1(l,{code:v,data:t,message:Lyte.errorCodes[v]});"hasMany"!=y.relType||t[l].add||(store.$.defArrUtls(t[l]),store.$.defPolyUtls(t[l]),store.$.defUtls(t[l],h,t,l))}}}return t},handleRelation:function(e,t,r,o,n,i){var a={};if(t.rel.hasOwnProperty(e))a=t.rel[e];else{var s=this.getRelations(t,e,store.modelFor(r.relatedTo),a);if(!0!==s)return s;t.rel[e]=a}return this.solveRelation(a,t,store.modelFor(r.relatedTo),e,o,n,i)},getRelations:function(e,t,r,o){if(null==r)return Lyte.error("LD05",e.fieldList[t].relatedTo,t,e._name),"ERR11";if(o.forward=e.fieldList[t],o.backward=this.getBackwardRel(e,o.forward,r),void 0===o.backward){var n={type:"relation",relatedTo:e._name,dummy:o.forward.relKey,relKey:void 0};r.relations[e._name]=r.relations[e._name]||[],r.relations[e._name].push(n),o.backward=n}return!0},getBackwardRel:function(e,t,r){var o,n,i;if(t.opts){if(o=t.opts.inverse,n=t.opts.polymorphic,null===o)return;if(n){var a=r.extendedBy;if(a)for(var s in a){var l=store.modelFor(s);if(l.relations[e._name]){r=l;break}}}}if(o&&""!=o)i=o;else{var d,c=r.relations[e._name],p=store.modelFor(e.extend);!c&&p&&r.relations[p._name]&&(c=r.relations[p._name],d=!0),i=!c||1!=c.length||c[0].opts&&c[0].opts.inverse&&c[0].opts.inverse!==t.relKey||d&&!(d&&c[0].opts&&c[0].opts.polymorphic)?void 0:c[0].relKey}if(!i){var u=r.relations[e._name],f=store.modelFor(e.extend);if(!u&&f&&r.relations[f._name]&&r.relations[f._name].opts&&r.relations[f._name].opts.polymorphic&&(u=r.relations[f._name]),t.dummy&&u){for(var h=0;h<u.length;h++)if(u[h]&&u[h].relKey&&u[h].relKey==t.dummy){i=u[h].relKey;break}}else if(u)for(h=0;h<u.length;h++){if(u[h]&&u[h].opts&&u[h].opts.inverse&&u[h].opts.inverse===t.relKey){i=u[h].relKey;break}if(u[h]&&u[h].dummy&&u[h].dummy==t.relKey){i=u[h];break}}}return i&&i.dummy?i:i&&e._fldGrps.inverse.hasOwnProperty(t.relatedTo)&&!t.dummy&&i&&e.relations[t.relatedTo]&&e.relations[t.relatedTo].length>1&&!o&&(!r.fieldList[i].opts||r.fieldList[i].opts&&!r.fieldList[i].opts.inverse)?void 0:i&&r?r.fieldList[i]:void 0},solveRelation:function(e,t,r,o,n,i,a){e.backward;var s=e.forward,l=a?a[o]:void 0,d=l&&l.partial,c=(t._pK,[]);if(i)c=i;else if(d)Array.isArray(n[o])&&(c=n[o].splice(0,n[o].length));else{if(n[o]&&(n[o].add||Lyte.isRecord(n[o])))return!0;if(Array.isArray(n[o])){if("belongsTo"==s.relType)return"ERR21"}else n[o]=[n[o]];c=n[o].splice(0,n[o].length),"belongsTo"==s.relType&&(n[o]=void 0)}for(var p=0;p<c.length;p++){var u;if(1!=(u=this.createAndRelate(t,r,n,o,c[p],e,l)))return u}return!0},createAndRelate:function(e,t,r,o,n,i,a){if(!i.backward&&(i.forward.relatedTo===e._name&&(i.backward=i.forward),void 0===i.backward))return"ERR12";var s,l=e._pK,d=t.isComp,c=i.forward&&i.forward.opts?i.forward.opts.polymorphic:void 0,p=a&&a.hasOwnProperty(n[l])?a[n[l]]:a;if(d||(void 0===n?"undefined":_typeof(n))!=t.fieldList[t._pK].type?"object"!=(void 0===n?"undefined":_typeof(n))||Lyte.isRecord(n)||(s=this.insertIntoStore(t._name,n,void 0,void 0,p)):s=store.peekRecord(t._name,n),s&&s.$&&s.$.isError){store.$.cmpSet(r.$,"isError",!0);var u={code:"ERR24",message:Lyte.errorCodes.ERR24,data:r,error:s.$.error};store.$.cmpSet(r.$.error,o,u)}else s?this.hasDuplicateRelation(s,r[o],t._pK,c?n._type:void 0,t)||this.establishLink(i.forward,i.backward,r,s,void 0,!0,!1):this.addToRelate(e._name,r,i,n);return!0},singleEstablishLink:function(e,t,r){var o=r.$._relationships,n=t.$.model._name,i=e.relKey;o[n]=o[n]||{},o[n][i]=o[n][i]||[],this.hasDuplicateRelation(t,o[n][i],t.$.model._pK,void 0,t.$.model)||o[n][i].push(t)},establishLink:function(e,t,r,o,n,i,a){if(!o)return"ERR13";if(!this.checkForCorrectRelation(e,o))return"ERR14";var s=e.relKey,l=e.opts&&e.opts.polymorphic,d=l?o._type:void 0,c={};if("belongsTo"==e.relType)r[s]!==o&&store.$.cmpSet(r,s,o,void 0,!0),r.$.partial&&Object.keys(r.$.partial).length&&r.$.partial[s]&&delete r.$.partial[s];else if("hasMany"===e.relType){if(r[s]||store.$.cmpSet(r,s,[],void 0,!0),!r[s].model){var p=o.$.model;l&&d&&(store.$.defProp(r[s],"polymorphic",!0),p=store.modelFor(p.extend)),store.$.establishObserverBindings(r,r.$.model._properties),store.$.defArrUtls(r[s]),store.$.defPolyUtls(r[s]),store.$.defUtls(r[s],p,r,s)}var u,f=e?store.modelFor(e.relatedTo):void 0;0!=a&&this.hasDuplicateRelation(o,r[s],e?f._pK:void 0,d,f)||(null!=n?this.handleArrOp(r[s],"insertAt",o,n):this.handleArrOp(r[s],"push",o)),!i&&e.opts&&e.opts.serialize&&(u=store.$.partialData(r,s,o.$.pK,"added"),c.relKey=s,c.model=r.$.model._name)}var h=!1;if(i||(h=!u),e==t)return this.singleEstablishLink(e,r,o),!0;if(null===t)return o.hasOwnProperty(y)&&delete o[y],!0;if(t.dummy)this.singleEstablishLink(e,r,o);else{var y=t.relKey,v=o.$.model;if(!this.checkForCorrectRelation(t,r))return"ERR14";if("belongsTo"==t.relType)null!=o[y]&&o[t.relKey]!==r&&this.toDemolishLink(v,o,t,i),o[y]!==r&&store.$.cmpSet(o,y,r,void 0,!0),o.$.partial&&Object.keys(o.$.partial).length&&o.$.partial[y]&&delete o.$.partial[y];else if("hasMany"===t.relType){o[y]||store.$.cmpSet(o,y,[],void 0,!0),o[y].model||(store.$.defArrUtls(o[y]),store.$.defPolyUtls(o[y]),store.$.defUtls(o[y],r.$.model,o,y));var m,_,g=t?store.modelFor(t.relatedTo):void 0;this.hasDuplicateRelation(r,o[y],t?g._pK:void 0,d,g)||this.handleArrOp(o[y],"push",r),!i&&t.opts&&t.opts.serialize&&(m=store.$.partialData(o,y,r.$.pK,"added")),i||(_=!m)}}return h&&(e.opts&&e.opts&&e.opts.deepNest&&(store.$.setDeepNest(r,e.relKey,o.$.pK,"added"),_=!1),_&&t&&t.opts&&t.opts.deepNest&&store.$.setDeepNest(o,t.relKey,r.$.pK,"added")),!0},toDemolishRelation:function(e,t,r,o,n){var i=e.data[t],a=e.relations;for(var s in a)for(var l=a[s],d=0;d<l.length;d++){var c=l[d],p=store.modelFor(c.relatedTo);if(p){var u=p._pK,f=c.relKey;if(e._name==p._name){var h,y=p.data;for(h=0;h<y.length;h++){var v=y[h];if(Array.isArray(v[f]))for(var m=0;m<v[f].length;m++)v[f][m][u]==i[u]&&!1!==o&&this.handleArrOp(v[f],"removeAt",void 0,m,1);else Lyte.isRecord(v[f])&&v[f][u]==i[u]&&!1!==o&&(v[f]=void 0)}}if(!i[c.relKey]&&!c.dummy)continue;this.toDemolishLink(e,i,c,r,o,n)}}},toDemolishLink:function(e,t,r,o,n,i){var a=t[r.relKey],s=e._pK,l=store.modelFor(r.relatedTo);if(l){l._pK,r.relatedTo;var d=this.getBackwardRel(e,r,l);if(r.opts&&r.opts.serialize,r.dummy&&(a=this.getRelatedRecord(t,r.relatedTo,r.dummy)),d)if(Array.isArray(a))for(var c=0;c<a.length;c++)this.demolishLink(t,s,a[c],d.relKey,r,d,o,void 0,n,i);else Lyte.isRecord(a)&&this.demolishLink(t,s,a,d.relKey,r,d,o,void 0,n,i)}},demolishSingleRelation:function(e,t,r,o,n,i,a){var s,l;Lyte.isRecord(e)&&(s=e.$._relationships)&&s[t]&&s[t][r]&&!1!==i&&!0!==a&&(s=s[t][r],(l=this.getIndex(s,n,o[n]))>-1&&s.splice(l,1))},demolishLink:function(e,t,r,o,n,i,a,s,l,d){var c,p=r[o],u=r.$.model,f=e.$.pK,h=p?p.polymorphic:void 0;if(Array.isArray(p)){var y=this.getIndex(p,t,f,h?e._type:void 0),v=r.$._attributes,m=v.hasOwnProperty(o)&&v[o]&&v[o].length?r.$.getInitialValues(o):void 0,_=!(!p.partial||!p.partial.has(f)||"added"!=p.partial.get(f).type);-1!=y&&(_||!1!==l&&!0!==d)&&(h&&(c=p[y].$.model._name),this.handleArrOp(r[o],"removeAt",void 0,y,1)),!s&&m&&(store.$.hasRecordsArrayChanged(r,o,m)||(delete r.$._attributes[o],Object.keys(r.$._attributes).length||(store.$.cmpSet(r.$,"isModified",!1),store.$.changePersist(r,!0),r.$.isNew||(store.$.deleteFromArray(u.dirty,r[u._pK]),(!r.$.dN||r.$.dN&&!Object.keys(r.$.dN).length)&&store.$.removeParentNesting(r)))))}else p&&("object"==(void 0===p?"undefined":_typeof(p))||Lyte.isRecord(p))&&!1!==l&&!0!==d?null!=Lyte&&null!=Lyte.objectUtils?Lyte.objectUtils(r,"delete",o,void 0,void 0,!0):delete r[o]:this.demolishSingleRelation(r,e.$.model._name,n.relKey,e,t,l,d);if(i||(i=u.fieldList[o]),!a&&!0!==l){var g,b;if(i){i.opts&&(i.opts.serialize,b=!!i.opts.serialize,g=i.opts.deepNest);var L=i?i.relType:void 0}if("belongsTo"==L&&b&&!e.$.isNew){var A=r.$.partial=r.$.partial||{};(A=A[o]=A[o]||new Map).has(f)||A.set(f,{}),(A=A.get(f)).type="removed"}i&&i.opts&&i.opts.serialize&&(g=(!store.$.partialData(r,o,f,"removed",c)||"hasMany"!=L)&&g),g&&(store.$.makeDirty("dirty",r,"removed",i,f),store.$.addDeepNest(r))}},rllBckRecArr:function(e,t,r,o){var n={},i=r._pK,a=store.modelFor(o.relatedTo)._pK;store.$.getRelations(r,o.relKey,store.modelFor(o.relatedTo),n);for(var s=e.length-1;s>=0;s--){var l=e[s].records;if("added"==e[s]._type)for(var d=0;d<l.length;d++)(f=l[d])&&f.$&&f.$.hasOwnProperty("pK")&&(this.demolishLink(f,a,t,n.forward.relKey),null!=n.backward&&this.demolishLink(t,i,f,n.backward.relKey,n.forward));else if("removed"==e[s]._type)for(d=l.length-1;d>=0;d--)(f=l[d])&&f.$&&f.$.hasOwnProperty("pK")&&this.establishLink(n.forward,n.backward,t,f,e[s]._indices[d]);else if("changed"==e[s]._type){var c=t[o.relKey];Array.isArray(c)||(c=[c]);for(var p=c.length,u=0;u<p;u++)(f=c[0])&&f.$&&f.$.hasOwnProperty("pK")&&(this.demolishLink(f,a,t,n.forward.relKey),null!=n.backward&&this.demolishLink(t,i,f,n.backward.relKey,n.forward));for(Array.isArray(l)||(l=[l]),d=0;d<l.length;d++){var f;"string"==typeof(f=l[d])&&(f=store.peekRecord(n.forward.relatedTo,f)),f&&f.$&&f.$.hasOwnProperty("pK")&&this.establishLink(n.forward,n.backward,t,f,void 0)}}}},sortBy:function(e,t){var r=store.$.mapBy.call(this,e),o=this.model.fieldList[e];o&&"string"==o.type?(r.sort(),"desc"==t&&r.reverse()):(r.sort((function(e,t){return e-t})),"desc"==t&&r.sort((function(e,t){return t-e})));for(var n=this.slice(0),i=[],a=0;a<r.length;a++)if(null!=r[a]){var s=store.$.getIndex(n,e,r[a]);i.push(n[s]),n.splice(s,1)}return n.length>0&&(i="desc"==t?i.concat(n):n.concat(i)),store.$.defArrUtls(i),store.$.defUtls(i,this.model),i},mapBy:function(e){return this.map((function(t){return t.$.get(e)}))},revertToOldVal:function(e,t,r,o){if(null!=r&&0!=r.length){Array.isArray(r)||(r=[r]);for(var n=0;n<r.length;n++){var i=o.forward.relatedTo,a=store.peekRecord(i,r[n]);this.establishLink(o.forward,o.backward,e,a,void 0)}}},removePartial:function(e,t){var r=e.$.partial;r&&r[t]&&delete r[t]},findCurrentInd:function(e,t){var r,o,n=!1;return e._deleted.forEach((function(e,i){n&&e.index<r&&o--,i==t&&(n=!0,o=r=e.index)})),o},modifyDelInd:function(e,t){var r,o=!1;e._deleted.forEach((function(e,n){o&&e.index>=r&&(e.index=e.index+1),n==t&&(o=!0,r=e.index)}))},rollBackDelete:function(e,t,r,o){var n=[],i=e._name;if(t){var a=e._deleted.get(t),s=e._pK;n=[a]}else e._deleted.forEach((function(e){n.push(e)}));for(var l=this,d=n.length-1;d>=0;d--){var c=(a=n[d]).data,p=e.data._recMap?e.data._recMap.get(c.$.pK):-1!==e.data.indexOf(c);if(Lyte.isRecord(c)){store.$.cmpSet(c.$,"isDeleted",!1),store.$.changePersist(c,!0);var u=store.$.isDuplicateRecord(e,c);if(p)store.$.addDeepNest(c,void 0,"added");else{r?l.handleArrOp(e.data,"insertAt",c,a.index):l.handleArrOp(e.data,"push",c),e.emit("add",[c]),store.emit("add",[e._name,c]);var f=e.relations;if(f)for(var h in f)(f[h]||[]).forEach((function(t){var r,o,n=t.relKey;if(c.hasOwnProperty(n)){o=store.modelFor(t.relatedTo),r=l.getBackwardRel(e,t,o);var i=c[n];Array.isArray(i)?i.forEach((function(e,o){l.establishLink(t,r,c,e,void 0,!0)})):l.establishLink(t,r,c,c[n],void 0,!0)}}))}var y=store.model.cachedQueries;if(y){var v=y[i];if(v&&v.length)for(var m=v.length-1;m>=0;m--)(a=v[m])&&a.hasDeletedRecords&&-1!=a.data[i].indexOf(c)&&delete a.hasDeletedRecords}(c.$.isNew||c.$.isModified)&&this.checkAndAddToArray(e.dirty,c[e._pK]),store.$.clrRecErr(c.$,s,"ERR17"),u||e.data._recMap.set("object"==_typeof(c.$.pK)?c.$.pK:c.$.pK.toString(),c),e._deleted.delete(c.$.pK)}}},rollBackNew:function(e,t,r,o){store.$.removeFromStore(e,t.$.pK,!0,o)},emit:function(e,t,r,o){t.$.emit(e,[t,r,o]),t.$.model.emit(e,[t,r,o]),store.emit(e,[t.$.model._name,t,r,o])},hasRecordsArrayChanged:function(e,t,r){var o=r||e.$.getInitialValues(t),n=!0;if(e.$.model._pK,o&&o.length==e[t].length){n=!1;for(var i=0;i<o.length;i++)if(-1==e[t].indexOf(o[i]))return!0}return n},setRecErr:function(e,t,r,o){store.$.cmpSet(e,"isError",!0);var n=r;"object"==(void 0===n?"undefined":_typeof(n))?store.$.cmpSet(e.error,t,n):("string"==typeof r&&(n=Lyte.errorCodes[r]?{code:r,message:Lyte.errorCodes[r]}:r),store.$.cmpSet(e.error,t,n),o&&store.$.cmpSet(e.error[t],"value",o)),store.$.emit("error",e.record,t,n)},clrRecErr:function(e,t,r){var o=Lyte.objectUtils,n=e.error;if(r)e.error.code==r&&(void 0!==o?o(n,"delete",t):delete n[t]);else if(t)void 0!==o?o(n,"delete",t):delete n[t];else if(void 0!==o)for(var i in n)o(n,"delete",i);else e.error={};0==Object.keys(e.error).length&&store.$.cmpSet(e,"isError",!1)},cacheQuery:function(e,t,r,o){var n=store.model.cachedQueries;(n=(n=store.model.cachedQueries=n||{})[e]=n[e]||[]).push({cacheQuery:t,data:r,status:o})},cacheRecordQuery:function(e,t,r,o,n){var i=store.model.cachedRecordQueries;(i=(i=(i=store.model.cachedRecordQueries=i||{})[e]=i[e]||{})[t]=i[t]||[]).push({cacheQuery:r,data:o,status:n})},isModelDataArray:function(e){if(Array.isArray(e)&&e.model&&e.model instanceof Model&&!e.polymorphic)return!0},handleArrOp:function(e,t,r,o,n){n=null!=n?n:0;var i,a,s=void 0!==Lyte.arrayUtils;if(e.key&&e.record){var l=e.record.$.model.fieldList[e.key],d=!1;l&&l.opts&&l.opts.sort&&(l.opts.sort.sortFn?(a=l.opts.sort.sortFn,l.opts.sort.observes&&(d=!0)):a={sortBy:l.opts.sort.sortBy,sortOrder:l.opts.sort.sortOrder})}switch(t){case"push":this.isModelDataArray(e)&&(null==e._recMap&&store.$.defProp(e,"_recMap",new Map),e._recMap.set("object"==_typeof(r.$.pK)?r.$.pK:r.$.pK.toString(),r)),i=a?s?Lyte.arrayUtils(e,"sort",a,[r]):e.push(r):s?Lyte.arrayUtils(e,t,r):e.push(r),d&&r&&r.$&&(r.$.hasOwnProperty("srtObs")||store.$.defProp(r.$,"srtObs",!0,!1,!0));break;case"removeAt":if(this.isModelDataArray(e))for(var c=n,p=0;p<c;p++){var u=e[o+p]?e[o+p].$.pK:void 0;(u="object"==(void 0===u?"undefined":_typeof(u))?u:u.toString())&&e._recMap&&e._recMap.delete(u)}var f=e[o];d&&f&&f.$&&!store.$.changeRelPkMaps(f,void 0,void 0,"srtObsChk",e.key)&&f.$.hasOwnProperty("srtObs")&&(f.$.srtObs=!1),i=s?Lyte.arrayUtils(e,t,o,n):e.splice(o,n);break;case"insertAt":this.isModelDataArray(e)&&(null==e._recMap&&store.$.defProp(e,"_recMap",new Map),e._recMap.set("object"==_typeof(r.$.pK)?r.$.pK:r.$.pK.toString(),r)),i=a?s?Lyte.arrayUtils(e,"sort",a,[r]):e.splice(o,n,r):s?Lyte.arrayUtils(e,t,o,r):e.splice(o,n,r),d&&r&&r.$&&(r.$.hasOwnProperty("srtObs")||store.$.defProp(r.$,"srtObs",!0,!1,!0));break;case"replaceAt":i=a?s?Lyte.arrayUtils(e,"sort",a,[r]):e.splice(o,n,r):s?Lyte.arrayUtils(e,t,o,r):e.splice(o,n,r),d&&r&&r.$&&(r.$.hasOwnProperty("srtObs")||store.$.defProp(r.$,"srtObs",!0,!1,!0));break;case"sort":i=Lyte.arrayUtils(e,"sort",a);break;default:Lyte.error("LD07",t)}return i},defpayObjUtls:function(e){Object.defineProperties(e,{set:{value:store.$.payloadSet},remove:{value:store.$.payloadRemove}})},defPayArrUtls:function(e){Object.defineProperties(e,{add:{value:store.$.payloadAdd},remove:{value:store.$.payloadRemove}})},defArrUtls:function(e){Object.defineProperties(e,{filterBy:{value:store.$.filterBy},sortBy:{value:store.$.sortBy},mapBy:{value:store.$.mapBy}})},defPolyUtls:function(e){Object.defineProperties(e,{add:{value:store.$.add},remove:{value:store.$.remove}})},defUtls:function(e,t,r,o){t&&store.$.defProp(e,"model",t),r&&store.$.defProp(e,"record",r,!1,!0),o&&store.$.defProp(e,"key",o)},defPar:function(e){store.$.defProp(e,"partial",new Map)},cmpSet:function(e,t,r,o,n){void 0!==Lyte.Component?Lyte.Component.set(e,t,r,o,n):e[t]=r},defProp:function(e,t,r,o,n){o=!!o,n=!!n,Object.defineProperty(e,t,{value:r,enumerable:o,writable:n})},removeChildRecords:function(e,t,r,o){if(!o.get(t)){o.set(t,!0);var n=t?t.$.pK:void 0,i=[];for(var a in i.push(n),e.relations)for(var s=e.relations[a],l=0;l<s.length;l++){var d=s[l].relKey?s[l].relKey:void 0;if(t&&d&&e.fieldList[d]&&"relation"==e.fieldList[d].type&&e.fieldList[d].opts&&e.fieldList[d].opts.inherit&&e.fieldList[d].relKey){var c=store.$.getBackwardRel(e,e.fieldList[d],store.modelFor(e.fieldList[d].relatedTo));if(c&&c.relatedTo==r&&null==c.dummy)continue;if("belongsTo"==e.fieldList[d].relType&&t[e.fieldList[d].relKey])this.removeChildRecords(store.modelFor(e.fieldList[d].relatedTo),t[e.fieldList[d].relKey],e._name,o);else if("hasMany"==e.fieldList[d].relType&&t[e.fieldList[d].relKey])for(var p=0;p<t[e.fieldList[d].relKey].length;p++)this.removeChildRecords(store.modelFor(e.fieldList[d].relatedTo),t[e.fieldList[d].relKey][p],e._name,o)}this.removeFromStore(e,i,!0,!0)}this.removeFromStore(e,i,!0,!0)}},rBinherit:function(e,t){var r=e.record,o=e.model.relations;for(var n in o)for(var i=0;i<o[n].length;i++)if(o[n][i].opts&&o[n][i].opts.inherit&&o[n][i].relatedTo!=e.model._name&&r[o[n][i].relKey])if("belongsTo"===o[n][i].relType)(l=r[o[n][i].relKey])&&!t.get(l)&&(t.set(l,!0),this.rollBackRecord(l.$,{inherit:!0}),store.$.rBinherit(l.$,t));else if("hasMany"===o[n][i].relType){var a=r[o[n][i].relKey].length;if(0!=a)for(var s=0;s<a;s++){var l;(l=r[o[n][i].relKey][s])&&!t.get(l)&&(t.set(l,!0),this.rollBackRecord(l.$,{inherit:!0}),store.$.rBinherit(l.$,t))}}},rollBackRecord:function(e,t){var r=e.model,o=r._pK;e.isModified&&(e.rollBackAttributes(e.getDirtyAttributes(),t),delete e._savedState),e.isDeleted?store.$.rollBackDelete(r,e.get(o),void 0,t):e.isNew?store.$.rollBackNew(r,e.record,o,t):e.isError&&store.$.clrRecErr(e),store.$.removeOnSave(e.model._name,e.record.$.pK)},buildVariables:function(e,t,r,o){for(var n in e=e||{},t){if(-1!=t[n].search(/!/g)&&!e[n]&&!r)return{LdEr:"LD30",LyteError:"ERR30",key:n};-1!=t[n].search(/!/g)&&(t[n]=t[n].replaceAll(/!/g,"")),r&&-1==t[n].search(/\./g)&&("ID"!=t[n]&&"ID!"!=t[n]||(e[n]=r));var i={LdEr:"LD31",LyteError:"ERR30",key:n};if(e&&e[n])switch(t[n]){case"Int":if("number"!=typeof e[n])return i;break;case"String":if("string"!=typeof e[n])return i;break;case"Float":if("number"!=typeof e[n])return i;break;case"Boolean":if("boolean"!=typeof e[n])return i;break;case"Object":if("object"!=_typeof(e[n]))return i}}for(var a in e)"string"!=typeof e[a]&&"object"!=_typeof(e[a])||(e[a]=store.$.LyteStringfy(e[a],""));return e},buildQuery:function(e,t,r,o,n,i,a,s,l,d){var c="",p=!1;for(var u in r)if("object"==_typeof(r[u])){if(c+=Object.keys(r)[0]+" ",a){for(var f in c+="( ",a)if(-1==f.search(/[.]/g)&&""==n)c+=f+":"+a[f]+" ";else if(""!=n&&-1!=f.search(/[.]/s)&&n==f.match(/.*(?=\..*$)/s)[0]){var h=f.split(".");c+=h[h.length-1]+":"+a[f]+" "}c=(c+=") ").replaceAll(/\([ ]*\)/g,"")}c+="{ ";for(var y=0;y<r[u].length;y++){var v=r[u][y];p=!1,l&&(p=!("string"!=typeof v||!l.includes(v)||""!=n)||!("object"!=(void 0===v?"undefined":_typeof(v))||!l.includes(Object.keys(v)[0])||""!=n)),p||("string"==typeof v?c=c+v+" ":(n=(n?n+".":"")+Object.keys(v)[0],c+=store.$.buildQuery(e,t,v,o,n,i,a,s,l,d),n=u==i?"":u))}c+=" } "}return c},QueryCallback:function(e,t,r,o,n,i,a,s,l){var d;if("object"==(void 0===o?"undefined":_typeof(o))){for(var c=Object.keys(o)[0],p=0;p<o[c].length;p++){var u=o[c][p];"object"==(void 0===u?"undefined":_typeof(u))&&store.modelFor(e).fieldList[Object.keys(u)[0]]&&store.modelFor(e).fieldList[Object.keys(u)[0]].relatedTo&&(d=store.modelFor(e).fieldList[Object.keys(u)[0]].relatedTo,store.$.QueryCallback(d,t,r,u,n,i,a,s,l))}var f=store.$.initCB("serializer",e,"serializeSelfQuery",{args:[e,t,l,o,n,i]});if(f){var h=f.data[Object.keys(o)[0]];o[Object.keys(o)[0]]=h}}},buildFields:function(e,t,r,o,n,i){var a=store.modelFor(e),s=a.fieldList,l=a.gql&&a.gql.localAttrs?a.gql.localAttrs:[];i?s=i:n.set(e,!0);var d={},c=[];for(var p in s)if(!l.includes(p)){if("relation"==s[p].type){if(store.modelFor(s[p].relatedTo)&&s[p].relatedTo!=o&&s[p].relatedTo!=e){var u=store.$.getBackwardRel(store.modelFor(e),s[p],store.modelFor(s[p].relatedTo));if(u&&u.relatedTo==t&&null==u.dummy)continue;n.has(s[p].relatedTo)||c.push(store.$.buildFields(s[p].relatedTo,s[p].relatedTo,p,o,n))}continue}"object"==s[p].type&&s[p].properties?c.push(store.$.buildFields(e,t,p,o,n,s[p].properties)):c.push(p)}return d[r]=c,n.delete(e),d},parseQuery:function(e,t,r,o,n,i,a,s,l,d,c){var p,u,f,h,y,v={},m={};"object"==(void 0===i?"undefined":_typeof(i))&&("variables"!=(y=Object.keys(i.query))[0]?y[0]:y[1],u=Object.assign({},i.query.variables),m["variables"!=y[0]?y[0]:y[1]]=Object.assign(i.query["variables"!=y[0]?y[0]:y[1]]),"object"==(void 0===m?"undefined":_typeof(m))&&(h=m));if("string"==typeof i&&-1!=i.search(/[ ]/g)){var _=i,g={};_=(_=(_=(_=(_=(_=(_=(_=(_=(_=(_=(_=(_=(_=(_=_.replaceAll(new RegExp("\n","g")," ")).replaceAll(/ *[ ]*\(/g,":{variables:[")).replaceAll(/ *\) *{/g,"],attrs:[")).replaceAll(/\w+/g,'"$&"')).replaceAll(/"!/g,'!"')).replaceAll(/" +"/g,'", "')).replaceAll(/\S+{"variables"/g,"{$&")).replaceAll(/} *"/g,'}, "')).replaceAll(/" *{/g,'" :{"attrs" :[')).replaceAll(/\} *\}/g,"]}}")).replaceAll(/" *}/g,'"]} }')).replaceAll(/]}}/g,"]}}]}}")).replaceAll(/]}}]}} *}/g,"]}}]}}]}}")).replaceAll(/} *{/g,"},{")).replaceAll(/\S+ *:{"attrs"/g,"{$&"),_=JSON.parse(_),h=store.$.buildQueryFields(_,g,"",Object.keys(_)[0]),u=g}if("object"==(void 0===h?"undefined":_typeof(h))){store.$.QueryCallback(e,r,e,h,a,h,u,o,s),n.query=h,a&&(n.variables=a);var b=Object.keys(u)[0];"Mutation"!=n.type||1!=Object.keys(u).length||"Object"!=u[b]&&"Object!"!=u[b]?n.variables:n.variables[b]=d;var L=store.$.initCB("serializer",e,"serializeGqlQuery",{args:[e,r,t,n,s,d,c]});if(L&&(h=L.data.query,L.data.variables&&(a=L.data.variables)),(f=store.$.buildVariables(a,u,t,s.type))&&f.LdEr)return f;s.gqlObj=n,p="{ "+(p=store.$.buildQuery(e,r,h,u,"",Object.keys(h)[0],0!=Object.keys(f).length?f:void 0,t,l,e))+" }"}return"Query"==n.type?v.query=p:v.query="mutation "+p,v},graphQlconfig:function(e,t,r,o,n,i,a,s,l){var d,c,p={},u=store.modelFor(e),f={},h=new Map,y=u.gql&&u.gql.localAttrs?u.gql.localAttrs:[];if("findAll"==r||"findRecord"==r){if(f.type="Query",void 0===(c=u.gql&&u.gql.query&&u.gql.query[n]?u.gql.query[n]:n)){var v=store.$.buildFields(e,null,e,e,h);(d={}).query=v,f.queryType="default"}else if("string"==typeof n&&-1!=n.search(/[ ]/g))d=n,f.queryType="query";else if("object"==(void 0===n?"undefined":_typeof(n)))d=n;else if("object"==(void 0===c?"undefined":_typeof(c)))d=c;else{if("string"!=typeof c||-1==c.search(/[ ]/g))return{LdEr:"LD32",LyteError:"ERR31",key:n};d=c,f.queryType="namedQuery",f.queryName=n}i=i?Object.assign({},i):void 0}else if(f.type="Mutation",c=u.gql&&u.gql.mutation&&u.gql.mutation[n]?u.gql.mutation[n]:n,"string"==typeof n&&-1!=n.search(/[ ]/g))d=n,f.mutationType="customMutation";else{if("string"!=typeof c||-1==c.search(/[ ]/g))return{LdEr:"LD32",LyteError:"ERR31",key:n};d=c,f.mutationType="namedMutation",f.MutationName=n}var m=store.$.parseQuery(e,t,r,o,f,d,i,a,y,s,l);return m.LdEr?m:(p.data=JSON.stringify(m),p.data)},setQuery:function(e,t,r,o){var n=e;n.gql?(n.gql[r]=n.gql[r]?n.gql[r]:{},n.gql[r][t]=n.gql[r][t]?n.gql[r][t]:{}):(n.gql={},n.gql[r]={},n.gql[r][t]={}),n.gql[r][t]=o},buildQueryFields:function(e,t,r,o){var n=Object.keys(e)[0],i=[],a={};if(e[n].variables)for(var s=0;s<e[n].variables.length;s+=2)t[(r?r+".":"")+e[n].variables[s]]=e[n].variables[s+1];for(var l=0;l<e[n].attrs.length;l++)"object"==_typeof(e[n].attrs[l])?(r=(r?r+".":"")+Object.keys(e[n].attrs[l])[0],i.push(this.buildQueryFields(e[n].attrs[l],t,r,o)),r=n!=o?n:""):i.push(e[n].attrs[l]);return a[n]=i,a},LyteStringfy:function(e,t,r){if("string"==typeof e)return'"'+e+'" ';if(Array.isArray(e)){t+="[";var o=0,n=e.length;e.forEach((function(r){o++,"string"==typeof r?t=t+'"'+r+'" ':"object"==(void 0===r?"undefined":_typeof(r))?t=store.$.LyteStringfy(r,t):"number"==typeof r&&(t+=e.toString()),t=o!=n?t+",":t})),t+="]"}else{if(!e||Array.isArray(e)||"object"!=(void 0===e?"undefined":_typeof(e)))return e.toString();t+="{";var i=0;for(var o in e)i++,"string"==typeof e[o]?t=t+o+' : "'+e[o]+'" ':"object"==_typeof(e[o])?(t=t+o+" : ",t=store.$.LyteStringfy(e[o],t)):t=t+o+" : "+e[o].toString(),Object.keys(e).length!=i&&(t+=", ");t+="}"}return t},cpdGql:function(e,t,r,o,n,i){o.gql&&("object"==_typeof(o.gql)?mutName=o.gql.mutation:1==o.gql&&(mutName=void 0),o.data=store.$.graphQlconfig(e,void 0,t,r,mutName,[],o,n,i))},payloadAdd:function(e,t){Array.isArray(e)||(e=[e]);for(var r=this._model,o=this._partialObj,n=this._payloadObj,i=0;i<e.length;i++){var a=store.peekRecord(r,e[i]),s={};store.$.defProp(s,"$",{});var l=s.$;Object.defineProperties(l,{pkVal:{value:a.$.pK},type:{value:"related"},model:{value:r},record:{value:a}});var d="object"==_typeof(a.$.pK)?a.$.pK:_defineProperty({},a.$.model._pK,a.$.pK);if(t?(Lyte.arrayUtils(o,"insertAt",t,s),Lyte.arrayUtils(n,"insertAt",t,_pK),t=t++):(Lyte.arrayUtils(o,"push",s),Lyte.arrayUtils(n,"push",d)),store.$.defProp(d,"$",{}),store.$.defpayObjUtls(d.$),Object.defineProperties(d.$,{_pkVal:{value:a.$.pK},_model:{value:r},_partialObj:{value:s},_payloadObj:{value:d}}),this._serialize&&"record"===this._serialize){var c=store.modelFor(r).fieldList;for(var p in c)"relation"!=c[p].type&&a[p]&&(d[p]=a[p])}}},payloadRemove:function(e){var t=this._model,r=this._partialObj,o=this._payloadObj;Array.isArray(e)||(e=[e]);for(var n=0;n<e.length;n++)if(Array.isArray(o)){store.peekRecord(t,e[n]);var i=o.length;if(this._serialize&&"id"==this._serialize){if(o.includes(e[n])){var a=o.indexOf(e[n]);o.splice(a,1)}}else for(var s=0;s<i;s++)r[s]&&r[s].$.pkVal==e&&(Lyte.arrayUtils(r,"removeAt",s,1),Lyte.arrayUtils(o,"removeAt",s,1))}else o[e]&&r[e]&&(Lyte.objectUtils(o,"delete",e[n]),Lyte.objectUtils(r,"delete",e[n]))},payloadSet:function(e){Array.isArray(e)||(e=[e]);var t=this._model,r=this._pkVal,o=store.modelFor(t),n=this._payloadObj,a=store.peekRecord(t,r),s=this._partialObj;for(i_key=0;i_key<e.length;i_key++){var l=e[i_key],d=o.fieldList[l];if(a[l]&&"relation"==d.type){if("hasMany"==d.relType){if(s[l]=[],n[l]=[],d.opts&&"id"==d.opts.serialize&&store.$.payLoadIdSerialize(n,l,a,o,d,s),store.$.defProp(n[l],"$",{}),store.$.defPayArrUtls(n[l].$),Object.defineProperties(n[l].$,{_key:{value:d.relKey},_partialObj:{value:s[l]},_model:{value:d.relatedTo},_payloadObj:{value:n[l]}}),d.opts&&d.opts.serialize&&!n[l].$.serialize&&Object.defineProperty(n[l].$,"_serialize",{value:d.opts.serialize}),d.opts&&"id"!=d.opts.serialize||!d.opts)for(i=0;i<a[l].length;i++)n[l].$.add(a[l][i].$.pK)}else if(s[l]={},n[l]={},store.$.PayloadSerialize(d,n,a,l,o,s),"object"==_typeof(n[l])){store.$.defProp(s[l],"$",{});var c=s[l].$;Object.defineProperties(c,{pkVal:{value:a.$.pK},type:{value:"related"},model:{value:t},record:{value:a[l]}}),store.$.defProp(n[l],"$",{}),Object.defineProperties(n[l].$,{_pkVal:{value:a[l].$.pK},_model:{value:d.relatedTo},_partialObj:{value:s[l]},_payloadObj:{value:n[l]}}),store.$.defpayObjUtls(n[l].$)}}else n[l]=a[l],s[l]=a[l]}},payLoadIdSerialize:function(e,t,r,o,n,i){var a={};e[t]=Lyte.deepCopyObject(r[t]),store.$.getRelations(o,t,store.modelFor(n.relatedTo),a),store.$.idSerialize(e,a,void 0,i)},PayloadSerialize:function(e,t,r,o,n,i){if(t[o]="object"==_typeof(r[o].$.pK)?r[o].$.pK:_defineProperty({},r[o].$.model._pK,r[o].$.pK),e.opts&&e.opts.serialize){if("record"==e.opts.serialize){var a=n.fieldList;for(var s in a)"relation"!=a[s].type&&r[s]&&(t[s]=r[s])}"id"==e.opts.serialize&&store.$.payLoadIdSerialize(t,o,r,n,e,i)}},replaceCheck:function(e){store.$.defProp(this._partialObj,"replace",e)}}};function Adapter(e,t,r){Object.defineProperty(this,"$lg",{value:Lyte.__gl}),store.$.newCB("adapter",this,r,e,t)}function Serializer(e,t,r){Object.defineProperty(this,"$lg",{value:Lyte.__gl}),store.$.newCB("serializer",this,r,e,t)}store.$.cbDef(Adapter,"adapter"),store.adapter={$:{buildURL:function(e,t,r,o,n,i,a,s,l,d){var c=store.adapter[r],p=store.$.getFromCB("adapter",r,"host"),u=(l=l||"",store.$.makeBatch);if(!l){u||void 0!==p&&(l+=p,"/"!=p[p.length-1]&&(l+="/"));var f={};if(d){f.method="POST",f.gql=d,t=f.method,l+=store.$.getFromCB("adapter",r,"gqlNamespace")||""}else{var h=store.$.getFromCB("adapter",r,"namespace");if(""!==h&&"/"!=h[h.length-1]?l+=h+"/":l+=h,"batch"!=e&&(l+=r,o&&"object"!=(void 0===o?"undefined":_typeof(o))&&(l+="/"+o)),"action"==e){l+="/"+store.$.getFromCB("adapter",r,"actionNamespace");var y=store.modelFor(r).actions;l+="/"+(y[a].endPoint?y[a].endPoint:a)}else"batch"==e&&(l+=store.$.getFromCB("adapter","application","batchNamespace"));f.method=t||""}}if(i||(i={}),(_=store.$.initCB("adapter",r,"headersForRequest",{args:[e,i,s,a,o]}))&&(f.headers=_.data),(_=store.$.initCB("adapter",r,"buildURL",{args:[r,e,i,n,l,a,s,o]}))&&(l=_.data),(_=store.$.initCB("adapter",r,"methodForRequest",{args:[t,e,i,s,a,o]}))&&(f.method=_.data),!u&&i&&Object.keys(i).length){l+="?";var v=0;for(var m in i){var _;0!==v&&(l+="&"),(_=i[m])&&"object"==(void 0===_?"undefined":_typeof(_))&&(_=JSON.stringify(_)),l+=m+"="+encodeURIComponent(_),v++}}return c&&1==c.withCredentials&&(f.withCredentials=!0),f.url=l,f.qP=i,f},get:function(e,t,r,o,n,i,a,s,l){var d,c=store.modelFor(t),p=store.$.makeBatch,u=l||s?{}:void 0;if(c){i=null==i?store.$.getFromCB("adapter",t,"customData"):i,s&&(u.query=s),l&&(u.variables=l),d=store.$.initCB("adapter",t,"gql",{args:[t,e,o,r,u,i]});var f=this.buildURL(e,"GET",t,r,void 0,o,void 0,i,void 0,d?d.data:void 0),h=this;if(o=f.qP,toCheckParams=n&&"boolean"!=typeof n?n:o&&"object"==(void 0===o?"undefined":_typeof(o))?o:void 0,f.gql&&("object"==_typeof(f.gql)?(s=f.gql.query,l=f.gql.variables):!0===f.gql&&(s=l=void 0),f.data=store.$.graphQlconfig(t,r,e,o,s,l,f),f.data.LdEr))return Lyte.warn(f.data.LdEr,f.data.key,t),Promise.reject({code:f.data.LyteError,message:Lyte.errorCodes[f.data.LyteError],data:f.data.key});if("findAll"==e&&toCheckParams&&store.model.cachedQueries&&store.model.cachedQueries[t]){for(var y=store.model.cachedQueries[t],v=0;v<y.length;v++){var m=y[v];if(!m.hasDeletedRecords){var _=m.cacheQuery;if(this.compareData(_,toCheckParams,!0)){g=[m.data,"cache",void 0,m.status];break}}}if(g)return new Promise((function(e){p&&store.$.addToCachedBatch(Array.isArray(g)?g[0][t]:g),e(g)}))}else if("findRecord"==e&&toCheckParams&&store.model.cachedRecordQueries&&store.model.cachedRecordQueries[t]&&store.model.cachedRecordQueries[t][r]){var g;for(y=store.model.cachedRecordQueries[t][r],v=0;v<y.length;v++)if(_=y[v].cacheQuery,this.compareData(_,toCheckParams,!0)){g=[y[v].data,"cache",void 0,y[v].status];break}if(g)return new Promise((function(e){p&&store.$.addToCachedBatch(Array.isArray(g)?g[0][t]:g),e(g)}))}else{var b=store.$.cbScp(t,"findRecord"==e?"reloadRecord":"reloadAll","adapter");if(b){var L,A=!1;if("findRecord"==e?(L=store.peekRecord(t,r),A=!!Lyte.isRecord(L)):"findAll"==e&&(A=!!(L=store.peekAll(t)).length),A&&!store.$.cB(b,[L,o,i,t])){var $={};return $[t]=L,new Promise((function(e){p&&store.$.addToCachedBatch($[t]),e([$,"cache"],"success",void 0,!0)}))}}}if("POST"==f.method){var E=store.$.initCB("serializer",t,"serialize",{args:[e,f?f.data:void 0,void 0,i,t,o,void 0,f?f.gqlObj:void 0]});E&&(f.data=E.data,!f.data||"object"!=_typeof(f.data)&&!Lyte.isRecord(f.data)&&!Array.isArray(f.data)||f.data instanceof FormData||(f.data=JSON.stringify(f.data)))}return new Promise((function(s,l){var d,c=store.modelFor(t),u=store.$.getIDBObj(c,o,e,r,i),y=store.$.getFromCB("adapter",t,"processRequest"),v=!0,m=!1,_=[t,e,r,f,s,l,"get",void 0,i],g={cacheQuery:n,cacheData:a,customD:i};if(y){v=!1;var b=h.callGeneric(e,t,void 0,void 0,i,o,r,f.url,void 0,f.method,f.headers);b instanceof Promise?(m=!0,b.then((function(o){o=""==o?JSON.parse("{}"):JSON.parse(o),d=h.getResponse(o,t,e,r,f,void 0,i,g),s([d])}),(function(e){l(e)}))):v=!0}p&&!m?store.adapter.$.constructBatch.apply(store.adapter.$,_).then((function(o){var n=o.content;store.adapter.$.getSuccess(t,e,r,f,void 0,s,l,n,o,void 0,g)}),(function(o){store.adapter.$.getFailure(t,e,r,f,void 0,s,l,g,o.content,o.code,o)})):u?store.adapter.$.getFromIDB(u,t,e,o,r,f,i).then((function(n){var i=store.$.initCB("serializer",t,"idbResponse",{args:[t,e,o,r,n]});i&&(n=i.data),0==n?store.adapter.$.sendXHR.apply(store.adapter.$,_).then((function(o){store.adapter.$.getSuccess(t,e,r,f,o,s,l,void 0,void 0,void 0,g)}),(function(o){store.adapter.$.getFailure(t,e,r,f,o,s,l,g)})):store.adapter.$.getSuccess(t,e,r,f,void 0,s,l,n,void 0,"idb",g)}),(function(o){store.adapter.$.sendXHR.apply(store.adapter.$,_).then((function(o){store.adapter.$.getSuccess(t,e,r,f,o,s,l,void 0,void 0,void 0,g)}),(function(o){store.adapter.$.getFailure(t,e,r,f,o,s,l,g)}))})):v&&store.adapter.$.sendXHR.apply(store.adapter.$,_).then((function(o){store.adapter.$.getSuccess(t,e,r,f,o,s,l,void 0,void 0,void 0,g)}),(function(o){store.adapter.$.getFailure(t,e,r,f,o,s,l,g)}))}))}return Lyte.warn("LD02","Model",t),Promise.reject({code:"ERR19",message:Lyte.errorCodes.ERR19,data:t})},constructBatch:function(e,t,r,o){return new Promise((function(e,t){var r=store.$.currentBatch,n=store.$.batch[r]=store.$.batch[r]||[],i=store.$.batchPromise[r]=store.$.batchPromise[r]||[],a={};a.method=o.method,a.uri="/"+o.url,a.parameters=o.qP,a.content="string"==typeof o.data?JSON.parse(o.data):void 0,n.push(a),i.push({resolve:e,reject:t})}))},getFromIDB:function(e,t,r,o,n,i,a){return new Promise((function(i,s){var l=e.queryCache?"getCachedData":"findAll"==r?"getAll":"get",d={resolve:i,reject:s,type:l,model:t,req:r,key:n};"getCachedData"==l&&(d.queryParams=o),d.queryCache=e.queryCache,d.customData=a,LyteIDB.postMessage(d)}))},sendXHR:function(e,t,r,o,n,i,a,s,l){var d=new XMLHttpRequest,c=new Promise((function(n,i){for(var a in d.open(o.method,o.url,!0),o.headers)d.setRequestHeader(a,o.headers[a]);d.withCredentials=!!o.withCredentials,store.$.initCB("adapter",e,"parseRequest",{args:[t,e,d,o?o.qP:void 0,r,l]}),store.emit("beforeRequest",[d,e,t,r,o.qP]),d.send(o.data),d.onreadystatechange=function(){if(4==d.readyState)return store.emit("afterRequest",[d,e,t,r,o.qP]),"2"==d.status.toString()[0]||"3"==d.status.toString()[0]?n(d):i(d)}}));return c.xhr=d,c},getSuccess:function(e,t,r,o,n,i,a,s,l,d,c){var p,u,f=s,h=n,y=c.customD;if(n&&n.status,"idb"!=d){if(h&&(f=(f=h.responseText)&&0!=f.length?JSON.parse(f):JSON.parse("{}")),l&&(p=l.index,u=l.batch,h=l.resp),h){var v=store.$.initCB("adapter",e,"parseResponse",{args:[t,e,h,f,o?o.qP:void 0,r,y,c]});if(v&&(f=v.data),f instanceof Promise)return this.handleParseResponsePromise(f,e,t,r,o,n,void 0,p,u,i,a,c)}return this.findParseRequestPromise(f,e,t,r,o,n,p,u,i,c)}i(n?[f,n.statusText,n]:null!=p?[f,"batch",{index:p,batch:u}]:d?[f,"idb"]:[f])},getFailure:function(e,t,r,o,n,i,a,s,l,d,c){var p=s.customD;if(n){var u,f=n.responseText;if(f)try{f=""==f?JSON.parse("{}"):JSON.parse(f)}catch(e){Lyte.warn("LD24",e)}u=f;var h=store.$.initCB("adapter",e,"parseResponse",{args:[t,e,n,f,o?o.qP:void 0,r,p,s]});if(h&&(u=h.data),u instanceof Promise)return this.handleParseResponsePromise(u,e,t,r,o,n,void 0,void 0,void 0,i,a,s)}else if(l){var y,v;c&&(v=c.index,y=c.batch),store.$.batchResponse[y][v]={code:d,status:"requestFailure",data:l},a({code:d,status:"requestFailure",data:l})}a(n)},getResponse:function(e,t,r,o,n,i,a,s){if(!0===(void 0===s.cacheData||null===s.cacheData||"object"!=_typeof(s.cacheData)||!s.cacheData.hasOwnProperty("normalize")||s.cacheData.normalize)){var l,d,c,p,u=e=store.serializer.$.normalizeResponse(t,r,e,o,i?i.status:i,n,a,s),f=n?n.qP:void 0;"object"!=(void 0===u?"undefined":_typeof(u))&&(u=JSON.parse(u)),(c=store.$.initCB("serializer",t,"extractMeta",{args:[u,t,r,f,a,s]}))&&(p=c.data,store.$.isEmpty(p)||(u.meta=p));var h=Object.keys(u),y=h.length;if(y){var v;if((c=store.$.initCB("serializer",t,"payloadKey",{args:[t,r,o,f,a,s]}))&&(v=c.data)&&v!=t){var m=u[v];u[t]=m,delete u[v]}if(l=store.$.cbScp(t,"deserializeKey","serializer")){Lyte.warn("LD08","deserializeKey","callback","Please use payloadKey callback instead"),y>2&&Lyte.error("LD09");var _=0;2==y&&"meta"==h[0]&&(_=1),d=[t,r];var g=store.$.cB(l,d),b=u[h[_]];delete u[h[_]],u[g]=b}store.serializer.$.normalize(t,r,u,o,i?i.status:i,n.headers,a,s,n)}return u}return"object"!=(void 0===e?"undefined":_typeof(e))&&(e=JSON.parse(e)),(c=store.$.initCB("serializer",t,"extractMeta",{args:[e,t,r,f,a,s]}))&&(p=c.data,store.$.isEmpty(p)||(e.meta=p)),e},initPartialObj:function(e,t,r,o,n,i){return{obj:new Map}},create:function(e,t,r,o,n,i){var a=r?"createRecord":"create",s=i?{mutation:i}:void 0,l=store.$.initCB("adapter",e,"gql",{args:[e,a,n,void 0,s,o]});o=null==o?store.$.getFromCB("adapter",e,"customData"):o;var d=this.buildURL(a,"POST",e,void 0,t,n,void 0,o,void 0,l?l.data:void 0);n=d.qP;var c=this.initPartialObj(e,a,n,void 0,d.url,o),p=store.$.toJSON(e,t,void 0,"create",c);return this.sendingData(e,p,d,a,o,t,c.obj),d.gql&&store.$.cpdGql(e,a,n,d,p,o),this.handleRequest(d,e,t,a,p,o,c.obj,void 0,void 0,c.ref)},put:function(e,t,r,o,n,i,a){var s=store.model[e],l=s.bK,d=s.isComp,c=a?{mutation:a}:void 0,p=o?"updateRecord":"update",u=(new Map,o?d&&l?r[l]:r.$.pK:void 0),f=store.$.initCB("adapter",e,"gql",{args:[e,p,i,void 0,c,n]});n=null==n?store.$.getFromCB("adapter",e,"customData"):n;var h=this.buildURL(p,"PATCH",e,u,t,i,void 0,n,void 0,f?f.data:void 0);i=h.qP;var y=this.initPartialObj(e,p,i,u,h.url,n),v=store.$.toJSON(e,t,void 0,void 0,y);return this.sendingData(e,v,h,p,n,r,y.obj),h.gql&&store.$.cpdGql(e,p,i,h,v,n),this.handleRequest(h,e,r,p,v,n,y.obj,void 0,void 0,y.ref)},del:function(e,t,r,o,n,i,a){var s=store.model[e],l=s.bK,d=s.isComp,c=a?{mutation:a}:void 0,p=o||"deleteRecord",u=r?d&&l?t[l]:t.$.pK:void 0;n=null==n?store.$.getFromCB("adapter",e,"customData"):n;var f=store.$.initCB("adapter",e,"gql",{args:[e,p,i,void 0,c,n]}),h=this.buildURL(p,"DELETE",e,u,t,i,void 0,n,void 0,f?f.data:void 0);i=h.qP,this.initPartialObj(e,p,i,u,h.url,n);var y=[];r||(y=t.map((function(e){return e.$.pK})));var v=r?t?t.$.pK:void 0:y;return this.sendingData(e,v,h,p,n,t),h.gql&&store.$.cpdGql(e,p,i,h,v,n),this.handleRequest(h,e,t,p,v,n,void 0,u)},sendingData:function(e,t,r,o,n,i,a){var s,l=e,d={},c=r?r.qP:void 0,p={};for(var u in r)p[u]=r[u];p.type=o,p.model=e,(s=store.$.initCB("serializer",e,"serializeKey",{args:[e,o,n,c]}))&&(l=s.data),t=this.serializeRecords(e,t,i,p,"serializeRecord",n,a),l?(Array.isArray(t)||"object"==(void 0===t?"undefined":_typeof(t))||Lyte.isRecord(t))&&(d[l]=t):d=t,(s=store.$.initCB("serializer",e,"serialize",{args:[o,d,i,n,e,c,r?r.gqlObj:void 0]}))&&(d=s.data),r.data=d},serializeRecords:function(e,t,r,o,n,i,a){var s=store.modelFor(e);if(!s)return t;var l,d=s.relations;if(r||"normalizeRecord"==n||(r=store.peekRecord(s._name,t.$.pK)),Array.isArray(t)){l=[];for(var c=0;c<t.length;c++){var p=t[c];p&&"object"===(void 0===p?"undefined":_typeof(p))?l.push(this.serializeSingleRecord(s._name,p,r?r[c]:void 0,o,d,n,i,a)):l.push(p)}}else t&&(l=t,"object"===(void 0===t?"undefined":_typeof(t))&&(l=this.serializeSingleRecord(s._name,t,r,o,d,n,i,a)));return l},serializeSingleRecord:function(e,t,r,o,n,i,a,s){var l,d;("serializeRecord"==i&&"object"==(void 0===t?"undefined":_typeof(t))&&null==t.$&&store.$.defProp(t,"$",{}),"object"==(void 0===s?"undefined":_typeof(s))&&r&&r.$&&r.$.pK)&&(l=s.get?s.get(r.$.pK):s,t.$&&t.$._partialObj&&(d=Object.assign({},t.$),t=Object.assign({},t),store.$.defProp(t,"$",d)),Object.defineProperties(t.$,{_partialObj:{value:l},_pkVal:{value:r.$.pK},_model:{value:e},_payloadObj:{value:t}}));"serializeRecord"==i&&store.$.defpayObjUtls(t.$);var c,p=store.$.cbScp(e,i,"serializer");for(var u in p&&(c="serializeRecord"==i?[o,t,r,e,a]:[o,t,e,a],t=store.$.cB(p,c)),n)for(var f=n[u],h=f.length,y=0;y<h;y++){var v,m,_,g,b=f[y],L=t[b.relKey];if("relation"==b.type&&L&&("normalizeRecord"==i||"serializeRecord"==i&&b.opts&&b.opts.serialize&&"id"!=b.opts.serialize))if(v=r?r[b.relKey]:void 0,m=b.relatedTo,_=b.opts?b.opts.serialize:void 0,g=b.opts?b.opts.polymorphic:void 0,"hasMany"===b.relType){Array.isArray(L)||(L=[L]);var A=L.length,$=[];"serializeRecord"==i&&(store.$.defProp($,"$",{}),store.$.defPayArrUtls($.$),l&&l[b.relKey]&&(Object.defineProperties($.$,{_key:{value:b.relKey},_partialObj:{value:l[b.relKey]},_model:{value:m},_payloadObj:{value:$}}),b.opts&&b.opts.serialize&&Object.defineProperty($.$,"_serialize",{value:b.opts.serialize})));for(var E=0;E<A;E++){var T=m;g&&("normalizeRecord"==i?T=L[E]&&L[E]._type?L[E]._type:m:"serializeRecord"==i&&("record"==_?T=v&&Lyte.isRecord(v[E])?v[E].$.model._name:m:"partial"==_&&(T=L[E]&&L[E].$?L[E].$.polymorphicType:m))),$.push(this.serializeRecords(T,L[E],void 0,o,i,a,l?l[b.relKey][E]:void 0))}t[b.relKey]=$}else T=m,g&&("normalizeRecord"==i?T=t[b.relKey]&&t[b.relKey]._type?t[b.relKey]._type:m:"serializeRecord"==i&&(T=Lyte.isRecord(r[b.relKey])?r[b.relKey].$.model._name:m)),t[b.relKey]=this.serializeRecords(T,t[b.relKey],r?r[b.relKey]:void 0,o,i,a,l?l[b.relKey]:void 0)}return t},handleAction:function(e,t,r,o,n,i,a){var s;r&&Lyte.isRecord(r)&&(s=r.$.get(t._pK));var l=t._name;o=null==o?store.$.getFromCB("adapter",t._name,"customData"):o;var d=this.buildURL("action",i||"POST",t._name,s,r,n,e,o);d.data=a,n=d.qP;var c=store.$.initCB("serializer",t._name,"serialize",{args:["action",a,r,o,l,n,e]});return c&&(d.data=c.data),this.handleRequest(d,t._name,void 0,"action",void 0,o,void 0,void 0,e)},handleRequest:function(e,t,r,o,n,i,a,s,l,d){if(e.data&&e.data.LdEr)return Lyte.warn(e.data.LdEr,e.data.key,t),Promise.reject({code:e.data.LyteError,message:Lyte.errorCodes[e.data.LyteError],data:e.data.key});!e.data||"object"!=_typeof(e.data)&&!Lyte.isRecord(e.data)&&!Array.isArray(e.data)||e.data instanceof FormData||(e.data=JSON.stringify(e.data));var c=this;return new Promise((function(n,p){var u=store.$.getFromCB("adapter",t,"processRequest"),f=!0,h=store.$.makeBatch,y=!1;if(u){f=!1;var v,m=c.callGeneric(o,t,e.data,r,i,e?e.qP:void 0,s,e.url,l,e.method,e.headers);m instanceof Promise?(y=!0,m.then((function(s){s=""==s?JSON.parse("{}"):JSON.parse(s),v=c.genericResponse(s,t,o,r,e,void 0,a,i),n(v)}),(function(e){p(e)}))):f=!0}if(h&&!y)store.adapter.$.constructBatch(t,o,s,e).then((function(a){var c=a.content;store.adapter.$.handleSuccess(t,o,void 0,r,e,n,c,a,void 0,p,s,i,l,d)}),(function(a){store.adapter.$.handleFailure(t,o,void 0,r,e,n,a.content,void 0,p,s,i,a.code,l,a)}));else if(f){var _=[t,o,s,e,n,p,"other",r,i];store.adapter.$.sendXHR.apply(store.adapter.$,_).then((function(c){store.adapter.$.handleSuccess(t,o,c,r,e,n,void 0,void 0,a,p,s,i,l,d)}),(function(d){store.adapter.$.handleFailure(t,o,d,r,e,n,void 0,a,p,s,i,void 0,l)}))}}))},handleSuccess:function(e,t,r,o,n,i,a,s,l,d,c,p,u,f){var h,y,v,m=r?r.responseText:void 0;if(r&&r.status,a)m=a;else if(m&&0!=m.length)if("action"==t)try{a=JSON.parse(m)}catch(e){a=m}else a=JSON.parse(m);else a=JSON.parse("{}");r&&(h=r),s&&(y=s.index,v=s.batch,h=s.resp);var _={customD:p};if(h){var g=store.$.initCB("adapter",e,"parseResponse",{args:[t,e,h,a,n?n.qP:void 0,c,p,void 0,u]});if(g&&(a=g.data)instanceof Promise)return this.handleParseResponsePromise(a,e,t,o,n,r,l,y,v,i,d,_)}return this.otherParseRequestPromise(a,e,t,o,n,r,l,y,v,i,d,p,f,c)},handleFailure:function(e,t,r,o,n,i,a,s,l,d,c,p,u,f){if(r){store.$.cbScp(e,"parseResponse","adapter");var h,y=r.responseText;if(y)try{y=""==y?JSON.parse("{}"):JSON.parse(y)}catch(e){Lyte.warn("LD24",e)}var v=store.$.initCB("adapter",e,"parseResponse",{args:[t,e,r,y,n?n.qP:void 0,d,c,void 0,u]});if(v&&(h=v.data)instanceof Promise)return this.handleParseResponsePromise(h,e,t,o,n,r,s,void 0,void 0,i,l,c)}else if(a){var m,_;f&&(_=f.index,m=f.batch),store.$.batchResponse[m][_]={code:p,status:"requestFailure",data:a},l({code:p,status:"requestFailure",data:a})}l(r)},updateIDB:function(e,t,r,o,n,i){r&&!Array.isArray(r)&&(r=[r]);var a=store.model[e],s=store.$.getIDBObj(a,n&&n.qP?n.qP:void 0,t,i,o);if(a&&s&&(!s||s.hasOwnProperty("queryCache"))){var l=store.$.idbQ2[e]=store.$.idbQ2[e]||[],d=s.queryCache;if(r)switch(t){case"update":case"updateRecord":r.forEach((function(t,r){if(t&&Lyte.isRecord(t)){var n=store.model[e].relations;t.$.inIDB&&t.$.inIDB.self&&l.push({type:"updateRecord",model:e,data:t.$.toJSON("idb"),queryCache:d,customData:o}),store.adapter.$.updateRelationsIDB(t,n,o),store.$.addToIDBonSave(e,t)}}));break;case"delete":case"deleteRecord":case"destroyRecord":var c=store.modelFor(e)._arrPk;r.forEach((function(t,r){if(t&&Lyte.isRecord(t)){var n=store.model[e].relations;t.$.parent;for(var i={},a=0;a<c.length;a++)i[c[a]]=t[c[a]];t.$.inIDB&&t.$.inIDB.self&&l.push({type:"deleteRecord",model:e,key:i,queryCache:d,customData:o}),store.adapter.$.updateRelationsIDB(t,n,o),store.$.removeOnSave(e,t.$.pK)}}));break;case"create":case"createRecord":r.forEach((function(t,r){if(t&&Lyte.isRecord(t)){var n=store.model[e].relations;l.push({type:"createRecord",model:e,data:t.$.toJSON("idb"),queryCache:d,customData:o}),store.adapter.$.updateRelationsIDB(t,n,o,"create"),store.$.addToIDBonSave(e,t)}}))}}else r.forEach((function(r,n){r&&Lyte.isRecord(r)&&store.adapter.$.updateRelationsIDB(r,store.model[e].relations,o,t)}))},updateRelationsIDB:function(e,t,r,o){switch(o){case"create":case"createRecord":for(var n in t)t[n].forEach((function(t){var o,n=t.relKey,i=t.relatedTo;store.$.idbQ2[i]=store.$.idbQ2[i]||[],e.$.inIDB,(o=t.dummy?store.$.getRelatedRecord(e,t.relatedTo,t.dummy):e[n])&&!Array.isArray(o)&&(o=[o]),o&&o.forEach((function(e){var t=e.$.model,o=store.$.idbQ2[t._name]=store.$.idbQ2[t._name]||[];for(var n in e.$.inIDB.self&&o.push({type:"updateRecord",model:t._name,data:e.$.toJSON("idb"),customData:r}),e.$.inIDB){var i=e.$.inIDB[n],a=store.$.idbQ2[n]=store.$.idbQ2[n]||[];i.forEach((function(e,t){a.push({type:"updateRecord",model:n,data:store.peekRecord(n,t).$.toJSON("idb"),customData:r})}))}}))}));break;default:var i=e.$.inIDB;if(i)for(mKey in i)i[mKey].forEach((function(e,t){var o=store.peekRecord(mKey,t);(store.$.idbQ2[mKey]=store.$.idbQ2[mKey]||[]).push({type:"updateRecord",model:mKey,data:o.$.toJSON("idb"),customData:r})}))}},callGeneric:function(e,t,r,o,n,i,a,s,l,d,c){var p=store.$.initCB("adapter",t,"processRequest",{args:[e,t,r,o,n,i,a,s,l,d,c]});return p?p.data:void 0},genericResponse:function(e,t,r,o,n,i,a,s,l){var d,c,p=e,u=(i&&i.status,n?n.qP:void 0);if(d=store.$.cbScp(t,"extractMeta","serializer"))if(p){var f=store.$.cB(d,[p,t,r,u,s]);store.$.isEmpty(f)||(p.meta=f),c=!0}else c=!1;if(p&&"action"!=r&&"ajax"!=r){p=store.serializer.$.buildJSON(t,r,p,Lyte.isRecord(o)?o[store.modelFor(t)._pK]:void 0,i?i.status:void 0,n,s,u),0==c&&d&&p&&(f=store.$.cB(d,[p,t,r,u,s]),store.$.isEmpty(f)||(p.meta=f));var h=Object.keys(p),y=h.length;if(d=store.$.cbScp(t,"deserializeKey","serializer")){Lyte.warn("LD08","deserializeKey","callback","Please use payloadKey callback instead"),y>2&&Lyte.error("LD09");var v=0;"meta"==h[0]&&(v=1);var m=store.$.cB(d,[t,r]),_=p[h[v]];delete p[h[v]],p[m]=_}this.handleResponse(o,p,store.modelFor(t),r,a,void 0,l)}return p},removePartialKeys:function(e,t,r){var o=t.relations,n=e.$.pK;for(var i in o)o[i].forEach((function(r){var o;if(bMod=store.model[r.relatedTo],bMod&&(o=store.$.getBackwardRel(t,r,bMod))&&"hasMany"==o.relType&&o.opts&&o.opts.serialize){var i=r.relKey,a=o.relKey,s=e[i];if(s)if(Array.isArray(s))s.forEach((function(e){var t=e[a];t&&t.partial&&t.partial.get(n)&&t.partial.delete(n)}));else if(s[a]){var l=s[a];l&&l.partial&&l.partial.get(n)&&l.partial.delete(n)}}}))},mergeError:function(e,t,r){if(r&&r.$&&r.$.isError){if(r.$.error){var o=r.$.error;for(var n in o)e.fieldList.hasOwnProperty(n)&&store.$.setRecErr(t.$,n,o[n])}return delete r.$.error,delete r.$.isError,!0}},mergeResponse:function(e,t,r,o,n,i){if(this.removePartialKeys(e,t,o),n&&Object.keys(n).length&&this.mergeNewDataKeys(n,e,r,i),!this.mergeError(t,e,r)){var a=store.peekRecord(e.$.model._name,e.$.pK),s=!1;e.$.isDeleted&&this.mergeDeletedRec(n,e,i),e.$.isNew&&a&&(s=this.mergeNewRecord(n,e,r,!0,i)),e.$.isModified&&a&&this.mergeModifiedRec(n,e,r,!0,s,i),t.dirty.length&&store.$.deleteFromArray(t.dirty,void 0),n&&Object.keys(n).length&&r&&!s&&r&&(a?(result=store.$.validateAndMerge(t,r,n,!0),result&&result.data?result=result.data:result&&result.type&&Lyte[result.type].apply(Lyte,result.args||[])):result=store.$.insertIntoStore(t._name,r,void 0,void 0,n));for(var l=e.$.isDirty(),d=0;d<l.length;d++){var c=e[l[d]];if(Array.isArray(c))for(var p=0;p<c.length;p++)Lyte.isRecord(c[p])&&(store.$.cmpSet(c[p].$,"isModified",!1),store.$.changePersist(c[p],!0));else Lyte.isRecord(c)&&(store.$.cmpSet(c.$,"isModified",!1),store.$.changePersist(c,!0))}store.adapter.$.removeDirtyStack(e)}},removeDirtyStack:function(e){e.$._attributes={},e.$.undoStack=store.$.genUnRedoStack(),e.$.redoStack=store.$.genUnRedoStack(),delete e.$._savedState,store.$.clrRecErr(e.$)},mergeNewRecord:function(e,t,r,o,n){var i,a=e.$?e.$.model:t.$.model._name,s=store.model[a],l=s._arrPk,d=t.$.pK,c=store.peekRecord(a,d),p=e.$?e.$.record:void 0;if(!Lyte.isRecord(p)||p===c){if(c){var u="object"==(void 0===d?"undefined":_typeof(d))?d:d.toString(),f=!1;if(!0!==n){l.forEach((function(e){r&&r.hasOwnProperty(e)?(store.$.cmpSet(t,e,r[e],void 0,!0),f=!0):Lyte.error("LD16",a,Lyte.isRecord(t)?"object"==_typeof(t.$.pK)?JSON.stringify(t.$.pK):t.$.pK:void 0)}));var h=store.$.getpKVal(t);store.$.cmpSet(t.$,"pK",store.$.getpKVal(t));var y="object"==(void 0===h?"undefined":_typeof(h))?h:h.toString();s.data._recMap&&(s.data._recMap.delete(u),s.data._recMap.set(y,t)),store.$.changeRelPkMaps(t,u,y),store.$.updateNestScp(t,d)}f&&e&&e.$&&(e.$.processed=!0),o&&!0!==n&&((i=store.$.validateAndMerge(s,r,e,!0))&&i.data?i=i.data:i&&i.type&&Lyte[i.type].apply(Lyte,i.args||[])),store.$.cmpSet(t.$,"isNew",!1),store.$.cmpSet(t.$,"isModified",!1),store.$.changePersist(t,!0),store.$.deleteFromArray(s.dirty,d),(!t.$.dN||t.$.dN&&0==Object.keys(t.$.dN).length)&&store.$.removeParentNesting(t)}return i}},mergeModifiedRec:function(e,t,r,o,n,i){var a,s=s||t.$.pK;return t.$.isDeleted||!r||n||!0===i||(r&&o&&((a=store.$.validateAndMerge(t.$.model,r,e,!0))&&a.data?a=a.data:a&&a.type&&Lyte[a.type].apply(Lyte,a.args||[])),n=!0),store.$.cmpSet(t.$,"isModified",!1),store.$.changePersist(t,!0),store.$.deleteFromArray(t.$.model.dirty,t.$.pK),(!t.$.dN||t.$.dN&&0==Object.keys(t.$.dN).length)&&store.$.removeParentNesting(t),a},mergeDeletedRec:function(e,t){var r,o,n;e?(r=e.$.model,o=e.$.pkVal):t&&(r=t.$.model._name,o=t.$.pK);var i=(h=(n=store.model[r])._deleted.get(o))?h.data:void 0,a=store.peekRecord(r,o);if(i){store.$.cmpSet(i.$,"isDeleted",!1),store.$.cmpSet(i.$,"isUnloaded",!0),store.$.cmpSet(i.$,"isPersisted",!0);var s=i.$.__scpObj;for(var l in s){var d=s[l].split("_"),c=Lyte.nestScp[d[0]];c&&Lyte.removeNestScp(c._data,d[0],d[1],void 0,i,void 0,void 0,{model:r,pK:o,attr:l})}n._deleted.delete(o),store.$.removeParentNesting(i)}if(a)store.$.removeFromStore(n,o,!0,void 0,void 0,!0),store.$.removeParentNesting(a);else{var p=store.model.cachedQueries;if(p){var u=p[r];if(u&&u.length)for(var f=u.length-1;f>=0;f--){var h;(h=u[f]).hasDeletedRecords&&h.data&&-1!==h.data[r].indexOf(i)&&u.splice(f,1)}}}e&&e.$&&e.$.parent&&(e.$.parent.$.partial={}),e&&e.$&&(e.$.processed=!0)},mergePartialObj:function(e,t,r,o,n){var i,a=store.peekRecord(e.$.model,e.$.pkVal),s=(t=t||a,!!a);if(!(e&&e.$&&e.$.processed||this.mergeError(store.model[e.$.model],t,r))){if(("added"==e.$.type||t&&t.$&&1==t.$.isNew)&&s)i=this.mergeNewRecord(e,t,r,o,n);else if(("modified"==e.$.type||"related"==e.$.type||t&&t.$&&1==t.$.isModified)&&s)this.mergeModifiedRec(e,t,r,o,i,n);else if("removed"==e.$.type)return void this.mergeDeletedRec(e,t,n);if(s){if("removed"!=e.$.type)for(var l in e){var d=e[l];this.mergeNewDataKeys(d,t[l],r?r[l]:void 0,n)}t.$.partial&&Object.keys(t.$.partial)&&(t.$.partial=new Map),store.adapter.$.removeDirtyStack(t)}}},mergeNewDataKeys:function(e,t,r,o){if(e&&(t&&t.partial&&t.partial.size||1==e.partial)){var n=this;if(Array.isArray(e)){var i=!!e.replace&&e.replace;e.forEach((function(e,a){if(e.$){var s=store.model[e.$.model]._pK,l=store.$.getIndex(t,s,e.$.pkVal);!0===e.$.onlyDetach?store.$.handleArrOp(t,"removeAt",void 0,l,1):i&&e.$.record&&e.$.record.$.isNew?i=!0:n.mergeNewDataKeys(e,-1!=l?t[l]:void 0,r?r[a]:void 0,o),t.partial&&t.partial.delete(e.$.pkVal)}}))}}else if(e&&e.$&&e.$.type)this.mergePartialObj(e,t,r,void 0,o);else if(Array.isArray(e))n=this,e.forEach((function(e,i){n.mergeNewDataKeys(e,t[i],r?r[i]:void 0,o)}));else if("object"==(void 0===e?"undefined":_typeof(e)))for(var a in e)e[a],this.mergeNewDataKeys(e[a],t[a],r?r[a]:void 0,o)},handleResponse:function(e,t,r,o,n,i,a){var s,l,d,c=r._pK;if(t=t[r._name],Array.isArray(e))for(var p=0;p<e.length;p++)d=(l=e[p]).$.pK,s=n&&l&&d?n.get(d):void 0,this.mergeResponse(e[p],r,Array.isArray(t)?t[p]:t,c,s);else d=e.$.pK,s=n&&e&&d?n.get(d):void 0,this.mergeResponse(e,r,t,c,s)},compareData:function(e,t,r){if(!store.$.isEmpty(e)&&!store.$.isEmpty(t)){var o=void 0===e?"undefined":_typeof(e);if(o!==(void 0===t?"undefined":_typeof(t)))return!1;switch(o){case"string":case"number":case"boolean":if(e===t)return!0;break;case"object":return this.compareObjects(e,t,r)}}return!1},compareObjects:function(e,t,r){if(!(e instanceof Object&&t instanceof Object))return!1;if(Object.keys(e).length!=Object.keys(t).length)return!1;for(var o in e){var n=e[o],i=t[o];if(r&&Array.isArray(n)&&Array.isArray(i)){if(n.length!=i.length)return!1;for(var a=n.length,s=0;s<a;s++)if(!store.adapter.$.compareData(n[s],i[s],r))return!1}else if(void 0===i||!store.adapter.$.compareData(n,i,r))return!1}return!0},handleBatchPromise:function(e){var t=e.response,r=e.batch;if(e.fail)store.$.batchPromise[r].forEach((function(e,t){e.reject({content:{},index:t,batch:r,code:"400",resp:{}})}));else{var o=store.$.initCB("serializer","application","normalizeResponse",{args:[void 0,"batch",e.response]});o&&(t=o.data),t.batch_requests.forEach((function(e,t){var o=store.$.batchPromise[r][t],n=e.status.toString(),i=n[0];"2"==i?o.resolve({content:e.content,index:t,batch:r,resp:e}):"4"!=i&&"5"!=i||(store.$.batchResponse[r][t]=void 0,o.reject({content:e.content,index:t,batch:r,resp:e,code:n}))}))}delete store.$.batch[r],delete store.$.batchPromise[r]},handleParseResponsePromise:function(e,t,r,o,n,i,a,s,l,d,c,p){e.then((function(e){"findRecord"==r||"findAll"==r?store.adapter.$.findParseRequestPromise(e,t,r,o,n,i,s,l,d,p):store.adapter.$.otherParseRequestPromise(e,t,r,o,n,i,a,s,l,d,c,p?p.customD:void 0,void 0,o)}),(function(e){c(i)}))},findParseRequestPromise:function(e,t,r,o,n,i,a,s,l,d){var c=Object.assign({},d);delete c.customD;var p=this.getResponse(e,t,r,o,n,i,d?d.customD:void 0,c);l(i?[p,i.statusText,i]:null!=a?[p,"batch",{index:a,batch:s}]:[p])},otherParseRequestPromise:function(e,t,r,o,n,i,a,s,l,d,c,p,u,f){var h=this.genericResponse(e,t,r,o,n,i,a,p,u);null!=s&&(store.$.batchResponse[l][s]=h),"action"!=r&&this.updateIDB(t,r,o,p,n,f),d(h)}}},store.$.defProp(store.adapter,"extends",(function(e,t,r){return store.$.scExtd("adapter",e,t,r)}),!1),Lyte.$.requiredMixins.serializer=Lyte.$.requiredMixins.adapter=function(e,t,r){Object.keys(e).length&&t.forEach((function(t,o){var n=t.scope,i=t.name,a=n[r][i];if(a)for(var s in e)a[s]=e[s]}))},Lyte.$.injectServices&&(Lyte.$.injectServices.adapter=Lyte.$.injectServices.serializer=function(e,t,r,o,n,i){var a=store[r],s={};for(var l in s.as=e,s.service=t,a){var d=a[l];store.$.extendService([s],r,l,d,store,!0,i)}}),store.$.cbDef(Serializer,"serializer"),store.serializer={$:{buildJSON:function(e,t,r,o,n,i,a,s){var l=i?i.headers:void 0,d=r,c=store.$.initCB("serializer",e,"normalizeResponse",{args:[e,t,d,o,n,l,i?i.qP:void 0,a,void 0,i?i.gqlObj:void 0]});c&&(d=c.data);var p,u=/^(findRecord|findAll)$/.test(t);if(!u&&d&&"object"==(void 0===d?"undefined":_typeof(d))&&(c=store.$.initCB("serializer",e,"payloadKey",{args:[e,t,void 0,s,a]}))){var f=c.data;if(f&&f!=e){var h=d[f];d[e]=h,delete d[f]}}if(u||d&&d[e]){if(p=d[e],scope=store.$.cbScp(e,"normalize","serializer"),scope)if(Array.isArray(p))for(var y=0;y<p.length;y++)p[y]=store.$.cB(scope,[e,t,p[y],a]);else p=store.$.cB(scope,[e,t,p,a]);var v="pushPayload"!=t?{url:i.url,method:i.method,headers:i.headers,type:t,qP:i.qP,withCredentials:i.withCredentials,model:e}:void 0;p=store.adapter.$.serializeRecords(e,p,void 0,v,"normalizeRecord",a),d[e]=p}return d},normalizeResponse:function(e,t,r,o,n,i,a,s){var l=i?i.headers:void 0,d=r,c=store.$.initCB("serializer",e,"normalizeResponse",{args:[e,t,d,o,n,l,i?i.qP:void 0,a,s,i?i.gqlObj:void 0]});return c&&(d=c.data),d},normalize:function(e,t,r,o,n,i,a,s,l){var d=r,c=!1;(/^(findRecord|findAll)$/.test(t)||d[e])&&(d=d[e],c=!0);var p=store.$.cbScp(e,"normalize","serializer");if(p)if(Array.isArray(d))for(var u=0;u<d.length;u++)d[u]=store.$.cB(p,[e,t,d[u],a,s]);else d=store.$.cB(p,[e,t,d,a,s]);c&&(r={},d=store.adapter.$.serializeRecords(e,d,void 0,{url:l.url,method:l.method,headers:l.headers,type:t,qP:l.qP,withCredentials:l.withCredentials,model:e},"normalizeRecord",a),r[e]=d)}}},store.$.defProp(store.serializer,"extends",(function(e,t,r){return store.$.scExtd("serializer",e,t,r)})),Object.defineProperties(store,{triggerUpdate:{value:function(e,t,r,o,n,i){var a={};if(null==(l=store.modelFor(e)))return Lyte.warn("LD02","Model",e),Promise.reject({code:"ERR19",message:Lyte.errorCodes.ERR19,data:e});var s=store.peekRecord(e,t);if(s){var l,d=(l=s.$.model)._arrPk;return(r||Object.keys(l.fieldList)).forEach((function(e){a[e]=s[e]})),d.forEach((function(e){a[e]=s[e]})),store.adapter.$.put(e,a,s,!0,n,o,i)}return Promise.reject("No such record found")}},batch:{value:function(e){return new Promise((function(t,r){store.$.makeBatch=!0,store.$.batch=store.$.batch||{},store.$.batchPromise=store.$.batchPromise||{};var o,n,i=void 0===store.$.currentBatch?Object.keys(store.$.batch).length:store.$.currentBatch+1,a=store.$.currentBatch=i;e&&"function"==typeof e?o=e:e&&"object"==(void 0===e?"undefined":_typeof(e))&&(o=e.method,n=e.customData);try{o()}catch(e){throw store.$.makeBatch=!1,e}store.$.makeBatch=!1;var s={batch:store.$.batch[a]},l=store.adapter.$.buildURL("batch","POST","application",void 0,s,void 0,void 0,n),d=s.batch;if(store.$.isEmpty(d)){if(store.$.cachedBatch&&store.$.cachedBatch[a]&&store.$.cachedBatch[a].length){var c=store.$.handleCachedResponse(a,[]);return t(c)}return t()}var p=store.$.initCB("serializer","application","serialize",{args:["batch",s,void 0,n]});p&&(s=p.data);var u=new XMLHttpRequest;for(var f in u.open("POST",l.url,!0),l.headers)u.setRequestHeader(f,l.headers[f]);u.withCredentials=!!l.withCredentials,u.send(JSON.stringify(s)),u.onreadystatechange=function(){if(4==u.readyState)if("2"==u.status.toString()[0]||"3"==u.status.toString()[0]){var e=JSON.parse(u.responseText);store.$.batchResponse=store.$.batchResponse||{},store.$.batchResponse[a]=[],store.adapter.$.handleBatchPromise({response:e,batch:a,resolve:t}),setTimeout((function(){var e=store.$.handleCachedResponse(a,store.$.batchResponse[a]);t(e),store.$.batchResponse[a]=[]}),0)}else store.$.batchResponse[a]=[],store.adapter.$.handleBatchPromise({batch:a,resolve:t,fail:!0}),setTimeout((function(){var e=store.$.handleCachedResponse(a,store.$.batchResponse[a]);r(e)}),0)}}))}},pushPayload:{value:function(e,t,r,o){var n=store.modelFor(e);if(n){var i,a=t;if(r){t=store.serializer.$.buildJSON(e,"pushPayload",t);var s=store.$.cbScp(e,"deserializeKey","serializer");if(i=t?Object.keys(t).length:void 0,s){Lyte.warn("LD08","deserializeKey","callback","Please use payloadKey callback instead"),i>2&&Lyte.error("LD09");var l=Object.keys(t);o=0,2==l.length&&"meta"==l[0]&&(o=1);var d=store.$.cB(s,[e,"pushPayload"]),c=t[l[o]];delete t[l[o]],t[d]=c}a=t[e]}var p=(t=store.$.insertIntoStore(e,a,!0,void 0,void 0,o,!0))||[];Array.isArray(p)||(p=[p]);var u=n&&n.hasOwnProperty("idb");return window.LyteIDB&&p.forEach((function(t){Lyte.isRecord(t)&&(u&&store.$.idbQ2Push(e,t,void 0,"pushPayload"),t.$.isError||t.$.inIDB&&Object.keys(t.$.inIDB).length&&store.adapter.$.updateRelationsIDB(t,t.$.model.relations))})),n&&delete n.rel,t}Lyte.warn("LD02","Model",e)}},registerModel:{value:function(e,t,r){if(store.model.hasOwnProperty(e))return Lyte.warn("LD14","Model",e),{error:Lyte.getErrorMessage("LD14","Model",e),extends:function(){}};var o,n,i,a;if(r&&"object"==(void 0===r?"undefined":_typeof(r))&&(o=r.extends||void 0,n=r.actions||void 0,i=r.idb||void 0,a=r.gql||void 0),o){var s=Object.assign({},store.model[o].fieldList);for(var l in s)"relation"==s[l].type&&delete s[l];t=Object.assign(t,s)}var d=store.model[e]=new Model(e,t);return o&&store.$.extendModel(o,d),n&&(d.actions=n),i&&(d.idb=i),a&&(d.gql=a),d}},unregisterModel:{value:function(e,t){t=!1!==t,Array.isArray(e)?e.forEach((function(e){store.$.unregisterModel(e,t)})):store.$.unregisterModel(e,t)}},unregisterAdapter:{value:function(e){Array.isArray(e)?e.forEach((function(e){store.$.unRegCb("adapter",e)})):store.$.unRegCb("adapter",e)}},unregisterSerializer:{value:function(e){Array.isArray(e)?e.forEach((function(e){store.$.unRegCb("serializer",e)})):store.$.unRegCb("serializer",e)}},addField:{value:function(e,t,r,o,n,i){var a,s=store.modelFor(e),l=[];if(r&&"object"==(void 0===r?"undefined":_typeof(r)))store.$.registerField(s,t,r,l),a="relation"==r.type?"relation":"attr",i=arguments[4],n=void 0===n?arguments[3]:n;else{var d=Lyte.attr(r,o);store.$.registerField(s,t,d,l)}"relation"!=a&&(n&&!i||store.$.updateFieldValidation(s,t,i,n))}},modelFor:{value:function(e){return store.model[e]}},createRecord:{value:function(e,t,r){return this.$.newRecord(e,t,r)}},deleteRecord:{value:function(e,t){this.$.removeFromStore(store.modelFor(e),t,void 0)}},findAll:{value:function(e,t,r,o,n,i,a){return store.adapter.$.get("findAll",e,void 0,t,r,n,o,i,a).then((function(){var i=arguments,a=i[0][0],s=i[0][2],l=s?s.status:i[0][3],d="cache"==i[0][1],c="batch"==i[0][1]?i[0][2]:void 0,p="idb"==i[0][1],u=store.model[e],f=r&&!0!==r?r:!0===r&&t&&"object"==(void 0===t?"undefined":_typeof(t))&&Object.keys(t).length?t:void 0;if(u||null!=o||(o=!1),void 0!==o&&"object"==(void 0===o?"undefined":_typeof(o))&&null!==o&&(o=!o.hasOwnProperty("cache")||o.cache),!1===o)return!d&&f&&store.$.cacheQuery(e,f,a,l),null!=c&&(store.$.batchResponse[c.batch][c.index]=a),a;if(a&&!a.save){if(!d){if(!a||!a.hasOwnProperty(e))return void Lyte.error("LD13","findAll",e,t&&"object"==(void 0===t?"undefined":_typeof(t))?",queryParams-"+JSON.stringify(t):"");var h=a[e];if(null==h||store.$.isEmptyArray(h))a[e]=[];else{Array.isArray(h)||Lyte.warn("LD19");var y=store.$.toInsertData(e,a,!0),v=y;y&&!Array.isArray(y)&&(v=[y]),window.LyteIDB&&!p&&(v&&!v.$||y&&y.$&&!y.$.isError)&&(u&&u.hasOwnProperty("idb")&&store.$.idbQ2Push(e,v,t,"findAll",void 0,void 0,n),v.forEach((function(e){e&&e.$&&e.$.inIDB&&Object.keys(e.$.inIDB).length&&store.adapter.$.updateRelationsIDB(e,e.$.model.relations)}))),window.LyteIDB&&p&&v&&Array.isArray(v)&&v.forEach((function(e){LyteIDB.changeIDBState(e)})),a[e]=y}a.hasOwnProperty("meta")&&(a[e].$||store.$.defProp(a[e],"$",{}),a[e].$.meta=a.meta),f&&store.$.cacheQuery(e,f,a)}return null!=c&&(store.$.batchResponse[c.batch][c.index]=a[e]),a[e]}return arguments}),(function(e){return Promise.reject(e)}))}},findRecord:{value:function(e,t,r,o,n,i,a,s){return null==t?Promise.reject({code:"ERR20",message:Lyte.errorCodes.ERR20}):store.adapter.$.get("findRecord",e,t,r,o,i,n,a,s).then((function(){var a=arguments[0][0],s="cache"==arguments[0][1],l=arguments[0][2],d=l?l.status:arguments[0][3],c="batch"==arguments[0][1]?arguments[0][2]:void 0,p="idb"==arguments[0][1],u=store.model[e],f=o&&!0!==o?o:!0===o&&r&&"object"==(void 0===r?"undefined":_typeof(r))&&Object.keys(r).length?r:void 0;if(u||null!=n||(n=!1),void 0!==n&&"object"==(void 0===n?"undefined":_typeof(n))&&null!==n&&(n=!n.hasOwnProperty("cache")||n.cache),!1===n)return!s&&f&&store.$.cacheRecordQuery(e,t,f,a,d),null!=c&&(store.$.batchResponse[c.batch][c.index]=a),a;if(a){if(!s){var h;if(!a||!a.hasOwnProperty(e))return void Lyte.error("LD13","findRecord",e,",key-"+("object"==(void 0===t?"undefined":_typeof(t))?JSON.stringify(t):t)+(r&&"object"==(void 0===r?"undefined":_typeof(r))?", queryParams-"+JSON.stringify(r):""));if(!Lyte.isRecord(a)){var y=a[e];if((store.$.isEmpty(y)||store.$.isEmptyObj(y))&&(a[e]={},h=!0),("object"!=(void 0===y?"undefined":_typeof(y))||Array.isArray(y))&&Lyte.warn("LD11"),!h){var v,m=store.$.insertIntoStore(e,y,!0,!0,void 0);window.LyteIDB&&!p&&Lyte.isRecord(m)&&!m.$.isError&&(Array.isArray(m)||(v=[m]),u&&u.hasOwnProperty("idb")&&store.$.idbQ2Push(e,v,r,"findRecord",t,a&&a.meta?a.meta:void 0,i),v.forEach((function(e){e&&e.$&&e.$.inIDB&&Object.keys(e.$.inIDB).length&&store.adapter.$.updateRelationsIDB(e,e.$.model.relations)}))),window.LyteIDB&&p&&v&&Array.isArray(v)&&v.forEach((function(e){LyteIDB.changeIDBState(e)})),a[e]=m}a.hasOwnProperty("meta")&&(Lyte.isRecord(m)?m.$.meta=a.meta:((y=a[e]).$||store.$.defProp(y,"$",{}),y.$.meta=a.meta))}!s&&f&&store.$.cacheRecordQuery(e,t,f,a)}return null!=c&&(store.$.batchResponse[c.batch][c.index]=a[e]),a[e]}return arguments}),(function(e){return Promise.reject(e)}))}},peekRecord:{value:function(e,t,r){var o=this.modelFor(e);if(o)if(!0===r){var n=o._deleted.get(t);if(n&&n.data)return n.data}else{var i=o.isComp;if(t=null==t?"":t,!i&&o.data._recMap)return o.data._recMap.get(t.toString());var a=o.data.filter((function(e){if(store.$.comparePk(e,t))return e}));if(a[0])return a[0]}else Lyte.warn("LD02","Model ",e)}},peekAll:{value:function(e){var t=this.modelFor(e);if(t)return arr=t.data,arr;Lyte.warn("LD02","Model ",e)}},deleteMany:{value:function(e,t){this.$.removeFromStore(store.modelFor(e),t,void 0)}},unloadRecord:{value:function(e,t,r){var o=this.modelFor(e);if(o){null==t&&Lyte.warn("LD18","key");var n,i=store.peekRecord(e,t),a=o._fldGrps.inherit&&Object.keys(o._fldGrps.inherit).length;if(r=!1!==r,i){if(n=i.$.pK,r&&a){var s=new Map;store.$.removeChildRecords(o,i,"",s)}else this.$.removeFromStore(o,n,!0,!0);o._deleted.delete(t);var l=this.model.cachedRecordQueries;l&&l[e]&&l[e][t]&&(l[e][t]=[]);var d=store.model.cachedQueries;if(d){var c=d[e];if(c&&c.length)for(var p=c.length-1;p>=0;p--){var u=c[p];u&&u.data&&-1!=u.data[e].indexOf(i)&&c.splice(p,1)}}}}else Lyte.warn("LD02","Model ",e)}},unloadAll:{value:function(e,t,r){var o=this.modelFor(e);if(o){var n=[],i=t||store.peekAll(e);if(i)for(var a=0;a<i.length;a++)n.push(i[a].$.pK);var s=o._fldGrps.inherit&&Object.keys(o._fldGrps.inherit).length;if((r=!1!==r)&&s)for(a=n.length-1;a>=0;a--){var l=i[a],d=new Map;store.$.removeChildRecords(o,l,"",d)}else this.$.removeFromStore(o,n,!0,!0);this.model[e].dirty=[],this.model[e]._deleted=new Map;var c=store.model.cachedQueries;c&&c[e]&&(c[e]=[]);var p=this.model.cachedRecordQueries;p&&p[e]&&(p[e]=[])}else Lyte.warn("LD02","Model ",e)}},triggerAction:{value:function(e,t,r,o,n,i){var a=store.modelFor(e);return null==a?(Lyte.warn("LD02","Model",e),Promise.reject({code:"ERR19",message:Lyte.errorCodes.ERR19,data:e})):(a.actions?a.actions[t]:void 0)?store.adapter.$.handleAction(t,a,store.peekAll(e),r,o,n,i).then((function(e){return e}),(function(e){return Promise.reject(e)})):Promise.reject({code:"ERR18",message:Lyte.errorCodes.ERR18})}},rollBack:{value:function(e){var t=this.modelFor(e);if(t.relations,null!=t){for(var r=t._pK,o=Array.from(t.dirty),n=o.length,i=0;i<n;i++){var a=this.peekRecord(e,o[i]);a&&a.$.isDeleted||(a&&a.$.isNew?this.$.rollBackNew(t,a,r):a&&a.$.isModified&&a.$.rollBackAttributes(a.$.getDirtyAttributes()))}this.$.rollBackDelete(t,void 0,!0)}else Lyte.warn("LD02","Model",e)}},create:{value:function(e,t,r,o,n,i){var a=store.modelFor(e);if(null==a)return Lyte.warn("LD02","Model",e),Promise.reject({code:"ERR19",message:Lyte.errorCodes.ERR19,data:e});if(Array.isArray(t)){var s=this;t.forEach((function(t){var r=s.$.newRecord(e,t);if(r.$.isError)return Promise.reject(r)}))}else if(t&&"object"==(void 0===t?"undefined":_typeof(t))){var l=this.$.newRecord(e,t);if(l.$.isError)return Promise.reject(l)}for(var d,c=a.dirty,p=c.length,u=[],f=0;f<p;f++){var h=store.peekRecord(e,c[f]);if(h&&h.$.isNew){if(n&&-1==n.indexOf(h))continue;if(d=new error1,store.$.validateRecord(h,a.fieldList),h.$.isError&&Object.keys(h.$.error).length>0)return Promise.reject(d);u.push(h)}}return u.length?store.adapter.$.create(e,u,!1,r,o,i):Promise.resolve()}},update:{value:function(e,t,r,o,n){if(null==this.modelFor(e))return Lyte.warn("LD02","Model",e),Promise.reject({code:"ERR19",message:Lyte.errorCodes.ERR19,data:e});var i,a=[],s=[],l=o||store.peekAll(e),d=(i=store.model[e]).relations;return l.forEach((function(t){if(Lyte.isRecord(t)&&t.$.model._name==e){var r=t,o=store.$.isDirty(r,d);if(r&&r.$.isModified&&!r.$.isNew||o&&o.length){var n=store.$.updateJSON(r,i,o);a.push(n),s.push(r)}}})),a.length?store.adapter.$.put(e,a,s,!1,t,r,n):Promise.resolve()}},delete:{value:function(e,t,r,o,n,i){var a=store.modelFor(e);if(null==a)return Lyte.warn("LD02","Model",e),Promise.reject({code:"ERR19",message:Lyte.errorCodes.ERR19,data:e});t&&this.deleteRecord(e,t);var s=[];if(a._deleted.forEach((function(e,t){s.push(e.data)})),n){var l=[];n.forEach((function(e){-1!=s.indexOf(e)&&l.push(e)})),s=l}return s.length?store.adapter.$.del(e,s,void 0,"delete",r,o,i).then((function(e){return e}),(function(e){return Promise.reject(e)})):Promise.resolve()}},registerAdapter:{value:store.adapter.extends},registerSerializer:{value:store.serializer.extends},clearCachedQuery:{value:function(e,t,r){var o,n;e&&"object"==(void 0===e?"undefined":_typeof(e))?(e=(n=e).modelName,t=n.key,o=r=n.cacheQuery):t&&"object"==(void 0===t?"undefined":_typeof(t))?(o=t,t=void 0):r&&"object"==(void 0===r?"undefined":_typeof(r))&&(o=r);var i=[];if(o){if(o){null==t?(s=this.model.cachedQueries)&&s[e]&&(i=s[e]):(l=this.model.cachedRecordQueries)&&l[e]&&l[e][t]&&(i=l[e][t]);for(var a=0;a<i.length;a++)if(this.adapter.$.compareData(i[a].cacheQuery,o,!0)){i.splice(a,1);break}}}else if(e){var s=this.model.cachedQueries,l=this.model.cachedRecordQueries;s&&s.hasOwnProperty(e)&&delete s[e],l&&l.hasOwnProperty(e)&&(t?delete l[e][t]:delete l[e])}else this.model.cachedQueries=[],this.model.cachedRecordQueries={}}},getErrorMessage:{value:function(e){return Lyte.errorCodes[e]}},setErrorMessages:{value:function(e){Object.assign(Lyte.errorCodes,e)}},addEventListener:{value:function(e,t){return store.$.eventListeners.add(store,e,t)}},removeEventListener:{value:function(e){store.$.eventListeners.remove(store,e)}},emit:{value:function(e,t){store.$.eventListeners.emit(store,e,t)}},getPrimaryKey:{value:function(e){var t=store.model[e];if(t)return t._pK;Lyte.warn("LD02","Model ",e)}}});var error1=function(e,t,r){Object.defineProperties(this,{$:{value:{isError:!0,error:r||{}}}}),e&&store.$.setError(this,e,t)};!function(e){function t(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?g[b.call(e)]||"object":typeof e}function r(e){var r=!!e&&"length"in e&&e.length,o=t(e);return!T.isFunction(e)&&!T.isWindow(e)&&("array"===o||0===r||"number"==typeof r&&r>0&&r-1 in e)}function o(e){return-1!==e.indexOf(":visible")}function n(e,t){var r,o=e.indexOf(":visible"),n=e.substring(0,o),i=0,s=[];for(r=t.querySelectorAll(n||"*");i<r.length;i++)a(r[i])&&s.push(r[i]);return s}function i(e,t,r){var a,s;if(o(e))if((a=e.split(",")).length>1)for(s=0;s<a.length;s++)i(a[s],t,r);else v.apply(r,n(a[0],t));else!function(e,t,r){var o=t.querySelectorAll(e);v.apply(r,o)}(e,t,r)}function a(e){return!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length)}function s(e){var t,r=!1,o=[],n=0,i=0,a=e.slice(0);if(e.sort((function(e,t){var o;return e===t?(r=!0,0):1&(o=(e.ownerDocument||e)===(t.ownerDocument||t)?e.compareDocumentPosition(t):1)?e===document||e.ownerDocument===E&&E.contains(e)?-1:t===document||t.ownerDocument===E&&E.contains(t)?1:a?a.indexOf(e)-a.indexOf(t):0:4&o?-1:1})),r){for(;t=e[n++];)t===e[n]&&(i=o.push(n));for(;i--;)e.splice(o[i],1)}return e}function l(e){return Math.round(parseFloat(e))}function d(){this.expando=T.expando+T.dataid++}function c(e){var t,r,o=0,n="",i=e.nodeType;if(i){if(1===i||9===i||11===i){if("string"==typeof e.textContent)return e.textContent;for(r=e.firstChild;r;r=r.nextSibling)n+=c(r)}else if(3===i||4===i)return e.nodeValue}else for(;t=e[o++];)n+=c(t);return n}function p(e,t){return t.toUpperCase()}function u(e,t,r){return"string"==typeof t?(r&&(t=":not("+t+")"),function(e,t){for(var r=[],o=0,n=t.length;o<n;o++)T._matches(t[o],e)&&r.push(t[o]);return r}(t,T.grep(e,(function(e){return 1===e.nodeType})))):T.isFunction(t)?T.grep(e,(function(e,o){return!!t.call(e,o,e)!==r})):1===t.nodeType?T.grep(e,(function(e){return e===t!==r})):T.grep(e,(function(e){return m.call(t,e)>-1!==r}))}function f(e,t,r){var o;if(void 0===r&&1===e.nodeType)if(o="data-"+t.replace(I,"-$&").toLowerCase(),"string"==typeof(r=e.getAttribute(o))){try{r=function(e){return"true"===e||"false"!==e&&("null"===e?null:e===+e+""?+e:B.test(e)?JSON.parse(e):e)}(r)}catch(e){}N.set(e,t,r)}else r=void 0;return r}var h=[],y=h.slice,v=h.push,m=h.indexOf,_=h.concat,g={},b=g.toString,L=g.hasOwnProperty,A=L.toString,$=A.call(Object),E=e.document,T=function(e,t){return new C(e,t)};T.isFunction=function(e){return"function"==typeof e&&"number"!=typeof e.nodeType};var R=/^(?:\s*(<[\w\W]+>)|#([\w-]+))$/,O=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i,w=/<|&#?\w+;/,S=/<([a-z][^\/\0>\x20\t\r\n\f]+)/i,C=function(t,r){var o,n,i,a,s=M;if(!t)return this;if("string"==typeof t){if(!(n="<"===t[0]&&">"===t[t.length-1]&&t.length>3?[null,t,null]:R.exec(t))||!n[1]&&r)return!r||r instanceof C?(r||s).find(t):this.constructor(r).find(t);if(n[1]){if(r=r instanceof C?r[0]:r,T.merge(this,T.parseHTML(n[1],r&&r.nodeType?r.ownerDocument:document)),O.test(n[1])&&T.isPlainObject(r))for(i in r)T.isFunction(this[i])?this[i](r[i]):this.attr(i,r[i]);return this}return o=document.getElementById(n[2]),(a=this.pushStack(o?[o]:[])).isId=!0,a}return t.nodeType?(this[0]=t,this.length=1,this.singular=!0,this):(a=T.makeArray(t,this),t===e&&(a.singular=!0),a)};C.prototype={splice:h.splice,constructor:T,length:0,push:h.push,sort:h.sort,indexOf:h.indexOf},T.prototype=C.prototype,T.extend=C.prototype.extend=function(){var e,t,r,o,n,i=1,a=!1,s=arguments.length,l=arguments[0]||{};for("boolean"==typeof l&&(a=l,l=arguments[i]||{},i++),s==i&&(l=this,i--),T.isFunction(l)||"object"==typeof l||(l={});i<arguments.length;i++)for(e in o=arguments[i])(t=o[e])!==(r=l[e])&&"__proto__"!==e&&(t&&a?Array.isArray(t)?(n=r&&Array.isArray(r)?r:[],l[e]=T.extend(a,n,t)):T.isPlainObject(t)?(n=T.isPlainObject(r)?r:{},l[e]=T.extend(a,n,t)):void 0!==t&&(l[e]=t):l[e]=o[e]);return l};var P={startsWith:function(e,t){return 0===t.indexOf(e)},endsWith:function(e,t){return t.indexOf(e)===t.length-e.length},includes:function(e,t){return-1!==t.indexOf(e)}},k=function(e,t,r,o){if("number"==typeof r)r=r.toString();else if("string"!=typeof r&&"any"!=e&&"empty"!=e)return!1;switch(r=function(e,t){return!1===t.caseSensitive&&(e=e.toLowerCase()),t.trim&&(e=e.trim()),e}(r,o),e){case"any":return!0;case"empty":return!r;case"equals":return t===r;case"notEquals":return t!=r;default:return!!t&&P[e](t,r)}};T.extend({userAgent:function(){var e,t=navigator.userAgent,r=t.match(/(opera|CriOS|FxiOS|EdgiOS|OPT|chrome|safari|firefox|msie|trident(?=\/))\/?\s*([\d.]+)/i)||[];return/trident/i.test(r[1])?{browser:"IE",version:((e=/\brv[ :]+([\d.]+)/g.exec(t)||[])[1]||"").split(".")[0],detailedVersion:["IE",e[1]]}:"Chrome"===r[1]&&null!=(e=t.match(/\b(OPR|Edge|UCBrowser|SamsungBrowser|YaBrowser|Edg|Falkon)\/([\d.]+)/))?("Edg"!==e[1]&&"EdgA"!==e[1]||(e[1]="Edge"),{browser:e[1],version:(e[2]||"").split(".")[0],detailedVersion:[e[1],e[2],r[1],r[2]]}):(r=r[2]?[r[1],r[2]]:[navigator.appName,navigator.appVersion],null==(e=t.match(/version\/([\d.]+)/i))||/android/i.test(t)||r.splice(1,1,e[1]),"CriOS"!==r[0]&&"FxiOS"!==r[0]&&"EdgiOS"!==r[0]&&"OPT"!==r[0]||(r[2]="Safari"),"MSIE"===r[0]&&(r[0]="IE"),{browser:r[0],version:(r[1]||"").split(".")[0],detailedVersion:r})}(),regex:{rnothtmlwhite:/[^\x20\t\r\n\f]+/g},_meta:{support:{}},_processInput:function(e,r,o,n,i,a,s){var l,d=e.length,c=0,p=null==r;if("object"===t(r))for(l in i=!0,r)T._processInput(e,l,r[l],n,!0);else if(void 0!==o&&(i=!0,T.isFunction(o)||(s=!0),p&&(s?(n.call(e,o),n=null):(p=n,n=function(e,t,r){return p.call(T(e),r)})),n))for(;c<d;c++)n(e[c],r,s?o:o.call(e[c],c,n(e[c],r)));return i?e:p?n.call(e):d?n(e[0],r):a},_camelCase:function(e){return e.replace(x,"ms-").replace(j,p)},_removeDupes:function(e,t,r){if(e.length>1){var o=s(e);return r.pushStack(t?o.reverse():o)}return r.pushStack(e)},_checkMatch:function(e,t){return!(t&&!T._matches(e,t))},_matches:function(e,t){var r,n,i,s,l=e.matches||e.matchesSelector||e.msMatchesSelector||e.webkitMatchesSelector||e.mozMatchesSelector;if(!o(t))return l.call(e,t);if(!((r=t.split(",")).length>1))return i=(t=r[0]).indexOf(":visible"),s=t.substring(0,i),l.call(e,s||"*")&&a(e);for(n=0;n<r.length;n++)if(T._matches(e,r[n]))return!0},expando:"lytedom"+Math.random().toString().replace(/\D/g,""),isWindow:function(e){return null!=e&&e===e.window},map:function(e,t){var o,n,i=e.length,a=[];if(r(e))for(o=0;o<i;o++)null!=(n=t(e[o],o))&&a.push(n);else for(o in e)null!=(n=t(e[o],o))&&a.push(n);return _.apply([],a)},grep:function(t,r,o){for(var n=0,i=!o,a=(t||[]).length,s=[];n<a;n++)!!r.call(e,t[n],n)===i&&s.push(t[n]);return s},each:function(e,t){var o,n;if(r(e))for(n=e.length,o=0;o<n&&!1!==t.call(e[o],o,e[o]);o++);else for(o in e)if(!1===t.call(e[o],o,e[o]))break;return e},merge:function(e,t){var r,o,n=t.length||0;for(r=e.length||0,o=0;o<n;o++)e[r+o]=t[o];return e.length=n+r,e},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},makeArray:function(e,t){var o=t||[];return null!=e&&(r(Object(e))?T.merge(o,"string"==typeof e?[e]:e):v.call(o,e)),o},inArray:function(e,t,r){return null==t?-1:m.call(t,e,r)},isPlainObject:function(e){var t,r;return!(!e||"[object Object]"!==b.call(e)||(t=Object.getPrototypeOf(e))&&("function"!=typeof(r=L.call(t,"constructor")&&t.constructor)||A.call(r)!==$))},parseXML:function(e){var t,r=new DOMParser;try{t=r.parseFromString(e,"text/xml")}catch(e){t=void 0}if(!t||t.getElementsByTagName("parsererror").length)throw new Error("Unable to parse"+e);return t},Evaluate:function(e){var t=document.createElement("script");t.text=e,document.head.appendChild(t).parentNode.removeChild(t)},removeLeaks:function(e){for(var t,r,o=0;o<e.length;o++){if(t=e[o][T._dataPriv.expando]){if(t.events)for(r in t.events)T.ev.removeEvents(e[o],r,t.handle);t=void 0}t&&(t=void 0)}},search:function(e,t,r,o,n,i){var a,s,l=[],d=!1;e.constructor!=Array&&"object"==typeof e&&(e=[e],s="object"),n?(d=n.recursive||!1,!1===n.caseSensitive&&(r=r.toLowerCase()),n.trim&&(r=r.trim())):n={},t&&"string"==typeof t&&(t=t.split(".")),o?"equals"!==o&&"number"==typeof r&&(r=r.toString()):o="includes",t&&(a=t[0]);for(var c=0;c<e.length;c++){var p=e[c];if(a){if(p instanceof Object&&a in p){if(1===t.length&&k(o,r,p[a],n))l.push(p);else if(p[a]instanceof Array||p[a]instanceof Object){if(u=this.search(p[a],t.slice(1),r,o,n,!0),d&&u)return u;u&&l.push(p)}}else if(p instanceof Array){if(u=this.search(p,t,r,o,n,!0),d&&u)return d;u&&l.push(p)}}else if(k(o,r,p,n))l.push(p);else if(p instanceof Array){var u=this.search(p,a,r,o,n,!0);if(d&&u)return u;u&&l.push(p)}d&&p[n.children]&&(u=this.search(p[n.children],t,r,o,n,!0))&&(l=l.length?l.concat(u):u)}return i?!!l.length&&(d?l:"object"===s?l[0]:l):l}}),T.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),(function(e,t){g["[object "+t+"]"]=t.toLowerCase()})),"undefined"!=typeof document&&(function(){var e=document.createElement("input"),t=document.createElement("select").appendChild(document.createElement("option"));e.type="checkbox",T._meta.support.checkOn=""!==e.value,T._meta.support.optSelected=t.selected,(e=document.createElement("input")).value="t",e.type="radio",T._meta.support.radioValue="t"===e.value}(),function(){function t(){if(i){var t,s=document.documentElement;a.style.cssText="position: absolute; left: 0px;width:300px;height:5px;",i.style.cssText="position:relative;width:200px;margin: auto; top: 1%;box-sizing:border-box;padding: 20px;",s.appendChild(a).appendChild(i),t=e.getComputedStyle(i),r=50===l(t.marginLeft),o="1%"!==t.top,n=200===l(t.width),s.removeChild(a),i=null}}var r,o,n,i=document.createElement("div"),a=document.createElement("div");T.extend(T._meta.support,{reliableMarginLeft:function(){return t(),r},reliablePixelPosition:function(){return t(),o},reliableBoxSizing:function(){return t(),n}})}()),T.needsContext=/^[\x20\t\r\n\f]*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\([\x20\t\r\n\f]*((?:-\d)?\d*)[\x20\t\r\n\f]*\)|)(?=[^-]|$)/i,T.dataid=0,T.extend(d.prototype,{cache:function(e){var t=e[this.expando];return t||(t={},e.nodeType?e[this.expando]=t:Object.defineProperty(e,this.expando,{value:t,configurable:!0})),t},get:function(e,t){return void 0===t?this.cache(e):e[this.expando]&&e[this.expando][T._camelCase(t)]},hasData:function(e){var t=e[this.expando];return void 0!==t&&!T.isEmptyObject(t)},access:function(e,t,r){return void 0===t||t&&"string"==typeof t&&void 0===r?this.get(e,t):(this.set(e,t,r),void 0!==r?r:t)},set:function(e,t,r){var o,n=this.cache(e);if("string"==typeof t)n[T._camelCase(t)]=r;else for(o in t)n[T._camelCase(o)]=t[o];return n},remove:function(e,t){var r,o=e[this.expando];if(void 0!==o){if(void 0!==t){r=(t=Array.isArray(t)?t.map(T._camelCase):(t=T._camelCase(t))in o?[t]:t.match(T.regex.rnothtmlwhite)||[]).length;for(;r--;)delete o[t[r]]}(void 0===t||T.isEmptyObject(o))&&(e.nodeType?e[this.expando]=void 0:delete e[this.expando])}}}),T._dataPriv=new d;var N=new d;C.prototype.extend({toArray:function(){return y.call(this)},add:function(e,t){return this.pushStack(s(T.merge(this.get(),T(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))},slice:function(){return this.pushStack(y.apply(this,arguments))},has:function(e){var t=T(e,this),r=t.length;return this.filter((function(){for(var e=0;e<r;e++)if(this!==t[e]&&this.contains(t[e]))return!0}))},is:function(e){return u(this,"string"==typeof e&&T.needsContext.test(e)?T(e):e||[],!1).length>0},not:function(e){return this.pushStack(u(this,e||[],!0))}}),C.prototype.extend({eq:function(e){var t=this.length;return e=e<0?t+e:e,this.pushStack(e<0||e>t-1?[]:[this[e]])},last:function(){return this.eq(-1)},first:function(){return this.eq(0)},end:function(){return this.prevObject||this.constructor()},map:function(e){return this.pushStack(T.map(this,(function(t,r){return e.call(t,r,t)})))},filter:function(e){return this.pushStack(u(this,e||[],!1))},find:function(e){var t,r,o=this,n=this.length;if("string"!=typeof e)return this.pushStack(T(e).filter((function(){for(r=0;r<n;r++)if(o[r]!==this&&o[r].contains(this))return!0})));for(t=this.pushStack([]),r=0;r<n;r++)i(e,this[r],t);return t.length>1?s(t):t},pushStack:function(e){var t;return(t=T.merge(this.constructor(),e)).prevObject=this,t},each:function(e){return T.each(this,e)},get:function(e){return null==e?y.call(this):e<0?this[e+this.length]:this[e]},empty:function(){return this.each((function(e,t){1===t.nodeType&&(T.removeLeaks(t.getElementsByTagName("*")),t.textContent="")})),this},text:function(e){return T._processInput(this,null,e,(function(e){return void 0===e?c(this):this.empty().each((function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=e)}))}),arguments.length)},clone:function(e,t){return e=!0===e,t=null==t?e:t,this.map((function(){return T.clone(this,e,t)}))}});var x=/^-ms-/,j=/-([a-z])/g;"undefined"!=typeof document&&function(){var e=document.createDocumentFragment().appendChild(document.createElement("div")),t=document.createElement("input");t.setAttribute("type","radio"),t.setAttribute("checked","checked"),t.setAttribute("name","t"),e.appendChild(t),T._meta.support.checkClone=e.cloneNode(!0).cloneNode(!0).lastChild.checked,e.innerHTML="<textarea>x</textarea>",T._meta.support.noCloneChecked=!!e.cloneNode(!0).lastChild.defaultValue}();var D={thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};D.tbody=D.tfoot=D.colgroup=D.caption=D.thead,D.th=D.td,T.extend({parseHTML:function(e,t){var r=O.exec(e);return r?[t.createElement(r[1])]:function(e,t){var r,o,n,i,a=document.createDocumentFragment(),s=[];if(w.test(e)){for(i=a.appendChild(document.createElement("div")),r=(S.exec(e)[1]||"").toLowerCase(),o=D[r]||D._default,i.innerHTML=o[1]+e+o[2],n=o[0];n--;)i=i.lastChild;T.merge(s,i.childNodes),(i=a.firstChild).textContent=""}return s}(e)}}),T.extend({hasData:function(e){return N.hasData(e)||T._dataPriv.hasData(e)},data:function(e,t,r){return N.access(e,t,r)},removeData:function(e,t){N.remove(e,t)},_data:function(e,t,r){return T._dataPriv.access(e,t,r)},_removeData:function(e,t){T._dataPriv.remove(e,t)}}),C.prototype.extend({data:function(e,t){var r,o,n,i=this[0],a=i&&i.attributes;if(void 0===e){if(this.length&&(n=N.get(i),1===i.nodeType&&!T._dataPriv.get(i,"hasDataAttrs"))){for(r=a.length;r--;)a[r]&&0===(o=a[r].name).indexOf("data-")&&(o=T._camelCase(o.slice(5)),f(i,o,n[o]));T._dataPriv.set(i,"hasDataAttrs",!0)}return n}return"object"==typeof e?this.each((function(){N.set(this,e)})):T._processInput(this,null,t,(function(t){var r;if(i&&void 0===t){if(void 0!==(r=N.get(i,e)))return r;if(void 0!==(r=f(i,e)))return r}else this.each((function(){N.set(this,e,t)}))}),arguments.length>1,null,!0)},removeData:function(e){return this.each((function(){N.remove(this,e)}))}});var I=/[A-Z]/g,B=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,M="undefined"!=typeof document?T(document):{};T.parse=JSON.parse,e.$L=T,e.lyteDomObj=C}("undefined"==typeof window?this:window),function(e){var t=e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||e.msRequestAnimationFrame||function(e){return setTimeout(e,25)},r=function(){this.readOps=[],this.writeOps=[]};r.prototype={constructor:r,scheduled:!1,measure:function(e,t){return e=t?e.bind(t):e,this.readOps.push(e),this.stagingFn(),e},mutate:function(e,t){return e=t?e.bind(t):e,this.writeOps.push(e),this.stagingFn(),e},stagingFn:function(){this.scheduled||(this.scheduled=!0,t(this.executeTasks.bind(this)))},executeTasks:function(){var e;try{this.execute(this.readOps),this.execute(this.writeOps)}catch(t){e=t}if(this.scheduled=!1,(this.readOps.length||this.writeOps.length)&&this.stagingFn(),e){if(!this.catch)throw e;this.catch(e)}},execute:function(e){for(var t;t=e.shift();)t()},clear:function(e){return this.remove(this.readOps,e)||this.remove(this.writeOps,e)},remove:function(e,t){var r=e.indexOf(t);return-1!==r&&!!e.splice(r,1)},catch:null},e.$L.fastdom=new r}("undefined"!=typeof window?window:this),function(e){function t(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()}function r(e,t,r){var o,n,i=parseFloat(function(e,t){return $L.css(e,t)}(e,t));return r&&r[3]||$L.cssNumber[t],r&&(o=i||0,n=r[1]?o+(r[1]+1)*r[2]:+r[2]),n}function o(e){return Array.isArray(e)?e:function(e){return(e&&e.match&&e.match($L.regex.rnothtmlwhite)||[]).join(" ")}(e).match($L.regex.rnothtmlwhite)||[]}function n(e){return e.getAttribute&&e.getAttribute("class")||""}function i(t){var r=t.ownerDocument.defaultView;return r&&r.opener||(r=e),r.getComputedStyle(t)}function a(e,t,r){var o;return(r=r||i(e))&&(o=r.getPropertyValue(t)||r[t]),void 0!==o?o+"":o}function s(e,t,r,o,n,i){var a="width"===t?1:0,s=0,l=0;if(r===(o?"border":"content"))return 0;for(;a<4;a+=2)"margin"===r&&(l+=$L.css(e,"margin"+u[a],!0,n)),o?("content"===r&&(l-=$L.css(e,"padding"+u[a],!0,n)),"margin"!==r&&(l-=$L.css(e,"border"+u[a]+"Width",!0,n))):(l+=$L.css(e,"padding"+u[a],!0,n),"padding"!==r?l+=$L.css(e,"border"+u[a]+"Width",!0,n):s+=$L.css(e,"border"+u[a]+"Width",!0,n));return!o&&i>=0&&(l+=Math.max(0,Math.ceil(e["offset"+t[0].toUpperCase()+t.slice(1)]-i-l-s-.5))),l}function l(e,t,r){var o=i(e),n=a(e,t,o),l="border-box"===$L.css(e,"boxSizing",!1,o),d=l;if(g.test(n)){if(!r)return n;n="auto"}return d=d&&($L._meta.support.reliableBoxSizing()||n===e.style[t]),("auto"===n||!parseFloat(n)&&"inline"===$L.css(e,"display",!1,o))&&(n=e["offset"+t[0].toUpperCase()+t.slice(1)],d=!0),(n=parseFloat(n)||0)+s(e,t,r||(l?"border":"content"),d,o,n)+"px"}function d(e,t,r){var o,n,i={};for(n in t)i[n]=e.style[n],e.style[n]=t[n];for(n in o=r.call(e),t)e.style[n]=i[n];return o}function c(e,t,r){var o=m.exec(t);return o?Math.max(0,o[2]-(r||0))+(o[3]||"px"):t}var p=/\r/g,u=["Top","Right","Bottom","Left"],f=/^(?:input|select|textarea|button)$/i,h=/^(?:a|area)$/i,y=/^--/,v=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,m=new RegExp("^(?:([+-])=|)("+v+")([a-z%]*)$","i"),_=/^(none|table(?!-c[ea]).+)/,g=new RegExp("^("+v+")(?!px)[a-z%]+$","i"),b={letterSpacing:"0",fontWeight:"400"},L=/^(?:checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped)$/i,A={set:function(e,t,r){return!1===r?$L.removeAttr(e,t):e.setAttribute(t,t),t}};$L.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},(function(e,t){var r="pageYOffset"===t;lyteDomObj.prototype[e]=function(o){return $L._processInput(this,e,o,(function(e,o,n){var i;if($L.isWindow(e)?i=e:9===e.nodeType&&(i=e.defaultView),null==n)return i?i[t]:e[o];i?i.scrollTo(r?i.pageXOffset:n,r?n:i.pageYOffset):e[o]=n}))}})),$L.each({Height:"height",Width:"width"},(function(e,t){$L.each({padding:"inner"+e,content:t,"":"outer"+e},(function(r,o){lyteDomObj.prototype[o]=function(n,i){var a=r||(!0===n||!0===i?"margin":"border");return $L._processInput(this,t,"boolean"!=typeof n?n:void 0,(function(t,r,n){var i;return $L.isWindow(t)?0===o.indexOf("outer")?t["inner"+e]:t.document.documentElement["client"+e]:9===t.nodeType?(i=t.documentElement,Math.max(t.body["scroll"+e],i["scroll"+e],t.body["offset"+e],i["offset"+e],i["client"+e])):void 0===n?$L.css(t,r,a):$L.style(t,r,n,a)}))}}))})),$L.texthighlighter=function(e,t,r,o,n){var i=new RegExp(t,"gi"),a=document.createDocumentFragment();if(r=r||"span",t.length>0){var s=e.match(i),l=0;for(l=0;s&&l<s.length;l++){var d=e.indexOf(s[l]),c=s[l];(u=e.slice(0,d)).length&&a.appendChild(document.createTextNode(u));var p=document.createElement(r);p.innerText=c,a.appendChild(p),e=e.slice(d+s[l].length)}}if(e.length){var u=e.slice(0,e.length);u&&a.appendChild(document.createTextNode(u))}return a},lyteDomObj.prototype.extend({path:function(){for(var e,t,r=this[0],o=[];r&&1===r.nodeType&&"BODY"!==r.tagName;){if(e=1,t="",t+=r.nodeName.toLowerCase(),r.id)t+="#"+r.id;else{for(;r.previousElementSibling;)r=r.previousElementSibling,e++;t+=":nth-child("+e+")"}o.unshift(t),r=r.parentNode}return o.join(" > ")},closest:function(e,t){var r=0,o=this.length,n=[];if(!$L.needsContext.test(e))for(;r<o;r++){var i=this[r];do{if(1===i.nodeType&&$L(i).is(e)){n.push(i);break}i=i.parentNode}while(i&&i!==t)}return $L._removeDupes(n,!1,this)},css:function(e,t){return $L._processInput(this,e,t,(function(e,t,r){var o=0,n={};if(Array.isArray(t)){for(;o<t.length;o++)n[t[o]]=$L.css(e,t[o]);return n}return null!=r?$L.style(e,t,r):$L.css(e,t)}))},removeProp:function(e){return $L.each(this,(function(){delete this[$L.propNames[e]||e]}))},removeAttr:function(e){return $L.each(this,(function(t,r){$L.removeAttr(r,e)}))},attr:function(e,t){return $L._processInput(this,e,t,$L.attr)},prop:function(e,t){return $L._processInput(this,e,t,$L.prop)},siblings:function(e){var t;return t=$L.map(this,(function(t,r){var o,n=[],i=t.parentElement.children;for(o=0;o<i.length;o++)t!==i[o]&&1===i[o].nodeType&&$L._checkMatch(i[o],e)&&n.push(i[o]);return n})),$L._removeDupes(t,!1,this)},children:function(e){var t;return t=$L.map(this,(function(t,r){var o,n=[],i=t.children,a=i.length;for(o=0;o<a;o++)1===i[o].nodeType&&$L._checkMatch(i[o],e)&&n.push(i[o]);return n})),this.pushStack(t)},prevUntil:function(e,t,r){var o;return o=$L.map(this,(function(o,n){var i=[];for(r&&$L._checkMatch(o,t)&&i.push(o);o=o.previousSibling;){if(1===o.nodeType&&$L(o).is(e)){r&&$L._checkMatch(o,t)&&i.push(o);break}1===o.nodeType&&$L._checkMatch(o,t)&&i.push(o)}return i})),$L._removeDupes(o,!0,this)},nextUntil:function(e,t,r){var o;return o=$L.map(this,(function(o,n){var i=[];for(r&&$L._checkMatch(o,t)&&i.push(o);o=o.nextSibling;){if(1===o.nodeType&&$L(o).is(e)){r&&$L._checkMatch(o,t)&&i.push(o);break}1===o.nodeType&&$L._checkMatch(o,t)&&i.push(o)}return i})),$L._removeDupes(o,!1,this)},parentsUntil:function(e,t){var r;return r=$L.map(this,(function(r,o){for(var n=[];(r=r.parentNode)&&(1!==r.nodeType||!$L(r).is(e));)1===r.nodeType&&$L._checkMatch(r,t)&&n.push(r);return n})),$L._removeDupes(r,!0,this)},parents:function(e){var t;return t=$L.map(this,(function(t,r){for(var o=[];(t=t.parentNode)&&9!==t.nodeType;)1===t.nodeType&&$L._checkMatch(t,e)&&o.push(t);return o})),$L._removeDupes(t,!0,this)},parent:function(e){var t=$L.map(this,(function(t,r){var o=t.parentNode;return o&&11!==o.nodeType&&$L._checkMatch(o,e)?o:null}));return $L._removeDupes(t,!1,this)},offsetParent:function(){return this.map((function(e,t){for(var r=t.offsetParent;r&&"static"===$L.css(r,"position");)r=r.offsetParent;return r||document.documentElement}))},offset:function(e){if(arguments.length)return void 0===e?this:this.each((function(t,r){$L.offset.setOffset(r,e,t)}));var t,r,o=this[0];return o?o.getClientRects().length?(t=o.getBoundingClientRect(),r=o.ownerDocument.defaultView,{top:t.top+r.pageYOffset,left:t.left+r.pageXOffset}):{top:0,left:0}:void 0},position:function(){if(this[0]){var e,t,r,o=this[0],n={top:0,left:0};if("fixed"===$L.css(o,"position"))t=o.getBoundingClientRect();else{for(t=this.offset(),r=o.ownerDocument,e=o.offsetParent||r.documentElement;e&&(e===r.body||e===r.documentElement)&&"static"===$L.css(e,"position");)e=e.parentNode;e&&e!==o&&1===e.nodeType&&((n=$L(e).offset()).top+=parseFloat($L.css(e,"borderTopWidth",!0)),n.left+=parseFloat($L.css(e,"borderLeftWidth",!0)))}return{top:t.top-n.top-parseFloat($L.css(o,"marginTop",!0)),left:t.left-n.left-parseFloat($L.css(o,"marginLeft",!0))}}},next:function(e){var t=$L.map(this,(function(t,r){do{t=t.nextSibling}while(t&&1!=t.nodeType);return t&&1===t.nodeType&&$L._checkMatch(t,e)?t:null}));return this.pushStack(t)},nextAll:function(e){var t=$L.map(this,(function(t,r){var o=[];do{(t=t.nextSibling)&&1===t.nodeType&&$L._checkMatch(t,e)&&o.push(t)}while(t);return o}));return $L._removeDupes(t,!1,this)},prev:function(e){var t=$L.map(this,(function(t,r){do{t=t.previousSibling}while(t&&1!=t.nodeType);return t&&1===t.nodeType&&$L._checkMatch(t,e)?t:null}));return this.pushStack(t)},prevAll:function(e){var t=$L.map(this,(function(t,r){var o=[];do{(t=t.previousSibling)&&1===t.nodeType&&$L._checkMatch(t,e)&&o.push(t)}while(t);return o}));return $L._removeDupes(t,!0,this)},contents:function(){var e=$L.map(this,(function(e){return e.nodeName&&"iframe"===e.nodeName.toLowerCase()?e.contentDocument:(e.nodeName&&"template"===e.nodeName.toLowerCase()&&(e=e.content||e),$L.merge([],e.childNodes))}));return this.pushStack(e)},toggleClass:function(e,t){var r,i,a,s,l=this;return $L.isFunction(e)?l.each((function(r,o){$L(o).toggleClass(e.call(o,r,n(o),t),t)})):"boolean"==typeof t?(t?l.addClass(e):l.removeClass(e),this):"string"==typeof t?(s=[].slice.call(arguments),this.toggleClass(s)):$L.each(l,(function(t,s){if(1===s.nodeType)if("string"==typeof e||Array.isArray(e)){var l=o(e);if(l.length)for(r=0;r<l.length;r++)(i=$L(s)).hasClass(l[r])?i.removeClass(l[r]):i.addClass(l[r])}else(a=n(s))&&$L._dataPriv.set(s,"__classname__",a),a||!1===e?s.setAttribute("class",""):s.setAttribute("class",$L._dataPriv.get(s,"__classname__"))}))},addClass:function(e){var t,r,i,a,s=this,l=this.length;if($L.isFunction(e))return s.each((function(t,r){$L(r).addClass(e.call(r,t,n(r)))}));if(arguments.length>1)return a=[].slice.call(arguments),this.addClass(a);for(i=o(e),t=0;t<l;t++)if(1===s[t].nodeType)for(r=0;r<i.length;r++)"string"==typeof i[r]&&i[r]&&(s[t].classList?s[t].classList.add(i[r]):s[t].className+=" "+i[r]);return this},removeClass:function(e){var t,r,i,a=this,s=this.length,l=0,d=0,c=!1;if($L.isFunction(e))return a.each((function(t,r){$L(r).removeClass(e.call(r,t,n(r)))}));if(!arguments.length)return this.attr("class","");if(arguments.length>1)return t=[].slice.call(arguments),this.removeClass(t);for(r=o(e),l=0;l<s;l++)if(1===a[l].nodeType){for(i=" "+(i=n(a[l]))+" ",d=0;d<r.length;d++)"string"==typeof r[d]&&r[d]&&(a[l].classList?a[l].classList.remove(r[d]):(c=!0,i.replace(" "+r[d]+" "," ")));c&&(a[l].setAttribute("class",i),c=!1)}return this},hasClass:function(e){var t,r=this.length;for(e=" "+e+" ",t=0;t<r;t++)if(1===this[t].nodeType&&-1!==(" "+n(this[t])+" ").indexOf(e))return!0;return!1},val:function(e){var t,r,o,n=this[0];if(void 0===e){if(n){if((o=$L.valHooks[n.type]||$L.valHooks[n.nodeName.toLowerCase()])&&"get"in o&&void 0!==(t=o.get(n,"value")))return t;t=n.value}return"string"==typeof t?t.replace(p,""):null==t?"":t}return r=$L.isFunction(e),this.each((function(t,o){var n;null==(n=r?e.call(o,t,$L(o).val()):e)?n="":"number"==typeof n?n+="":Array.isArray(n)&&(n=$L.map(n,(function(e){return null==e?"":e+""})));var i=$L.valHooks[this.type]||$L.valHooks[this.tagName.toLowerCase()];i&&"set"in i&&void 0!==i.set(this,n,"value")||(this.value=n)}))}}),$L.cssHooks={borderWidth:{set:c},padding:{set:c},marginLeft:{get:function(e,t){if(t&&!$L._meta.support.reliableMarginLeft())return e.getBoundingClientRect().left-d(e,{marginLeft:0},(function(){return e.getBoundingClientRect().left}))+"px"}},opacity:{get:function(e,t){if(t){var r=a(e,"opacity");return""===r?"1":r}}}};var $={position:"absolute",visibility:"hidden",display:"block"};$L.each(["top","left"],(function(e,t){$L.cssHooks[t]={get:function(e,r){if(r&&!$L._meta.support.reliablePixelPosition()){var o=a(e,t);return g.test(o)?$L(e).position()[t]+"px":o}}}})),$L.each(["width","height"],(function(e,t){$L.cssHooks[t]={get:function(e,r,o){if(r)return!_.test($L.css(e,"display"))||e.getClientRects().length&&e.getBoundingClientRect().width?l(e,t,o):d(e,$,(function(){return l(e,t,o)}))},set:function(e,r,o){var n,a=o&&i(e),l=o&&"border-box"===$L.css(e,"boxSizing",!1,a),d=o&&s(e,t,o,l,a);return d&&(n=m.exec(r))&&"px"!==(n[3]||"px")&&(e.style[t]=r,r=$L.css(e,t)),c(0,r,d)}}})),$L.offset={setOffset:function(e,t,r){var o,n,i,a,s,l,d=$L.css(e,"position"),c=$L(e),p={};return"static"===d&&c.css("position","relative"),s=c.offset(),i=$L.css(e,"top"),l=$L.css(e,"left"),("absolute"===d||"fixed"===d)&&(i+l).indexOf("auto")>-1?(a=(o=c.position()).top,n=o.left):(a=parseFloat(i)||0,n=parseFloat(l)||0),$L.isFunction(t)&&(t=t.call(e,r,$L.extend({},s))),null!=t.top&&(p.top=t.top-s.top+a),null!=t.left&&(p.left=t.left-s.left+n),c.css("top",p.top),c.css("left",p.left),c}},$L.extend({cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},propNames:{cellpadding:"cellPadding",cellspacing:"cellSpacing",class:"className",colspan:"colSpan",contenteditable:"contentEditable",for:"htmlFor",frameborder:"frameBorder",maxlength:"maxLength",readonly:"readOnly",rowspan:"rowSpan",tabindex:"tabIndex",usemap:"useMap"},attrHooks:{type:{set:function(e,r){if(!$L._meta.support.radioValue&&t(e,"input")&&"radio"===r){var o=e.value;return e.setAttribute(type,r),o&&(e.value=o),r}}}},removeAttr:function(e,t){var r,o=0;for(t=t&&t.match($L.regex.rnothtmlwhite)||[];r=t[o++];)e.removeAttribute(r)},style:function(e,t,o,n){var i,a,s=y.test(t),l=typeof o;e&&1===e.nodeType&&(i=e.style,a=$L.cssHooks[t]||$L.cssHooks[o],"string"===l&&(ret=m.exec(o))&&ret[1]&&(o=r(e,t,ret),l="number"),"number"===l&&(o+=$L.cssNumber[t]?"":"px"),o=a&&"set"in a?a.set(e,o,n):o,s?i.setProperty(e,o):i[t]=o)},css:function(e,t,r,o){var n,i,s=$L._camelCase(t);return(i=$L.cssHooks[t]||$L.cssHooks[s])&&"get"in i&&(n=i.get(e,!0,r)),void 0===n&&(n=a(e,t,o)),"normal"===n&&t in b&&(n=b[t]),r?parseFloat(n)||0:n},attr:function(e,t,r){var o,n;return t=t.toLowerCase(),o=$L.attrHooks[t]||L.test(t)&&A,void 0!==r?null===r?void $L.removeAttr(e,t):o&&"set"in o&&void 0!==(n=o.set(e,t,r))?n:(e.setAttribute(t,r+""),r):o&&"get"in o&&null!==(n=o.get(e,t))?n:null==(n=e.getAttribute(t))?void 0:n},prop:function(e,t,r){var o,n;return t=$L.propNames[t]||t,o=$L.propHooks[t],void 0===r?o&&"get"in o&&void 0!==(n=o.get(e,t))?n:e[t]:o&&"set"in o&&void 0!==(n=o.set(e,r,t))?n:e[t]=r},valHooks:{checkbox:{set:function(e,t){Array.isArray(t)&&(e.checked=$L.inArray($L(e).val(),t)>-1)},get:function(e){null===e.getAttribute("value")||e.value}},radio:{set:function(e,t){if(Array.isArray(t))return e.checked=$L.inArray($L(e).val(),t)>-1},get:function(e){return null===e.getAttribute("value")?"on":e.value}},select:{get:function(e){var r,o,n,i=e.options,a=e.selectedIndex,s="select-one"===e.type,l=s?null:[],d=s?a+1:i.length;for(n=a<0?d:s?a:0;n<d;n++)if(((o=i[n]).selected||n===a)&&!o.disabled&&(!o.parentNode.disabled||!t(o.parentNode,"optgroup"))){if(r=$L(o).val(),s)return r;l.push(r)}return l},set:function(e,t){for(var r,o,n=e.options,i=$L.makeArray(t),a=n.length;a--;)((o=n[a]).selected=$L.inArray($L.valHooks.option.get(o),i)>-1)&&(r=!0);return r||(e.selectedIndex=-1),i}},option:{get:function(e){var t=$L.attr(e,"value");return null!=t?t:function(e){return(e.match($L.regex.rnothtmlwhite)||[]).join(" ")}($L(e).text())}}}}),$L.propHooks={tabIndex:{get:function(e){var t=e.getAttribute("tabindex");return t?parseInt(t,10):f.test(e.nodeName)||h.test(e.nodeName)&&e.href?0:-1}}}}(null==window?this:window),function(e){function t(){for(var e;e=a.shift();)e.call()}function r(e){for(var t in e)if(e[t].length>0)return!1;return!0}function o(e,t,o,n,i,a){var s;return"boolean"==typeof o&&(o=p),"function"!=typeof o?e:(s=o,a&&(o=function(e){var t,n=e.delegateTarget,i=$L._dataPriv.get(n),a=e.type,l=i.events[a];for(t=0;t<l.length;t++)if(l[t].handler===o){l.splice(t,1);break}r(i.events)&&n.removeEventListener(a,i.handle),s.apply(this,arguments)}),o.unId||(o.unId=$L.ev.unId++),$L.each(e,(function(e,r){var a,s,l,d,c=$L._dataPriv.get(r);for(c.events||(c.events={}),s=(a=t.match($L.regex.rnothtmlwhite)).length,(d=c.handle)||(c.handle=d=function(e){$L.ev.triggered!==e.type&&$L.ev.dispatch.apply(r,arguments)});s--;)l=a[s],c.events[l]||(c.events[l]=[]),c.events[l].push({handler:o,type:l,selectors:n,data:i}),r.addEventListener(l,d)})))}function n(e){return 1===e.nodeType||9===e.nodeType||!+e.nodeType}function i(e){e.stopPropagation()}var a=[],s="initial",l=/^key/,d=/^(?:mouse|pointer|contextmenu|drag|drop)|click/;$L.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],(function(e,t){lyteDomObj.prototype[t]=function(e){return this.on(t,e)}})),lyteDomObj.prototype.ready=function(e){return a.push(e),"initial"===s&&"ready"!==document.readyState&&"complete"!==document.readyState?(s="registered",document.addEventListener("DOMContentLoaded",(function(){t()}))):"ready"!==document.readyState&&"complete"!==document.readyState||t(),this},$L.each(["blur","focus","focusin","focusout","resize","bindScroll","click","dblclick","mousedown","mouseup","mousemove","mouseover","mouseout","mouseenter","mouseleave","change","select","submit","keydown","keypress","keyup","contextmenu"],(function(e,t){lyteDomObj.prototype[t]=function(e,r){var o="bindScroll"===t?"scroll":t;return arguments.length>0?this.on(o,null,e,r):this.trigger(o)}})),$L.debounce=function(e,t,r){var o,n=function(){var n,i=arguments,a=this,s=function(){n=e.apply(a,i)};return!t&&r?s():(o&&clearTimeout(o),o=setTimeout(s,t)),n};return n.cancel=function(){clearTimeout(o),o=null},n},lyteDomObj.prototype.extend({on:function(e,t,r,o){return $L.ev.add(this,e,t,r,o)},one:function(e,t,r,o){return $L.ev.add(this,e,t,r,o,!0)},off:function(e,t,r){var o,n;if(e.preventDefault&&e.handleObj)return n=e.handleObj,$L(e.delegateTarget).off(e.type,n.selector,n.handler),this;if("object"==typeof e){for(o in e)this.off(o,t,e[o]);return this}return!1!==t&&"function"!=typeof t||(r=t,t=void 0),!1===r&&(r=p),$L.each(this,(function(){$L.ev.removeEvents(this,e,t,r)}))},trigger:function(e,t){return this.each((function(r,o){$L.ev.trigger(e,t,o)}))},triggerHandler:function(e,t){var r=this[0];if(r)return $L.ev.trigger(e,t,r,!0)}}),$L.ev={unId:1,removeEvents:function(e,t,r,o){var n,i,a,s,l,d,c,p=$L._dataPriv.hasData(e)&&$L._dataPriv.get(e),u=(p||{}).events,f=0;if(u){for(a=(n=(t||"").match($L.regex.rnothtmlwhite)||[]).length;f<a;f++){for(l=u[s=n[f]]||[],i=0;i<l.length;i++)c=(d=l[i]).handler,r&&r!==d.selector&&("**"!==r||!d.selector)||o&&c.unId!==o.unId||(l.splice(i,1),i--);l.length||(e.removeEventListener(s,p.handle),delete u[s])}$L.isEmptyObject(u)&&$L._dataPriv.remove(e,"events handle")}},add:function(e,t,r,n,i,a){var s;if("object"==typeof t){if("string"==typeof r)for(s in t)$L.ev.add(e,s,r,n,t[s],a);else for(s in t)$L.ev.add(e,s,void 0,r,t[s],a);return e}return null==n&&null==i?o(e,t,r,void 0,void 0,a):null==i?"string"==typeof r?o(e,t,n,r,void 0,a):o(e,t,n,void 0,r,a):o(e,t,i,r,n,a)},trigger:function(t,r,o,a){var s,l,d,c,p,u,f,h=[o||document],y=0,v="string"==typeof t?t:t.type;r=void 0===r?[]:r;if(l=u=o=o||document,s=o.parentNode,p="on"+(v=(t=t[$L.expando]?t:new $L.Event(v,"object"==typeof t&&t)).type),t.target||(t.target=o),d=$L.merge([t],r),f=$L.ev.special[v]||{},a||!f.trigger||!1!==f.trigger.apply(o,r)){if(!a&&!f.noBubble&&!$L.isWindow(o)){for(;s;s=s.parentNode)h.push(s),l=s;l===(o.ownerDocument||document)&&h.push(l.defaultView||l.parentWindow||e)}for(;(s=h[y++])&&!t.isPropagationStopped();)u=s,(c=($L._dataPriv.get(s,"events")||{})[v]&&$L._dataPriv.get(s,"handle"))&&c.apply(s,d),(c=p&&s[p])&&c.apply&&n(s)&&(t.result=c.apply(s,d),!1===t.result&&t.preventDefault());return a||t.isDefaultPrevented()||f._default&&!1!==f._default.apply(h.pop(),d)||!n(o)||p&&$L.isFunction(o[v])&&!$L.isWindow(o)&&((l=o[p])&&(o[p]=null),$L.ev.triggered=v,t.isPropagationStopped()&&u.addEventListener(v,i),o[v](),t.isPropagationStopped()&&u.removeEventListener(v,i),$L.ev.triggered=void 0,l&&(o[p]=l)),t.result}},addProp:function(e,t){Object.defineProperty($L.Event.prototype,e,{enumerable:!0,configurable:!0,get:$L.isFunction(t)?function(){if(this.originalEvent)return t(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[e]},set:function(t){Object.defineProperty(this,e,{enumerable:!0,configurable:!0,writable:!0,value:t})}})},dispatch:function(e){var t,r,o,n,i,a,s,l,d,c=this,p=e.expando?e:new $L.Event(e),u=$L._dataPriv.get(c).events[p.type],f=[],h=[],y={context:c,handler:[]};for(p.delegateTarget=this,f[0]=p,t=1;t<arguments.length;t++)f[t]=arguments[t];for(t=0;t<u.length;t++)if(o=(r=u[t]).handler,n=r.selectors,d=r.data,!n||"click"===p.type&&p.button>=1)"click"===p.type&&p.button>=1||y.handler.push(r);else for(i=e.target;i!==c;i=i.parentNode)1!==i.nodeType||"click"===e.type&&!0===i.disabled||$L._matches(i,n)&&(p.currentTarget=i,h.push({context:i,handler:[r]}));for(h.push(y),t=0;t<h.length&&!p.isPropagationStopped();t++)for(o=h[t].handler,s=h[t].context,p.currentTarget=s,i=0;i<o.length&&!p.isImmediatePropagationStopped();i++)l=o[i].handler,d=o[i].data,p.data=d,p.handleObj=o[i],a=l.apply(s,f),!1===(p.result=a)&&(p.preventDefault(),p.stopPropagation());return p.result},triggered:void 0,special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==document.activeElement&&this.focus)return this.focus(),!1}},blur:{trigger:function(){if(this!==document.activeElement&&this.blur)return this.blur(),!1}},click:{trigger:function(){if("input"===this.nodeName.toLowerCase()&&"checkbox"===this.type&&this.click)return this.click(),!1}},beforeunload:{postDispatch:function(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}}};var c=function(){return!0},p=function(){return!1};$L.Event=function(e,t){if(this===$L)return new $L.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.currentTarget=e.currentTarget,this.relatedTarget=e.relatedTarget,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented?c:p,this.target=e.target):this.type=e,t&&$L.extend(this,t),this.timeStamp=e&&e.timeStamp||Date.now(),this[$L.expando]=!0},$L.Event.prototype={constructor:$L.event,isDefaultPrevented:p,isPropagationStopped:p,isImmediatePropagationStopped:p,isSimulated:!1,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=c,e&&!this.isSimulated&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=c,e&&!this.isSimulated&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=c,e&&!this.isSimulated&&e.stopImmediatePropagation(),this.stopPropagation()}},$L.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:function(e){var t=e.button;return null==e.which&&l.test(e.type)?null!=e.charCode?e.charCode:e.keyCode:!e.which&&void 0!==t&&d.test(e.type)?1&t?1:2&t?3:4&t?2:0:e.which}},$L.ev.addProp)}(null==window?this:window),function(e){function t(e){var t=[];return $L.each(e,(function(){!function(e,r){var o;o=$L.isFunction(r)?r():r,t[t.length]=encodeURIComponent(e)+"="+encodeURIComponent(o)}(this.name,this.value)})),t.join("&")}function r(e){return"string"==typeof e?e:Array.isArray(e)?t(e):function(e){var t=[];for(var r in e)t[t.length]=encodeURIComponent(r)+"="+encodeURIComponent(null==e[r]?"":e[r]);return t.join("&")}(e)}function o(e,t){for(var r in t)r=r.toLowerCase(),e.hasOwnProperty(r)||(e[r]=t[r])}function n(e){var t,r=["accepts","converters","contents","headers"],n=$L.ajaxSettings;for(t in n)~r.indexOf(t)?o(e[t]?e[t]:e[t]={},n[t]):e[t]=null==e[t]?n[t]:e[t]}function i(e){return"text"!==(e.responseType||"text")||"string"!=typeof e.responseType}function a(e,t,r){for(var o;o=e.shift();)o.apply(t,r)}function s(e,t,r,o){var n,i,a=t.dataTypes,s=t.contents;if("*"===a[0]&&(n=t.mimeType||r.getResponseHeader("content-type")),n)for(i in s)if(s[i].test(n)){a[0]=i;break}return"*"===a[0]&&(a[0]=o),function(e,t,r,o,n){var i,a,s;if(e===t)return{data:r,state:"success"};if("HEAD"!==n.type){for(var l in a=e+" "+t,n.converters)if(l.toLowerCase()===a){s=n.converters[l];break}o.responseText=r;try{i=s?s(r):""}catch(e){return{data:void 0,state:"parseerror",error:e}}return $L.ajaxSettings.responseFields[t]&&(o[$L.ajaxSettings.responseFields[t]]=i),{data:i,state:"success"}}}(o,a[0],e,r,t)}var l,d=/^(HEAD|GET)$/,c=/\?/,p=new Date,u=/(.*?):\s*(.*?)[\r\n]/g,f=/#.*$/,h=/([?&])_=[^&]*/;"undefined"!=typeof document&&((l=document.createElement("a")).href=e.location.href),$L.extend({active:0,ajaxSettings:{contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/,script:/\b(?:java|ecma)script\b/},converters:{"* text":String,"text text":function(e){return e},"text html":function(e){return e},"text json":JSON.parse,"text xml":$L.parseXML,"text javascript":$L.Evaluate},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},accepts:{"*":"*/*",text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript",script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"}},ajaxSetup:function(e){for(var t in e)$L.ajaxSettings[t]=e[t]},ajax:function(e,t){function o(e,r,o,n,i){var l=r;E||(E=!0,L=n||"",K.readyState=e>0?4:0,(O=e>=200&&e<300||304===e)?(o=s(o,t,K,i),304==e?l="notmodified":204==e||"HEAD"==t.type?l="nocontent":(l=o.state,w=o.data,S=o.error,O=!S)):(K.responseText=o,!e&&l||(l="error",e=e<0?0:e),S=l),K.status=e,K.statusText=(l||r)+"",O?C.length>0&&a(C,D,[w,l,K]):P.length>0&&a(P,D,[K,l,S]),I&&I.trigger&&v&&I.trigger(O?"ajaxSuccess":"ajaxError",[K,t,O?w:S]),k.length>0&&a(k,D,[K,l]),I&&I.trigger&&v&&(I.trigger("ajaxComplete",[K,t]),$L.ev&&!--$L.active&&$L.ev.trigger("ajaxStop")))}"object"==typeof e&&(e=(t=e).url),n(t||(t={})),t.url||(t.url=e);var y,v,m,_,g,b,L,A,$,E,T,R,O,w,S,C=[],P=[],k=[],N=t.xhr,x=(t.type||"GET").toUpperCase(),j=d.test(x),D=t.context||t,I=t.context&&(t.context instanceof lyteDomObj||t.nodeType)?$L(t.context):$L.ev,B=t.beforeSend,M="cancelled",F={},K={readyState:0,setRequestHeader:function(e,t){return null==E&&t&&(F[e]=t),this},overrideMimeType:function(e){return null==E&&(t.mimeType=e),this},getAllResponseHeaders:function(){return E?L:null},getResponseHeader:function(e){var t;if(E){if(!A)for(A={};t=u.exec(L);)A[t[1].toLowerCase()]=t[2];return(t=A[e.toLowerCase()])||null}},abort:function(e){var t=e||M;return H&&H.abort(),o(0,t),this},then:function(e,r){return C.push(e),P.push(r),t.async||(O?a(C,D,[w,this.statusText,this]):a(P,D,[this,this.statusText,S])),this},fail:function(e){return P.push(e),t.async||O||a(P,D,[this,this.statusText,S]),this},always:function(e){return k.push(e),t.async||a(k,D,[this,this.statusText]),this},done:function(e){return C.push(e),!t.async&&O&&a(C,D,[w,this.statusText,this]),this}};if(t.dataTypes=(t.dataType||"*").toLowerCase().match($L.regex.rnothtmlwhite),y=t.async="boolean"!=typeof t.async||t.async,v=t.global="boolean"!=typeof t.global||t.global,$=t.processData="boolean"!=typeof t.processData||t.processData,l&&null==t.crossDomain){R=document.createElement("a");try{R.href=t.url,R.href=R.href,t.crossDomain=R.protocol+"//"+R.host!=l.protocol+"//"+l.host}catch(e){t.crossDomain=!0}}for(b in m=t.url.replace(f,""),$&&(j?(_=t.url.slice(m.length),t.data&&(m=function(e,t){var o;return o=r(t),e+(c.test(e)?"&":"?")+o}(m,t.data)),!1===t.cache&&(m=m.replace(h,"$1"),_=(c.test(m)?"&":"?")+"_="+p+++_),t.url=m+_):t.data&&(t.data=r(t.data))),$L.ev&&v&&0==$L.active++&&$L.ev.trigger("ajaxStart"),(t.data&&!j&&!1!==t.contentType||t.contentType)&&K.setRequestHeader("Content-Type",t.contentType||"application/x-www-form-urlencoded; charset=UTF-8"),t.headers)K.setRequestHeader(b,t.headers[b]);if(K.setRequestHeader("Accept",t.dataTypes[0]&&t.accepts[t.dataTypes[0]]?t.accepts[t.dataTypes[0]]+("*"!==t.dataTypes[0]?",*/*; q=0.01":""):t.accepts["*"]),B&&(!1===B.call(D,K,t)||E))return K.abort();if(M="abort",t.success&&C.push(t.success),t.error&&P.push(t.error),t.complete&&k.push(t.complete),K.readyState=1,I&&I.trigger&&v&&I.trigger("ajaxSend",[K,t]),E)return K;var H=N||new XMLHttpRequest;for(T in H.open(x,t.url,y),t.xhrFields)H[T]=t.xhrFields[T];for(b in t.mimeType&&K.overrideMimeType(t.mimeType),t.crossDomain||F["X-Requested-With"]||(F["X-Requested-With"]="XMLHttpRequest"),F)H.setRequestHeader(b,F[b]);return g=!j&&t.data||null,H.onload=function(){var e=i(H);o(H.status,H.statusText,e?H.response:H.responseText,H.getAllResponseHeaders(),e?"binary":"text")},H.onerror=H.onabort=function(){var e=i(H);o(H.status,H.statusText,e?H.response:H.responseText,H.getAllResponseHeaders(),e?"binary":"text")},t.async&&(H.timeout=t.timeout?t.timeout:0,H.ontimeout=function(){o(0,"timeout")}),H.send(g),K},getScript:function(e,t,r){return $L.get(e,t,r)},getJSON:function(e,t){return $L.get(e,void 0,t)}}),$L.each(["get","post"],(function(e,t){$L[t]=function(e,r,o,n){return $L.isFunction(r)&&(n=n||o,o=r,r=void 0),$L.ajax($L.extend({type:t,url:e,data:r,dataType:n,success:o},$L.isPlainObject(e)&&e))}}))}("undefined"==typeof window?this:window),function(){var e=function(){var e="reverse",t=document.createElement("div");t.innerHTML="<div style='position: absolute; left: 0; top: 0; overflow: hidden; width: 10px;height: 1px;'><div style='width: 20px; height: 1px;'></div></div>";var r=t.children[0];return document.body.appendChild(r),r.scrollLeft>0?e="default":(r.scrollLeft=-5,r.scrollLeft<0&&(e="negative")),document.body.removeChild(r),e};"undefined"!=typeof document&&("ready"!==document.readyState&&"complete"!==document.readyState?document.addEventListener("DOMContentLoaded",(function(){$L.rtlScrollType=e()})):"ready"!==document.readyState&&"complete"!==document.readyState||($L.rtlScrollType=e()))}();